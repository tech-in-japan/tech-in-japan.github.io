<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌫️ 🏤 🍌 Arduinoでquadrocopterをプログラミングします（パート1） 👏🏽 ✋🏻 🥊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、habrozhiteli！ 
 このシリーズの記事では、クアドロコプターの蓋をあなたの趣味が必要とするよりも少しだけ開き、フライトコントローラー用の独自のプログラムを作成、構成、起動します。これは通常のArduino Mega 2560ボードです。 

 私たちには先があります： 

1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Arduinoでquadrocopterをプログラミングします（パート1）</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><img src="https://habrastorage.org/getpro/habr/post_images/273/acb/b5e/273acbb5ef7f942256627c7fe9d1ed92.jpg"><br clear="all"><br clear="all"> こんにちは、habrozhiteli！ <br clear="all"> このシリーズの記事では、クアドロコプターの蓋をあなたの趣味が必要とするよりも少しだけ開き、フライトコントローラー用の独自のプログラムを作成、構成、起動します。これは通常のArduino Mega 2560ボードです。 <br clear="all"><br clear="all"> 私たちには先があります： <ol><li> 基本的な概念（初心者ヘリコプターガイド用）。 </li><li> 仮想クアドロコプターでの作業のインタラクティブなWebデモンストレーションを備えたPIDコントローラー。 </li><li> 実際には、ArduinoのプログラムとQtのチューニングプログラムです。 </li><li> ロープでの危険なクアドロコプターテスト。 最初のフライト。 </li><li> 現場でのクラッシュと損失。  QtとOpenCVを使用した自動航空検索。 </li><li> 最後に成功したテスト。 まとめます。 次はどこ？ </li></ol><br clear="all"> 素材は膨大ですが、2〜3件の記事に収まるようにします。 <br clear="all">  <b>今日は私たちを待っています：私たちのクアドロコプターが飛んだ方法のビデオでネタバレ。</b>  <b>基本的な概念;</b>  <b>PIDレギュレーターとその係数の選択方法。</b> <a name="habracut"></a><br clear="all"><br clear="all"><h1>  <font color="black">なんでこんなこと？</font> </h1> 学術的な関心。これは、偶然にも私だけではありません（ <a href="http://habrahabr.ru/company/technoworks/blog/216437/">1、2、3</a> ）。 まあ、もちろん、魂のために。 仕事中にそれをとても楽しんで、プログラムで「IT」が飛んだとき、言葉では言い表せないほどの幸せを感じました:-) <br clear="all"><br clear="all"><h1>  <font color="black">誰のため？</font> </h1> この資料は、遠くにいる人や、マルチローターシステムの作業を始めようとしている人にとって興味深いものです。 それでは、クアドロコプターのメインノードの指定、それらが相互にどのように相互作用するか、基本的な概念、および飛行の原理について話しましょう。 もちろん、私たちが必要とするすべての知識はネット上で見つけることができますが、広大なインターネット上でそれを探すことを強制することはできません。 <br clear="all"><br clear="all"> 基本概念の理解を損なうことなく<b>、太字の</b>次のなじみのない用語、または理解できない図まで、知っていることをすべてスキップしてください。 <br clear="all"><br clear="all"><h1>  <font color="red">いいえ、1番！</font> </h1> かなり多くの既製のソリューション（Ardupilot、MegapirateNG、MiltiWii、AeroQuadなど）を試すまでは、フライトコントローラー用の独自のプログラムを作成しないでください。 まず、危険です！  GPSと気圧計を使用せずにクアドロコプターを制御するには、練習が必要です。さらに、バギーの場合、ひっくり返り、本来あるべき場所に飛行できません。これは、最初のテストではほとんど回避できません。 第二に、何をプログラムする必要があり、最終的にどのように機能するかを理解することで、プログラムが何倍も簡単になります。 信じてください： <b>飛行数学はプログラムコードのほんの一部です</b> 。 <br clear="all"><br clear="all"><h1>  <font color="red">いいえ2！</font> </h1> 学術的な興味を追求しておらず、すべてを自分で書いている間に、既製のソリューション（フライ、写真を撮る、ビデオを撮る、課題を飛ぶなど）だけが必要な場合は、フライトコントローラー用の独自のプログラムを作成しないでください。あなたが一人ではない場合でも、多くの時間が経過します。 <br clear="all"><br clear="all"><h1>  <font color="black">基本的な概念</font> </h1><br clear="all"> クアドロコプターは異なりますが、それらはすべて4つのローターによって結合されています。 <table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a8/8e8/331/9a88e83311d45323b463c27b61bd21c3.png"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/53c/748/9c4/53c7489c45995345b5d65f658742a233.png"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/33e/6b1/d33/33e6b1d33a7c20a6154332340a546674.png"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </td></tr><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/690/205/4f9/6902054f93423197b7093bac17fe1de9.png"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/946/53d/dad/94653ddad9e5dd8a3f0477f86e8f2ce5.png"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/de5/415/362/de541536288b239ca72500177f8e5aee.png"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </td></tr></tbody></table>見かけの対称性にもかかわらず、パイロットはクアドロコプターが正面にある場所を区別することが非常に重要です（矢印で表示）。 ここでは、ラジコンカーモデルと同様に、「forward」コマンドを使用すると、クアドロコプターはパイロットが見ている場所ではなく、クアドロコプターの仮想鼻が向いている場所を飛行します。 これには危険が伴います：初心者が風に巻き込まれ、何らかの方法で横に展開されたデバイスを取り戻すのは難しい場合があります（もちろん、一人称視点でカメラを飛行することや、コンパスとGPSを使用した「スマート」フライトモードについては話していません）。前面のネジまたは異なる色の光線、前面のボールまたはマルチカラーLEDがこの問題を部分的に解決します。 しかし、ペペラットが急速に地平線上のポイントに変わっているとき、これはすべて役に立たない。 <br clear="all"><br clear="all"> 私は「X」という形のクアッドコプターのフレームで飛行します。私はそれがより外部的に好きだからです。 各設計には、独自の利点と目的があります。 クアドロコプターに加えて、他のマルチコプターがあります。 あなたがエキゾチックなオプションを数えなくても、それらのタイプはすべて同じです-たくさん！ <br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/0a9/a34/eaa/0a9a34eaa5d4d3319d3f9dda1a988be1.png"><br clear="all"><br clear="all"> クアドロコプターが内部にどのように配置されているか、プログラムする予定のフライトコントローラーで何をすべきかを把握します。 <br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/62b/019/4a5/62b0194a51d7507b7c9ba573fdc94e4c.png"><br clear="all"><br clear="all">  <b>ピッチ、ロール、およびヨー</b>角<b>（ピッチ、ロール、ヨー）</b>は、空間内のクアドロコプターの方向を決定および設定するのに慣習的な角度です。 <br clear="all"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/14f/b14/a73/14fb14a73d90543d287955f53eb127e5.gif"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/cee/343/33d/cee34333da9ffa9431e699d42eb8ee10.gif"><img src="https://habrastorage.org/getpro/habr/post_images/c9d/58f/ffe/c9d58fffe5d31afa35d443f77a948418.gif"><br clear="all"><br clear="all"> 時々、「角度」という言葉が省略され、彼らは単にピッチ、ロール、ヨーを言います。 しかし、 <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B0%25D0%25BD%25D0%25B3%25D0%25B0%25D0%25B6">ウィキペディアに</a>よると<a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B0%25D0%25BD%25D0%25B3%25D0%25B0%25D0%25B6">、</a>これは完全に正確ではありません。 これら3つの角度を変更することで、必要な方向のクアッドコプター飛行が実現します。 たとえば、前方に飛行するには、後方のモーターが前方のモーターよりもわずかに強く回転するため、クアドロコプターは曲がる必要があります。 <br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/91a/c31/ce3/91ac31ce3c7c0612db0e509d50dcbb4b.gif"><br clear="all">  <b>クアドロコプターガス</b>は、すべてのモーターの回転速度間の算術平均です。 ガスが多いほど、モーターの総推力が大きくなり、クアドロコプターを強くドラッグします（前方へ移動<i>し</i>ないでください!!!ここでの「床への滑り止め」は、最も速い上昇を意味します）。 通常、パーセンテージとして測定されます：0％-モーターが停止し、100％-最大速度で回転します。  <b>空中ガス</b>は、クアドロコプターの高度が失われないようにするために必要な最小ガスレベルです。 <br clear="all"><br clear="all"> ガス、ピッチ、ロール、ヨー-これら4つのパラメーターを制御できる場合、クアドロコプターを制御できます。 制御チャネルとも呼ばれます。  2チャンネルのリモコンを購入した場合、quadrocopterに対処できません。  3チャンネルは小型ヘリコプターに適しています。ロール制御なしで飛行できますが、クアドロコプターでは便利ではありません。 飛行モードを変更したい場合は、5チャンネルのリモートに分岐する必要があります。 船上でカメラの傾きと回転を制御したい-専門家はこれに別のリモートコントロールを使用しますが、別のプラス2チャンネル。 <br clear="all"><br clear="all"> 多くの飛行モードがあります。  GPS、気圧計、距離計を使用します。 しかし、基本的なもの-安定化モード（ <b>スタブ、スタビライズ</b> 、「スタブ」で飛ぶ）を実装します。クアドロコプターは、外部要因に関係なく、リモートコントロールから設定された角度を保持します。 このモードでは、風がない場合、クアドロコプターはほぼ所定の位置にぶら下がることができます。 風はパイロットを補償する必要があります。 <br clear="all"><br clear="all"> ネジの回転方向はランダムに選択されていません。 すべてのモーターが一方向に回転した場合、作成されたモーメントにより、クアドロコプターは反対方向に回転します。 したがって、対向するモーターの1つのペアは常に1つの方向に回転し、もう1つのペアはもう1つの方向に回転します。 回転モーメントの外観の効果は、ヨー角を変更するために使用されます：モーターの1つのペアは、もう一方よりも少し速く回転し始め、今ではクアドロコプターがゆっくりと向きを変えます（なんて恐ろしい）： <br clear="all"><br clear="all"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/341/09c/feb/34109cfeb1325ec11a5925410416e84e.gif"><img src="https://habrastorage.org/getpro/habr/post_images/8ac/9b8/607/8ac9b86079db63df8b320890b90319f0.gif"><br clear="all"><br clear="all"><ul><li>  LFW-左前時計回りの回転（左前時計回りの回転） </li><li>  RFC-右前の反時計回りの回転（右前の反時計回りの回転） </li><li>  LBC-左回りの反時計回りの回転（反時計回りの回転） </li><li>  RBW-右後方への時計回りの回転（右後方への時計回りの回転） </li></ul><br clear="all"> モーターの回転速度は、 <b>フライトコントローラー（コントローラー、脳）</b>によって制御されます。 通常、これは多くの入力と出力を備えた小さなボードまたはボックスです。 異なる機能セット、異なるファームウェア、異なるタスクを持つ膨大な数の異なるコントローラーがあります。 ほんの一部を次に示します。 <br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/5d4/d29/571/5d4d29571c2e44ce85fdad821bdb8af0.png"><br clear="all"><br clear="all"> フライトコントローラーの一般化されたタスクは、センサー読み取り値の読み取り、制御チャネルの読み取り、情報の処理、モーターへの制御信号の発行を含む制御サイクルを実行するための1秒あたり数十回です。 それが私たちがプログラムしようとしていることです。 <br clear="all"><br clear="all"> 使用できるセンサーにはさまざまな種類があります。 すべてのクアドロコプターでほぼ必須となっている<b>3軸ジャイロスコープと3軸加速度計</b>を使用します。 加速度計は加速度を測定し、ジャイロスコープは角速度を測定します。 それらのおかげで、フライトコントローラーは現在のピッチ、ロール、ヨー角を認識します。 これらのセンサーはフライトコントローラーに組み込まれていますが、外部にあります。 センサーの読み取り値から3つの角度を計算するプロセスは、別の記事のトピックです。 ただし、ここでこれを知る必要はありません。MPU-6050がすべてを行います。 これは、必要な計算とフィルタリングを内部で実行し、i2cプロトコルを使用してほぼ準備完了の角度を発行する小さなボードです。 それらを読み取り、残りのデータで処理し、モーターに制御信号を発行するだけです。 <br clear="all"><br clear="all"> マルチコプターモーターは大電流を消費するため、フライトコントローラーは直接電流を制御するのではなく、 <b>速度コントローラー（ <abbr title="電気速度レギュレータ">ESC</abbr> 、control、esc）</b>と呼ばれる特別なハードウェアドライバーを介して制御します。 これらのレギュレーターは、メインのオンボードバッテリーから電力を供給され、コントローラーから制御信号を受信し、出力にはモーターに直接つながる3本のワイヤー（A、B、C）があります（各モーターには独自のレギュレーターがあります！） <br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/64f/a68/967/64fa689675e9558e13fc530ce290080a.gif"><br clear="all"><br clear="all"> レギュレーターとモーター間の通信の「プロトコル」は、フライトコントローラーとレギュレーター間の通信の「プロトコル」ほど重要ではありません。コントローラーからレギュレーターをプログラムで制御する必要があるためです。  i2cによって制御されるレギュレーターがありますが、最も一般的なレギュレーターは、最小0ボルト、最大3-5ボルトの長方形信号によって制御されます（ <b><abbr title="パルス幅変調">PWM</abbr></b>または<b><abbr title="パルス幅変調">PWM</abbr></b>と呼ばれ、より正確であると主張する人もいます。詳細は、たとえば、 <a href="http://blog.oscarliang.net/pwm-ppm-difference-conversion/">こちら</a> ）。 <br clear="all"><br clear="all">  「プロトコル」-大声で言われます：モーターに最大速度で回転するように命令するために、コントローラーは10ミリ秒から20ミリ秒の論理ゼロと交互に2ミリ秒のパルスを送信する必要があります。  1ミリ秒のパルス持続時間は、モーター停止、1​​.1 ms-最大速度の10％、1.2 ms-20％などに対応します。 実際には、ゼロの期間は何の役割も果たさず、パルス自体の期間のみが重要です。 <br clear="all"><br clear="all"> 明らかな単純さのために、ここには待ち伏せがあります。フライトコントローラーは異なる設定で異なり、レギュレーターは異なり、最小（1 ms）と最大（2 ms）は普遍的ではありません。 多くの要因に応じて、1〜2ミリ秒の範囲は実際には1.1〜1.9ミリ秒です。 レギュレーターとコントローラーがまったく同じ言語を話すために、レギュレーターを調整する手順があります。 この手順の間、レギュレーターの範囲は変化し、コントローラーの範囲と等しくなります。 手順は各コントローラーのプログラムに縫い付けられており、いくつかの簡単な手順が含まれています（手順はメーカーによって異なる場合があります-説明書をお読みください！）。 <br clear="all"><br clear="all"><ul><li> レギュレーターの電源を切ります。 </li><li> モーターからプロペラを取り外します。 </li><li> 最大回転速度に対応する信号をコントローラーの入力に適用します。 </li><li> レギュレーターに電力を供給します。 この場合、モーターは支援なしで動かないままでなければなりません。 </li><li>  1〜2秒間一時停止し、特徴的なきしみ音を待ちます。 </li><li> 最低回転速度に対応する信号をコントローラーの入力に加えます。 </li><li>  1〜2秒間一時停止し、特徴的なきしみ音を待ちます。 </li><li> レギュレーターの電源を切ります。 </li></ul><br clear="all"> その後、対応する間隔の境界がコントローラーに入力されます。 キャリブレーションされていないコントローラーで離陸しようとすると、予期しない結果になることがあります。クアドロコプターの突然の急な動きから最も近いツリーへの移動、あらゆるガス値でのモーターの完全な不動。 <br clear="all"><br clear="all">  PWMは、まったく同じ原理<b>でオンボードレシーバー</b>を使用します。 これは、地上から無線制御信号を受信して​​フライトコントローラーに送信する小さなデバイスです。 ほとんどの場合、各制御チャネル（ガス、ピッチ、ロールなど）のフライトコントローラーには、PWMが到着する独自の入力があります。 相互作用ロジックは単純です。たとえば、「70％ガス」などのコマンドは、地上から受信機に連続的に送られ、そこでPWMに変換され、別のワイヤを介してフライトコントローラーに供給されます。 ピッチ、ロール、ヨーでも同様です。 <br clear="all"><br clear="all"> レシーバーとコントローラーの間には友好的なPWM関係があるため、それらもキャリブレーションする必要があります。レシーバーを備えたリモコンは、動作範囲によって異なります。 コントローラーは適応できる必要があります。  <b>ラジオのキャリブレーション</b>手順は、規制当局のキャリブレーションとは対照的に、フライトプログラムの一部として自分で作成する必要があります。 一般的なキャリブレーション計画は次のとおりです。 <br clear="all"><br clear="all"><ul><li> 念のため、モーターからプロペラを取り外してください。 </li><li> 何らかの方法で、コントローラーを無線校正モードにします。 </li><li> コントローラは数十秒間無線のキャリブレーションを開始します。 </li><li> 割り当てられた時間、コンソールのすべてのスティックを停止するすべての方向に動かします。 </li><li> コントローラは、何世紀にもわたって内部メモリ内のすべての制御チャネルの高低を記憶しています。 </li></ul> そのため、無線のキャリブレーション中、フライトコントローラーはすべての制御チャネルの受信機の範囲を記憶します。 コントローラーのキャリブレーション中に、フライトコントローラーの範囲がすべてのコントローラーに入力されます。 <br clear="all"><br clear="all"> フライトコントローラー用のプログラムに加えて、別のプログラムが必要です： <b>フライトコントローラー構成インターフェイス</b>です。 ほとんどの場合、USBを介してフライトコントローラーに接続し、ユーザーがフライトプログラムを構成および確認できるようにするPCプログラムです。たとえば、無線のキャリブレーションを開始し、安定化パラメーターを調整し、センサーの動作を確認し、マップ上のフライトルートを設定し、信号が失われたときのマルチコプターの動作を決定しますなどなど。 コンソールユーティリティとしてC ++およびQtでカスタマイズインターフェイスを記述します。 未来を見るとここにあります： <br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/234/23e/080/23423e080c6c9d70ad9b9f5c6d5ee6fe.png"><br clear="all"><br clear="all"> 誰も偶然から安全ではありません。 小型モーターの10インチプラスチックネジでさえ、皮膚に血のあざが残る可能性があり、それがさらに1週間傷つく可能性があります（個人的に検証済み）。 クアドロコプターを持ち運んでいるときにリモコンにガススティックを引っ掛けると、新しいメイクアップやヘアスタイルを作ることが基本になります。 したがって、フライトコントローラーは、少なくともある程度のセキュリティ（ <b>武装/武装解除メカニズム）を</b>提供する必要があります。 クワドロコプターの「武装解除」状態は、モーターがオフになり、リモートコントロールからのフルスロットルコマンドでも、電力は供給されますが効果がないことを意味します。 クアドロコプターの「武装」状態は、リモートコントロールコマンドがフライトコントローラーによって実行されることを意味します。 この状態では、クアドロコプターが離陸、飛行、着陸します。 クアッドコプターがオンになり、リモートコントロールのスロットルスティックがゼロになっていないときに不注意なパイロットがオンにした場合、直ちに武装解除状態になります。 ヘリコプターを「武装」状態にするためには、パイロットはリモコンのスティックを使って何らかの種類の所定のジェスチャーを行う必要があります。 多くの場合、このジェスチャーは、右下隅に左スティックを保持することです（ガス= 0％、ヨー= 100％）。 その後、フライトコントローラーは少なくとも最小限の自己<b>診断を</b>行い、正常に合格した場合は「 <b>アーム</b> 」（飛行準備完了！） <b>、</b>別のジェスチャー（ガス= 0％、ヨー= 0％）、クアッドコプターが「 <b>武装解除</b> 」します。 もう1つの優れた安全対策は、ガスが2〜3秒間ゼロになった場合の<b>自動軍縮</b>です。 <br clear="all"><br clear="all"><div class="spoiler">  <b class="spoiler_title">モーター、バッテリー、レギュレーター、プロペラについて</b> <div class="spoiler_text"> マルチコプター用のアクセサリの選択は、一連の記事全体のトピックです。 最初のクアドロコプターを作成する場合-必要なものを定式化し、ベテランのもののヒントを使用するか、他の誰かが作成して正常に飛行するコンポーネントのリストを取得します。 <br clear="all"><br clear="all"> それでも、一般的な理解のために、主要なポイントを知ることは有用です。 <br clear="all"><br clear="all"><h2> バッテリー </h2><br clear="all"> マルチローターシステムのアマチュアおよび専門家の間では、オンボードエレクトロニクスおよびモーターの主な電源として、リチウムポリマーバッテリーが最も一般的です。 それらは、静電容量、電圧、最大電流出力によって区別されます。 通常、容量はアンペア時またはミリアンペア時で測定されます。 電圧は、バッテリーの「缶」の数で測定されます。  1つの「バンク」-平均3.7ボルト。 完全に充電された「缶」は4.2ボルトです。 缶の数が3〜6の最も一般的なバッテリー。 最大電流出力はアンペアで測定され、たとえば次のようにマークされます：25C。  C-バッテリー容量、25-乗数。 容量が5アンペアの場合、そのようなバッテリーは25 * 5 = 125アンペアになります。 もちろん、現在の出力パラメーターは余裕を持って取得する方が良いですが、基本的には、それが大きいほど、バッテリーは高価になります。 ラベルの例：25C 3S 4500mah。 <br clear="all"><br clear="all"> 各ジャーは個別のバッテリーです。 それらはすべて直列にはんだ付けされています。 すべてのバンクを均等に充電するために、各バンクにアクセスできるバランスコネクタが個別に提供され、特別な充電器が使用されます。 <br clear="all"><br clear="all"><h2> モーター、プロペラ、レギュレーター </h2><br clear="all"> ブラシレスモーターの主なパラメーターはkvです。 これは、供給電圧の各ボルトに対する1分あたりの回転数です。  300〜1100のkvのモーターが最も一般的です。通常、1000に近いKvは、小型のクアドロコプター（1〜2キログラム+ペイロード500グラム）に選択され、直径12インチまでのプラスチックプロペラが置かれます。 大型マルチコプター（良好で重量のある写真ビデオ機器を上げるため）または長期飛行（飛行時間の記録）の場合、モーターは通常、低kv（300-500）と巨大なカーボンプロペラ（直径15-20インチ）を持っています。  Kvはモーターの唯一の重要なパラメーターではありません。多くの場合、モーターの出力と駆動力が印加電圧と取り付けられているプロペラのタイプに依存することを示す表全体を見つけることができます。 さらに、各モーターは、独自の電圧範囲（バッテリー缶の数）および独自の最大電流用に設計されています。 メーカーが3-4Sを書いている場合、5Sバッテリーと一緒に使用しないでください。 同じことが規制当局にも当てはまります。 <br clear="all"><br clear="all"> モーターが最大30Aの電流用に設計されている場合、過熱を防ぐためにレギュレーターは最大30 + 10Aの電流をカウントする必要があります。 不十分または不適切な規制当局は、いわゆる「タイミング停止」とモーターの飛行を停止させる可能性があり、あなたは別のマルチローター用語「 <b>惑星を捕まえた</b> 」を認識するでしょう。 もう1つの重要なポイントは、ワイヤの太さと品質です。 ワイヤの断面積が正しく計算されていなかったり、コネクタの品質が悪いと、空中で火災が発生することがあります。 <br clear="all"><br clear="all"> ご覧のとおり、微妙な違いがたくさんあります。 半分もリストしていなかったので、最初のマルチコプターのコンポーネントを自分で選択することは非常に困難です。 </div></div><br clear="all"><br clear="all"><h1><a name="PID"></a>  <font color="black">数学安定化、PIDコントローラー（PID）</font> </h1><br clear="all"> マルチコプターを扱う場合は、遅かれ早かれ、PIDコントローラーの調整に対処する必要があります。これは、この数学的な装置がほぼすべての安定化タスクで使用されるためです：空中のクアドロコプター角度の安定化、飛行およびGPS位置保持、気圧計高度保持、ブラシレス機構飛行中のビデオカメラを安定させます（カメラのサスペンション）。 <br clear="all"><br clear="all"> カメラの2軸ジンバルを取得します。たとえば、GoProを入れて電源を入れると、安定化の代わりに痙攣、振動、痙攣が発生しますが、すべてのセンサーが較正され、機械的な問題は解消されます。 その理由は、PIDコントローラーのパラメーターが正しくないためです。 <br clear="all"><br clear="all"> あなたはマルチコプターを集め、センサー、レギュレーター、ラジオを較正し、すべてをチェックし、離陸しようとします。 またはその逆：それは非常に鋭利であるため、突然許可されずに三重の宙返りを壊し、ねじります。 理由は同じです：PIDコントローラーのパラメーター。 <br clear="all"><br clear="all">  PIDコントローラーを使用する多くのデバイスには、ユーザー自身からの多数のビデオ指示に加えて、セットアップの指示、またはいくつかの指示さえあります。 しかし、この多様性を簡単にナビゲートするには、これらのレギュレーターが内部にどのように配置されているかを理解することが役立ちます。 さらに、独自のクアドロコプター安定化システムを作成します！  PIDコントローラーの公式を<b>理解</b>する<b>ために、</b>改めて<b>「指で」</b>再発明することを提案します。 ドライな数学言語がもっと好きな人には、 <a href="http://en.wikipedia.org/wiki/PID_controller">英語の記事</a> Wikipediaをお勧めします。  <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%2598%25D0%2594-%25D1%2580%25D0%25B5%25D0%25B3%25D1%2583%25D0%25BB%25D1%258F%25D1%2582%25D0%25BE%25D1%2580">ロシア語では、</a>資料はまだそれほど詳しくありません。 <br clear="all"><br clear="all">  Quadrocopterを2次元空間で検討します。この場合、1つの角度（かかとの角度）と2つのモーター（左右）しかありません。 <br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/987/fde/420/987fde420fd3a0854b9bac6d38e47465.png"><br clear="all"><br clear="all"> フライトコントローラーは、地上からコマンドを継続的に受信します。「30度のロール」、「-10度のロール」、「0度のロール（地平線を維持）」。 そのタスクは、風、クアドロコプターの重量の不均一な分布、モーターの不均一な摩耗、クアドロコプターの慣性などを考慮して、モーターの助けを借りて可能な限り迅速かつ正確にそれらを実行することです したがって、フライトコントローラーは、motor角の現在の値と必要な値を考慮して、各モーターに適用する回転速度の問題を継続的に解決する必要があります。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">継続的に-もちろん、これは大声で言われます。</font><font style="vertical-align: inherit;">それはすべて、特定のハードウェアのコンピューティング機能に依存します。</font><font style="vertical-align: inherit;">Adruinoでは、処理および制御サイクルの1つの反復を10ミリ秒に収めることができます。</font><font style="vertical-align: inherit;">つまり、10ミリ秒ごとに、クアドロコプターの角度の読み取り値が読み取られ、それに基づいて制御信号がモーターに送信されます。</font><font style="vertical-align: inherit;">この10ミリ秒は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">規制期間</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">小さいほど、より頻繁に、より正確に規制が行われることは明らかです。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ガスレベルは、レシーバーからコントローラーに流れます。</font><font style="vertical-align: inherit;">聞かせて</font></font><img src="https://habrastorage.org/getpro/habr/post_images/6f9/9c1/32a/6f99c132aac32c39dfd62b0c326dd143.gif">  。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> これは、すべてのモーターの回転速度間の算術平均であり、最大回転速度の割合として表されることを思い出させてください。 </font></font>もし <img src="https://habrastorage.org/getpro/habr/post_images/e04/1d8/5ef/e041d85ef4ad9f1c043476871fc750b5.gif"> そして <img src="https://habrastorage.org/getpro/habr/post_images/e14/9cf/276/e149cf276f4dbe6b5af2e2cac980f0e1.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -次に、左右のモーターの回転速度： </font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/519/6cf/2fe/5196cf2fefec6a552c78b23f7b839f35.gif"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/850/bce/b9c/850bceb9ccc101bb79f2f796612f717b.gif"><br clear="all"><br clear="all"> どこで <img src="https://habrastorage.org/getpro/habr/post_images/3b8/6c2/613/3b86c261318947f131298dd0c57511e3.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-クアドロコプターの反作用（力）。これは、左のモーター</font></font><img src="https://habrastorage.org/getpro/habr/post_images/3b8/6c2/613/3b86c261318947f131298dd0c57511e3.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がガスよりも速く</font><font style="vertical-align: inherit;">回転</font><font style="vertical-align: inherit;">し、右の</font><font style="vertical-align: inherit;">モーター</font><font style="vertical-align: inherit;">が同じくらい遅い</font><font style="vertical-align: inherit;">という事実により回転の瞬間を作り出し</font><font style="vertical-align: inherit;">ます。</font></font><img src="https://habrastorage.org/getpro/habr/post_images/3b8/6c2/613/3b86c261318947f131298dd0c57511e3.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">負の値を取ることができ、適切なモーターがより速く回転します。処理サイクルの各反復でこの値を計算することを学べば、quadrocopterを制御できます。</font></font><img src="https://habrastorage.org/getpro/habr/post_images/3b8/6c2/613/3b86c261318947f131298dd0c57511e3.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">少なくとも、現在のヒールの角度（</font></font><img src="https://habrastorage.org/getpro/habr/post_images/8b3/5fc/864/8b35fc8647c66f80cd26a59d1aae72bb.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）と</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c85/68e/dae/c8568edaeee9f2d0400605a9a1090878.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、コントロールパネルからの</font><font style="vertical-align: inherit;">希望のヒールの角度</font><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">）に</font><font style="vertical-align: inherit;">依存する必要</font><font style="vertical-align: inherit;">があることは明らかです</font><font style="vertical-align: inherit;">。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状況を想像してください：コマンド「地平線を保持」（</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c85/68e/dae/c8568edaeee9f2d0400605a9a1090878.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 0）が</font><font style="vertical-align: inherit;">受信され</font><font style="vertical-align: inherit;">、クアドロコプターは左にロールします：</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/3fa/8a1/71b/3fa8a171be4df8f91c95e8b35ca7f432.png"><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-間の差（エラー）</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c85/68e/dae/c8568edaeee9f2d0400605a9a1090878.gif"> そして <img src="https://habrastorage.org/getpro/habr/post_images/8b3/5fc/864/8b35fc8647c66f80cd26a59d1aae72bb.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コントローラーが最小化しようとします。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">希望するロール角と現在のロール角の差が大きいほど、反応が強くなり、左のモーターが右に比べて速く回転します。これが表記を使用して記述されている場合：</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/d75/b07/41d/d75b0741d4402ca24513df83d59b8ecc.gif"><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、Pは比例係数です。それが大きいほど、反応が強くなり、クアドロコプターは必要なヒールの角度からの逸脱に鋭く反応します。この直感的でシンプルな式は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比例コントローラの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作を説明しています</font><font style="vertical-align: inherit;">。本質は基本的なものです。クアドロコプターが望ましい位置から大きく外れているほど、それを戻そうとする必要が強くなります。残念ながら、この式は複雑でなければなりません。主な理由はオーバーシュートです。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数十ミリ秒（処理サイクルの数回の反復）以内に、比例コントローラーの影響下で、クアドロコプターは必要な（この場合は水平）位置に戻ります。この間ずっと、エラー</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と労力の</font></font><img src="https://habrastorage.org/getpro/habr/post_images/3b8/6c2/613/3b86c261318947f131298dd0c57511e3.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">符号は同じになりますが、絶対値はますます小さくなります。ある種の回転速度（角速度）を入力すると、クアドロコプターは単純に反対側に落ちます。これは誰も必要な位置で停止しないためです。常に最初の位置に戻ろうとするバネと同じですが、引き戻されて解放されると、摩擦が引き継ぐまで変動します。もちろん、摩擦はクアドロコプターにも作用しますが、実際には十分ではないことが示されています。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このため、比例レギュレータにもう1つの用語を追加する必要があります。これにより、クアドロコプターの回転が遅くなり、オーバーシュート（反対方向への転倒）が防止されます。合理的な制限。</font><font style="vertical-align: inherit;">回転速度（エラーの変化率）はで表されます</font></font><img src="https://habrastorage.org/getpro/habr/post_images/1d5/de0/b6d/1d5de0b6da187474bf732cac26f868a6.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/d35/846/20f/d3584620f4b13dc128bbfffe67b87a35.gif"><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、Dは調整可能な係数です。大きくなるほど、停止力が強くなります。</font><font style="vertical-align: inherit;">漠然とした記憶は、物理学の授業で、値の変化率は時間に対するこの値の導関数であるということを示しています。</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/af3/5dd/24c/af35dd24c7bca8b131420c365c650495.gif">  。 <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> そして、ここで比例レギュレーターは比例微分（比例項と微分）に変わります。 </font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/1ef/92b/7f5/1ef92b7f57f69e694e600419713c1928.gif">  。 <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラーは</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計算</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">簡単です。なぜなら、各反復でわかっているからです。</font></font><img src="https://habrastorage.org/getpro/habr/post_images/8b3/5fc/864/8b35fc8647c66f80cd26a59d1aae72bb.gif"> そして <img src="https://habrastorage.org/getpro/habr/post_images/c85/68e/dae/c8568edaeee9f2d0400605a9a1090878.gif">  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PおよびDは、開始前の構成可能なパラメーターです。</font><font style="vertical-align: inherit;">導関数（変化率</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を計算する</font><font style="vertical-align: inherit;">には、前の値を保存し</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、現在の値</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を知り、測定間で経過した時間（規制期間）を</font><font style="vertical-align: inherit;">知る</font><font style="vertical-align: inherit;">必要があり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">そして、彼女はここにいます-学校の6年生の物理学（速度=距離/時間）：</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/516/061/81e/51606181e138d5e9505a66fa416e4554.gif">  。 <br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/e59/acf/d82/e59acfd823451727672042a740be8c27.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-規制期間; </font></font><img src="https://habrastorage.org/getpro/habr/post_images/3ab/65b/7da/3ab65b7dacd9f57b54f8ffa3969e281a.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-規制サイクルの前回の反復からのエラー値。ところで、この式は数値微分の最も簡単な方法であり、ここで私たちに非常に適しています。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラットな「バイコプター」に比例微分コントローラーがありますが、もう1つの問題が残っています。左端の重量を右端よりもわずかに大きくするか、同じことですが、左のモーターの動作は右よりもわずかに悪くなります。クワッドコプターは少し左に傾いており、元に戻りません：微分項はゼロに等しく、比例項は正の値を取りますが、クワッドコプターを水平位置に戻すだけでは十分ではありません。その結果、クアドロコプターは常に左に引っ張ります。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このような逸脱を追跡して修正するには、メカニズムが必要です。このようなエラーの特徴は、時間の経過とともに現れることです。不可欠な用語が助けになります。</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">処理サイクルのすべての反復の</font><font style="vertical-align: inherit;">すべてのエラーの合計を保存し</font><font style="vertical-align: inherit;">ます。これはどのように役立ちますか？比例項が小さな誤差を修正するのに十分ではないが、まだ残っている場合-徐々に、時間とともに積分項が強度を獲得し、反応が増加し</font></font><img src="https://habrastorage.org/getpro/habr/post_images/3b8/6c2/613/3b86c261318947f131298dd0c57511e3.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、クアドロコプターが必要なロール角を取ります。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュアンスがあります。仮に</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1度、調整サイクルに等しい-0.1秒。</font><font style="vertical-align: inherit;">その後、1秒で、エラーの合計は10度の値になります。</font><font style="vertical-align: inherit;">処理サイクルが0.01秒の場合、量は100度も増加します。</font><font style="vertical-align: inherit;">そのため、同じ期間に積分項が異なる規制期間で同じ値を得るため、結果の量に規制期間自体が乗算されます。</font><font style="vertical-align: inherit;">どちらの場合でも、結果は1度の量であると計算するのは簡単です。</font><font style="vertical-align: inherit;">ここにあります-積分項（これまでのところ、カスタム係数なし）：</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/d6b/8e4/715/d6b8e47154fb589a3d9d4234646f1cb9.gif">  。 <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この式は</font></font><img src="https://habrastorage.org/getpro/habr/post_images/c01/54b/a86/c0154ba86607cc99f86646dcd71f8613.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ゼロから現在の瞬間までの区間の</font><font style="vertical-align: inherit;">関数の時間積分にすぎません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それが用語が積分と呼ばれる理由です：</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/c27/67c/6f9/c2767c6f9210431ee5c174080e81774d.gif">  、 <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、Tは現在の時刻です。</font></font><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比例積分微分コントローラの最終式を書く時が来ました：</font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/731/2ca/657/7312ca65766354c215a731d0896cc106.gif">  、 <br clear="all"><br clear="all"> どこで <img src="https://habrastorage.org/getpro/habr/post_images/c32/64e/8b9/c3264e8b949f2e9430fa37dc1f7ce989.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -カスタマイズ可能なパラメーターの1つ。そのうち3つがあります。 </font></font><img src="https://habrastorage.org/getpro/habr/post_images/de2/b62/cda/de2b62cdaa63a97ee016bf170c0a6f08.gif">  。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> この式はプログラムコードから使用すると便利ですが、教科書に記載されている式は次のとおりです。 </font></font><br clear="all"><br clear="all"><img src="https://habrastorage.org/getpro/habr/post_images/d7c/a5e/337/d7ca5e3376c3263a381a9d2da0d32867.gif">  。 <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> これにはいくつかのバリエーションがあります。たとえば、積分項のモジュールを制限して、特定の許容しきい値を超えないようにすることができます（そのようにします）。 </font></font><br clear="all"><br clear="all"><h1> <font color="black"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">練習する</font></font></font> </h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さて、今は係数を選択する練習の時間です。</font><font style="vertical-align: inherit;">読者は、仮想のquadrocopterを使用したJavaScriptページに招待されています。これは、すでに写真で見</font></font><a href="http://copterpilot.ru/articles/o-pid-regulyatorax-2/"><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとおりです。quadrocopterのPIDコントローラーパラメーターの選択</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a href="http://jsfiddle.net/limon_spb/ZPmPh/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSFiddle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）最初の開始時に、オーバーシュートがすぐに表示されます-目的の位置の周りの変動。振動が停止すると、「非対称」クアドロコプター（「非対称」の目盛りで設定）による比例係数がエラーに対処できないという効果を観察できます。パラメーターP、I、Dをチューニングに使用できます。クアドロコプターの下の「スクロール」により、希望のロール値を制御できます。 「間隔（ms）：」-規制間隔。減らすことは「不正行為」ですが、それが安定化の品質にどのように影響するかを確認することは非常に便利です。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「純粋な」数学を愛する人のために</font><a href="http://copterpilot.ru/articles/o-pid-regulyatorax/"><u><font style="vertical-align: inherit;">、抽象PIDコントローラーの構成</font></u></a><font style="vertical-align: inherit;">を提案できます。</font></font><a href="http://copterpilot.ru/articles/o-pid-regulyatorax/"><u><font style="vertical-align: inherit;"></font></u></a> <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力したパラメーターは自動的に適用されません。「適用」をクリックする必要があります。いくつかの小さなヒント：クアドロコプターが制御するには反応が遅すぎると思う場合-Pを増やすことができますが、Pが大きすぎるとオーバーシュートにつながる可能性があります。パラメータDはオーバーシュートに役立ちますが、値が大きすぎると頻繁に変動するか、再度オーバーシュートします。パラメータIは通常、パラメータPの10〜100倍小さいため、彼の強みは時間の経過に伴う蓄積にあり、迅速な対応にはありません。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIDパラメーターの手動調整には練習が必要です。</font><font style="vertical-align: inherit;">それらを計算するための分析方法がありますが、それらは特定のカスタムシステムの多くのパラメーターの適切な準備と正確な知識を必要とします。</font><font style="vertical-align: inherit;">手動選択と分析計算の中間点として、さまざまな研究者によって提案された幅広い経験的方法があります。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2Dクアドロコプターでは、1つの角度しか変化しません-かかとの角度です。</font><font style="vertical-align: inherit;">チューニング3Dクアドロコプターでは、角度ごとに3つの独立したPIDコントローラーが必要であり、特定のモーターを制御することは、すべてのコントローラーの努力の合計を表します。</font></font><br clear="all"><br clear="all"><h1> <font color="black"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前半のまとめ</font></font></b></font> </h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事では、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クアドロコプターとフライトの原理、ピッチ、ロール、ヨー、ガス、ホバリングガス、フライトモードの安定化、フライトコントローラー、ジャイロスコープ、加速度計、速度コントローラー、PWM、コントローラーキャリブレーション、無線キャリブレーション、オンボードレシーバー、フライトコントローラーの設定インターフェイス、武装/武装解除状態、自動武装解除</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その後、</font><b><font style="vertical-align: inherit;">数値の微分と統合</font></b><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">少し触れ</font><font style="vertical-align: inherit;">て</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIDコントローラーの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式を再発明</font><font style="vertical-align: inherit;">し、</font><a href="http://copterpilot.ru/articles/o-pid-regulyatorax-2/"><u><font style="vertical-align: inherit;">仮想quadrocopterで</font></u></a><font style="vertical-align: inherit;">パラメーター</font><b><font style="vertical-align: inherit;">P、I、D</font></b><font style="vertical-align: inherit;">を構成する方法を独自のスキンで経験し</font><a href="http://copterpilot.ru/articles/o-pid-regulyatorax-2/"><u><font style="vertical-align: inherit;">ました</font></u></a><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="http://copterpilot.ru/articles/o-pid-regulyatorax-2/"><u><font style="vertical-align: inherit;"></font></u></a><font style="vertical-align: inherit;"></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さて、ライトセーバープログラミングを所有している場合は、quadrocopter安定化プログラムに着手できます。または、さらに良いことに、新鮮なアイデアで新鮮なオープンソースプロジェクトに参加できます。まあ、</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1、2週間</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、品質に匹敵する力と時間があるとき、プログラミング、テスト、落下、指を切って未知の方向に完全に飛び去った方法の話を続けます。本当に継続したい場合は、ここで私を蹴ることができます。たとえば、Vkontakte：これは少しインセンティブを与えます。</font></font><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（！最初）：この部分の結論として、私はちょうどファームウェアMegapirateNGに複雑なQuadrocopterのコンポーネントと構成を選ぶ際に私を助けたし、辛抱強くこれらの最も基本的な概念に疑問の数百に答えた人言及する必要があり</font></font><a href="http://habrahabr.ru/users/sovgvd/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SovGVD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、あなたに感謝を！</font></font> :-) <br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> このシート全体を浪費することができた人々への報酬として、私たちの「発明された」PIDコントローラーを備えたクアドロコプターのような約束された小さなビデオを投稿し、Arduino Mega 2560のプログラムを飛ばします： </font></font><br clear="all"><br clear="all"><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://www.youtube.com/embed/VSgZAQwO0fI%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700283&amp;usg=ALkJrhjUQSLDWus7y0u_EW4v_XS811zeEw" frameborder="0" allowfullscreen=""></iframe><br clear="all"><br clear="all"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もちろん、彼はGPSを欠いており、商業製品や量産品と同様に、彼は安定性を少し欠いていますが、一方で私たちは、積分係数を持つ最後の因子までそれを知っています！</font><font style="vertical-align: inherit;">そして、そのような技術が今日私たちに利用可能であることは本当にクールです。</font></font><br clear="all"><br clear="all"><h3> <font color="black"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">楽しい時間を過ごしていませんか？！</font></font></font> </h3></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J227409/index.html">例としてRL78ラインを使用したルネサスマイクロコントローラの紹介</a></li>
<li><a href="../J227411/index.html">SynologyがXS / XS +シリーズNASの5年間無料保証を発表</a></li>
<li><a href="../J227415/index.html">独自のWebGLエンジン。 記事番号3。 プリミティブ</a></li>
<li><a href="../J227419/index.html">生成されたWebCamp予備プログラム：プロジェクト管理の日</a></li>
<li><a href="../J227423/index.html">データベース監視HostTracker</a></li>
<li><a href="../J227429/index.html">猫のしっぽはなぜ：中程度の視界条件でのリアルタイム統計</a></li>
<li><a href="../J227431/index.html">ウェビナー「富士通の統合ITインフラストラクチャ」</a></li>
<li><a href="../J227433/index.html">真空トランジスタは1 THzのしきい値を克服できます</a></li>
<li><a href="../J227435/index.html">CCU.IOを使用して、後悔したりスマートホームを決して「実行」しないでください</a></li>
<li><a href="../J227443/index.html">Linux VPSサーバーの購入方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>