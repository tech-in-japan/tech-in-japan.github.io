<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛱️ 🍀 👨🏿 ファイル暗号化トロイの木馬との戦いの歴史-キーコントロールセンターへの旅 🔟 ✋🏻 👩🏾‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="はじめに  
  
 話は一日の始めに電話がかかったときに始まりました。 クライアントの興奮した声は、コンピューターが読み込まれず、ドキュメントが開かず、画面上の通常のデスクトップの代わりに、おおよその意味を持つ脅迫的な碑文があると言いました：「私たちにお金を払えば、デスクトップとドキュメントをあな...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>ファイル暗号化トロイの木馬との戦いの歴史-キーコントロールセンターへの旅</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><h4> はじめに </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     話は一日の始めに電話がかかったときに始まりました。 クライアントの興奮した声は、コンピューターが読み込まれず、ドキュメントが開かず、画面上の通常のデスクトップの代わりに、おおよその意味を持つ脅迫的な碑文があると言いました：「私たちにお金を払えば、デスクトップとドキュメントをあなたに返します」。 状況は多くの人によく知られています：コンピューターに別のウィンロックが存在する可能性が高いため、ランサムウェアの切断作業には最大で10分かかります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Winlockerを取り外すために、10分後には街の反対側に行きたくなかったので、システムを私に持ってきて、整理して返却することに同意しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     システムを入手し、電源を入れました。  XPを起動しました。 デスクトップが表示されました-winlockerの兆候はありません。一見、すべてが順調です。 しかし、デスクトップから出会った最初のドキュメントを開こうとすると、応答で「怖い」メッセージを受け取りました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/5e6/c48/713/5e6c4871384d02c5ee59fd904032a5c7.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     当然、ランサムウェアトロイの木馬に最初に出会った人ではない人のように、私はこのテキストにかなりの懐疑心を持って反応しました。 確かに、これはすべて、通常のプログラムの問題で、拡張子が.docおよび.xlsのファイルを開くように再構成し、理解できない単語を含むテキストで経験の浅いユーザーを怖がらせるためのものです。 この仮定を検証し、フーリガンプログラムをキャッチするために、システムリカバリイメージからコンピューターを起動し、ファイルマネージャーでCドライブを開いて、完全に不幸な画像を見ました：ローカルドライブ上のすべてのファイルが突然M5bFu拡張を取得し、その内容はジェネレーターの結果のように見えました乱数。 ファイルの以前の内容のトレースはありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、ファイルが暗号化されたというメッセージは純粋な真実であることが判明しました。 拡張子がdoc、xls、dbf、avi、jpg、txt、rar、zipのサイズが2ギガバイト未満のすべてのファイルは暗号化されました。一般に、情報の所有者にとって価値のあるすべてのものが暗号化されました。 暗号化されたファイルの中で-1Cベースおよび重要なドキュメント。  1Cを新しいバックアップから復元できる場合、貴重なドキュメントと写真の損失はクライアントの健康に大きな影響を与える可能性があります。 したがって、選択の余地はありませんでした-データの復号化に取り組む必要がありました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ステージ1.暗号化アルゴリズムの検索 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     繰り返しますが、本質的に少し不信であるため、メッセージ内の暗号化アルゴリズムの明示的な指示にもかかわらず、どの暗号化アルゴリズムがファイル内のデータを暗号化したかを個別に判断することにしました（突然、すべてが書かれているほど怖くありません）。 最初に、最も単純で最も一般的な置換暗号を確認します：Caesarの暗号、XORなど。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     分析のために、2つのdbfファイルを取得します。1つは感染したシステムから暗号化され、もう1つは新しいバックアップからそのままで、それらを互いに比較します。 連続する同一バイト、たとえば値0で満たされたソースdbfファイルの領域は、プリミティブ置換暗号を示している可能性があります。幸いなことに、dbfファイルは、格納された情報の高密度に違いがなく、それらに多くのゼロバイトがあります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/59b/8ab/4d4/59b8ab4d4f203f3c769566e3e1550a05.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この図は、ソースファイルの断片に複数のゼロが連続して含まれており、これらのゼロが暗号化されたファイルになったことを示しています。 プレーンテキストシンボルが同じ暗号グラムシンボルに変換される単純なインライン置換暗号は、すぐに消滅しました。 より詳細な分析では、単純な文字ベースのキーワードとプレーンテキストのXORもここでは行われないことが示されました。 最終的に、暗号がブロックされており、フィードバックや賭博がないことがわかりました。 ブロック長は16バイトです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、トロイの木馬の作成者からのメッセージに示されている<a href="http://ru.wikipedia.org/wiki/RC6">RC6</a>暗号の使用を仮説として受け入れる必要がありました。 その後、仮説が確認されました。つまり、暗号化はブロック長16バイトのRC6アルゴリズムによって実行され、ブロック図に従って「ロック」を使用します。 実装の作成者は、16バイト未満の不完全なブロックを暗号化することさえせず、暗号化せずにそのまま残しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、アルゴリズムは既知です。 残っているのはキーを見つけることだけです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ステージ2.キー検索 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     キーを検索するには、まず悪意のあるプログラムの本体（またはこの本体の残り）を見つけます。  ％SYSTEMROOT％\ System32ディレクトリには、2つの「余分な」exeファイルがあります。system.exeとランダムな名前の別の実行可能ファイル（H3w2DWg.exe）です。 両方のファイルは、システムに感染したトロイの木馬の一部ですが、検出時（2012年4月）のファイルはどれも、ウイルス対策ソフトウェアによって悪意のあるものとして認識されませんでした。 現時点では、一部のアンチウイルスはTrojan.Encoder.136（DrWeb）またはWin32 / Filecoder.AF（ESET-NOD32）としてトロイの木馬を正しく認識しますが、ほとんどのアンチウイルスはせいぜいこれはほんの少し疑わしいファイルだと考えています。 ここに<a href="https://www.virustotal.com/file/e52ac505e971d5dc8daa05b7549d056e71a253666fbb0207fe7a9772246de157/analysis/1353492233/">virustotal</a>へのリンクが<a href="https://www.virustotal.com/file/e52ac505e971d5dc8daa05b7549d056e71a253666fbb0207fe7a9772246de157/analysis/1353492233/">あり</a>ます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     トロイの木馬がアンチウイルスによって認識されない場合は、自分で分析する必要があります。  hiew32、OlyDbg、および仮想マシンを装備して、彼は検死に進みました。 剖検により、トロイの木馬のファイルはパッケージ化も暗号化もされておらず、Borland Delphiで記述されていることが明らかになりました。 内部では、暗号化されたaccount.cfg、config.cfg、lock.cfgファイルへのリンクも見つかりました。これらのファイルは、％SYSTEMROOT％\ System32にもあります。  exeファイルの腸でデバッグすることにより、特定のキーが32文字の長さ32の文字列「1kv9yha029v9vi71xioa7h812ga811n9」の形式でも見つかりました。このキーを使用して、トロイの木馬はlock.cfgファイルを解読しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この文字列がどのようにRC6キーに変換されるかを理解する必要があります。  RC6キーの長さは128ビット以上です。 最初の試みとして、ASCIIコードを使用して各文字を8ビット表現に変換しようとします。 その結果、長さ32 * 8 = 256ビットのキーを取得します。  C ++でプログラムを作成し、キーとlock.cfgファイルを入力プログラムに送信します。 復号化プロセスを開始します。 失敗。 ファイルは復号化されませんでした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     残っているオプションは何ですか？ 最も長く最も骨の折れる作業は、実行可能ファイルからデバッガーでキーを生成するアルゴリズムを引き出すことです。 過度の労力のため、このオプションを最後の手段として残しました。 代わりに、少し考えて、マルウェアの作成者の立場になってください。 トロイの木馬の作成者が独自に暗号化アルゴリズムを実装した可能性は低いです。 高い確率で、イルカのアルゴリズムの完成した実装がインターネットからダウンロードされました。 また、既製のコンパイルされたライブラリはほとんど使用されませんでした。それらでは、暗号化アルゴリズムがはるかに良く実装され、16バイト未満のブロックが暗号化されないままになりません。 このトロイの木馬は学生のカリキュラムを使用した可能性が高いと結論付けました。このカリキュラムのソースは攻撃者がインターネットから盗んだものです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Googleに乗り込み、キーワードDelphi RC6で何かを探します。 リンク<a href="http://www.delphi-club.ru/delphi/rc6_encryption.html">http://www.delphi-club.ru/delphi/rc6_encryption.html</a>を見つけ<a href="http://www.delphi-club.ru/delphi/rc6_encryption.html">ます</a> 。 つまり、Delphi上のモジュールであり、ギャミングなしでブロックを使用してファイルを暗号化し、16バイト未満の最後のブロックを暗号化せずに残します。 実装からキー生成機能を取得し、C ++で書き換えて、復号化プログラムをコンパイルします。 プログラムに32文字のキーを入力し、lock.cfgファイルの暗号化を解除します。 再び失敗。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      OllyDbgとトロイの木馬の本体にはオプションがありました。 特に手順自体にそれほど時間はかからなかったため、キーを作成するための秘密アルゴリズムを取得する詳細については説明しません。 秘密は簡単でした。 キーを含む文字列は、ASCIIエンコーディング（32文字= 32バイト）でファイルのリソースから読み取られ、その後（明らかにDelphi自身）UTF-16LEに変換されました-64バイトが取得されました（実際には、バイトは単にゼロで希釈されました）。 そして、この結果はすでに有名な人に提供されています。これは、キーを取得するためのアルゴリズムであるイルカのソースコードのおかげです。 出力のキーの長さは512ビットです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      lock.cfgファイルは受信したキーで正常に復号化されました。 ファイル内には、config.cfgファイルとaccount.cfgファイルのキー、hostsファイルを介してブロックするサイトのドメイン名のリスト、およびトロイの木馬の意見で「有害」なプロセス（アンチウイルス、ファイアウォール）のリストがあります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      account.cfgファイルには、いくつかの追加キー（同じ32行の文字列形式）、Money @ Mail.ruのアカウント番号、誰かの電子メールアドレス、感染したコンピューターに関する情報、その他の小さな情報が含まれていました。  config.cfgファイルには、とりわけ、コンピューターのIPアドレスがありました。これは、すべての兆候から、悪意のあるプログラムの制御サーバーでした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ただし、悲しいことに、ファイル内で見つかったキーはいずれも、感染したコンピューターのディスク上のファイルを解読するのに適していませんでした。 攻撃者による別の声明は真実であることが判明しました。ファイルを復号化するためのキーは実際にはコンピューターに保存されていません。 最後の希望は残った-悪意のあるプログラムの制御サーバーからキーを振る。 トロイの木馬の作者からのメッセージによると、キーはそこに7日間保存されますが、この時点でキーを取得する必要があります。そうしないと、ファイルを解読できません-大文字と小文字の数字とラテン文字の組み合わせから32文字のキーを選択するのに数十年かかります。緊急に必要な文書。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ステージ3.キーコントロールセンターへ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     コントロールセンターに向かう前に、その操作のいくつかの機能、つまり、サーバーへの接続に使用されるトランスポートプロトコル、接続が暗号化されているかどうか、クライアントとサーバーが相互にデータを交換する方法を見つける必要があります。 これらの問題を解決するための最も明白なオプションは、トロイの木馬をクリーンなシステムに展開し、管理サーバーとのネットワーク交換を観察することでした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     クリーンなオペレーティングシステムが仮想マシンにインストールされ、WireSharkがメインマシンで起動され、トロイの木馬が仮想マシンで起動されました。 接続はTCPポート80を介した暗号化されていない接続を使用することが判明しました。最初の感染時に、コンピューターデータ（OS、プロセッサ、メモリ）がサーバーに送信され、追加のトロイの木馬モジュールがSSLeay dllファイルと同様にサーバーからダウンロードされます。 Money@Mail.ruサイトで作業します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ほとんどの場合、サーバーにコンピューターデータを送信すると、サーバー上にコンピューターアカウントが作成されます（これは、オペレーティングシステムの再インストールに関するセクションの作成者からのメッセージのヒントです）。 アカウントとともに、一意のキーが作成され、その後ハードドライブ上のデータが暗号化されます。 このキーは、取得する必要があるものです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     感染したコンピューターでトロイの木馬が再起動されると、管理サーバーにも接続します。 同時に、このトロイの木馬はコンピューターに関するデータをレポートしなくなりましたが、アカウントにaccount.cfgファイルに保存されているキーを提供します。 感染したコンピューターの識別子はこのキーであり、ファイルを解読するためのキーを受け取るのはこのキーです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     管理サーバーとの交換の形式は、「クライアントコマンド-サーバー応答」です。 マルウェアの腸を調べて、有効なコマンドのリストを取り出しました：mail、rekey、key、c​​heck_pay、get_masks、ssl、winlockなど。  WireSharkから、クライアントのコマンドとパラメーターの形式を学びました。 それは実験の時間です。  telnetを使用してサーバーに侵入し、感染したコンピューター（キーの形式のパラメーターを持つclient_infoコマンド）を装って、キーコマンドを入力しました。これに応答して、ファイルを解読するための既製のキーを受け取りました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その結果、ディスク上のすべてのファイルを復号化するプログラムをC ++で追加しました。 クライアントはさらに、自分のすべてのファイルとデスクトップを受け取りました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> おわりに </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私は自分をウイルスアナリストとはまったく考えていません。この場合、勝利への道のりで、攻撃者のいくつかの明らかな間違いが助けになったと思います。 まず、マルウェアの作成者自身がユーザーへのメッセージで多くの重要な情報を明らかにしました。暗号化アルゴリズムとキーがサーバーに保存されているという事実です。 第二に、サーバーとの交換は、かなり単純なテキストプロトコルを使用してオープンチャネルを介して実行されました。これにより、キーを取得するプロセスが大幅に加速されました。 第三に、トロイの木馬の作成者は、製品を逆コンパイルやデバッグから保護することについてあまり気にしなかったため、最終的に暗号化およびキー受信アルゴリズムの分析が簡素化されました。 そして、一般的な印象：誰かが自分の製品をハッキングから保護することを本当に心配せずに、すぐにお金を削減したかっただけです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     将来、このような悪意のあるプログラムが広く普及しないことが望まれます。 より良い無害なウィンロックは、そのような恐ex者よりも優れています。そのおかげで、ファイルを永久に失う可能性があります。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J159801/index.html">Infoboxのクラウドサーバー</a></li>
<li><a href="../J159803/index.html">悪鳥のサクセスストーリー</a></li>
<li><a href="../J159805/index.html">来週、Roskomnadzorの「ブラックリスト」は、TwitterとLiveJournalをホストするブログで補充される可能性があります</a></li>
<li><a href="../J159809/index.html">マイクロソフトは失敗しますか？</a></li>
<li><a href="../J15981/index.html">フォールアウトとベセスダ：残念ながら、私たちはそれをプレイしませんでした</a></li>
<li><a href="../J159813/index.html">ToWaveオンライン版の新しいデザイン</a></li>
<li><a href="../J159815/index.html">自分でやる：自宅でビデオを作る方法</a></li>
<li><a href="../J159817/index.html">シスコが12億ドルでMerakiを購入した5つの理由</a></li>
<li><a href="../J159819/index.html">サイモンマーロウがFacebookでマイクロソフトリサーチを辞め</a></li>
<li><a href="../J15982/index.html">HPはカメラをリリースしたくない</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>