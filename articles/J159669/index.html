<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👨🏽 ♥️ 🤾 Duqu-入れ子人形 🕜 💇🏻 🌅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="はじめに 
  
 
  
 2011年9月1日、ハンガリーから、〜DN1.tmpという名前のファイルがVirusTotal Webサイトに送信されました。 当時、このファイルはBitDefenderとAVIRAの2つのアンチウイルスエンジンによってのみ悪意のあるものとして検出されました。 それでD...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Duqu-入れ子人形</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body">  <strong>はじめに</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2011年9月1日、ハンガリーから、〜DN1.tmpという名前のファイルがVirusTotal Webサイトに送信されました。 当時、このファイルはBitDefenderとAVIRAの2つのアンチウイルスエンジンによってのみ悪意のあるものとして検出されました。 それでDuquの物語が始まりました。 今後、Duquマルウェアファミリはこのファイルにちなんで命名されたと言わざるを得ません。 ただし、このファイルは完全に独立したスパイモジュールであり、キーロガーの機能がインストールされており、おそらく悪意のあるドロッパーローダーを使用します。Duquの動作中にDuquマルウェアによってロードされる「ペイロード」と見なすことができます。  Duquのコンポーネントの1つは、9月9日にのみVirustotalサービスに送信されました。 その際立った機能は、C-Mediaによってデジタル署名されたドライバーです。 一部の専門家はすぐに、別の有名なマルウェアモデルであるStuxnetとの類推を開始しました。Stuxnetは署名されたドライバーも使用しました。 世界中のさまざまなウイルス対策会社によって検出されたDuquに感染したコンピューターの総数は、数十個です。 多くの企業は、再び主な目標はイランであると主張していますが、感染の分布の地理的条件から判断すると、これは確かに言えません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img alt="分布の地理Duqu" src="https://habrastorage.org/getpro/habr/post_images/5d4/b6a/1eb/5d4b6a1ebbc3946cf4bf4751958eb3c2.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この場合、 <a href="http://habrahabr.ru/company/pt/blog/142024">APT</a> （高度な持続的脅威）という新しい言葉を使って、次の会社についてだけ自信を持って話す必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>システム実装手順</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ハンガリーの組織CrySyS（ブダペスト工科大学と経済学の暗号化とシステムセキュリティのハンガリー研究所）の専門家が実施した調査により、システムが感染したインストーラー（ドロッパー）が発見されました。 これは、TTFフォントのレンダリングを担当するwin32k.sysドライバーの脆弱性（MS11-087、2011年11月13日にMicrosoftが説明）を悪用したMicrosoft Wordファイルでした。 エクスプロイトシェルコードは、ドキュメントに埋め込まれた「Dexter Regular」というフォントを使用します。ShowtimeInc.は、フォントの作成者として示されています。 ご覧のとおり、Duquの作成者はユーモアのセンスには馴染みがありません。Dexterは連続殺人犯で、Showtimeが撮影した同名のテレビシリーズのヒーローです。 デクスターは（可能であれば）犯罪者のみを殺します。つまり、合法性の名の下に法律を犯します。 おそらく、この方法で、Duquの開発者は、彼らが良い目的を持って違法な活動に従事していることを皮肉に思うでしょう。 メールは意図的に送信されました。 送信の場合、追跡を困難にするために、ほとんどの場合、侵害された（ハッキングされた）コンピューターが媒介として使用されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、Word文書には次のコンポーネントが見つかりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> テキストコンテンツ </li><li> 組み込みフォント。 </li><li> シェルコードの悪用。 </li><li> 運転手 </li><li> インストーラー（DLL）。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     操作が成功した場合、エクスプロイトシェルコードは次の操作を実行しました（カーネルモード）： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 再感染のチェックが行われました;これのために、 'CF1D'キーの存在がレジストリのアドレス 'HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Internet Settings \ Zones \ 4 \'で確認されました;これが正しければ、シルクコードは実行を完了しました; </li><li>  2つのファイルが復号化されました-ドライバー（sys）とインストーラー（dll）。 </li><li> ドライバーはservices.exeプロセスに挿入され、インストーラーを実行しました。 </li><li> 最後に、シェルコードはメモリ内のゼロで自動的に消去されました。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      win32k.sysが特権ユーザー「System」に代わって実行されるという事実により、Duqu開発者は不正な起動と権限の昇格（制限付き権限を持つユーザーアカウントからの起動）の両方のタスクをエレガントに解決しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     コントロールを受け取った後、インストーラーはメモリに含まれる3ブロックのデータを復号化しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 署名済みドライバー（sys）; </li><li> メインモジュール（dll）; </li><li> インストーラー構成データ（pnf）。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     インストーラー構成データで、日付範囲が設定されました（開始と終了の2つのタイムスタンプの形式で）。 インストーラーは、現在の日付がそれに該当するかどうかを確認し、該当しない場合は実行を完了しました。 また、インストーラーの構成データは、ドライバーとメインモジュールが保存された名前を示していました。 この場合、メインモジュールは暗号化された形式でディスクに保存されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img alt="Duquパーツ" src="https://habrastorage.org/getpro/habr/post_images/cb4/62c/b3e/cb462cb3e5c719006dc6c95cc641441f.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Duquの自動実行では、ドライバーファイルを使用してサービスが作成され、レジストリに保存されたキーを使用して、メインモジュールがその場で復号化されました。 メインモジュールには、構成データの独自のブロックが含まれています。 最初の起動時に復号化され、インストール日が入力された後、再び暗号化されてメインモジュールによって保存されました。 したがって、インストールが正常に完了すると、影響を受けるシステムに3つのファイル（ドライバー、メインモジュール、およびその構成データファイル）が保存され、最後の2つのファイルは暗号化形式でディスクに保存されました。 すべての復号化手順はメモリ内でのみ実行されました。 このような複雑なインストール手順を使用して、ウイルス対策ソフトウェアによる検出の可能性を最小限に抑えました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>メインモジュール</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Kaspersky Labによる<a href="http://www.securelist.com/ru/blog%3Fprint_mode%3D1%26amp%3Bweblogid%3D207763871">と</a> 、メインモジュール（リソース302）は、純粋なCのMSVC 2008を使用して書かれていますが、オブジェクト指向のアプローチを使用しています。 悪意のあるコードを開発する場合、このアプローチは特徴的ではありません。 通常、このコードはCで記述されており、サイズを縮小し、C ++に固有の暗黙的な呼び出しを取り除きます。 ここにはある共生があります。 さらに、イベント駆動型アーキテクチャが使用されました。 カスペルスキーの従業員は、メインモジュールはプリプロセッサアドインを使用して記述され、オブジェクトスタイルでCコードを記述できるという理論に傾倒しています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     メインモジュールは、オペレーターからコマンドを受信する手順を担当します。  Duquは、HTTPおよびHTTPSプロトコルの使用、および名前付きパイプの使用など、いくつかの対話方法を提供します。  HTTP（S）の場合、コマンドセンターのドメイン名が示されますが、プロキシサーバーを介して作業することは可能でした-ユーザー名とパスワードが与えられました。 チャネルには、IPアドレスとその名前が設定されます。 指定されたデータは、メインモジュールの構成データブロックに（暗号化された形式で）保存されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     名前付きパイプを使用するために、RPCサーバーの独自の実装が開始されました。 彼女は次の7つの機能をサポートしました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> インストールされているバージョンを返します。 </li><li>  dllを指定されたプロセスに挿入し、指定された関数を呼び出します。 </li><li>  dllをダウンロードします。 </li><li>  CreateProcess（）を呼び出してプロセスを開始します。 </li><li> 特定のファイルの内容を読み取ります。 </li><li> 指定されたファイルにデータを書き込みます。 </li><li> 指定されたファイルを削除します。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ローカルネットワーク内で名前付きパイプを使用して、Duquに感染したコンピューター間で更新されたモジュールと構成データを配布できます。 さらに、Duquは他の感染したコンピューター（ゲートウェイのファイアウォール設定によりインターネットにアクセスできなかったコンピューター）のプロキシサーバーとして機能する可能性があります。  Duquの一部のバージョンでは、RPC機能が欠落していました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>既知のペイロード</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     シマンテックは、Duqu Control Centerのコマンドからダウンロードした少なくとも4種類の「ペイロード」を発見しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さらに、そのうちの1つだけが常駐し、実行可能ファイル（exe）としてコンパイルされ、ディスクに保存されました。 残りの3つはdllライブラリとして実行されました。 これらは動的にロードされ、ディスクに保存せずにメモリで実行されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     常駐の「ペイロード」は、キーロガーの機能を備えたスパイモジュール（ <em><strong>infostealer</strong></em> ）でした。  Duquの研究が始まったのは、VirusTotalへの送信からでした。 主なスパイ機能はリソースにあり、その最初の8キロバイトにはフォトギャラクシーNGC 6745（マスキング用）の一部が含まれていました。  2012年4月に、イランが何らかの悪意のあるStarsソフトウェアにさらされたという情報がいくつかのメディア（http://www.mehrnews.com/en/newsdetail.aspx?NewsID=1297506）で公開されたことを思い出してください。事件の詳細は明らかにされていない。 おそらく、イランで発見されたのはまさに「ペイロード」Duquのそのようなモデルであり、したがって「スター」（スター）という名前です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      spyモジュールは次の情報を収集しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 実行中のプロセスのリスト、現在のユーザーとドメインに関する情報。 </li><li> ネットワークドライブを含む論理ドライブのリスト。 </li><li> スクリーンショット </li><li> ネットワークインターフェイスアドレス、ルーティングテーブル。 </li><li> キーボードのキーストロークログファイル。 </li><li> 開いているアプリケーションウィンドウの名前 </li><li> 利用可能なネットワークリソース（共有リソース）のリスト。 </li><li> リムーバブルドライブを含む、すべてのドライブ上のファイルの完全なリスト。 </li><li>  「ネットワーク環境」にあるコンピューターのリスト。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     別のスパイモジュール（ <em><strong>infostealer</strong></em> ）は既に説明したもののバリエーションでしたが、dllライブラリの形式でコンパイルされ、キーロガーの機能、ファイルのリストのコンパイル、ドメインに属するコンピューターのリストの削除が行われました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     次のモジュール（ <em><strong>偵察</strong></em> ）はシステム情報を収集しました： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> コンピューターがドメインの一部であるかどうか。 </li><li>  Windowsシステムディレクトリへのパス。 </li><li> オペレーティングシステムのバージョン; </li><li> 現在のユーザーの名前。 </li><li> ネットワークアダプタのリスト。 </li><li> システムおよび現地時間、タイムゾーン。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最後のモジュール（ <em><strong>ライフスパンエクステンダー</strong></em> ）は、作業が完了するまでの残り日数の値（メインモジュールの構成データファイルに格納されている）を増やす機能を実装しました。 デフォルトでは、この値はDuquの変更に応じて30または36日に設定され、毎日1ずつ減少しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>チームセンター</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2011年10月20日（発見に関する情報の普及から3日後）、Duquのオペレーターは、コマンドセンターの機能の痕跡を破壊する手順を実行しました。 コマンドセンターは、世界中のハッキングされたサーバーでホストされていました-ベトナム、インド、ドイツ、シンガポール、スイス、イギリス、オランダ、韓国。 興味深いのは、識別されたすべてのサーバーがCentOSバージョン5.2、5.4、または5.5を実行していたことです。  OSは32ビットと64ビットの両方でした。 コマンドセンターの作業に関連するすべてのファイルが削除されたという事実にもかかわらず、カスペルスキーのスペシャリストは、ログファイルの情報の一部をスラックスペースから回復することができました。 最も興味深い事実は、サーバーの攻撃者が常にデフォルトでインストールされるOpenSSH 4.3パッケージをバージョン5.8に置き換えたことです。 これは、ハッキングサーバーに対するOpenSSH 4.3の未知の脆弱性を示している可能性があります。 すべてのシステムがコマンドセンターとして使用されたわけではありません。 ポート80および443のトラフィックをリダイレクトしようとしたときにsshdログのエラーから判断して、一部はターミナルコマンドセンターに接続するためのプロキシサーバーとして使用されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>日付とモジュール</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Kaspersky Labによって調査された2011年4月に送信されたWord文書には、2007年8月31日のコンパイル日付のインストーラーダウンロードドライバーが含まれていました。  CrySys研究所に到着したドキュメントの同様のドライバー（サイズ-20608バイト、MD5-EEDCA45BD613E0D9A9E5C69122007F17）のコンパイル日は2008年2月21日でした。 さらに、カスペルスキーの専門家は、2008年1月20日付の自動実行ドライバーrndismpc.sys（サイズ-19968バイト、MD5-9AEC6E10C5EE9C05BED93221544C783E）を発見しました。  2009年のマークが付いたコンポーネントは見つかりませんでした。  Duquの個々の部分のコンパイルタイムスタンプに基づいて、その開発は2007年初頭まで遡ります。 その初期の兆候は、〜DO（おそらくスパイウェアモジュールの1つによって作成された）の形式の一時ファイルの検出に関連付けられています。作成日は2008年11月28日です（ <a href="http://www.secureviewmag.com/downloads/article_pdf/4th_quarter_secureview_small_file.pdf">記事</a> 「Duqu＆Stuxnet：A Timeline of Interesting Events」）。  Duquに関連する最新の日付は2012年2月23日です。これは、2012年3月にシマンテックが発見したインストーラダウンロードドライバに含まれていました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>使用される情報源：</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     カスペルスキーのDuqu <a href="http://www.securelist.com/ru/blog%3Ftopic%3D199193785">に関する一連の記事</a> 。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     シマンテックの分析レポート<a href="http://aroundcyber.files.wordpress.com/2012/11/w32_duqu_the_precursor_to_the_next_stuxnet_research.pdf">「W32 Duqu、次のStuxnetの前身」</a> 、バージョン1.4、2011年11月（pdf）。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J15966/index.html">追加のコンピューターを使用するにはどうすればよいですか？</a></li>
<li><a href="../J159661/index.html">SemonixのPhilipp Torchinsky：SmartOSをインストールし、Node.jsを使用する</a></li>
<li><a href="../J159663/index.html">月の黙示録！？ -稼ぐには時間が必要です...</a></li>
<li><a href="../J159665/index.html">IntelがARMチップ開発者を引き継ぐ-ZiiLabs</a></li>
<li><a href="../J159667/index.html">Youtube.comはzapret-info.gov.ruから削除されました</a></li>
<li><a href="../J15967/index.html">景品パワー</a></li>
<li><a href="../J159673/index.html">通常、コードコメントはどの言語で記述しますか？</a></li>
<li><a href="../J159675/index.html">VDS以上</a></li>
<li><a href="../J159677/index.html">直接：WebRTCサポートへの道の落とし穴</a></li>
<li><a href="../J159679/index.html">イギリス空軍に基づいてウィリアム王子の写真を公開した後、軍はパスワードを変更する必要がありました</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>