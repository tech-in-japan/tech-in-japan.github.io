<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧒🏼 ⛽️ 🍹 LinuxでC / Rテクノロジーをテストする機能 ☘️ 🙅 🈁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2012年、Andrew MortonはC / R（チェックポイント/復元）をサポートするLinuxカーネルへの最初の変更を受け入れたとき、将来のCRIUプロジェクト（ユーザー空間でのチェックポイントと復元）に悲観的でした。 ユーザーのスペースで実行中のプロセスを保存および復元する機能を実装するとい...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>LinuxでC / Rテクノロジーをテストする機能</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/283504/"><img width="400" align="left" src="https://habrastorage.org/files/28c/ef3/d1e/28cef3d1e1354f159c436db74d5b1379.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2012年、Andrew MortonはC / R（チェックポイント/復元）をサポートするLinuxカーネルへの最初の変更を受け入れたとき、将来のCRIUプロジェクト（ユーザー空間でのチェックポイントと復元）に悲観的でした。 ユーザーのスペースで実行中のプロセスを保存および復元する機能を実装するというアイデアは<a href="http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/%3Fid%3D099469502f62fbe0d7e4f0b83a2f22538367f734">夢中</a>になりました。4年後、プロジェクトは生きているだけでなく、ますますそれ自体に興味を持ちました。  CRIUプロジェクトの開始前に、Linux（DMTCP、BLCR、OpenVZ、CKPTなど）にC / Rを実装する試みが行われましたが、CRIUが実行可能なプロジェクトになった一方で、それらはすべてさまざまな理由で失敗する運命にありました。 残念ながら、LinuxのC / Rタスクは簡単になりませんでした。 この記事では、CRIUテストの機能について説明します。 <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ユニットテストの利点、継続的インテグレーションシステムの使用についての書籍や数百の記事がすでに書かれています。 これらの手法は、経験豊富な開発者全員に知られており、あらゆるソフトウェアプロジェクトの絶対的な基準です。 したがって、ここではこれらの手法を使用する利点については説明しませんが、代わりにCRIUを他のプロジェクトと区別するニュアンスについてのみ説明します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      CRIU開発プロセス自体は、Linuxカーネル開発と変わりません。すべての新しい変更は1つの完全な思考です。 すべてのパッチは<a href="http://lists.openvz.org/pipermail/criu">criu @</a>メーリングリストに<a href="http://lists.openvz.org/pipermail/criu">送られ</a> 、そこでレビューされます。 レビューされたパッチは、プロジェクトのメンテナーによってリポジトリに追加されます。 コードの問題の一部はレビュー段階で明らかになりますが、スクリプトと構成の数のためにそれらをゼロに減らすことはできません。 したがって、劣化を検出するために、新しい変更ごとにテストを実行します。 テストの継続的な実行の保証は、自動作業テストです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     開発の初期段階で<a href="https://openvz.org/Checkpointing_and_live_migration">、OpenVZでのC / Rのカーネル内実装の</a>テストに成功した<a href="https://criu.org/ZDTM_Test_Suite">ZDTM</a> （Zero DownTime Migration）テストスイートの機能テストの使用を開始しました。 現在、このセットの各テストは個別に起動され、3つの段階を経ています。環境の準備、「デモ」、およびシグナル（ステータスをチェックする時間であることをテストに知らせる）の待機、結果の確認。 テストは条件付きで2つのグループに分けられます。 最初のグループは、ある種の一定の環境または状態を準備し、信号を見越して「眠りに落ちる」静的テストです。  2番目のグループは、状態や環境を絶えず変更する動的テストです（たとえば、TCP接続でデータを送信します）。  2012年にCRIUユニットテストシステムが約70の個別のテストプログラムで構成されていた場合、今日ではその数<a href="https://github.com/xemul/criu/tree/master/test">は200に増えてい</a>ます。 しかし、完全なCRIUテストのために実行する必要がある組み合わせの数は本当に恐ろしいです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     主な構成は、ホストで一連のテスト全体を実行することです。各テストプログラムは特定の位置に置かれ、テストプロセスが保存および復元され、同じ位置に残っているかどうかを確認するように求められます。 次に重要な構成は、C / Rが機能するだけでなく、Cの後、メインプロセスが中断しなかったことを確認することです。 したがって、各テストは、最初の部分のみが完了して（回復せずに）バリアントで実行され、ポーズが観察されることを確認する必要があります。 これはテストなしのテストです。 復元されたプロセスは同じ位置にある場合がありますが、繰り返されるC / Rには適していません。 したがって、もう1つの構成が表示されます-C / Rを繰り返します。 次に、スナップショットの構成、名前空間に囲まれたC / R、通常のユーザー権限のC / R、後方互換性チェックのC / R、BTRFSおよびNFSでの正常な回復の検証（これらのFSには独自の<a href="https://criu.org/Filesystems_pecularities">「機能」があるため</a> ）があります。 しかし、個々のプロセスのC / Rに加えて、グループC / Rを行うことができます-すべてのプロセスが同じ位置にあり、各プロセスが独自の位置にあるときにプロセスのグループを保存します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      CRIUはいくつかのハードウェアアーキテクチャをサポートしていますが、現在はx86_64、ARM、AArch64、PPC64le、i386が近づいています。 厳しい現実により、カーネルのいくつかのバージョンをテストする必要があります。バニラカーネルの最後の公式リリース、RHEL7カーネル（3.11ベース）、およびlinux-nextブランチです。 テスト期間は短い（2〜10分）が、既存のシナリオと可能な構成の組み合わせの数を考慮すると、印象的な数値が得られる。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すでに書いたように、テストは定期的に使用される場合にのみ役立ちます。 しばらくの間、手動でテストを開始しましたが、ある時点で、ローカルテストには開発者からの時間がかかり、新しい変更ごとにテストを実行するためのシステムをセットアップすることに気付きました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2つのCIシステムを使用します<a href="https://travis-ci.org/xemul/criu/branches">。TravisCIは</a> 、サポートされているすべてのハードウェアアーキテクチャでコンパイルをチェックするために使用されます。  Travis CIはバージョン3.8よりも低いカーネルを使用しているため、CRIUに必要なパッチのほとんどが不足しているため、Travisはテストの実行に適していないほか、よく知られている<a href="https://ci.openvz.org/view/CRIU/">Jenkins CI</a>を使用します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> 結論 </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> コードカバレッジのアセンブリ、テスト、および測定を自動化する必要があります </li><li> 多くのテストは行われず、有用なコードとテストコードの比率は約1.6（48 KLOC対30 KLOC）であり、努力することが多くあります。 </li><li> テストする構成の数が膨大な場合は、優先順位を付けます </li><li> いつもの<a href="https://criu.org/Contacts">ように、CRIU</a>で<a href="https://criu.org/Contacts">私たちのところ</a>に<a href="https://criu.org/Contacts">来てください</a> 。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>CRIUプロジェクトは2012年にVirtuozzoのエンジニアによって開始されましたが、後にLinuxでC / Rテクノロジーを作成することに関心を持つ<a href="https://criu.org/Community">他の企業</a>によってサポートされました。</i> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J283494/index.html">ReactNativeで簡単な歩数計アプリを開発する</a></li>
<li><a href="../J283496/index.html">Operaブラウザの省電力</a></li>
<li><a href="../J283498/index.html">Windows Conference DevCon 2016のトラックのお知らせ</a></li>
<li><a href="../J28350/index.html">大規模なリソースですか、テーマ別のサイトですか？ バナー広告はどこでより効果的ですか？</a></li>
<li><a href="../J283502/index.html">チェスの氷と炎</a></li>
<li><a href="../J283508/index.html">新しいIntel RealSense SR300カメラの紹介</a></li>
<li><a href="../J28351/index.html">SEOチートシート</a></li>
<li><a href="../J283510/index.html">モスクワアトラシアンMeetup 4月20日のレポート</a></li>
<li><a href="../J283512/index.html">クロスデバイス広告の仕組み：技術開発の難しさと展望</a></li>
<li><a href="../J283516/index.html">.NET開発：大人のための9つの質問</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>