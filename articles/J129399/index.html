<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍💻 🥖 👩🏾‍🚀 DIY Loopdetect 🆒 🤰🏽 ✌🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="問題の本質  
  
 イーサネットネットワークの最悪の悪化の1つは、いわゆるループです。 （主に人的要因による）ネットワークトポロジでリングが形成されるときに発生します。 たとえば、2つのスイッチポートがパッチコードで接続されていた（2つのスイッチが1つに置き換えられて、すべてを固定しているように...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>DIY Loopdetect</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><h5> 問題の本質 </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     イーサネットネットワークの最悪の悪化の1つは、いわゆるループです。  （主に人的要因による）ネットワークトポロジでリングが形成されるときに発生します。 たとえば、2つのスイッチポートがパッチコードで接続されていた（2つのスイッチが1つに置き換えられて、すべてを固定しているように見えない場合によく発生します）または、新しい回線でノードを起動し、古いものを切断するのを忘れました（結果は悲しく、特定するのが困難です）。 このようなループの結果、パケットが増加し始め、スイッチングテーブルが失われ、雪崩のようなトラフィックの増加が始まります。 このような状況では、ネットワーク機器がフリーズし、ネットワークが完全に混乱します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これらのループに加えて、ポート（スイッチまたはネットワークカード）が燃え尽きると、受信したパケットがネットワークに返され始め、ほとんどの場合、接続が10Mでネゴシエートされ、ケーブルが切断されていてもリンクがアップすることは珍しくありません。 セグメントにポートが1つしかない場合、結果はそれほど嘆かわしいものではないかもしれませんが、依然として非常に敏感です（VistaおよびSevenのユーザーは特にひどく苦しんでいます）。 いずれにせよ、このようなことを行うと、短時間でも意図的にまたは誤ってループを作成することで、ネットワークセグメント全体を切断できるという事実を容赦なく戦い、理解する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> マテリエル </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     幸いなことに、ほとんどの最新のマネージドスイッチは、何らかの形でループ検出機能（loopdetect、stp）を備えており、さらにプロトコルのstpファミリにより、リングトポロジを具体的に構築できます（フォールトトレランスと信頼性を向上させるため）。 しかし、コインには裏返しがあり、1つの焼けたポートが通信なしでエリア全体から出ることがよくあります。 または、同じstpで、トポロジはすぐに再構築されず、この時点での接続は、もちろん、多くの要望を残します。 さらに、一部のメーカーは、ループ検出プロトコルの実装に非常に怠慢です。たとえば、DES-3016（glink）は、2つのポートを接続するだけではループをまったく決定できないと言います。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> 識別の原則 </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ループ検出（loopdetect）の原理は非常に簡単です。 ブロードキャストアドレス（すべてのユーザー向け）を使用して特別なパケットがネットワークに送信されます。戻った場合、このインターフェイスの背後のネットワークはループバックされていると考えられます。 次に行うことは、機器の種類と設定によって異なります。 ほとんどの場合、ポートは完全にまたは部分的に（別のVLANで）ブロックされ、イベントがログに記録され、SNMPトラップが送信されます。 これがシステム管理者と緊急サービスの出番です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ネットワーク全体が管理可能であれば、ループを特定して排除することは難しくありません。 ただし、5〜6個のアンマネージドスイッチのチェーンが1つのポートに接続されているネットワークはそれほど多くありません。 このようなループを削除するには、多くの時間と労力がかかります。 検索プロセスは、ポートの順次無効化（有効化）に要約されます。 ループの存在を判別するには、優れた管理対象スイッチまたはスニファー（wireshark、tcpdump）のいずれかが使用されます。 最初の方法は、ロックのオンとオフの間に遅延があるため非常に危険です。最良の場合、ユーザーは単に遅れをとるだけであり、最悪の場合、ループ検出はラインでより高く動作し、より大きなセグメントが落ちるでしょう。  2番目のケースでは、ユーザーに危険はありませんが、ループの存在を判断することははるかに困難です（特に、ブロードキャストトラフィックがほとんどない小さなセグメントで）、それにもかかわらず、スニファーは定義上、受動的です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> 自分でやる </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     前述のように、ループ検索のハードウェア実装で十分です。 ためらうことなく、wiresharkをオンにし、フィルターを構成して、スイッチの機能と方法を確認します。 実際には、すべてが単純です：宛先アドレス<b>cf：00：00：00：00：00</b> 、タイプ<b>0x9000</b> （ <a href="http://wiki.wireshark.org/Loop">CTP</a> ）、および不明な機能番号256（見つかったドキュメントには2つだけが記載されています）でポートにイーサネットパケットが送信されます。 宛先アドレスはブロードキャストであるため、ネットワークにループがある場合は、このパケットのコピーをいくつか戻す必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最初にライブラリを決定しました： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 生のパケットをキャプチャして送信するには、pcapyライブラリを使用します。 </li><li> パッケージ生成では、dpktが役立ちます。 </li><li> サウンドを再生するには、pyaudeoとwaveを使用します。 </li><li> まあ、いくつかの標準ライブラリ。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さらに、すべてが簡単でシンプルです。 選択したインターフェイスでpcapy.open_liveクラスのインスタンスを作成し、それにフィルターを追加します。 定期的にパケットを送信する最初のループを作成し、その中に返されたパケットをキャプチャして処理する2番目のループを作成します。 キャプチャされたパケットが送信されたパケットと同一である場合、+ 1がカウンターに追加されます。 タイムアウトの期限が切れた後、パケットの複数のコピーが受信されると、サウンドが再生され、コンソールにループメッセージが表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     結果のスクリプトは後で見つけることができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pcapy, dpkt , sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time , random, socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyaudio , wave <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">packetBody</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(length)</span></span></span><span class="hljs-function">:</span></span> rez = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,length): rez.append(random.choice(<span class="hljs-string"><span class="hljs-string">'0123456789abcdef'</span></span>) + random.choice(<span class="hljs-string"><span class="hljs-string">'0123456789abcdef'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rez <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loopDetector</span></span></span><span class="hljs-class">:</span></span> packetCount = <span class="hljs-number"><span class="hljs-number">0</span></span> loopCount = <span class="hljs-number"><span class="hljs-number">0</span></span> timeout = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,iface)</span></span></span><span class="hljs-function">:</span></span> self.iface = iface self.pcaper = pcapy.open_live(iface,<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) self.Mac = <span class="hljs-string"><span class="hljs-string">'00:19:5b:'</span></span>+<span class="hljs-string"><span class="hljs-string">':'</span></span>.join(packetBody(<span class="hljs-number"><span class="hljs-number">3</span></span>)) self.pcaper.setfilter(<span class="hljs-string"><span class="hljs-string">'ether dst cf:00:00:00:00:00 and ether src %s'</span></span> % self.Mac) wf = wave.open(<span class="hljs-string"><span class="hljs-string">'alarm.wav'</span></span>, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) self.pyA = pyaudio.PyAudio() self.stream = self.pyA.open(format = self.pyA.get_format_from_width(wf.getsampwidth()), channels = wf.getnchannels(), rate = wf.getframerate(), output = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) self.wfData = wf.readframes(<span class="hljs-number"><span class="hljs-number">100000</span></span>) wf.close() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__del__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.stream.stop_stream() self.stream.close() self.pyA.terminate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlayAlarm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.stream.write(self.wfData) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Capture</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,hdr,data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> data == str(self.sPkt): self.packetReceived += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: pktData = <span class="hljs-string"><span class="hljs-string">'00000001'</span></span> + <span class="hljs-string"><span class="hljs-string">''</span></span>.join(packetBody(<span class="hljs-number"><span class="hljs-number">42</span></span>)) self.sPkt = dpkt.ethernet.Ethernet(dst=<span class="hljs-string"><span class="hljs-string">"cf0000000000"</span></span>.decode(<span class="hljs-string"><span class="hljs-string">'hex'</span></span>), src=<span class="hljs-string"><span class="hljs-string">''</span></span>.join(self.Mac.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>)).decode(<span class="hljs-string"><span class="hljs-string">'hex'</span></span>), type=<span class="hljs-number"><span class="hljs-number">36864</span></span>,data=pktData.decode(<span class="hljs-string"><span class="hljs-string">'hex'</span></span>)) endTime = time.time() + self.timeout <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Send packet to %s"</span></span> % self.iface self.packetCount += <span class="hljs-number"><span class="hljs-number">1</span></span> self.pcaper.sendpacket(str(self.sPkt)) self.packetReceived = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> time.time() &lt; endTime: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: self.pcaper.dispatch(<span class="hljs-number"><span class="hljs-number">-1</span></span>,self.Capture) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> socket.timeout: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.packetReceived &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: self.loopCount += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Loop Detected. Duplication found %s"</span></span> % self.packetReceived self.PlayAlarm() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyboardInterrupt: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Packets sent: "</span></span>, self.packetCount , <span class="hljs-string"><span class="hljs-string">"Loops discovered : "</span></span> , self.loopCount <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> dev_list = {} n = <span class="hljs-number"><span class="hljs-number">0</span></span> iface = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pcapy.findalldevs(): dev_list[n] = x n += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: iface = dev_list[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyError: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"No device found"</span></span> exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(sys.argv) == <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-string"><span class="hljs-string">'list'</span></span>,<span class="hljs-string"><span class="hljs-string">'ls'</span></span>,<span class="hljs-string"><span class="hljs-string">'all'</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev_list: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'Index:'</span></span>, x, <span class="hljs-string"><span class="hljs-string">'Device name:'</span></span> ,dev_list[x] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: iface = dev_list[int(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>])] <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyError: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Invalid device id, trying use first"</span></span> iface = dev_list[<span class="hljs-number"><span class="hljs-number">0</span></span>] ld = loopDetector(iface) ld.Process() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">"__main__"</span></span>: main()</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://animage.me/%3Fp%3D137">オリジナルとソース</a>へのリンク </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J129393/index.html">ノキアは新しいモバイルOS Meltemiの作成に取り組んでいます</a></li>
<li><a href="../J129394/index.html">Amazonは各タブレットで50ドルを失います</a></li>
<li><a href="../J129395/index.html">OpenGTSオープンソース車両追跡ソリューション</a></li>
<li><a href="../J129396/index.html">WP Creator Calculator-電卓フォームを作成するためのプラグイン</a></li>
<li><a href="../J129398/index.html">ASP.NET MVC3の控えめな検証</a></li>
<li><a href="../J12940/index.html">IISは2008年にApacheに追いつきますか？</a></li>
<li><a href="../J129401/index.html">FreeBSDのすべてのバージョンにおける深刻な脆弱性</a></li>
<li><a href="../J129402/index.html">そして、最後に完成したプロジェクトは何ですか？</a></li>
<li><a href="../J129403/index.html">「眠っている」ラップトップサムスン350U2Bのレビュー</a></li>
<li><a href="../J129404/index.html">プリンストンは科学記事の有料購読で戦います</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>