<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👷 👰 🤘🏽 UEFIセキュリティパート3 🖐🏽 🚣🏽 🌃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="UEFIセキュリティについて引き続き説明します。 
  
 今回は、ACPI S3（スリープモード）の実装で2014年後半に公開された深刻な脆弱性、その動作と結果についてお話します。 この脆弱性の主な「トリック」は、以前はまったく問題とは見なされていなかったUEFIセキュリティ問題のクラス全体を明ら...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>UEFIセキュリティパート3</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/267237/"><img align="left" src="https://habrastorage.org/files/74f/d27/2f8/74fd272f8e3c4b4388bdf46813925981.jpg">  UEFIセキュリティについて引き続き説明します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     今回は、ACPI S3（スリープモード）の実装で2014年後半に公開された深刻な脆弱性、その動作と結果についてお話します。 この脆弱性の主な「トリック」は、以前はまったく問題とは見なされていなかったUEFIセキュリティ問題のクラス全体を明らかにしたため、別の記事に値することです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     サイクルの前の記事を<a href="http://habrahabr.ru/post/266935/">一</a> <a href="http://habrahabr.ru/post/267197/">度</a>も読んでいない人のために-私は最初にそれらを読むことを提案します、私はカットの下で残りを待ちます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>パート3。</b>  <b>ACPI S3</b> </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>ほんの少しの教育プログラム</b> </h5>  <abbr title="システム管理モード">SMM</abbr>とは異なり、ACPI S3については、平均的なユーザーはほとんどの場合、疑いさえしていません。 スリープモード、ラップトップまたはPCを過去10年間にリリースした人なら誰でも知っています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <abbr title="高度な構成と電源インターフェイス">ACPI</abbr>標準は、 <a href="http://habrahabr.ru/post/259477/">私が最近書い</a>た最新バージョンの変更について、いわゆるセットを定義しています  <i>スリープ状態</i> 。次のいずれかのシステムがあります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>S0-作業中</b> 、つまり 通常の操作では、すべてのデバイスがオンになっています。 この状態の中で、システム製造業者は他の状態の束を定義する権利を持っています： <abbr title="性能">P</abbr>状態、 <abbr title="CPUアイドル">C</abbr>状態、 <abbr title="スロットル">T</abbr>状態など、私はそれらについて改めて話しましょう。 </li><li>  <b>S1-プロセッサコンテキストが維持された状態</b>での<b>スリープ</b> 、別名Power on Suspend、つまり すべてのプロセッサコアがHLTコマンドを実行してスタンドになっていますが、すべてのキャッシュとRAMは有効で更新されており、すべてのS0専用ラインからの電力は削除されています。 この状態からの復帰には約10 msかかりますが、そのうちの約90％は、S0専用回線に電力を供給した後の定常状態モードの予測です。 この状態のCPU、チップセット、またはデバイスのレジスタはリセットされないため、この記事には興味がありません。 </li><li>  <b>S2 / S3-RAMへのサスペンド</b> 、つまり メモリの内容は有効で更新されたままであり、プロセッサとチップセットの一部は完全に無効になり、ほぼすべてのレジスタのコンテキストと内容が失われます。  S2とS3の違いは最小限であり、ほとんどの場合、S2はまったく別の状態に割り当てられていません。  S3から起動した後、プロセッサはResetVectorからコードの実行を開始します。 適切に「ウェイクアップ」するために、彼は自分自身とチップセットのコンテキスト全体を復元する必要があります。 この段階で、ファームウェアの開発者は、この記事で説明するいくつかの水中レーキを待っています。 </li><li>  <b>S4-ディスクへのサスペンド</b> 、つまり メモリの内容がディスクにフラッシュされ、システムはすべてのデバイスと電源をオフにします。 スイッチをオンにすると、システムは通常どおり起動し、UEFIの観点から見ると、S4とS5の間に実質的な違いはありません（FastBootを無効にした場合、まったく違いはありません）。 </li><li>  <b>S5-ソフトオフ</b> 、つまり システムはオフですが、スタンバイ電源は存在します。  S4 / S5から、システムは<abbr title="リアルタイムクロック">RTC</abbr>信号、デバイスからのWake信号、または電源ボタンを押すことで出力できます。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>UEFIでのS3の実装方法</b> </h5>  「ウェイクアップ」時にコンテキストを復元するには、まずどこかに保存する必要があります。 同時に、プロセッサとチップセットアーキテクチャの特定の機能に執着しすぎないこと、および後でデバッグで死ぬことがないように、コンテキストの保存と復元をできるだけ透過的にすることをお勧めします。 なぜなら  S3のパフォーマンスは、ほとんどすべての最新のPCの非常に重要な特性です。ただし、稼働時間の長いサーバーを除き、コンテキストを保存および復元する技術は2004年の早い時期にIntelエンジニアによって開発され、 <a href="http://www.intel.com/content/www/us/en/architecture-and-technology/unified-extensible-firmware-interface/efi-boot-script-specification-v091.html">EFI S3 BootScript</a>と呼ばれていました。 それ以来、仕様は何度も改良され、最新バージョンはUEFI <abbr title="プラットフォームインターフェース">PI</abbr>仕様の第6巻になりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その本質は次のとおりです。基本的なデバイスの初期化が行われる<abbr title="事前efi初期化">PEI</abbr>フェーズの実行後。 プロセッサ、キャッシュ、およびRAM、システムは現在のブートモードを決定します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>1.</b>このモードがS3 Resumeと異なる場合、ダウンロードは通常どおり続行され、PEIは<abbr title="ドライバー実行環境">DXE</abbr>マネージャーで終了します<abbr title="ドライバー実行環境">。DXE</abbr>マネージャーは新しい空のS3 BootScriptを作成し、使用可能なすべてのDXEドライバーを起動します。 このような各ドライバーは、担当するデバイスの最終初期化を実行し、S3から戻るときにデバイスの初期化を繰り返すために実行する必要があるコマンドをS3 BootScriptに追加します。 コマンドは次のようなものです（リストはPI 1.4仕様から取られていますが、特定の実装では非標準のものも見つけることができます）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>IO_WRITE-</b>指定された値を指定されたCPU IOポートに書き込みます </li><li>  <b>IO_READ_WRITE-</b>指定されたマスクに従って、指定されたCPU IOポートの値を変更します </li><li>  <b>IO_POLL-</b>指定された条件が満たされるまで、指定されたIOポートから読み取りますが、指定されたタイムアウト以下 </li><li>  <b>MEM_WRITE-</b>指定された値を指定された物理アドレスに書き込みます </li><li>  <b>MEM_READ_WRITE-</b>指定されたマスクに従って、指定された物理アドレスの値を変更します </li><li>  <b>MEM_POLL-</b>指定された条件が満たされるまで、指定されたアドレスで読み取られますが、指定されたタイムアウト以下になります </li><li>  <b>PCI_CONFIG_WRITE-</b>指定されたPCIデバイスの構成スペースの指定されたアドレスに指定された値を書き込みます </li><li>  <b>PCI_CONFIG_READ_WRITE-</b>指定されたマスクに従って、指定されたPCIデバイスの構成スペース内の指定されたアドレスの値を変更します </li><li>  <b>PCI_CONFIG_POLL-</b>指定された条件が満たされるまで、指定されたPCIデバイスの構成スペース内の指定されたアドレスで読み取りますが、指定されたタイムアウト以下になります </li><li>  <b>SMBUS_EXECUTE-</b>指定されたコマンドをSMBusバス上の指定されたデバイスに送信します </li><li>  <b>STALL-</b>指定されたマイクロ秒数待つ </li><li>  <b>DISPATCH-</b>指定されたアドレスでコードを実行 </li></ul> 上記のコマンドは、すべての初期化を実行するPEIドライバーに制御を単純に転送する最後のコマンドを考慮すると、特にデバイスを再初期化するのに十分ですが、これは、残りのコマンドを省くことができない特に困難な場合にのみ必要です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DXEフェーズの終了後、ディスパッチャは結果のS3 BootScriptをAcpiNVSメモリに保存します。AcpiNVSメモリには、ACPIテーブルと、OSがACPIで正しく機能するために必要なその他のデータが含まれます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>2.</b>ブート時に、システムがDXEマネージャーではなくS3 Resumeにあることが判明した場合、BootScriptExecutorという美しい名前のPEIモジュールが起動され、BootScriptが実行され、最後の通常のブート以降にメモリに慎重に保存され、OSに制御が転送されます。起動し、ユーザーを喜ばせます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     言葉で、彼は説明したように、今では同じこと-仕様からの写真： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/8e4/75b/6d6/8e475b6d6f134ba388a7417a9d8d1224.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>水中熊手</b> </h5>これはすべて約10年間正常に機能し、2014年の終わりに狭いサークルでよく知られた仲間、ラファルヴォイチュチュクとコーリーカレンバーグが明らかで非常に危険な<a href="https://frab.cccv.de/system/attachments/2566/original/venamis_whitepaper.pdf">攻撃である</a>ことが判明するまで、ほとんど誰もそのトリックを見ませんでした。  S3 BootScriptを格納するメモリ領域（AcpiNVSなど）は変更から保護されていないことが判明しました。 はい、OSはそれをサービス1として認識し、コンテンツ自体を台無しにしませんが、管理者権限を持つ攻撃者はそれを行います。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     変更は非常に異なる場合がありますが、  SPIチップでの任意のコードフラッシュ、およびSMMへの不正アクセスに対する保護を提供する保護メカニズムのほとんどは、プロセッサおよびチップセットレジスタを介して構成されているため、これらのメカニズムを正常にバイパスするには、メモリ内のBootScriptを見つけるだけで十分です（これは簡単です）必要なレジスタ（難易度なし）を変更し、次のS3レジューム保護がオンにならないように変更します。 変わり、眠りに落ち、目を覚ましなさい-op、そして王は裸です！  SPIチップとSMMからの保護の削除を脅かすもの-前のパートですでに書いたように、繰り返しはしませんが、良い結果で終わることはありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     興味深いことに、Intelのエンジニアはこの攻撃を予見し、事前に保護を実装しました。  <i>SmmLockBox</i> 。 保護は非常に簡単です。スクリプトのコンパイルが終了すると、SMRAMに完全にコピーされますが、元のBootScriptは削除されません。  S3から回復するとき、SMIハンドラーが呼び出され、元のBootScriptがSMRAMのコピーと一致することを確認し、そうでない場合は、変更されたBootScriptをコピーで上書きするか、マシンを再起動します（これはより安全ですが、ユーザーはRAMからすべてのデータを失います）。 問題は、SmmLockBoxが時間内に実装する時間がないことであり、RafalとCoreyが脆弱性をテストしたとき、攻撃を受けないマザーボードはIntelのUEFI開発キットだけであることが判明しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     攻撃が公開された後、 <abbr title="独立したBIOSベンダー">IBV</abbr>は急いで元のSmmLockBoxまたは同じアイデアに基づく類似物のいずれかを導入し始めましたが、この実装はさまざまな理由で停止することがよくありました。 たとえば、AMDプロセッサを搭載したシステムでは、SMMはDXEフェーズで初期化されたため、S3 Resumeを使用したPEIからのSMIハンドラーの呼び出しは失敗し、S3はまったく動作しなくなりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ただし、現時点では、少なくとも耳の端までセキュリティについて聞いているすべてのベンダーは、すでに何らかの方法でこの問題を解決しています。また、ファームウェアが2015年6月より新しく、システムの製造元が悪口でない場合、システムは直接攻撃する可能性が高いですS3 BootScriptは影響を受けなくなりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>プラットフォームメーカーの豚</b> </h5> パニックが少し落ち着き、BootScriptがSMRAMに正常にプッシュされた後（目の前にそれを保存する必要があるのは明らかですが、これについては最後の部分で書きました）、IntelとAMDのエンジニアがそれを知らずに突然判明しました、彼らはプラットフォームの所有者にいくつかのPEIモジュールに直面してまともな豚を植えました。これ<b>は</b> <b>a</b> ）BootScriptのすぐ隣のメモリにコピーされ、 <b>b</b> ）DISPATCHコマンドによって何十回も呼び出され、 <b>c</b> ）SMRAMにスペースを確保するのに十分な大きさでした十分ではありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、BootScript自体を一般的に変更することなく、任意のコードの実行を整理できます。代わりに、そのようなモジュールの1つのエントリポイントを変更します。  S3の動作を中断せずにこのようなモジュールを削除することはできませんでしたが、解決策が見つかりました-メモリにコピーする代わりに、DXEボリュームの展開された部分に転送され、SPIPAチップからコードが直接呼び出されるようにDISPATCHコマンドが修正されました。 これはRAMよりも少し遅いことが判明しましたが、ブタはなんとかそれを追い出しました。 この方法で攻撃できるシステムの数はわかりませんが、多くのシステムがあると思われます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>忘れっぽい紳士</b> </h5> 人はエラーの影響を受けず、DXEドライバーの開発者も人間であり、BootScriptに重要なレジスターを追加することを忘れてしまうことがあります。S3の後、このレジスターは元の値になります。 ほとんどの場合、このような物忘れはS3後の軽微な不具合につながるだけですが、マーフィーの法則は、重要なレジスタを忘れると忘れてしまうと言っています。 忘れっぽさの最新の注目すべき例は、今年の5月下旬にAppleラップトップファームウェアで<a href="https://reverse.put.as/2015/05/29/the-empire-strikes-back-apple-how-your-mac-firmware-security-is-completely-broken/">公開さ</a>れた脆弱性です。エンジニアはS3 BootScriptのPRレジスタにエントリを追加するのを忘れ、S3の後、SPIチップはファームウェア自体によって保護されなくなりました。 結局のところ、ふたを閉じるのは非常に便利です。また、フラッシュROMを入手してBIOSでコードを書くことができるので、Appleは再びシンプルで使いやすくなっています。 ケースが独特だと思う場合<a href="https://github.com/chipsec/chipsec">-PCでChipsec</a>ユーティリティを実行し、S3の前後に作成されたレポートを比較することをお勧めします。 同時に、驚きが起こる可能性があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>私はS3をオフにし、草が成長しません</b> </h5> これについて、より表現力豊かで、少しわいせつなだけで、初めて問題に遭遇したとき、私は叫んだ。 残念ながら、このオプションは常に可能というわけではありません（SSDのS4の速度はほとんど変わりませんが、信頼性は大きく異なりますが、スクリプトやエグゼキューターとのダンスは必要ありません）、さらに、ファームウェアを変更してS3を厳しく無効にしなかった場合、攻撃者はシステムUEFIシェルで実行し、S3を簡単にオンにします。 次のパートでは、このような厄介な運命を避ける方法を説明しようとしますが、簡単に-SecureBootをオンにして使用します。調理できるなら、それはまったく悪ではありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>自信の危機</b> </h5>  S3 BootScriptを使用したこの全体の話から、UEFIでの10年間の気楽な開発が今だけ真剣に解決され始めたという興味深い問題が明らかになりました。 問題は、「安全な」ファームウェアが、OSがアクセスした、またはアクセスしたものを信頼できないことです。 デバイスを個別にリセットおよび初期化する必要があり、メモリをクリアし、そこから何も使用しないでください（そこからコードをランダムに呼び出さないでください！）、ランタイムサービスはReadyToBootイベントの後は使用できません（攻撃者は既にそれらをフックしていることがあります）一般に、堅固な地雷原で、私は少しつまずきました-そして今、あなたはすでに他の誰かのコードの完全なBIOS、バックドアのバックドア、SMRAMの正直なドライバーが場所を持っていません。 そのため、プラットフォームメーカーはハードウェアソリューションの救済を求めています。誰かが検証済みブートを実装し、誰かがセキュリティコプロセッサーにS3 BootScriptを保存し、誰かが自分の暗号チップを開発し、誰かがスコアを付けてUEFIフォーラムソリューションを手に入れるのを待っています低下します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、Intelは、Skylakeに興味深い<abbr title="ソットウェアガードエクステンション">SGX</abbr>テクノロジーを追加しました。これは、システム内の他のすべてからコードやデータの個々の部分を分離するために使用できます。 このテクノロジーは非常においしいように見えますが、第一に、プログラミングが困難であり、第二に、IntelのみがSkylakeにのみ搭載しています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      「安全な」OSの部分では、ファームウェアに対する不信のレベルはまったく同じであり、2009年以来話題になっている<abbr title="SMMトランザクションモニター">STM</abbr>テクノロジーは、最近に<a href="https://firmware.intel.com/sites/default/files/A_Tour_Beyond_BIOS_Launching_STM_to_Monitor_SMM_in_EFI_Developer_Kit_II.pdf">なって正式に導入され</a> 、「戦闘中」はここでテストされていませんが、役に立つ場合があります。 両手が届くと、それについて書きます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>おわりに</b> </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さて、S3 BootScriptの問題は背後にあります。次の部分では、NVRAMとSecureBootへの攻撃について、またBIOSパスワードが正直な人々からのものである理由について説明します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     良い伝統により、私<a href="http://blog.cr4.sh/2015/02/exploiting-uefi-boot-script-table.html">はこの記事の</a>同志<a href="http://blog.cr4.sh/2015/02/exploiting-uefi-boot-script-table.html">がここに</a>英語の愛好家に助言し<a href="http://blog.cr4.sh/2015/02/exploiting-uefi-boot-script-table.html">ます</a> 同じトピックの<a href="https://habr.com/users/d_olex/" class="user_link">d_olex</a> 。 深刻さ、深さ、コード、写真がありますが、ここでの私の言い回しとは異なります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     安全なファームウェアをお読みいただきありがとうございます。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J26722/index.html">グランドキャニオンを征服するロボット</a></li>
<li><a href="../J267225/index.html">JetBrains：サブスクリプションの再考と安定性の確認</a></li>
<li><a href="../J267229/index.html">Chromeおよびその他のブラウザーのDoS攻撃</a></li>
<li><a href="../J26723/index.html">オンラインセミナーを開催するためのビジネスの見通し</a></li>
<li><a href="../J267231/index.html">機能的なC＃：バグの処理</a></li>
<li><a href="../J26724/index.html">IBM、SolidDBを自社ブランドで発売</a></li>
<li><a href="../J267241/index.html">メンテナンスコード。 リファクタリングをビジネスに「販売」する方法</a></li>
<li><a href="../J267243/index.html">RxJava。 厳しい現実の課題と戦う</a></li>
<li><a href="../J267245/index.html">RailsClub 2015：ニコライ・リジコフとのインタビュー</a></li>
<li><a href="../J267247/index.html">あなたの性格を知るために、いくつのツイートが必要ですか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>