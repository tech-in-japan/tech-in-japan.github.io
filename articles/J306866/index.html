<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚸 👩🏽‍🤝‍👩🏻 🌼 誤った更新を排除して、クライアントマシンへの更新のインストールを自動化する 👵🏾 🎽 💦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1年に1回、更新により通常の作業が中断されます。 Windowsは3回インストールを試み、3回ロールバックされた場合、インストールせずにロードします。 朝のユーザーが電話をかけ始めます。 何もしなければ、翌朝、状況は繰り返されます。 
  
 

- WSUSサーバーでは、それをUnapproved...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>誤った更新を排除して、クライアントマシンへの更新のインストールを自動化する</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/306866/">  1年に1回、更新により通常の作業が中断されます。  Windowsは3回インストールを試み、3回ロールバックされた場合、インストールせずにロードします。 朝のユーザーが電話をかけ始めます。 何もしなければ、翌朝、状況は繰り返されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>WSUS</b>サーバーでは、それを<b>Unapproved</b>に移動しても意味がありません。 パッチはすでにクライアントマシンにダウンロードされており、 <b>SoftwareDistribution</b>フォルダーにあります。手動で削除する必要があります </li><li> 多くのバグのあるパッチが存在する可能性があります </li><li> 半年で管理者は再度承認できます </li><li> 半年または1年に1回承認すると、1台の車（1台の車）について、1日あたり最大で1日の仕事が行われます。 </li><li>  OSが同じであっても、ある構成からの更新が別の構成に適さない場合があります </li><li>  <b>SoftwareDistributionが</b>削除されると、 <b>非表示の</b>更新ステータスがリセットされます </li><li> データベースにバグがあり、検索に時間がかかりすぎる場合、 <b>SoftwareDistributionを</b>無効にする必要があります。定期的に実行することをお勧めします </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これはすべて不便であるため、管理者はほとんど同じことを行います。問題のマシンの更新を無効にします。 そして、1、2年後、彼はローリングアップデートを開始し、同じ問題に直面します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     なぜなら 更新の不具合により緊急モードが発生し、まったく意味のないごみを扱うスタッフに信じられないほどの時間がかかり、 <a href="https://habrahabr.ru/post/301242/">スマートインフラストラクチャ</a>に到達するために、このプロセスを自動化することが決定されました。 途中で、自動モードで新しくインストールしたマシンにすべての更新をインストールできるスクリプトを受け取りました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すぐに予約する必要があります-このスクリプトは、まったくロードしないシステムの修復方法を知らず、更新プログラムのインストール方法を認識し、周期的な再起動を引き起こす更新プログラムを自動的にスローし、リストに不正な更新プログラムを手動で追加し、インストールに関する問題を管理者に通知することができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> すべてを開始する方法、クイックスタート </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://new.vk.com/doc281099435_437751611%3Fhash%3D95fe0a54b9267270e4%26dl%3D41784adf27d1b0420d">1つのファイル内の記事のソース</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>0.</b>システムでスクリプトを許可します。  <b>Set-ExecitionPolicy Unrestricted</b>または証明書でスクリプトに署名します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>1.</b> WUErrorreportingスクリプトを制御対象マシンのディスクにコピーし、午後12:30などにタスクスケジューラに追加します。  <a href="http://windowsnotes.ru/powershell-2/zapusk-powershell-skripta-po-raspisaniyu/">スケジュールされたタスクの作成方法がわからない場合は、ここをクリックしてください</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">WUErrorreporting.ps1</b> <div class="spoiler_text"><pre><code class="cs hljs">&lt;<span class="hljs-meta"><span class="hljs-meta"># 2016.05.23 Windows Update Error reporter      .           20   . Pak NV #&gt; ############# # Variables # ############# #        [int]$DaysBefore = 5 #         $SaveLog = $false $LogPath = 'c:\WUError.txt' #   HTML [boolean]$SaveReport = $False [string]$ReportPath = 'C:\WUErrorReport.html' #  HTML  [boolean]$SendReport = $true [string]$ReportMail1 = 'admin@test.local' [string]$from = 'bot_abormot@test.local' [string]$SMTPServer = 'mail.test.local' ############################################################################# #      $Events = Get-EventLog -LogName System -EntryType Error -After (Get-Date).AddDays(-$DaysBefore) -InstanceId 20 -ErrorAction SilentlyContinue #          </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Events.Count -eq 0) { Write-Host '   ,  ' -ForegroundColor Green Exit } #    $Log = @() #          foreach ($Event in $Events) { $regex = $Event.Message -match "KB\d+" $KB = $matches[0] $params = [ordered]@{ 'KB'=$KB #'EntryType'=$Event.EntryType 'Index'=$Event.Index 'MachineName'=$Event.MachineName 'Message'=$Event.Message 'Source'=$Event.Source 'TimeGenerated'=$Event.TimeGenerated 'TimeWritten'=$Event.TimeWritten 'UserName'=$Event.UserName } $obj = New-Object -TypeName PSObject -Property $params $Log += $obj } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($SaveLog -eq $true) { #      Add-Content -Path $LogPath -Value '' $Log | select -ExpandProperty KB | Add-Content -Path $LogPath } #,    #################################   ##################################### Write-Verbose 'HTML fragment producing' $ClientName = $env:COMPUTERNAME $TotalErrors = $log.Count $frag1 = $Log | ConvertTo-Html -As table -Fragment -PreContent "&lt;h2&gt;Windows Update </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta"> report. $ClientName &lt;/h2&gt;&lt;br&gt;&lt;h3&gt;Total $TotalErrors errors.&lt;/h3&gt;" | Out-String Write-Verbose 'definiting CSS' $head = @' &lt;style&gt; body { background-color:#ffffff; font-family:Tahoma; font-size:12pt; } td, th { border:1px solid black; border-collapse:collapse; } th { color:white; background-color:black; } table, tr, td, th { padding: 2px; margin: 0px } table { font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif; font-size: 14px; border-radius: 10px; border-spacing: 0; text-align: center; } th { background: #BCEBDD; color: white; text-shadow: 0 1px 1px #2D2020; padding: 10px 20px; } th, td { border-style: solid; border-width: 0 1px 1px 0; border-color: white; } th:first-child, td:first-child { text-align: left; } th:first-child { border-top-left-radius: 10px; } th:last-child { border-top-right-radius: 10px; border-right: none; } td { padding: 10px 20px; background: #F8E391; } tr:last-child td:first-child { border-radius: 0 0 0 10px; } tr:last-child td:last-child { border-radius: 0 0 10px 0; } tr td:last-child { border-right: none; } &lt;/style&gt; '@ $Date = Get-Date </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($SendReport -eq $true) { Write-Verbose 'SendEmail' $encoding = [System.Text.Encoding]::UTF8 $body = ConvertTo-HTML -head $head -PostContent $frag1 -PreContent "&lt;h1&gt;Windows Update </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta"> report. Client $ClientName. Date:$Date&lt;/h1&gt;" | Out-String $params = @{'To'=$ReportMail1 'From'=$from 'Subject'="$ClientName. Windows Update </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta"> $Date" 'Body'=$Body 'BodyAsHTML'=$True 'SMTPServer'=$SMTPServer} Send-MailMessage @params -Encoding $encoding }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>2.</b>更新エラー通知パラメーターを設定します。これにより、パラメーターを変更します 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>$ ReportMail1 = 'admin@test.local'</b>をメールに 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>$ SMTPServer = 'mail.test.local'</b>からメールサーバーへ。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>3.</b>構成リセットスクリプトを目的のマシンにコピーして実行します。 初期設定でディレクトリを作成します。ディレクトリがある場合は、初期状態にリセットします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Rearm_Install-ClientUpdate.ps1</b> <div class="spoiler_text"><pre> <code class="cs hljs">&lt;<span class="hljs-meta"><span class="hljs-meta">#       #&gt; #         $Path = Split-Path ($MyInvocation.MyCommand.Path) -Parent </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ((Test-Path -Path "$Path\BadUpdates") -eq $false) { New-Item -Path "$Path\BadUpdates" -ItemType Directory -Force } #    $LastInstalledUpdatesFile = "$Path\BadUpdates\LastInstalledUpdates.txt" #     $BadUpdatesFile = "$Path\BadUpdates\BadUpdates.txt" # FastInstaller $KAFUFile = "$Path\BadUpdates\KAFU.txt" #      $KAFUDeltaFile = "$Path\BadUpdates\KAFUDelta.txt" # Fastinstaller watchdog $KAFUWatchDogFile = "$Path\BadUpdates\KAFUWatchDog.txt" # Fastinstaller update installer watchdog $KAFUWatchDog2File = "$Path\BadUpdates\KAFUWatchDog2.txt" # SlowInstaller $KASUFile = "$Path\BadUpdates\KASU.txt" #   $WorkLogFile = "$Path\BadUpdates\log.txt" #   $KAFile = "$Path\BadUpdates\KA.txt" Set-Content $LastInstalledUpdatesFile -Value '' Set-Content $KAFUFile -Value 0 Set-Content $KAFUDeltaFile -Value 5 Set-Content $KAFUWatchDogFile -Value 0 Set-Content $KAFUWatchDog2File -Value 0 Set-Content $KASUFile -Value 0 Set-Content $KAFile -Value 99 Set-Content $BadUpdatesFile -Value ''</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>4.</b>更新スクリプトを前のスクリプト（注、以下は大きなスクリプト、85kb）を含むディレクトリにコピーします。コピーしないように<a href="https://new.vk.com/doc281099435_437751608%3Fhash%3D2ce9542d2b5d03ce90%26dl%3D287497cda5cdfb74ab">、ここから</a>ダウンロード<a href="https://new.vk.com/doc281099435_437751608%3Fhash%3D2ce9542d2b5d03ce90%26dl%3D287497cda5cdfb74ab">します</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/6a2/9f4/8cc/6a29f48cc51c4e81993571673b18a0ec.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Install-ClientUpdate.ps1</b> <div class="spoiler_text"><pre> <code class="cs hljs">&lt;<span class="hljs-meta"><span class="hljs-meta"># 2016.06.14 ver 2            .        .       (FastUpdate)       30%  ,      25%,      5  .    ,             ,                                 ,   ,         1.      2.    "\BadUpdates\KA.txt"   9,  11 3.            -  ,  6   -   powershell.exe -file "   \Install-ClientUpdate.ps1" 4.       5.       $RebootEnabled = $False                    1.      2.    "\BadUpdates\KA.txt"   9,  11 3.            -   (  ),   10   -   powershell.exe -file "   \Install-ClientUpdate.ps1" 4.       5.       $RebootEnabled = $true              :       SoftwareDistribution.                  Plugins.           .           ,          .        "    "      .          .      IsHidden=1            .        "4.      ".    .    win 7       .             : powershell 2.0 Pak Nikolay GEOM, Aqtobe   win 8.1/2012R2; win 7; win 2008R2 #&gt; ############# # Variables # ############# # Allow reboot.        .      #    .       10 ,   .    #    . #$RebootEnabled = $true $RebootEnabled = $False # Fast install          $FastInstallLimit = 45 #         $Path = Split-Path ($MyInvocation.MyCommand.Path) -Parent #    $LastInstalledUpdatesFile = "$Path\BadUpdates\LastInstalledUpdates.txt" #     $BadUpdatesFile = "$Path\BadUpdates\BadUpdates.txt" # FastInstaller $KAFUFile = "$Path\BadUpdates\KAFU.txt" #      $KAFUDeltaFile = "$Path\BadUpdates\KAFUDelta.txt" # Fastinstaller watchdog $KAFUWatchDogFile = "$Path\BadUpdates\KAFUWatchDog.txt" # Fastinstaller update installer watchdog $KAFUWatchDog2File = "$Path\BadUpdates\KAFUWatchDog2.txt" # SlowInstaller $KASUFile = "$Path\BadUpdates\KASU.txt" #   $WorkLogFile = "$Path\BadUpdates\log.txt" #   $KAFile = "$Path\BadUpdates\KA.txt" ########################## Report params ################################### [boolean]$SaveReport = $true [string]$ReportPath = 'C:\Report-InstallUpdates.html' [boolean]$SendReport = $true [string]$From = 'bot_abormot@test.local' [string]$SMTP = 'mail.test.local' [string]$ReportMail1 = 'admin1@test.local' [string]$ReportMail2 = 'admin2@test.local' [string]$ReportMail3 = 'admin3@test.local' function report { Param ( [string]$Text = 'test' ) $Date = Get-Date </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($SaveReport = $true) { $Text | Out-File $ReportPath } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($SendReport = $true) { $encoding = [System.Text.Encoding]::UTF8 $body = $Text $Subj = "install-updates script report $Date" $params = @{'To'=$ReportMail1 'From'=$From 'Subject'=$Subj 'Body'=$Body 'BodyAsHTML'=$True 'SMTPServer'=$SMTP} Send-MailMessage @params -Encoding $encoding $params = @{'To'=$ReportMail2 'From'=$From 'Subject'=$Subj 'Body'=$Body 'BodyAsHTML'=$True 'SMTPServer'=$SMTP} Send-MailMessage @params -Encoding $encoding $params = @{'To'=$ReportMail3 'From'=$From 'Subject'=$Subj 'Body'=$Body 'BodyAsHTML'=$True 'SMTPServer'=$SMTP} Send-MailMessage @params -Encoding $encoding } } ########################## Report params ################################### function Log { PARAM ( [parameter(Mandatory = $true)] [string]$Message ) $Date = Get-Date -Format "yyyy.MM.dd HH:mm:ss" [string]$Msg = $Date + "`t" + $Message Out-File -FilePath $WorkLogFile -InputObject $Msg -Append # -encoding unicode } function Clear-Log { $Date = Get-Date -Format "yyyy.MM.dd HH:mm:ss" $Msg = $Date + "`t" + '   Clear-Log' Set-Content -Path $WorkLogFile -Value $Msg } function Trim-Log { #    5    </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ( (Get-Item -Path $WorkLogFile).Length -gt 5mb ) { Clear-Log } } &lt;#   SoftwareDistribution      ,  ,       WUAUSRV       .       #&gt; function ResetSoftwareDistribution { $WUServices = 'BITS','wuauserv' $windows = 0x24 Log 'call ResetSoftwareDistribution' Log 'stopping WU services' Write-Host " SoftwareDistribution" -ForegroundColor Green Write-Host "-------------------------------" -ForegroundColor Green Write-Host " " -ForegroundColor Green $WUServices | Stop-Service -Verbose Start-Sleep -Seconds 20 #      </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ( ((Get-Service 'BITS').Status -eq 'stopped' ) -and ((Get-Service 'wuauserv').Status -eq 'stopped') ) { Log 'services stopped sucsessful' Write-Host '  ' -ForegroundColor Green $Folders = Get-ChildItem ( (New-Object -ComObject Shell.Application).Namespace( $windows ).Self.Path) -Directory | where { $_.Name -like '*SoftwareDistribution*' } Write-Host "   WU" -ForegroundColor Green $Folders Write-Host " ..." $Folders | Remove-Item -Recurse -Force -Verbose -Confirm:$false #   $Folders = Get-ChildItem ( (New-Object -ComObject Shell.Application).Namespace( $windows ).Self.Path) -Directory | where { $_.Name -like '*SoftwareDistribution*' } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Folders -eq $null) { Log 'SoftwareDistribution folder deleted successful' Write-Host " SoftwareDistribution  " -ForegroundColor Green } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log 'SoftwareDistribution folder deleted NOT successful' Write-Host "SoftwareDistribution   !" -ForegroundColor Red #              Softwaredistrib #Exit } } Log 'starting WU services' Write-Host " " -ForegroundColor Green $WUServices | Start-Service -Verbose } &lt;#            KB      IsHidden  0,    Softwaredistribution    Hidden .         IsHidden = 1             '2976978', '3156418' | install-updates -Verbose #&gt; function install-updates { [CmdletBinding()] PARAM ( [Parameter( Position=0, Mandatory=$true, ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true) ] [string[]]$KB ) BEGIN { Log 'call install-updates' $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $Updates = $searcher.Search("IsInstalled=0 and Type='Software' and ISHidden=0") #     </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Updates.Updates.Count -eq 0) { $NoUpdates = $true } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { $NoUpdates = $false } #   Write-Verbose '---------------------------------------------------------------------' Write-Verbose "install-updates:   NoUpdates = $NoUpdates" </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($NoUpdates -eq $false) { Write-Verbose "   " $temp1 = $Updates.updates | select Title $temp1 | Write-Verbose $Count = $Updates.Updates.Count Write-Verbose "$Count   " Log "$Count   " foreach ( $temp in $temp1 ) { Log " $temp" } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "install-updates:      " Write-Verbose "install-updates:      " } Write-Verbose '---------------------------------------------------------------------' } PROCESS { Write-Verbose "install-updates:     process $KB" </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($NoUpdates -eq $true) { break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($KB -match ' ' ) { break } $HotFix = $Updates.Updates | where { $_.Title -like "*$KB*" } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($HotFix -eq $null) { Write-Verbose "     " Log "     " break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { $Title = $HotFix.Title Write-Verbose "    $Title" Log "    $Title" } #   $downloads = New-Object -ComObject Microsoft.Update.UpdateColl $downloads.Add( $HotFix ) #      80070005.        SYSTEM #                  #      Write-Verbose ' ' Log 'download update' $downloader = $session.CreateUpdateDownLoader() $downloader.Updates = $downloads $downloader.Download() </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($HotFix.IsDownloaded) { Log 'download successfull' Write-Verbose ' . (   downloads)' } $installs = New-Object -ComObject Microsoft.Update.UpdateColl </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($HotFix.IsDownloaded) { $installs.Add( $HotFix ) | Out-Null } log 'start instal' #      80070005.        SYSTEM #                  #      $installer = $session.CreateUpdateInstaller() $installer.Updates = $installs $installresult = $installer.Install() $installresult log 'installing successfull' } END { Write-Verbose 'install-updates:   ' log 'install-updates:   ' log '--------------------------------------------------------------' } } &lt;#         20-30     .    .               .            , ..  10-20                .      ,             .       $KAFUWatchDog     0       1/3          1       1/4          2       5         #&gt; #  [int]$KAFU = Get-Content $KAFUFile #      [int]$KAFUDelta = Get-Content $KAFUDeltaFile function Fast-Update { function Write-KAFU { PARAM ( $State ) Set-Content $KAFUFile -Value $State } Log "--- Fast-Update ---------------------------------------------------------" Log "Fast-Update    " switch ($KAFU) { 0 { Log "   0" #        $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Count = $temp.Updates.Count #   ,              $KAFUWatchDog = Get-Content $KAFUWatchDogFile log "KAFUWatchDog = $KAFUWatchDog" switch ($KAFUWatchDog) { 0 { #  ,     2      $KAFUDelta = [Math]::Truncate( $Count / 3 ) Log " ,   1/3     $KAFUDelta" } 1 { #     4      $KAFUDelta = [Math]::Truncate( $Count / 4 ) Log " ,   1/4     $KAFUDelta" } 2 { #     -          #   5    $KAFUDelta = 5 log '    -            5' } default { Log '   ,   ' $KAFUWatchDog = 0 $KAFUDelta = [Math]::Truncate( $Count / 3 ) Set-Content $KAFUWatchDogFile -Value $KAFUWatchDog } } #     Set-Content $LastInstalledUpdatesFile -Value '' Set-Content $KAFUDeltaFile -Value $KAFUDelta Set-Content $KAFUWatchDog2File -Value 0 Write-KAFU 1 break } 1 { Log "enter in state 1" $LastInstalled = Get-Content $LastInstalledUpdatesFile $BadUpdates = Get-Content $BadUpdatesFile log '     ' $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Updates = $temp.Updates | select title #        [string[]]$HotFixs = '' foreach ($temp in $Updates) { $regex = $temp.Title -match "KB\d+" $KB = $matches[0] $HotFixs += $KB Log "   : $KB" } $Count = $HotFixs.Count Log "    $Count" log ' ' $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $Upd #         </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($BadUpdates.Count -ne 0) { $temp = Compare-Object -ReferenceObject $HotFixs -DifferenceObject $BadUpdates $temp = $temp | where { $_.Sideindicator -like '&lt;=' } | select -ExpandProperty InputObject $HotFixs = $temp $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd $temp = $HotFixs Log "    :" foreach ( $temp1 in $temp ) { Log "    : $temp1" } $Count = $temp.Count Log ": $Count " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "   " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($LastInstalled.Count -ne 0) { $temp = Compare-Object -ReferenceObject $HotFixs -DifferenceObject $LastInstalled $temp = $temp | where { $_.Sideindicator -like '&lt;=' } | select -ExpandProperty InputObject $HotFixs = $temp Log "     :" $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd $temp = $HotFixs foreach ( $temp1 in $temp ) { Log "     : $temp1" } $Count = $temp.Count Log ": $Count " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "     " } #     [int]$KAFUWatchDog2 = Get-Content $KAFUWatchDog2File </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($KAFUWatchDog2 -gt 20) { Log "   ,      1,  : $KAFUWatchDog2" Write-KAFU 2 Set-Content $KAFUWatchDog2File -Value 0 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($HotFixs.Count -eq 0) { #   log ' ,   .    2' Write-KAFU 2 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { #     $temp = $HotFixs | select -First $KAFUDelta $Count = $temp.Count </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Count -eq 0) { log '  .    2' Write-KAFU 2 break } foreach ( $temp1 in $temp ) { Log "   : $temp1" } Log ": $Count " $HotFixs = $temp #   Add-Content -Path $LastInstalledUpdatesFile -Value '' Add-Content -Path $LastInstalledUpdatesFile -Value $HotFixs @(Get-Content $LastInstalledUpdatesFile) -match '\S' | out-file $LastInstalledUpdatesFile LOG "    " #    log '  ' $HotFixs | install-updates } Set-Content $KAFUWatchDog2File -Value ($KAFUWatchDog2 + 1) break } 2 { #           Log '   2.' $KAFUWatchDog = Get-Content $KAFUWatchDogFile $KAFUDelta = Get-Content $KAFUDeltaFile $LastInstalled = Get-Content $LastInstalledUpdatesFile log "KAFUWatchDog = $KAFUWatchDog" switch ($KAFUWatchDog) { 0 { #   .   ?      $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Updates = $temp.Updates #       * 3 - 2 $Count1 = $Updates.Count </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($KAFUDelta -eq 0) { $KAFUDelta = 5 } $Count2 = $KAFUDelta * 3 - 2 </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Count2 -lt $Count1) { #     .     $KAFUWatchDog = 1 Set-Content $KAFUWatchDogFile -Value 1 Write-KAFU 0 Log '    .   = 1.    0' break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { log '    WatchDog = 0' log '   3' Write-KAFU 3 break } } 1 { #     $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Updates = $temp.Updates | select title #       * 3 - 2 $Count1 = $Updates.Count $Count2 = $KAFUDelta * 4 - 2 </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Count2 -gt $Count1) { #     - 4        25%  #      5 $KAFUWatchDog = 2 Set-Content $KAFUWatchDogFile -Value 2 Write-KAFU 0 Log '    .  = 2.    0' break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { log '    WatchDog = 1' log '   3' Write-KAFU 3 break } } 2 { #     5    log '    WatchDog = 2' log '   3' Write-KAFU 3 break } default { Log '     0' Set-Content $KAFUWatchDogFile -Value 0 Write-KAFU 0 break } } } 3 { # ,  Write-KAFU 3 break } default { Set-Content $KAFUWatchDogFile -Value 0 Write-KAFU 0 Log "</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">warning</span></span></span><span class="hljs-meta">!!!   ,   0. KAFU = $KAFU" break } } Log "--- Fast-Update -- -------------------------------------------------------" } &lt;################################################################################################      .       .     ,      .    48      24   2  ,   1 .       3-6   ,      30-40    . ################################################################################################&gt; &lt;#                           #&gt; #  [int]$KASU = Get-Content $KASUFile function Slow-update { function Write-KASU { PARAM ( $State ) Set-Content $KASUFile -Value $State } Log "--- Slow Update ---------------------------------------------------------" Log "Slow Update " switch ($KASU) { 0 { #    log "   0,   " #     Set-Content $LastInstalledUpdatesFile -Value '' Set-Content $KAFUWatchDog2File -Value 0 Set-Content $KAFUWatchDog2File -Value 0 Write-KASU 1 break } 1 { log "   1" $LastInstalled = Get-Content $LastInstalledUpdatesFile $BadUpdates = Get-Content $BadUpdatesFile log '     ' $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Updates = $temp.Updates | select title #        [string[]]$HotFixs = '' foreach ($temp in $Updates) { $regex = $temp.Title -match "KB\d+" $KB = $matches[0] $HotFixs += $KB Log "   : $KB" } $Count = $HotFixs.Count Log "    $Count" $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $PotentialBad = $Upd #         </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($BadUpdates.Count -ne 0) { $temp = Compare-Object -ReferenceObject $HotFixs -DifferenceObject $BadUpdates $temp = $temp | where { $_.Sideindicator -like '&lt;=' } | select -ExpandProperty InputObject $HotFixs = $temp Log "    :" $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd $temp = $HotFixs foreach ( $temp1 in $temp ) { Log "    : $temp1" } $Count = $temp.Count Log ": $Count " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "   " } $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($LastInstalled.Count -ne 0) { $temp = Compare-Object -ReferenceObject $HotFixs -DifferenceObject $LastInstalled $temp = $temp | where { $_.Sideindicator -like '&lt;=' } | select -ExpandProperty InputObject $HotFixs = $temp Log "     :" $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd $temp = $HotFixs foreach ( $temp1 in $temp ) { Log "     : $temp1" } $Count = $temp.Count Log ": $Count " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "     " } $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($HotFixs.Count -eq 0) { #   log ' ,   .     ' </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($PotentialBad -ne 0 ) { foreach ( $Bad in $PotentialBad ) { log "   : $Bad" } #   ..   ,         #Add-Content -Path $BadUpdatesFile -Value '' #Add-Content -Path $BadUpdatesFile -Value $LastInstalled } Write-KASU 2 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { #     $temp = $HotFixs | select -First 1 $Count = $temp.Count </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ( $Count -eq 0 ) { log '   2' Write-KASU 2 break } foreach ( $temp1 in $temp ) { Log "   : $temp1" } Log ": $Count " $HotFixs = $temp #   Add-Content -Path $LastInstalledUpdatesFile -Value '' Add-Content -Path $LastInstalledUpdatesFile -Value $HotFixs @(Get-Content $LastInstalledUpdatesFile) -match '\S' | out-file $LastInstalledUpdatesFile LOG "    " #    log '  ' Write-Host $HotFixs -ForegroundColor Green $HotFixs | install-updates } Set-Content $KAFUWatchDog2File -Value ($KAFUWatchDog2 + 1) break } 2 { #  ,  Write-KASU 2 break } default { #   log " " Write-KASU 0 } } Log "--- Slow-Update -- -------------------------------------------------------" } [int]$KA = Get-Content $KAFile function Write-KA { PARAM ( $State ) Set-Content $KAFile -Value $State } Log ' ' Log " " Log ' ' Log ' ' Log ' ' Log '##############################' Log "### ---   --- ###" Log '##############################' switch ($KA) { 0 { #   log( ' = 0.         ' ) Set-Content $LastInstalledUpdatesFile -Value '' Set-Content $KAFUWatchDogFile -Value 0 Set-Content $KASUFile -Value 0 Set-Content $KAFUFile -Value 0 Write-KA 9 break } 1 { #   Log '  1.    ' [int]$KAFU = Get-Content $KAFUFile </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($KAFU -eq 3) { #    log '  ,    ' Write-KA 2 Set-Content $KASUFile -Value 0 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { log '  ' ResetSoftwareDistribution Fast-Update Trim-Log break } } 2 { #  log ' 2,  ' [int]$KASU = Get-Content $KASUFile </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($KASU -eq 2) { #    #                 Trim-Log ResetSoftwareDistribution log( ' = 2.    ' ) $BadUpdates = Get-Content $BadUpdatesFile $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Updates = $temp.Updates | select title #        [string[]]$HotFixs = '' foreach ($temp in $Updates) { $regex = $temp.Title -match "KB\d+" $KB = $matches[0] $HotFixs += $KB Log "   : $KB" } $Count = $HotFixs.Count Log "    $Count" $PotentialBad = $HotFixs #    </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($BadUpdates.Count -ne 0) { $temp = Compare-Object -ReferenceObject $HotFixs -DifferenceObject $BadUpdates $temp = $temp | where { $_.Sideindicator -like '&lt;=' } | select -ExpandProperty InputObject $HotFixs = $temp Log "    :" foreach ( $temp1 in $temp ) { Log "    : $temp1" } $Count = $temp.Count Log ": $Count " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "   " } $Updates = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Updates += $temp } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Updates.Count -ne 0) { #    log '        ' Add-Content -Path $BadUpdatesFile -Value '' Add-Content -Path $BadUpdatesFile -Value $Updates $Date = Get-Date $CompName = $env:COMPUTERNAME $body = "&lt;H1&gt;     $CompName,&lt;br&gt;&lt;br&gt;   &lt;/H1&gt;&lt;h3&gt;" foreach ($upd in $updates) { $body += "&lt;br&gt; $upd&lt;br&gt;" } $body += "&lt;br&gt;         .   ,        " report -text $body } Write-KA 9 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { log '        ' ResetSoftwareDistribution Trim-Log Slow-update break } } 9 { #     log( ' = 9.     ' ) Trim-Log ResetSoftwareDistribution $BadUpdates = Get-Content $BadUpdatesFile log '    ' $session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search("IsInstalled=0 and Type='Software'" ) $Updates = $temp.Updates | select title #        [string[]]$HotFixs = '' foreach ($temp in $Updates) { $regex = $temp.Title -match "KB\d+" $KB = $matches[0] $HotFixs += $KB Log "   : $KB" } $Count = $HotFixs.Count Log "    $Count" $PotentialBad = $HotFixs #    </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($BadUpdates.Count -ne 0) { $temp = Compare-Object -ReferenceObject $HotFixs -DifferenceObject $BadUpdates $temp = $temp | where { $_.Sideindicator -like '&lt;=' } | select -ExpandProperty InputObject $HotFixs = $temp Log "    :" $Upd = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Upd += $temp } } $HotFixs = $Upd $temp = $HotFixs foreach ( $temp1 in $temp ) { Log "    : $temp1" } $Count = $temp.Count Log ": $Count " } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { Log "   " } log ' ' $Updates = @() foreach ($temp in $HotFixs) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($temp -ne '') { $Updates += $temp } } $Count = $Updates.Count Log "  $Count  " #     $FastInstallLimit    </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Updates.Count -gt $FastInstallLimit) { #    log "updates more than $FastInstallLimit. Go to FastInstall" Write-KA 1 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Updates.Count -gt 0) { log "Go to Slow Install" Write-KA 2 Set-Content $KASUFile -Value 0 break } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ($Updates.Count -eq 0) { log '    ' Write-KA 9 break } } default { #   log( '   .    0' ) Write-KA 0 } } #ResetSoftwareDistribution #Fast-Update #Trim-Log #Slow-update Log '##############################' Log "### ---   --- ###" Log '##############################' </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ( $RebootEnabled -eq $true ) { Restart-Computer -Force Log ' &gt;&gt;&gt;' } &lt;# schtasks /run /tn "\My_Tasks\PSWindowsUpdate" [Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("cp866") #&gt;</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SYSTEM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特権</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">してスケジューラでタスクを作成し、</font><font style="vertical-align: inherit;">1日に1回実行します。既知の問題は、アップデートのインストールが</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SYSTEM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">権限でのみ開始できること</font><font style="vertical-align: inherit;">です。 （ちなみに、このメソッドを使用してアクティベーターと最高の特権で動作するすべてのものを起動することができます）</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/96d/cf7/a55/96dcf7a552e7427b8f547c6e32dbae2d.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6時間の起動後</font><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">遅延はうまくいき</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/c1c/b9a/510/c1cb9a5102c94f0681bc812923b4d250.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の3回は、検証のために手動で実行できます。スケジューラからタスクを実行し、ファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ BadUpdates \ log.txtの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容を確認</font><font style="vertical-align: inherit;">します。スクリプトのログが含まれている必要があります。空の場合は、スクリプト実行ポリシーが有効になっているかどうかを確認し、更新サーバーが利用可能な場合は、更新を手動で検索してみてください。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">45を超える更新がある場合（この値は変更できます）、スクリプトは更新をバッチでインストールしようとします。この場合、最初に一度に1 \ 3をインストールしようとします。3パックの更新プログラムのいずれもインストールされていない場合、ステップは1/4に変更されます。 1つのマシンに6つの不適切な更新が均等に分散されていたが、一度に1つずつほぼ90の更新をインストールすることはオプションではありません（1つの更新で90日）。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote> <b>  :</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.   <b>WUErrorreporting</b>      20,                 . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2.       <b>SoftwareDistribution</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     3.         .    : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     4.     45        «»   
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>       ,      ,    <b>1/3</b> ,     <b>1/4</b> ,    <b>5</b> </li><li>                           </li><li>       ,      </li><li>         <b>BadUpdates\LastInstalledUpdates.txt</b>         </li><li>               </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     5.    45         
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     6.      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>          </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新のリストは、あなたが試したものと間違いなく悪いものなしで受信されます。更新が残っていない場合、インストールされていない更新は、正確に悪いもののリストに追加され、電子メールアラートによって修正されます。</font><font style="vertical-align: inherit;">まだある場合、インストールが開始されます</font></font></li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.ワークアウト後、マシンは更新待ち状態になります </font></font></blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SoftwareDistribution</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーが削除されていないことがログに示されている場合は</font><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SoftwareDistribution \ Plugins</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーを確認してください</font><font style="vertical-align: inherit;">。一部のプログラムはそれを保持し、クリーニングを許可しません。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 新しくインストールしたシステムを更新する必要がある場合は、次の手順を実行します。 </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ RebootEnabled = $ trueを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定します</font><font style="vertical-align: inherit;">。これにより、スクリプトの実行後すぐに再起動できます</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> システムの起動後、10分間トリガーを設定します </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> スクリプトを保存して実行します </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> その後、彼は自分で更新プログラムをインストールしようとし、コンピューターを自分で再起動するか、別のユーザーを作成するか、自分の仕事のために特別にログインする必要はありません。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 一定時間後、ログファイルを見て制御します </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてを入れて状態9（更新待ち）になったとき</font><b><font style="vertical-align: inherit;">$ RebootEnabled = $ falseを</font></b><font style="vertical-align: inherit;">設定し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 更新する必要がなくなったらトリガーを無効にします </font></font></li></ul></blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 仕事を分析しましょう </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wuerrorreporting </font></font></h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.変数を設定します</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も重要なのは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ DaysBefore</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">-ログがスキャンされる日数、デフォルトでは5日です。更新プログラムのインストール中にエラーが発生した場合、同じエラーに関する連続した5日間の管理通知を受け取ります。原則として、1日か2日を置くのは普通です。意味がありません。週末に誰かが仕事に出かけた場合、レポートをスキップできます。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAVELOG $</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディスクに現在の実行ログを維持する責任。便利なのは、クライアントマシンにアクセスしたり、クライアントマシンに接続したり、操作中にどのアップデートが配信されなかったかを見たりすることです。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後の4つの変数は、レポートの送信先を管理します。</font><b><font style="vertical-align: inherit;">$ SendReport = $ trueの</font></b><font style="vertical-align: inherit;">ままにする必要があり</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通知をメールで</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する場合は、</font><font style="vertical-align: inherit;">管理</font><b><font style="vertical-align: inherit;">メール</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ ReportMail1 = 'admin@test.local'</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">指定し、</font><font style="vertical-align: inherit;">どのサーバーに</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ SMTPServer = 'mail.test.local'を</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信</font><font style="vertical-align: inherit;">するかを指定します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">認証が必要な場合は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">156</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行目</font><font style="vertical-align: inherit;">に追加し</font><font style="vertical-align: inherit;">ます</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数のセクション</font></font></b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">############# # Variables # ############# #        [int]$DaysBefore = 5 #         $SaveLog = $false $LogPath = 'c:\WUError.txt' #   HTML [boolean]$SaveReport = $False [string]$ReportPath = 'C:\WUErrorReport.html' #  HTML  [boolean]$SendReport = $true [string]$ReportMail1 = 'admin@test.local' $from = 'bot_abormot@test.local' [string]$SMTPServer = 'mail.test.local'</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.操作の原理は非常に単純です。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムログからID20のエラーのみ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">アップロードします。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs">$Events = Get-EventLog -LogName System -EntryType Error -After (Get-Date).AddDays(-$DaysBefore) -InstanceId <span class="hljs-number"><span class="hljs-number">20</span></span> -ErrorAction SilentlyContinue</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> エラーがある場合は、レポートオブジェクトを生成します </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#    $Log = @() #          foreach ($Event in $Events) { $regex = $Event.Message -match "KB\d+" $KB = $matches[0] $params = [ordered]@{ 'KB'=$KB #'EntryType'=$Event.EntryType 'Index'=$Event.Index 'MachineName'=$Event.MachineName 'Message'=$Event.Message 'Source'=$Event.Source 'TimeGenerated'=$Event.TimeGenerated 'TimeWritten'=$Event.TimeWritten 'UserName'=$Event.UserName } $obj = New-Object -TypeName PSObject -Property $params $Log += $obj }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そしてそれらを</font><a href="https://habrahabr.ru/post/279005/"><font style="vertical-align: inherit;">「正しい」方法</font></a><font style="vertical-align: inherit;">で送ります</font></font><a href="https://habrahabr.ru/post/279005/"><font style="vertical-align: inherit;"></font></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"> $encoding = [System.Text.Encoding]::UTF8 $body = ConvertTo-HTML -head $head -PostContent $frag1 -PreContent <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Windows Update error report. Client $ClientName. Date:$Date&lt;/h1&gt;"</span></span> | Out-String $<span class="hljs-keyword"><span class="hljs-keyword">params</span></span> = @{<span class="hljs-string"><span class="hljs-string">'To'</span></span>=$ReportMail1 <span class="hljs-string"><span class="hljs-string">'From'</span></span>=$<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'Subject'</span></span>=<span class="hljs-string"><span class="hljs-string">"$ClientName. Windows Update error $Date"</span></span> <span class="hljs-string"><span class="hljs-string">'Body'</span></span>=$Body <span class="hljs-string"><span class="hljs-string">'BodyAsHTML'</span></span>=$True <span class="hljs-string"><span class="hljs-string">'SMTPServer'</span></span>=$SMTPServer} Send-MailMessage @<span class="hljs-keyword"><span class="hljs-keyword">params</span></span> -Encoding $encoding</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適用されるCSSスタイルはOutlook向けにシャープ化され、WordをHTMLエンジンとして使用するため、標準のサポートが不完全になります。</font><font style="vertical-align: inherit;">誰かがOutlookで機能する別の美しいスタイルを選んだら、私も捨ててください。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSSスタイルレポート</font></font></b> <div class="spoiler_text"><pre> <code class="css hljs">$<span class="hljs-selector-tag"><span class="hljs-selector-tag">head</span></span> = @' &lt;style&gt; body { <span class="hljs-selector-tag"><span class="hljs-selector-tag">background-color</span></span>:<span class="hljs-selector-id"><span class="hljs-selector-id">#ffffff</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">font-family</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:Tahoma</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">font-size</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12pt</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>:<span class="hljs-number"><span class="hljs-number">1px</span></span> solid black; <span class="hljs-attribute"><span class="hljs-attribute">border-collapse</span></span>:collapse; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>:white; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>:black; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">2px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> } <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-family</span></span>: <span class="hljs-string"><span class="hljs-string">"Lucida Sans Unicode"</span></span>, <span class="hljs-string"><span class="hljs-string">"Lucida Grande"</span></span>, Sans-Serif; <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">14px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-spacing</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: center; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: <span class="hljs-number"><span class="hljs-number">#BCEBDD</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: white; <span class="hljs-attribute"><span class="hljs-attribute">text-shadow</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1px</span></span> <span class="hljs-number"><span class="hljs-number">1px</span></span> <span class="hljs-number"><span class="hljs-number">#2D2020</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span> <span class="hljs-number"><span class="hljs-number">20px</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border-style</span></span>: solid; <span class="hljs-attribute"><span class="hljs-attribute">border-width</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1px</span></span> <span class="hljs-number"><span class="hljs-number">1px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-color</span></span>: white; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:first-child</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:first-child</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: left; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:first-child</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border-top-left-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:last-child</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border-top-right-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-right</span></span>: none; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span> <span class="hljs-number"><span class="hljs-number">20px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: <span class="hljs-number"><span class="hljs-number">#F8E391</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:last-child</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:first-child</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">10px</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:last-child</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:last-child</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">10px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:last-child</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border-right</span></span>: none; } &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">style</span></span>&gt; '@</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Install-ClientUpdate.ps1 </font></font></h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3つの有限状態マシンがスクリプトに実装されています。単純な管理者にとっては、スクリプトを理解するのは非常に複雑です。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要な変数を設定します。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ FastInstallLimit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がこのしきい値を超えると、クイックインストールがオンになり、更新をこのしきい値よりも1つずつ少なくします。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ RebootEnabled</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、スクリプトの各パスの後に再起動を許可します。</font><font style="vertical-align: inherit;">車をアップグレードする必要がある場合に使用されます。</font><font style="vertical-align: inherit;">このパラメーターを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ true</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に設定し、開始時間を10分に設定して、朝までそのままにします。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下はメール設定です</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">########################## Report params ################################### [boolean]$SaveReport = $true [string]$ReportPath = 'C:\Report-InstallUpdates.html' [boolean]$SendReport = $true [string]$From = 'bot_abormot@test.local' [string]$SMTP = 'mail.test.local' [string]$ReportMail1 = 'admin1@test.local' [string]$ReportMail2 = 'admin2@test.local' [string]$ReportMail3 = 'admin3@test.local'</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リモートマシンまたはローカルマシンに更新があるかどうかを確認する必要がある場合は、次のコードを使用します。</font><font style="vertical-align: inherit;">コピーしてコンソールに貼り付けるだけです</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs">$session = New-Object -ComObject Microsoft.Update.Session $searcher = $session.CreateUpdateSearcher() $temp = $searcher.Search(<span class="hljs-string"><span class="hljs-string">"IsInstalled=0 and Type='Software'"</span></span> ) $Count = $temp.Updates.Count $Count <span class="hljs-string"><span class="hljs-string">''</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的な推奨事項：最初の段階では、次のようにユーザーと連絡をとることをお勧めします。</font><font style="vertical-align: inherit;">更新プログラムの長期インストールとその後のロールバックを恐れています。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">また、コンピュータの電源を切ったばかりで、「更新して作業を完了する」をクリックしなかったと説明することをお勧めします。そうしないと、すべての更新がインストールされ、作業のロジックに違反します。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このスクリプトはwin 8.1でテストされました。</font><font style="vertical-align: inherit;">2012R2; </font><font style="vertical-align: inherit;">win 7 x64 </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドオン2016.08.03：既知の明らかに</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">悪い更新がある場合</font><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">KB121212</font></b><font style="vertical-align: inherit;">の形式で</font><font style="vertical-align: inherit;">ファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ BadUpdates \ BadUpdates.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">手動で書き込みます。</font><font style="vertical-align: inherit;">作業中に、スクリプトはインストールオプションからこの更新を自動的に削除します</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J306848/index.html">HOCON-柔軟に構成可能</a></li>
<li><a href="../J30685/index.html">大人の写真の新しい投稿</a></li>
<li><a href="../J306850/index.html">固定インターネットラジオのレビューとプログラミング</a></li>
<li><a href="../J306862/index.html">Windows 10（1607）のすべてのカーネルモードドライバーは、Microsoftによって署名される必要があります。</a></li>
<li><a href="../J306864/index.html">デミウルジュの簡単なリマインダー</a></li>
<li><a href="../J306872/index.html">最終的なYandex.Algorithm 2016のタスクの結果と分析</a></li>
<li><a href="../J306874/index.html">Uberは常に勝つとは限りません</a></li>
<li><a href="../J306876/index.html">ゲームのゲームデザインドキュメントを書いたとき</a></li>
<li><a href="../J306878/index.html">Javaの世界からの興味深いイベントのダイジェストとその周辺＃7（2016年7月18日-2016年7月31日）</a></li>
<li><a href="../J306880/index.html">ITにログイン</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>