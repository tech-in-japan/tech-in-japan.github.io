<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ğŸ¾ âœŠ ğŸ§™ğŸ½ ãƒã‚¹ãƒˆã‚»ãƒƒãƒˆãƒ„ãƒªãƒ¼ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ğŸ¹ ğŸŒ ğŸ™†ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æŒ‘æˆ¦ã™ã‚‹  
  
 ãˆãˆã€ã‚ãªãŸã¯ãƒœãƒ¼ãƒˆã«ä¹—ã£ã¦æ°´ã«ä¹—ã£ã¦äººç”Ÿã‚’æ¥½ã—ã¿ã¾ã™ã€‚ ç§ã¯ä¼‘æ¯ã™ã‚‹ãŸã‚ã«æ¬¡ã®æ¹–ã«è¡Œãã¾ã—ãŸã€ãã—ã¦å½¼ã‚‰ã¯çŠ¬ã‚„ãƒœãƒ¼ãƒˆã¯è¨±å¯ã•ã‚Œã¦ã„ãªã„ã¨è¨€ã£ã¦ã„ã‚‹ã¨ã‚ãªãŸã«è©±ã—ã¾ã™ã€ãã—ã¦ä¸€èˆ¬çš„ã«ç§ãŸã¡ã®æ¹–ã¯ã„ã¤ã‚‚å‡ã£ã¦ã„ã¾ã™ã€ã“ã“ã§ã‚ãªãŸã¯ã‚¹ã‚±ãƒ¼ãƒˆã‚’æŒã£ã¦ã„ã¾ã™-ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚ ã€Œä»®æƒ³...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>ãƒã‚¹ãƒˆã‚»ãƒƒãƒˆãƒ„ãƒªãƒ¼ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/65495/"><h4> æŒ‘æˆ¦ã™ã‚‹ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãˆãˆã€ã‚ãªãŸã¯ãƒœãƒ¼ãƒˆã«ä¹—ã£ã¦æ°´ã«ä¹—ã£ã¦äººç”Ÿã‚’æ¥½ã—ã¿ã¾ã™ã€‚ ç§ã¯ä¼‘æ¯ã™ã‚‹ãŸã‚ã«æ¬¡ã®æ¹–ã«è¡Œãã¾ã—ãŸã€ãã—ã¦å½¼ã‚‰ã¯çŠ¬ã‚„ãƒœãƒ¼ãƒˆã¯è¨±å¯ã•ã‚Œã¦ã„ãªã„ã¨è¨€ã£ã¦ã„ã‚‹ã¨ã‚ãªãŸã«è©±ã—ã¾ã™ã€ãã—ã¦ä¸€èˆ¬çš„ã«ç§ãŸã¡ã®æ¹–ã¯ã„ã¤ã‚‚å‡ã£ã¦ã„ã¾ã™ã€ã“ã“ã§ã‚ãªãŸã¯ã‚¹ã‚±ãƒ¼ãƒˆã‚’æŒã£ã¦ã„ã¾ã™-ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚  <i>ã€Œä»®æƒ³ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°æ¹–ã¸ã‚ˆã†ã“ãã€‚ã€</i> <a name="habracut"></a> ã©ã†ã„ã†ã‚ã‘ã‹ã€ <i>ã‚¹ãƒ¼ãƒ‘ãƒ¼</i>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒ<i>MySQL</i>ã§ãƒˆãƒªã‚¬ãƒ¼ã‚’ä½œæˆã§ãã‚‹ã¨ã„ã†äº‹å®Ÿã«æ³¨æ„ã‚’æ‰•ã£ã¦ã„ã¾ã›ã‚“ã§ã—ãŸãŒã€ã“ã‚Œã¯ã‚„ã‚„é©šãã¹ãã“ã¨ã§ã™ãŒã€é–‹ç™ºè€…ã®è‰¯å¿ƒã«ä»»ã›ã¾ã—ã‚‡ã†ã€‚ åŸºæœ¬çš„ã«Perlã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã™ãŒã€ä½œæˆã—ãŸæ™‚ç‚¹ã§ã¯å®Œå…¨ã«ç•°ãªã‚‹ã‚¿ã‚¹ã‚¯ã¨è¦ä»¶ãŒã‚ã‚Šã¾ã—ãŸã€‚ ã—ãŸãŒã£ã¦ã€ã“ã®è¨˜äº‹ã¯ä»¥å‰ã®é–‹ç™ºã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã®ã§ã¯ãªãã€è¿½åŠ ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æä¾›ã™ã‚‹ã ã‘ã§ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ç‰¹å®šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã¨ç‰¹å®šã®ã€Œãƒ©ãƒƒãƒ‘ãƒ¼ã€ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã®ã€Œãƒ©ãƒƒãƒ‘ãƒ¼ã€ã«ã¯ã€ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ©Ÿèƒ½ã®æ‹¡å¼µã¨ã—ã¦å«ã‚ã¾ã™ã€‚ ãƒ©ãƒƒãƒ‘ãƒ¼ã¯è‡ªå·±è¨˜è¿°å‹ã§ã™ã€‚  <i>DBIx :: Class</i>ã‚„ãã®ä»–ã®æ—¢æˆã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®åå¯¾è€…ã§ã¯ãªã„ã®ã§ã€äº‹å‰ã«äºˆç´„ã—ã¾ã™ã€‚ä»•äº‹ã§ãã‚Œã‚‰ã‚’ä½¿ç”¨ã—ã¦æº€è¶³ã—ã¦ã„ã¾ã™ã€‚ è³ªå•ã¯<i>ä»®æƒ³ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã¨</i>ãã‚Œã«ä¼¼ãŸä»–ã®ã‚‚ã®ã«ã‹ã‹ã£ã¦ã„ã¾ã™ï¼šmod_perlã®æ¬ å¦‚ã¨è¿½åŠ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®hemoã€‚ åŒã˜<i>DBIx :: Class</i>ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯é–‹ç™ºä¸­ã§ã™ãŒã€å¿…è¦ãŒãªã„ã®ã§ã‚ã¾ã‚Šé«˜é€Ÿã§ã¯ãªã„ã®ã§ã€ååˆ†ãªãƒˆãƒªã‚¬ãƒ¼ãŒã‚ã‚‹ãŸã‚ã€ <i>æŒ¿å…¥</i> ã€ <i>æ›´æ–°</i> ã€ <i>å‰Šé™¤ã®</i> 3ã¤ã®æ‰‹é †ã ã‘ãŒå¿…è¦ã§ã™ã€‚ ã“ã‚Œã¯ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã§ã‚ã‚Šã€ã€Œãƒ©ãƒƒãƒ‘ãƒ¼ã€ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦ç¶™æ‰¿ã•ã‚Œã¾ã™ã€‚ ãŸã ã—ã€ã“ã®è¨˜äº‹ã§ã¯ã€ã»ã¼è‡ªçµ¦è‡ªè¶³ã«ã—ã¾ã™ã€‚ ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å«ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚1ãƒ¬ãƒ™ãƒ«ä¸Šã§ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€è‡ªåˆ†ã§ã‚³ãƒ¼ãƒ‰ã«å«ã‚ã‚‹ã“ã¨ã¯é›£ã—ããªã„ã¨æ€ã„ã¾ã™ã€‚ ã€æ©Ÿèƒ½ã®å°‘ã—ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸãŒã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> åŸºæœ¬çš„ãªæ‰‹é †ã¨å¤‰æ•° </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã‚‚ã¡ã‚ã‚“ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹ãŸã‚ã®æ‰‹é †ã§ã™ãŒã€å¤–éƒ¨ã‹ã‚‰å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸$ dbhã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚Šã¾ã™ã€‚ ã¾ãŸã€æ™®éæ€§ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã«ã€ãƒ„ãƒªãƒ¼ã®æ§‹é€ ã‚’æ‹…å½“ã™ã‚‹ç‹¬è‡ªã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚»ãƒƒãƒˆã‚’å„ãƒ†ãƒ¼ãƒ–ãƒ«ã«å®šç¾©ã™ã‚‹é…åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ1ï¼‰ <pre>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸MY :: NestedSets;
 ï¼ƒå¦¥å”ã®ãªã„å¤§äººã¨ã—ã¦ã®ã™ã¹ã¦;-)
å³æ ¼ãªä½¿ç”¨;
è­¦å‘Šã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
 $ VERSION = '0.0.1';
 ï¼ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã§ä½¿ç”¨ã™ã‚‹å¤‰æ•°ã‚’å®šç¾©ã—ã¾ã™
 $ dbh = undef;
 $ãƒ†ãƒ¼ãƒ–ãƒ«= {
                ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ=&gt; {ï¼ƒãƒ†ãƒ¼ãƒ–ãƒ«å
                    ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰=&gt; {ï¼ƒãƒ†ãƒ¼ãƒ–ãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
                         id =&gt; 'id'ã€ï¼ƒå®Ÿéš›ã«IDã€ã ã‚Œã‚‚ãŒã©ã®ã‚ˆã†ã«é›»è©±ã™ã‚‹ã‹ã‚ã‹ã‚Šã¾ã›ã‚“
                         left_key =&gt; 'left_key'ã€ï¼ƒå·¦ã‚­ãƒ¼
                         right_key =&gt; 'right_key'ã€ï¼ƒå³ã‚­ãƒ¼
                         level =&gt; 'level'ã€ï¼ƒãƒ¬ãƒ™ãƒ«
                         parent_id =&gt; 'parent_id'ã€ï¼ƒè¦ªID
                         tree =&gt; 'tree'ï¼ƒãƒ„ãƒªãƒ¼è­˜åˆ¥å­
                                 }ã€
                     multi =&gt; 1ã€ï¼ƒãƒ†ãƒ¼ãƒ–ãƒ«ã«è¤‡æ•°ã®ãƒ„ãƒªãƒ¼ãŒã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã™
                             }ã€
                };

 sub dbh {
 ï¼ƒã¾ã ä½œæˆã—ã¦ã„ã‚‹å ´åˆã€æœ€åˆã®å€¤ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åå‰ã¾ãŸã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¯ãƒ©ã‚¹ã«ãªã‚Šã¾ã™
 ï¼ƒãã‚Œã§ã€ç§ãŸã¡ã¯æ™‚ã€…ãã‚Œã‚’æ–­ã¡åˆ‡ã‚Šã€ã‚¯ãƒ©ã‚¹ã‚’æŒã£ã¦ã„ã¾ã›ã‚“ã€‚
     shift if $ _ [0] &amp;&amp;ï¼ˆ$ _ [0] eq __PACKAGE__ ||ï¼ˆref $ _ [0] &amp;&amp; ref $ _ [0] eq __PACKAGE__ï¼‰ï¼‰;
     $ dbh = $ _ [0] if $ _ [0];
     return $ dbh;
 }

 sub set_table_params {
     shift if $ _ [0] &amp;&amp;ï¼ˆ$ _ [0] eq __PACKAGE__ ||ï¼ˆref $ _ [0] &amp;&amp; ref $ _ [0] eq __PACKAGE__ï¼‰ï¼‰;
 ï¼ƒç‰¹å®šã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¨­å®šã™ã‚‹
     myï¼ˆ$ table_nameã€$ paramsï¼‰= @_;
     $ tables-&gt; {$ table_name} = $ params;
     $ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿”ã—ã¾ã™ã€‚
 }
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ä¸¦è¡Œã—ã¦ã€useã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªä½“ã‚’è¨˜è¿°ã—ã¾ã™ãŒã€ã“ã‚Œã‚‚ãƒ†ã‚¹ãƒˆç”¨ã§ã™ã€‚ ãã®ãŸã‚ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ãã®ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’æ±ºå®šã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ2ï¼‰ <pre> ï¼ƒï¼/ usr / bin / perl
å³æ ¼ãªä½¿ç”¨; è­¦å‘Šã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
 lib '../lib'ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
 MY :: NestedSetsã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
 DBIã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
 Data :: Dumperã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

 ï¼ƒ------------------------------------------------- -------------------------------------------------- -----
 ï¼ƒINIT

 my $ dbh = DBI-&gt; connectï¼ˆ 'dbiï¼šmysqlï¼šdatabase = test; host = localhost; port = 3306'ã€ 'user'ã€ 'pass'ï¼‰;
ç§ã®$ table_name = 'test_nested_sets';
 myï¼…f =ï¼ˆ
         id =&gt; 'ids'ã€
         left_key =&gt; 'lk'ã€
         right_key =&gt; 'rk'ã€
        ãƒ¬ãƒ™ãƒ«=&gt; 'lv'ã€
         parent_id =&gt; 'pi'ã€
        ãƒ„ãƒªãƒ¼=&gt; 'tr'ã€
         ï¼‰;
 $ dbh-&gt; doï¼ˆ "DROP TABLE` $ table_name`;"ï¼‰;
 my $ query = "CREATE TABLE` $ table_name`ï¼ˆ
     `$ f {id}` intï¼ˆ11ï¼‰NOT NULL auto_incrementã€
     `$ f {left_key}` intï¼ˆ11ï¼‰NOT NULLãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ '0'ã€
     `$ f {right_key}` intï¼ˆ11ï¼‰NOT NULLãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ '0'ã€
     `$ f {level}` intï¼ˆ11ï¼‰NOT NULLãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ '0'ã€
     `$ f {parent_id}` intï¼ˆ11ï¼‰NOT NULLãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ '0'ã€
     `$ f {tree}` intï¼ˆ11ï¼‰NOT NULLãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ '1'ã€
     `field1` VARCHARï¼ˆ100ï¼‰ã€
    ä¸»ã‚­ãƒ¼ï¼ˆ `$ f {id}`ï¼‰
 ï¼‰ã‚¨ãƒ³ã‚¸ãƒ³= MyISAM; ";
 $ dbh-&gt; doï¼ˆ$ queryï¼‰;

 MY :: NestedSets-&gt; dbhï¼ˆ$ dbhï¼‰;
 MY :: NestedSets-&gt; set_table_paramsï¼ˆ$ table_name =&gt; {fields =&gt; \ï¼…fã€multi =&gt; 1}ï¼‰;
 ...
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ãƒãƒ¼ãƒ‰ã‚’æŒ¿å…¥ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ä½œæ¥­ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯ã€ãƒˆãƒªã‚¬ãƒ¼ã®ãƒ­ã‚¸ãƒƒã‚¯ã¨åŒã˜ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ3ï¼‰ <pre>ã‚µãƒ–æŒ¿å…¥{
 ï¼ƒç€ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ã«å ´æ‰€ã«é…å¸ƒã—ã€ãã‚Œã«å¿œã˜ã¦ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™
     shift if $ _ [0] &amp;&amp;ï¼ˆ$ _ [0] eq __PACKAGE__ ||ï¼ˆref $ _ [0] &amp;&amp; ref $ _ [0] eq __PACKAGE__ï¼‰ï¼‰;
     myï¼ˆ$ table_nameã€$ newï¼‰= @_;
     return {success =&gt; 0ã€error =&gt; 'Bad Income dataï¼'} $ dbh &amp;&amp; $ table_name &amp;&amp; $ new &amp;&amp; ref $ new &amp;&amp; ref $ new eq 'HASH';
 ï¼ƒã©ã‚“ãªç¨®é¡ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¦‹ã¤ã‘ã¦ã€è¿½åŠ ã®å±æ€§ã¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚·ãƒãƒ‹ãƒ ã‚’å–å¾—ã—ã¾ã™
    ç§ã®$ table = $ tables-&gt; {$ table_name} ||  $ tables-&gt; {default};
    ç§ã®$ f = $ table-&gt; {fields};
    ç§ã®$ result_flags = {is_last_unit =&gt; undef};
 ï¼ƒãƒ„ãƒªãƒ¼ã‚­ãƒ¼ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’æ±ºå®šã™ã‚‹
     $ new-&gt; {$ f-&gt; {left_key}} || = 0;
     $ new-&gt; {$ f-&gt; {right_key}} = undef;
     $ new-&gt; {$ f-&gt; {level}} = undef;
     $ new-&gt; {$ f-&gt; {parent_id}} || = 0;
 ï¼ƒè¦ªãƒãƒ¼ãƒ‰ã‚’æŒ‡å®šã¾ãŸã¯å¤‰æ›´ã—ãŸå ´åˆã€ã‚­ãƒ¼ã‚’æ±ºå®šã—ã¾ã™
     ifï¼ˆ$ new-&gt; {$ f-&gt; {parent_id}}ï¼‰{
        ç§ã®$ sql = 'SELECT'ã€‚
                         ï¼ˆ$ãƒ†ãƒ¼ãƒ–ãƒ«-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ã€ŒASãƒ„ãƒªãƒ¼ã€ï¼š ''ï¼‰ã€‚
                         $ f-&gt; {right_key}ã€‚ '  AS left_keyã€ 'ã€‚
                         $ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚ '  + 1 ASãƒ¬ãƒ™ãƒ« 'ã€‚
                  ã€ŒFROMã€$ Table_nameã€‚
                  'WHERE'ã€‚$ F-&gt; {id}ã€‚ '  = 'ã€‚$ new-&gt; {$ f-&gt; {parent_id}};
 ï¼ƒæ˜ç¢ºã«ã™ã‚‹ãŸã‚ã«ã€ã“ã‚Œã¯ã‚¯ã‚¨ãƒªã§ã™ï¼ˆè§’æ‹¬å¼§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å¼ã§ã™ï¼‰ï¼š
 ï¼ƒSELECT [tree AS treeã€] right_key AS left_keyã€level + 1 AS level FROM $ table_name WHERE id = $ parent_id;
        ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
        ç§ã®$ row = $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
         $ sth-&gt; finish;
 ï¼ƒè¦ªãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã£ãŸãŸã‚ã€ã‚­ãƒ¼å€¤ã‚’å†å®šç¾©ã—ã¾ã™
         ifï¼ˆ$ rowï¼‰{
             $ new-&gt; {$ f-&gt; {tree}} = $ row-&gt; {tree} || æœªå®šç¾©
             $ new-&gt; {$ f-&gt; {left_key}} = $ row-&gt; {left_key};
             $ new-&gt; {$ f-&gt; {level}} = $ row-&gt; {level};
         } else {
 ï¼ƒè¦ªãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„ãŸã‚ã€parent_idãŒæ®‹ã£ã¦ã„ã‚‹ãŸã‚ã€ãƒªã‚»ãƒƒãƒˆã—ã¾ã™
             $ new-&gt; {$ f-&gt; {parent_id}} = 0;
             $ new-&gt; {$ f-&gt; {level}} = 0;
         }
     }
 ï¼ƒå·¦ã‚­ãƒ¼ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã‚­ãƒ¼ã‚’æ±ºå®šã—ã¾ã™ãŒã€åŒæ™‚ã«ã€è¦ªãƒãƒ¼ãƒ‰ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ã‹ã€è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
     ifï¼ˆï¼$ new-&gt; {$ f-&gt; {parent_id}} &amp;&amp; $ new-&gt; {$ f-&gt; {left_key}}ï¼‰{
 ï¼ƒã“ã‚Œã¯é‡è¦ã§ã™ï¼ ãƒãƒ«ãƒãƒ„ãƒªãƒ¼ã®å ´åˆã€$ treeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒå¿…è¦ã§ã™
         $ new-&gt; {$ f-&gt; {tree}} &amp;&amp; $ table-&gt; {multi};ã§ãªã„é™ã‚Šã€{success =&gt; 0ã€error =&gt; 'No tree valueï¼'}
 ï¼ƒæœ€åˆã¯SQLã‚’ä½¿ç”¨ã—ãŸã‹ã£ãŸ::æŠ½è±¡çš„ã ãŒã€æ°—ã«å…¥ã‚‰ãªã‹ã£ãŸã€‚è¤‡é›‘ãªã‚¯ã‚¨ãƒªã‚’è¨˜è¿°ã™ã‚‹ã®ã¯é›£ã—ãã¦é•·ã„
 ï¼ƒå·¦å³ã®ã‚­ãƒ¼ã§ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹
        ç§ã®$ sql = 'SELECT'ã€‚
                         $ f-&gt; {id}ã€‚ '  AS idã€ 'ã€‚
                         $ f-&gt; {left_key}ã€‚ '  AS left_keyã€ 'ã€‚
                         $ f-&gt; {right_key}ã€‚ '  AS right_keyã€ 'ã€‚
                         $ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚ '  ASãƒ¬ãƒ™ãƒ«ã€ 'ã€‚
                         $ f-&gt; {parent_id}ã€‚ '  AS parent_id 'ã€‚
                  ã€ŒFROMã€$ Table_nameã€‚
                  ã€Œã©ã“ã€ã€‚
                  ï¼ˆ$ãƒ†ãƒ¼ãƒ–ãƒ«-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ '='ã€‚$ new-&gt; {$ f-&gt; {tree}}ã€‚ 'AND'ï¼š ''ï¼‰ã€‚
                  'ï¼ˆ'ã€‚$ f-&gt; {left_key}ã€‚ '='ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚ 'OR'ã€‚
                  $ f-&gt; {right_key}ã€‚ '  = 'ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚'ï¼‰LIMIT 1 ';
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒé¸æŠ
 ï¼ƒid AS idã€
 ï¼ƒleft_key AS left_keyã€
 ï¼ƒright_key AS right_keyã€
 ï¼ƒãƒ¬ãƒ™ãƒ«ASãƒ¬ãƒ™ãƒ«ã€
 ï¼ƒparent_id AS parent_id
 ï¼ƒFROM $ table_name
 ï¼ƒã©ã“
 ï¼ƒ[tree = $ tree AND]
 ï¼ƒï¼ˆleft_key = $ left_keyã¾ãŸã¯right_key = $ left_keyï¼‰
 ï¼ƒLIMIT 1;
        ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
        ç§ã®$ row = $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
         $ sth-&gt; finish;
 ï¼ƒå·¦ã‚­ãƒ¼ã§ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã£ãŸãŸã‚ã€è¦‹ã¤ã‹ã£ãŸæ–°ã—ã„ãƒãƒ¼ãƒ‰
         ifï¼ˆ$ row &amp;&amp; $ row-&gt; {left_key} == $ new-&gt; {$ f-&gt; {left_key}}ï¼‰{
             $ new-&gt; {$ f-&gt; {parent_id}} = $ row-&gt; {parent_id};
             $ new-&gt; {$ f-&gt; {level}} = $ row-&gt; {level};
 ï¼ƒãƒãƒ¼ãƒ‰ã¯æ­£ã—ã„ã‚­ãƒ¼ã§æ¤œå‡ºã•ã‚ŒãŸãŸã‚ã€æ–°ã—ã„ãƒãƒ¼ãƒ‰ã¯æ¤œå‡ºã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸‹ã«ã‚ã‚Šã¾ã™
         } elsifï¼ˆ$è¡Œï¼‰{
             $ new-&gt; {$ f-&gt; {parent_id}} = $ row-&gt; {id};
             $ new-&gt; {$ f-&gt; {level}} = $ row-&gt; {level} + 1;
         } else {
 ï¼ƒç¹°ã‚Šè¿”ã—ã¾ã™ãŒã€ãã®ã‚ˆã†ãªãŒã‚‰ããŸã¯ã€å®Œå…¨ã«æ®‹ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ èª“ã†ã®ã¯è‰¯ã„ã“ã¨ã§ã™ãŒã€ä»Šã®ã¨ã“ã‚ã€ã“ã‚Œã‚‰ã®ç¾¤ã‚Œã‚’ç„¡è¦–ã—ã¦ãã ã•ã„ã€‚
 ï¼ƒã“ã®ãƒ‡ãƒ¼ã‚¿ãŒãªãã¦ã‚‚å‡¦ç†ã§ãã‚‹ãŸã‚
             $ new-&gt; {$ f-&gt; {left_key}} = undef;
         }
     }
 ï¼ƒå®Ÿéš›ã«ã€æŒ¿å…¥ãƒã‚¤ãƒ³ãƒˆã‚’å–å¾—ã§ããªã‹ã£ãŸã‹ã€å˜ã«ç¤ºã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚
 ï¼ƒãƒ„ãƒªãƒ¼ã®æœ€å¾Œã«æŒ¿å…¥ã™ã‚‹ãŸã‚ã€æ—¢å­˜ã®ãƒãƒ¼ãƒ‰ã‚’æ›´æ–°ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€å¯¾å¿œã™ã‚‹ãƒ•ãƒ©ã‚°ã‚’ä½œæˆã—ã¾ã™ã€‚
     ï¼ˆ$ new-&gt; {$ f-&gt; {left_key}}ï¼‰{
         $ result_flags-&gt; {is_last_unit} = 1;
 ï¼ƒã“ã‚Œã‚‚ã¾ãŸé‡è¦ã§ã™ï¼ è¤‡æ•°ãƒ„ãƒªãƒ¼ã®å ´åˆã¯ã€$ treeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒå¿…è¦ã§ã™ã€‚
 ï¼ƒä¸€èˆ¬ã«ã€æœ€åˆã«ã“ã‚Œã‚’ç¢ºèªã§ãã¾ã™ãŒã€parent_idã‚’æŒ‡å®šã—ãŸå ´åˆã€ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ä¸è¦ã§ã™ã€‚
 ï¼ƒæ¬¡ã«ã€ãƒ„ãƒªãƒ¼ã‚­ãƒ¼ã®å€¤ãŒæ±ºå®šã•ã‚Œã¾ã™ã€‚
         $ new-&gt; {$ f-&gt; {tree}} &amp;&amp; $ table-&gt; {multi};ã§ãªã„é™ã‚Šã€{success =&gt; 0ã€error =&gt; 'No tree valueï¼'}
 ï¼ƒãã‚Œã¯ç°¡å˜ã§ã™ã€æœ€å¤§ã®æ­£ã—ã„ã‚­ãƒ¼ã‚’æ±ºå®šã—ã¦å–œã¶
        ç§ã®$ sql = 'SELECT MAXï¼ˆ'ã€‚$ f-&gt; {right_key}ã€‚ 'ï¼‰+ 1 AS left_key
             FROM 'ã€‚$ Table_nameã€‚
             ï¼ˆ$ table-&gt; {multi}ï¼Ÿ 'WHERE'ã€‚$ f-&gt; {tree}ã€‚ '='ã€‚$ new-&gt; {$ f-&gt; {tree}}ï¼š ''ï¼‰;
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒSELECT MAXï¼ˆright_keyï¼‰+ 1 AS left_keyã€
 ï¼ƒFROM $ table_name
 ï¼ƒ[WHERE tree = $ tree];
        ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
        ç§ã®$ row = $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
         $ sth-&gt; finish;
 ï¼ƒã—ã‹ã—ã€ãƒãƒ¼ãƒ‰ãŒã¾ã£ãŸããªã„å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å–œã³ã¯å®Œå…¨ã§ã¯ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
         $ new-&gt; {$ f-&gt; {left_key}} = $ row-&gt; {left_key} ||  1;
         $ new-&gt; {$ f-&gt; {parent_id}} = 0;
         $ new-&gt; {$ f-&gt; {level}} = 0;
     }
 ï¼ƒã•ã¦ã€å ´æ‰€ã§ã€ãƒ„ãƒªãƒ¼ã®ã‚­ãƒ¼ã‚’å£Šã™ã“ã¨ãŒã§ãã‚‹ã¨æ±ºã‚ã¾ã—ãŸï¼š
     ï¼ˆ$ result_flags-&gt; {is_last_unit}ï¼‰{
         my $ query = 'UPDATE'ã€‚$ table_nameã€‚
                        'SET'ã€‚$ F-&gt; {left_key}ã€‚ '  =ã‚±ãƒ¼ã‚¹
                                     'ã€‚$ F-&gt; {left_key}ã®å ´åˆã€‚  &gt; = 'ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚
                                    ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  + 2 ELSE 'ã€‚$ F-&gt; {left_key}'ã€‚  ENDã€
                             'ã€‚$ f-&gt; {right_key}'ã€‚  = 'ã€‚$ f-&gt; {right_key}ã€‚'  + 2
                      WHERE 'ã€‚
                      ï¼ˆ$ãƒ†ãƒ¼ãƒ–ãƒ«-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ '='ã€‚$ new-&gt; {$ f-&gt; {tree}}ã€‚ 'AND'ï¼š ''ï¼‰ã€‚
                       $ f-&gt; {right_key}ã€‚ '  &gt; = 'ã€‚$ new-&gt; {$ f-&gt; {left_key}};
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒUPDATE $ table_name
 ï¼ƒã‚»ãƒƒãƒˆ
 ï¼ƒleft_key = left_key&gt; = $ left_keyã®å ´åˆ 
 ï¼ƒTHEN left_key + 2 
 ï¼ƒELSE left_key
 ï¼ƒENDã€
 ï¼ƒright_key = right_key + 2
 ï¼ƒWHERE [tree = $ tree AND] right_key&gt; = $ left_key;
         $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
     }
 ï¼ƒå®Ÿéš›ã€ãªãœã“ã“ã«æ¥ãŸã®ã‹ï¼š
 ï¼ƒæ­£ã—ã„ã‚­ãƒ¼ãŒè¨ˆç®—ã•ã‚Œã¾ã™
     $ new-&gt; {$ f-&gt; {right_key}} = $ new-&gt; {$ f-&gt; {left_key}} + 1;
 ï¼ƒã‚­ãƒ¼ã‚’ç½®ãã¾ã™
     $ new-&gt; {$ f-&gt; {tree}} = $ new-&gt; {$ f-&gt; {tree}} if if table-&gt; {multi};
 ï¼ƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç‰¹å®šã®é †åºã§è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹
    ç§ã®@fields = keysï¼…{$ new};
 ï¼ƒã“ã“ã§ã€éæ•°å€¤ã®ç©ºã®è¡Œã‚’å¼•ç”¨ã—ã¦@fieldsã®é †ã«è©°ã‚ã‚‹ã«ã¯
 ï¼ƒãã—ã¦ã¯ã„ã€å°‘ãªãã¨ã‚‚äºŒé‡å¼•ç”¨ç¬¦ã«ã¤ã„ã¦ã¯ã€ã“ã“ã«æ¥ã‚‹å‰ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
    ç§ã®@values = map {defined $ new-&gt; {$ _} &amp;&amp; $ new-&gt; {$ _} =ã€œ/ ^ \ d + $ /ï¼Ÿ  $ new-&gt; {$ _}ï¼š '"'ã€‚$ new-&gt; {$ _}ã€‚ '"'} @fields;
 ï¼ƒå®Ÿéš›ã«æŒ¿å…¥
     my $ query = 'INSERT INTO'ã€‚$ table_nameã€‚ '  ï¼ˆ 'ã€‚ï¼ˆjoin'ã€ 'ã€@fieldsï¼‰'ï¼‰VALUESï¼ˆ 'ã€‚ï¼ˆjoin'ã€ 'ã€@valuesï¼‰ã€‚'ï¼‰ ';
     $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
 ï¼ƒã—ã‹ã—ã€è¿”ã™ã¹ãã‚‚ã®ã¯åˆ¥ã®è³ªå•ã§ã™ã€‚æ®‹å¿µãªãŒã‚‰ã€ãƒ•ã‚§ãƒƒãƒã›ãšã«æŒ¿å…¥ã•ã‚ŒãŸè¡Œã‚’è¿”ã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
 ï¼ƒãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ãŒã‚ã‚Šã¾ã™ãŒã€INSERTã§ãã‚Œã‚‰ã‚’æŒ‡å®šã—ãªã‹ã£ãŸãŸã‚ã€‚
 ï¼ƒåŒã˜SELECTã‚’ã—ã¾ã—ã‚‡ã†
    ç§ã®$ sql = 'SELECT * FROM'ã€‚$ table_nameã€‚ '  ORDER BY 'ã€‚$ F-&gt; {id}ã€‚'  DESC LIMIT 1 ';
    ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
    ç§ã®$ row = $ sth-&gt; fetchrow_hashref;
     $ sth-&gt; finish;
     return {success =&gt; 1ã€row =&gt; $ row};
 }
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã¯ã„ã€ãŸãã•ã‚“ã®ã‚³ãƒ¼ãƒ‰ãŒåˆ¤æ˜ã—ã¾ã—ãŸ...ã—ã‹ã—ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤ã™ã‚‹ã¨ã€è¡Œæ•°ãŒåŠåˆ†ã«ãªã‚Šã¾ã™;-)ãŒã€ã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚ åŸºæœ¬çš„ã«ï¼šç¹°ã‚Šè¿”ã—ã¾ã™ãŒã€è¦ªã®è¨­å®šãŒå„ªå…ˆã•ã‚Œã¾ã™ã€‚ è¦ªãŒæŒ‡å®šã•ã‚Œã€å·¦ã®ã‚­ãƒ¼ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€æœ‰åŠ¹ãªãƒ„ãƒªãƒ¼ã§ã¯å¾Œè€…ãŒç„¡è¦–ã•ã‚Œã¾ã™ã€‚ ã—ãŸãŒã£ã¦ã€ä½•ã‹ã«å¾“å±ã™ã‚‹ãƒãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã¨åŒæ™‚ã«ã€å­ã®ãƒªã‚¹ãƒˆå†…ã§ãã®å ´æ‰€ã‚’æŒ‡å®šã™ã‚‹å ´åˆã¯ã€parent_idã‚’æ¸¡ã™å¿…è¦ãŒãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ4ï¼‰ <pre> ...ç§ã®$ãƒ„ãƒªãƒ¼= 1;  ï¼ƒ------------------------------------------------- -------------------------------------------------- --------------------ï¼ƒINSERTï¼ƒåº§æ¨™ãªã—ã§è¨˜éŒ²my $ insert = MY :: NestedSets-&gt; insertï¼ˆ$ table_nameã€{field1 =&gt; 'row1-'ã€‚ $ treeã€tr =&gt; $ tree}ï¼‰;  Dumper $ insertã«è­¦å‘Šã—ã¾ã™ã€‚  ï¼ƒè¦ªã®ã‚ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰$ insert = MY :: NestedSets-&gt; insertï¼ˆ$ table_nameã€{field1 =&gt; 'row2-'ã€‚$ Treeã€pi =&gt; $ insert-&gt; {row}-&gt; {ids}ã€tr =&gt; $ãƒ„ãƒªãƒ¼}ï¼‰;  Dumper $ insertã«è­¦å‘Šã—ã¾ã™ã€‚  ï¼ƒleft_keyã®ã‚¨ãƒ³ãƒˆãƒª$ insert = MY :: NestedSets-&gt; insertï¼ˆ$ table_nameã€{field1 =&gt; 'row3-'ã€‚$ Treeã€lk =&gt; 1ã€tr =&gt; $ tree}ï¼‰;  Dumper $ insertã«è­¦å‘Šã—ã¾ã™ã€‚  $ insert = MY :: NestedSets-&gt; insertï¼ˆ$ table_nameã€{field1 =&gt; 'row4-'ã€‚$ treeã€lk =&gt; 4ã€tr =&gt; $ tree}ï¼‰;  Dumper $ insertã«è­¦å‘Šã—ã¾ã™ã€‚  ï¼ƒé–“é•ã£ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼$ insert = MY :: NestedSets-&gt; insertï¼ˆ$ table_nameã€{field1 =&gt; 'row5-'ã€‚$ Treeã€pi =&gt; 1000ã€tr =&gt; $ tree}ï¼‰;  Dumper $ insertã«è­¦å‘Šã—ã¾ã™ã€‚  $ insert = MY :: NestedSets-&gt; insertï¼ˆ$ table_nameã€{field1 =&gt; 'row6-'ã€‚$ treeã€lk =&gt; 100ã€tr =&gt; $ tree}ï¼‰;  Dumper $ insertã«è­¦å‘Šã—ã¾ã™ã€‚  ... </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ãƒãƒ¼ãƒ‰å¤‰æ›´ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰ç›´æ¥å¤‰æ›´ã™ã‚‹ã“ã¨ã«åŠ ãˆã¦ã€å¤‰æ›´ã¯å¿…è¦ã«å¿œã˜ã¦ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚‚é©ç”¨ã•ã‚Œã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ5ï¼‰ <pre>ã‚µãƒ–ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ{
 ï¼ƒå—ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’å ´æ‰€ã«é…å¸ƒã—ã€ãã‚Œã«å¿œã˜ã¦ã€ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™
    ã‚·ãƒ•ãƒˆif $ _ [0] &amp;&amp;ï¼ˆ$ _ [0] eq __PACKAGE__ ||ï¼ˆref $ _ [0] &amp;&amp; ref $ _ [0] eq __PACKAGE__ï¼‰ï¼‰;
     myï¼ˆ$ table_nameã€$ newï¼‰= @_;
     return {success =&gt; 0ã€error =&gt; 'Bad Income dataï¼'} $ dbh &amp;&amp; $ table_name &amp;&amp; $ new &amp;&amp; ref $ new &amp;&amp; ref $ new eq 'HASH';
 ï¼ƒã©ã‚“ãªç¨®é¡ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¦‹ã¤ã‘ã¦ã€è¿½åŠ ã®å±æ€§ã¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚·ãƒãƒ‹ãƒ ã‚’å–å¾—ã—ã¾ã™
    ç§ã®$ table = $ tables-&gt; {$ table_name} ||  $ tables-&gt; {default};
    ç§ã®$ f = $ table-&gt; {fields};
    ãƒªã‚¿ãƒ¼ãƒ³{æˆåŠŸ=&gt; 0ã€ã‚¨ãƒ©ãƒ¼=&gt; 'æ‚ªã„åå…¥ãƒ‡ãƒ¼ã‚¿ï¼'} $ new-&gt; {$ f-&gt; {id}};
 ï¼ƒå€‹åˆ¥ã«å¤‰æ›´ã§ããªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å‰Šé™¤ã—ã¾ã™
    å‰Šé™¤$ new-&gt; {$ f-&gt; {right_key}};
    å‰Šé™¤$ new-&gt; {$ f-&gt; {tree}};
    å‰Šé™¤$ new-&gt; {$ f-&gt; {level}};
    ç§ã®$ tmp_left_key = $ new-&gt; {$ f-&gt; {left_key}};
    ç§ã®$ result_flags = {it_is_moving =&gt; undef};
 ï¼ƒã•ã‚‰ã«ã‚¸ãƒ¬ãƒ³ãƒã€‚ å¤‰æ›´ã‚’å—ã‘å…¥ã‚Œã‚‹ã«ã¯ã€ã‚½ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã™
 ï¼ƒã“ã®å ´åˆã€ã©ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã€ã©ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå®Ÿéš›ã«å¤‰æ›´ã•ã‚ŒãŸã‹ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€
 ï¼ƒå¯å¤‰ãƒãƒ¼ãƒ‰ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã™ã‚‹
    ç§ã®$ sql = 'SELECT * FROM'ã€‚$ table_nameã€‚ '  WHERE 'ã€‚$ F-&gt; {id}ã€‚'  = 'ã€‚$ new-&gt; {$ f-&gt; {id}};
    ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
     $ old = $ sth-&gt; fetchrow_hashref;
     $ sth-&gt; finish;
     return {success =&gt; 0ã€error =&gt; 'No old unitï¼'}ãŒ$ oldã§ãªã„é™ã‚Š;
 ï¼ƒæ–°ã—ã„ãƒãƒ¼ãƒ‰åº§æ¨™ã‚’è¨ˆç®—ã™ã‚‹
 ï¼ƒè¦ªãƒãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå ´åˆã€ã‚­ãƒ¼ã‚’æ±ºå®šã—ã¾ã™
     ifï¼ˆå®šç¾©æ¸ˆã¿$ new-&gt; {$ f-&gt; {parent_id}} &amp;&amp; $ new-&gt; {$ f-&gt; {parent_id}}ï¼= $ old-&gt; {$ f-&gt; {parent_id}}ï¼‰{
         ifï¼ˆ$ new-&gt; {$ f-&gt; {parent_id}}&gt; 0ï¼‰{
            ç§ã®$ sql = 'SELECT'ã€‚
                             ï¼ˆ$ãƒ†ãƒ¼ãƒ–ãƒ«-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ã€ŒASãƒ„ãƒªãƒ¼ã€ï¼š ''ï¼‰ã€‚
                             $ f-&gt; {right_key}ã€‚ '  AS left_keyã€ 'ã€‚
                             $ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚ '  + 1 ASãƒ¬ãƒ™ãƒ« 'ã€‚
                      ã€ŒFROMã€$ Table_nameã€‚
                      'WHERE'ã€‚$ F-&gt; {id}ã€‚ '  = 'ã€‚$ new-&gt; {$ f-&gt; {parent_id}};
 ï¼ƒæ˜ç¢ºã«ã™ã‚‹ãŸã‚ã«ã€ã“ã‚Œã¯ã‚¯ã‚¨ãƒªã§ã™ï¼ˆè§’æ‹¬å¼§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å¼ã§ã™ï¼‰ï¼š
 ï¼ƒSELECT [tree AS treeã€] right_key AS left_keyã€level + 1 AS level FROM $ table_name WHERE id = $ parent_id;
            ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
            ç§ã®$ row = $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
             $ sth-&gt; finish;
 ï¼ƒè¦ªãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã£ãŸå¾Œã€ã‚­ãƒ¼å€¤ã‚’å†å®šç¾©ã—ã¾ã™
             ifï¼ˆ$ rowï¼‰{
                 $ new-&gt; {$ f-&gt; {tree}} = $ row-&gt; {tree} if if table-&gt; {multi};
                 $ new-&gt; {$ f-&gt; {left_key}} = $ row-&gt; {left_key};
                 $ new-&gt; {$ f-&gt; {level}} = $ row-&gt; {level};
                 $ result_flags-&gt; {it_is_moving} = 1;
             } else {
 ï¼ƒè¦ªãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„ãŸã‚ã€parent_idãŒæ®‹ã£ã¦ã„ã‚‹ãŸã‚ã€ãƒªã‚»ãƒƒãƒˆã—ã¾ã™
                 $ new-&gt; {$ f-&gt; {parent_id}} = $ old-&gt; {$ f-&gt; {parent_id}};
             }
         } else {
 ï¼ƒæœ€é«˜ãƒ¬ãƒ™ãƒ«ã«ç§»è¡Œ
 ï¼ƒãã‚Œã¯ç°¡å˜ã§ã™ã€æœ€å¤§ã®æ­£ã—ã„ã‚­ãƒ¼ã‚’æ±ºå®šã—ã¦å–œã¶
            ç§ã®$ sql = 'SELECT MAXï¼ˆ'ã€‚$ f-&gt; {right_key}ã€‚ 'ï¼‰+ 1 AS left_key
                 FROM 'ã€‚$ Table_nameã€‚
                 ï¼ˆ$ table-&gt; {multi}ï¼Ÿ 'WHERE'ã€‚$ f-&gt; {tree}ã€‚ '='ã€‚$ old-&gt; {$ f-&gt; {tree}}ï¼š ''ï¼‰;
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒSELECT MAXï¼ˆright_keyï¼‰+ 1 AS left_keyã€
 ï¼ƒFROM $ table_name
 ï¼ƒ[WHERE tree = $ tree];
            ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
            ç§ã®$ row = $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
             $ sth-&gt; finish;
             $ new-&gt; {$ f-&gt; {left_key}} = $ row-&gt; {left_key};
             $ new-&gt; {$ f-&gt; {parent_id}} = 0;
             $ new-&gt; {$ f-&gt; {level}} = 0;
         }
     }
 ï¼ƒå·¦ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŒã€è¦ªãƒãƒ¼ãƒ‰ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ã‹è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€ã‚­ãƒ¼ã‚’æ±ºå®šã—ã¾ã™
     ifï¼ˆ$ tmp_left_key &amp;&amp; $ new-&gt; {$ f-&gt; {left_key}} &amp;&amp;ï¼ƒleft_keyãŒæŒ‡å®šã•ã‚ŒãŸ
          $ new-&gt; {$ f-&gt; {left_key}} == $ tmp_left_key &amp;&amp;ï¼ƒparent_idã¯å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã›ã‚“
          $ tmp_left_keyï¼= $ old-&gt; {$ f-&gt; {left_key}}ï¼‰{ï¼ƒleft_key changed
 ï¼ƒæœ€åˆã¯SQLã‚’ä½¿ç”¨ã—ãŸã‹ã£ãŸ::æŠ½è±¡çš„ã ãŒã€æ°—ã«å…¥ã‚‰ãªã‹ã£ãŸã€‚è¤‡é›‘ãªã‚¯ã‚¨ãƒªã‚’è¨˜è¿°ã™ã‚‹ã®ã¯é›£ã—ãã¦é•·ã„
 ï¼ƒå·¦å³ã®ã‚­ãƒ¼ã§ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹
        ç§ã®$ sql = 'SELECT'ã€‚
                         $ f-&gt; {id}ã€‚ '  AS idã€ 'ã€‚
                         $ f-&gt; {left_key}ã€‚ '  AS left_keyã€ 'ã€‚
                         $ f-&gt; {right_key}ã€‚ '  AS right_keyã€ 'ã€‚
                         $ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚ '  ASãƒ¬ãƒ™ãƒ«ã€ 'ã€‚
                         $ f-&gt; {parent_id}ã€‚ '  AS parent_id 'ã€‚
                  ã€ŒFROMã€$ Table_nameã€‚
                  ã€Œã©ã“ã€ã€‚
                  ï¼ˆ$ table-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ '='ã€‚$ old-&gt; {$ f-&gt; {tree}}ã€‚ 'AND'ï¼š ''ï¼‰ã€‚
                  'ï¼ˆ'ã€‚$ f-&gt; {left_key}ã€‚ '='ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚ 'OR'ã€‚
                  $ f-&gt; {right_key}ã€‚ '  = 'ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚'ï¼‰LIMIT 1 ';
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒé¸æŠ
 ï¼ƒid AS idã€
 ï¼ƒleft_key AS left_keyã€
 ï¼ƒright_key AS right_keyã€
 ï¼ƒãƒ¬ãƒ™ãƒ«ASãƒ¬ãƒ™ãƒ«ã€
 ï¼ƒparent_id AS parent_id
 ï¼ƒFROM $ table_name
 ï¼ƒã©ã“
 ï¼ƒ[tree = $ tree AND]
 ï¼ƒï¼ˆleft_key = $ left_keyã¾ãŸã¯right_key = $ left_keyï¼‰
 ï¼ƒLIMIT 1;
        ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
        ç§ã®$ row = $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
         $ sth-&gt; finish;
 ï¼ƒå·¦ã‚­ãƒ¼ã§ãƒãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã£ãŸãŸã‚ã€è¦‹ã¤ã‹ã£ãŸæ–°ã—ã„ãƒãƒ¼ãƒ‰
         ifï¼ˆ$ row &amp;&amp; $ row-&gt; {left_key} == $ new-&gt; {$ f-&gt; {left_key}}ï¼‰{
             $ new-&gt; {$ f-&gt; {parent_id}} = $ row-&gt; {parent_id};
             $ new-&gt; {$ f-&gt; {level}} = $ row-&gt; {level};
 ï¼ƒãƒãƒ¼ãƒ‰ã¯æ­£ã—ã„ã‚­ãƒ¼ã§æ¤œå‡ºã•ã‚ŒãŸãŸã‚ã€æ–°ã—ã„ãƒãƒ¼ãƒ‰ã¯æ¤œå‡ºã•ã‚ŒãŸãƒãƒ¼ãƒ‰ã®ä¸‹ã«ã‚ã‚Šã¾ã™
         } elsifï¼ˆ$è¡Œï¼‰{
             $ new-&gt; {$ f-&gt; {parent_id}} = $ row-&gt; {id};
             $ new-&gt; {$ f-&gt; {level}} = $ row-&gt; {level} + 1;
         } else {
 ï¼ƒç¹°ã‚Šè¿”ã—ã¾ã™ãŒã€ãã®ã‚ˆã†ãªãŒã‚‰ããŸã¯ã€å®Œå…¨ã«æ®‹ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ ãƒãƒ¼ãƒ‰ã‚’æœ€åˆã«ç½®ãã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ãŒã€
 ï¼ƒæ¬¡ã«ã€ã“ã‚Œã¯é–“é•ã„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ ã—ã‹ã—ã€ä»–ã®å ´åˆã«ã¯ã€ç§»å‹•ã‚’ç„¡è¦–ã—ã¦ãã ã•ã„
             $ new-&gt; {$ f-&gt; {left_key}} = $ new-&gt; {$ f-&gt; {left_key}} &amp;&amp; $ new-&gt; {$ f-&gt; {left_key}} == 1ï¼Ÿ  1ï¼š$ old-&gt; {$ f-&gt; {left_key}};
         }
     }
 ï¼ƒã“ã‚Œã§ã€å·¦ã®ã‚­ãƒ¼ãŒä½•ã§ã‚ã‚‹ã‹ãŒã‚ã‹ã£ãŸã®ã§ã€å†…å´ã«é€ä¿¡ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã§ãã¾ã™
     ifï¼ˆ$ new-&gt; {$ f-&gt; {left_key}}&gt; $ old-&gt; {$ f-&gt; {left_key}} &amp;&amp; $ new-&gt; {$ f-&gt; {left_key}} &lt;$ old-&gt; {$ f-&gt; {right_key}}ï¼‰{
         return {success =&gt; 0ã€error =&gt; 'ãƒ¦ãƒ‹ãƒƒãƒˆã‚’å†…éƒ¨ã«ç§»å‹•ã§ãã¾ã›ã‚“'};
     }
 ï¼ƒåº§æ¨™ã‚’è¨ˆç®—ã—ã¾ã—ãŸãŒã€å”¯ä¸€ã®ã‚‚ã®ã¯ã€è¦‹ã¦ã€ãƒ„ãƒªãƒ¼ã«å¤‰æ›´ãŒã‚ã£ãŸã‹ã©ã†ã‹ã§ã™
     ifï¼ˆ$ new-&gt; {$ f-&gt; {left_key}} &amp;&amp; $ new-&gt; {$ f-&gt; {left_key}}ï¼= $ old-&gt; {$ f-&gt; {left_key}}ï¼‰{
 ï¼ƒãƒ¬ãƒ™ãƒ«ã¨ãƒ„ãƒªãƒ¼ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹
        ç§ã®$ skew_level = $ new-&gt; {$ f-&gt; {level}}-$ old-&gt; {$ f-&gt; {level}};
        ç§ã®$ skew_tree = $ old-&gt; {$ f-&gt; {right_key}}-$ old-&gt; {$ f-&gt; {left_key}} + 1;
 ï¼ƒãƒ„ãƒªãƒ¼ã‚’ä¸‹ã«ç§»å‹•ã™ã‚‹
         ifï¼ˆ$ new-&gt; {$ f-&gt; {left_key}}&gt; $ old-&gt; {$ f-&gt; {left_key}}ï¼‰{
            ç§ã®$ skew_edit = $ new-&gt; {$ f-&gt; {left_key}}-$ old-&gt; {$ f-&gt; {left_key}}-$ skew_tree;
             my $ query = 'UPDATE'ã€‚$ table_nameã€‚
                            'SET'ã€‚$ F-&gt; {left_key}ã€‚ '  = 'ã€‚$ F-&gt; {right_key}ã®å ´åˆã€‚  &lt;= 'ã€‚$ old-&gt; {$ f-&gt; {right_key}}ã€‚'
                                     ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  + 'ã€‚$ skew_editã€‚'
                                      ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã®ãã®ä»–ã®å ´åˆã€‚  &gt; 'ã€‚$ old-&gt; {$ f-&gt; {right_key}}ã€‚'
                                               ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  -'ã€‚$ skew_treeã€‚'
                                                ELSE 'ã€‚$ F-&gt; {left_key}'ã€‚
                                          çµ‚äº†
                                ENDã€
                     'ã€‚$ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚'  = 'ã€‚$ F-&gt; {right_key}ã®å ´åˆã€‚  &lt;= 'ã€‚$ old-&gt; {$ f-&gt; {right_key}}ã€‚'
                                     THEN 'ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚  + 'ã€‚$ skew_levelã€‚'
                                     ELSE 'ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}'ã€‚
                                ENDã€
                     'ã€‚$ f-&gt; {right_key}'ã€‚  = 'ã€‚$ F-&gt; {right_key}ã®å ´åˆã€‚  &lt;= 'ã€‚$ old-&gt; {$ f-&gt; {right_key}}ã€‚'
                                      THEN 'ã€‚$ F-&gt; {right_key}'ã€‚  + 'ã€‚$ skew_editã€‚'
                                      ã€Œã€‚$ F-&gt; {right_key}ã€ã®å ´åˆã®ãã®ä»–ã®å ´åˆã€‚  &lt;'ã€‚$ new-&gt; {$ f-&gt; {left_key}}'ã€‚
                                                THEN 'ã€‚$ F-&gt; {right_key}'ã€‚  -'ã€‚$ skew_treeã€‚'
                                                ELSE 'ã€‚$ F-&gt; {right_key}ã€‚
                                          çµ‚äº†
                                çµ‚äº†
                ã©ã“
                     'ã€‚ï¼ˆ$ table-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚' = 'ã€‚$ old-&gt; {$ f-&gt; {tree}}ã€‚' AND 'ï¼š' 'ï¼‰ã€‚
                      $ f-&gt; {right_key}ã€‚ '  &gt; 'ã€‚$ old-&gt; {$ f-&gt; {left_key}}ã€‚'  AND 'ã€‚
                      $ f-&gt; {left_key}ã€‚ '  &lt;'ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚'; ';
             $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
             $ new-&gt; {$ f-&gt; {left_key}} = $ new-&gt; {$ f-&gt; {left_key}}-$ skew_tree;
         } else {
 ï¼ƒãƒ„ãƒªãƒ¼ã‚’ä¸Šã«ç§»å‹•ã™ã‚‹
            ç§ã®$ skew_edit = $ new-&gt; {$ f-&gt; {left_key}}-$ old-&gt; {$ f-&gt; {left_key}};
             my $ query = 'UPDATE'ã€‚$ table_nameã€‚ '
                ã‚»ãƒƒãƒˆ
                     'ã€‚$ f-&gt; {right_key}'ã€‚  =ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã€‚  &gt; = 'ã€‚$ old-&gt; {$ f-&gt; {left_key}}'ã€‚
                                      THEN 'ã€‚$ F-&gt; {right_key}'ã€‚  + 'ã€‚$ skew_editã€‚'
                                      ã€Œã€‚$ F-&gt; {right_key}ã€ã®å ´åˆã®ãã®ä»–ã®å ´åˆã€‚  &lt;'ã€‚$ old-&gt; {$ f-&gt; {left_key}}'ã€‚
                                                THEN 'ã€‚$ F-&gt; {right_key}'ã€‚  + 'ã€‚$ skew_treeã€‚'
                                                ELSE 'ã€‚$ F-&gt; {right_key}ã€‚
                                          çµ‚äº†
                                 ENDã€
                     'ã€‚$ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚'  =ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã€‚  &gt; = 'ã€‚$ old-&gt; {$ f-&gt; {left_key}}'ã€‚
                                      THEN 'ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚  + 'ã€‚$ skew_levelã€‚'
                                      ELSE 'ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}'ã€‚
                                 ENDã€
                     'ã€‚$ f-&gt; {left_key}'ã€‚  =ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã€‚  &gt; = 'ã€‚$ old-&gt; {$ f-&gt; {left_key}}'ã€‚
                                     ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  + 'ã€‚$ skew_editã€‚'
                                      ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã®ãã®ä»–ã®å ´åˆã€‚  &gt; = 'ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚
                                               ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  + 'ã€‚$ skew_treeã€‚'
                                                ELSE 'ã€‚$ F-&gt; {left_key}'ã€‚
                                          çµ‚äº†
                                çµ‚äº†
                ã©ã“
                     'ã€‚ï¼ˆ$ table-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚' = 'ã€‚$ old-&gt; {$ f-&gt; {tree}}ã€‚' AND 'ï¼š' 'ï¼‰ã€‚
                     $ f-&gt; {right_key}ã€‚ '  &gt; = 'ã€‚$ new-&gt; {$ f-&gt; {left_key}}ã€‚  AND 'ã€‚
                     $ f-&gt; {left_key}ã€‚ '  &lt;'ã€‚$ old-&gt; {$ f-&gt; {right_key}}ã€‚'; ';
             $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
         }
     }
 ï¼ƒã¾ãšæœ€åˆã«ã€å®Ÿéš›ã«å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã‚’$ newã®ã¾ã¾ã«ã—ã¾ã™ã€‚
    ç§ã®@sets =ï¼ˆï¼‰;
     $ã‚­ãƒ¼ã‚’foreachï¼ˆkeysï¼…{$ new}ï¼‰{
         ï¼ƒãã®ã‚ˆã†ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã¾ã£ãŸãã‚ã‚Šã¾ã›ã‚“
        å‰Šé™¤$ new-&gt; {$ key}ã€æ¬¡ã«å­˜åœ¨ã—ãªã„é™ã‚Š$ old-&gt; {$ key};
         ï¼ƒã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã›ã‚“
         $ new-&gt; {$ key}ã‚’å‰Šé™¤ã€$ old-&gt; {$ key} &amp;&amp; $ new-&gt; {$ key} &amp;&amp; $ new-&gt; {$ key} eq $ old-&gt; {$ key};
         ï¼ƒã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã›ã‚“
        å‰Šé™¤$ new-&gt; {$ key}ã€next ifï¼$ old-&gt; {$ key} &amp;&amp;ï¼$ new-&gt; {$ key};
         ï¼ƒIDã¯å¤‰æ›´ã—ã¾ã›ã‚“ãŒã€å¿µã®ãŸã‚å‰Šé™¤ã—ã¾ã™
        å‰Šé™¤$ new-&gt; {$ key}ã€æ¬¡ã«$ key eq $ f-&gt; {id};
 ï¼ƒåŒã˜ã“ã¨ã€å€¤ãƒã‚§ãƒƒã‚¯ãªã—
         @ setsã€$ã‚­ãƒ¼ã‚’æŠ¼ã—ã¾ã™ã€‚  ã€Œ=ã€ã€‚  ï¼ˆå®šç¾©ã•ã‚ŒãŸ$ new-&gt; {$ key} &amp;&amp; $ new-&gt; {$ key} =ã€œ/ ^ \ d + $ /ï¼Ÿ$ new-&gt; {$ key}ï¼š '"'ã€‚$ new-&gt; {$ key}ã€‚ '"'ï¼‰;
     }
 ï¼ƒå¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°
     my $ query = 'UPDATE'ã€‚$ table_nameã€‚
                    ã€ŒSETã€ï¼ˆã€Œã€ã€ã€@ setsã«å‚åŠ ï¼‰ã€‚
                    'WHERE'ã€‚$ F-&gt; {id}ã€‚ '  = 'ã€‚$ old-&gt; {$ f-&gt; {id}};
     $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
 ï¼ƒç¹°ã‚Šè¿”ã—ã¾ã™ãŒã€UPDATEå¾Œã«è¡Œã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã™ã€‚ã©ã®ãƒˆãƒªã‚¬ãƒ¼ãŒæ›´æ–°ã•ã‚ŒãŸã‹ã¯ã‚ã‹ã‚Šã¾ã›ã‚“
     $ sql = 'SELECT * FROM'ã€‚$ table_nameã€‚ '  WHERE 'ã€‚$ F-&gt; {id}ã€‚'  = 'ã€‚$ old-&gt; {$ f-&gt; {id}}'  LIMIT 1 ';
     $ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
    ç§ã®$ row = $ sth-&gt; fetchrow_hashref;
     $ sth-&gt; finish;
     return {success =&gt; 1ã€row =&gt; $ row};
 }
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     æŒ¿å…¥æ™‚ã¨åŒã˜å„ªå…ˆé †ä½ã€‚ é€ä¿¡ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®å¦¥å½“æ€§ã‚‚ãƒã‚§ãƒƒã‚¯ã•ã‚Œãªã„ã¨ã„ã†äº‹å®Ÿã¯ã€è¦šãˆã¦ãŠã„ã¦ãã ã•ã„ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ6ï¼‰ <pre> ï¼ƒ------------------------------------------------- -------------------------------------------------- --------------------
 ï¼ƒæ›´æ–°
    
     ï¼ƒãƒ„ãƒªãƒ¼ã‚’ä¸‹ã«ç§»å‹•ã™ã‚‹
     my $ update = MY :: NestedSets-&gt; updateï¼ˆ$ table_nameã€{field1 =&gt; 'row-u-1-'ã€‚$ treeã€ids =&gt; 1ã€lk =&gt; 10ã€tr =&gt; $ tree}ï¼‰;
         Dumper $ã®æ›´æ–°ã‚’è­¦å‘Šã—ã¾ã™ã€‚
     ï¼ƒãƒ„ãƒªãƒ¼ã‚’ä¸Šã«ç§»å‹•ã™ã‚‹
     $ update = MY :: NestedSets-&gt; updateï¼ˆ$ table_nameã€{field1 =&gt; 'row-u-4-'ã€‚$ treeã€ids =&gt; 6ã€lk =&gt; 1ã€tr =&gt; $ tree}ï¼‰;
         Dumper $ã®æ›´æ–°ã‚’è­¦å‘Šã—ã¾ã™ã€‚
     ï¼ƒè¦ªã‚’å¤‰æ›´
     $ update = MY :: NestedSets-&gt; updateï¼ˆ$ table_nameã€{field1 =&gt; 'row-u-8-'ã€‚$ treeã€ids =&gt; 2ã€pi =&gt; 5ã€tr =&gt; $ tree}ï¼‰;
         Dumper $ã®æ›´æ–°ã‚’è­¦å‘Šã—ã¾ã™ã€‚
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ãƒãƒ¼ãƒ‰ã‚’å‰Šé™¤ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã™ãã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€å†…éƒ¨ã®ã‚³ãƒ¡ãƒ³ãƒˆï¼š 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ7ï¼‰ <pre>ã‚µãƒ–å‰Šé™¤{
 ï¼ƒç€ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ã«å ´æ‰€ã«é…å¸ƒã—ã€ãã‚Œã«å¿œã˜ã¦ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
    ã‚·ãƒ•ãƒˆif $ _ [0] &amp;&amp;ï¼ˆ$ _ [0] eq __PACKAGE__ ||ï¼ˆref $ _ [0] &amp;&amp; ref $ _ [0] eq __PACKAGE__ï¼‰ï¼‰;
     myï¼ˆ$ table_nameã€$ idã€$ flagï¼‰= @_;
     return {success =&gt; 0ã€error =&gt; 'Bad Income dataï¼'} $ dbh &amp;&amp; $ table_name &amp;&amp; $ id;
 ï¼ƒã©ã‚“ãªç¨®é¡ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¦‹ã¤ã‘ã¦ã€è¿½åŠ ã®å±æ€§ã¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚·ãƒãƒ‹ãƒ ã‚’å–å¾—ã—ã¾ã™
    ç§ã®$ table = $ tables-&gt; {$ table_name} ||  $ tables-&gt; {default};
    ç§ã®$ f = $ table-&gt; {fields};
 ï¼ƒæ¸¡ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ•°ã¨é‡ã®ãƒˆãƒªã‚¬ãƒ¼ã®ã‚ˆã†ã«åˆ¶é™ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€
 ï¼ƒå‰Šé™¤ã®å®Ÿè£…ã¯äºŒé‡ã«ãªã‚Šã¾ã™ï¼šãƒ–ãƒ©ãƒ³ãƒå…¨ä½“ã‚’å‰Šé™¤ã—ã€ãƒ„ãƒªãƒ¼ã®1ã¤ã®ãƒãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã¾ã™
 ï¼ƒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ãƒ–ãƒ©ãƒ³ãƒå…¨ä½“ã‚’å‰Šé™¤ã—ã¾ã™
     $ flag = {cascade =&gt; 'cascade'ã€one =&gt; 'one'}-&gt; {$ flag ||  'ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰'} ||  'ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰';
 ï¼ƒå‰Šé™¤ã™ã‚‹ãƒãƒ¼ãƒ‰ã‚’é¸æŠã—ã¾ã™ã€‚å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã€treeã€left_keyã€right_keyã®3ã¤ã ã‘ã§ã™
 ï¼ƒãã‚Œã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦æ¸¡ã™ã“ã¨ã¯ã§ãã¾ã™ãŒã€ä½•ãŒã‚ã‹ã‚‰ãªã„ã®ã‹ã€ãã®å‰ã«ã‚­ãƒ¼ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€
 ï¼ƒã“ã‚Œã§ãƒ„ãƒªãƒ¼ãŒå´©ã‚Œã¾ã™ã€‚
    ç§ã®$ sql = 'SELECT'ã€‚
             ï¼ˆ$ãƒ†ãƒ¼ãƒ–ãƒ«-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ã€ŒASãƒ„ãƒªãƒ¼ã€ï¼š ''ï¼‰ã€‚
             $ f-&gt; {parent_id}ã€‚ '  AS parent_idã€ 'ã€‚
             $ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚ '  ASãƒ¬ãƒ™ãƒ«ã€ 'ã€‚
             $ f-&gt; {left_key}ã€‚ '  AS left_keyã€ 'ã€‚
             $ f-&gt; {right_key}ã€‚ '  AS right_key 'ã€‚
              ã€ŒFROMã€$ Table_nameã€‚
              'WHERE'ã€‚$ F-&gt; {id}ã€‚ '  = 'ã€‚$ id;
    ç§ã®$ sth = $ dbh-&gt; prepareï¼ˆ$ sqlï¼‰;  $ sth-&gt;å®Ÿè¡Œ||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
    ç§ã®å¤ã„$ $ sth-&gt; fetchrow_hashrefï¼ˆï¼‰;
     $ sth-&gt; finish;
     return {success =&gt; 0ã€error =&gt; 'No old unitï¼'}} $ oldã§ãªã„é™ã‚Š;
     ifï¼ˆ$ flag eq 'cascade'ï¼‰{
 ï¼ƒãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤
         my $ query = 'DELETE FROM'ã€‚$ table_nameã€‚
                    ã€Œã©ã“ã€ã€‚
                         ï¼ˆ$ table-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ '='ã€‚$ old-&gt; {tree}ã€‚ 'AND'ï¼š ''ï¼‰ã€‚
                         $ f-&gt; {left_key}ã€‚ '  &gt; = 'ã€‚$ old-&gt; {left_key}ã€‚'  AND 'ã€‚
                         $ f-&gt; {right_key}ã€‚ '  &lt;= 'ã€‚$ old-&gt; {right_key};
         $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
 ï¼ƒã‚­ãƒ¼ã‚®ãƒ£ãƒƒãƒ—ã‚’å‰Šé™¤ã—ã¾ã™ã€‚
        ç§ã®$ skew_tree = $ old-&gt; {right_key}-$ old-&gt; {left_key} + 1;
         $ query = 'UPDATE' $ table_nameã€‚
                     'SET'ã€‚$ F-&gt; {left_key}ã€‚ '  =ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã€‚  &gt; 'ã€‚$ old-&gt; {left_key}ã€‚'
                                                    ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  -'ã€‚$ skew_treeã€‚'
                                                     ELSE 'ã€‚$ F-&gt; {left_key}'ã€‚
                                                ENDã€ 'ã€‚
                             $ f-&gt; {right_key}ã€‚ '  = 'ã€‚$ f-&gt; {right_key}ã€‚'  -'ã€‚$ skew_treeã€‚
                     ã€Œã©ã“ã€ã€‚
                         ï¼ˆ$ table-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ '='ã€‚$ old-&gt; {tree}ã€‚ 'AND'ï¼š ''ï¼‰ã€‚
                         $ f-&gt; {right_key}ã€‚ '  &gt; 'ã€‚$ old-&gt; {right_key}ã€‚'; ';
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªå½¢å¼ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒUPDATE $ table_name
 ï¼ƒSET left_key = left_key&gt; OLD.left_keyã®å ´åˆ
 ï¼ƒTHEN left_key-$ skew_tree
 ï¼ƒELSE left_key
 ï¼ƒENDã€
 ï¼ƒright_key = right_key-$ skew_tree
 ï¼ƒã©ã“
 ï¼ƒ[tree = OLD.tree AND]
 ï¼ƒright_key&gt; OLD.right_key;
         $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
     } else {
 ï¼ƒãƒãƒ¼ãƒ‰ã‚’å‰Šé™¤
         my $ query = 'DELETE FROM'ã€‚$ table_nameã€‚ '  WHERE 'ã€‚$ F-&gt; {id}ã€‚'  = 'ã€‚$ idã€‚'  LIMIT 1 ';  ï¼ƒçŸ¥ã‚‰ãªã„
         $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
 ï¼ƒã‚®ãƒ£ãƒƒãƒ—ã‚’å‰Šé™¤ã—ã€ä¸‹ä½ãƒ–ãƒ©ãƒ³ãƒã‚’å†æ§‹ç¯‰ã—ã¾ã™
         $ query = 'UPDATE' $ table_nameã€‚
                     'SET'ã€‚$ F-&gt; {left_key}ã€‚ '  =ã€Œã€‚$ F-&gt; {left_key}ã€ã®å ´åˆã€‚  &lt;'ã€‚$ old-&gt; {left_key}ã€‚'
                                                    ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚
                                                     ã€Œã€‚$ F-&gt; {right_key}ã€ã®å ´åˆã®ãã®ä»–ã®å ´åˆã€‚  &lt;'ã€‚$ old-&gt; {right_key}ã€‚'
                                                              ãã‚Œã‹ã‚‰ 'ã€‚$ F-&gt; {left_key}'ã€‚  -1 
                                                               ELSE 'ã€‚$ F-&gt; {left_key}'ã€‚  -2
                                                         çµ‚äº†
                                                ENDã€ 'ã€‚
                             $ f-&gt; {parent_id}ã€‚ '  = 'ã€‚$ F-&gt; {right_key}ã®å ´åˆã€‚  &lt;'ã€‚$ old-&gt; {right_key}ã€‚
                                                           ã€ŒANDã€ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚  = 'ã€‚$ old-&gt; {level}ã€‚'  + 1
                                                      THEN 'ã€‚$ Old-&gt; {parent_id}'
                                                      ELSE 'ã€‚$ F-&gt; {parent_id}'ã€‚
                                                 ENDã€ 'ã€‚
                             $ f-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚ '  = 'ã€‚$ F-&gt; {right_key}ã®å ´åˆã€‚  &lt;'ã€‚$ old-&gt; {right_key}ã€‚'
                                                  THEN 'ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}ã€‚  -1
                                                  ELSE 'ã€‚$ F-&gt; {ãƒ¬ãƒ™ãƒ«}'ã€‚
                                             ENDã€ 'ã€‚
                             $ f-&gt; {right_key}ã€‚ '  = 'ã€‚$ F-&gt; {right_key}ã®å ´åˆã€‚  &lt;'ã€‚$ old-&gt; {right_key}ã€‚'
                                                      THEN 'ã€‚$ F-&gt; {right_key}'ã€‚  -1 
                                                      ELSE 'ã€‚$ F-&gt; {right_key}ã€‚  -2
                                                çµ‚äº†
                       WHERE 'ã€‚
                             ï¼ˆ$ table-&gt; {multi}ï¼Ÿ$ f-&gt; {tree}ã€‚ '='ã€‚$ old-&gt; {tree}ã€‚ 'AND'ï¼š ''ï¼‰ã€‚
                            'ï¼ˆ'ã€‚$ f-&gt; {right_key}ã€‚ '&gt;'ã€‚$ old-&gt; {right_key}ã€‚ 'OR
                             ï¼ˆ 'ã€‚$ f-&gt; {left_key}ã€‚'&gt; 'ã€‚$ old-&gt; {left_key}ã€‚' AND 'ã€‚$ f-&gt; {right_key}ã€‚' &lt;'ã€‚$ old-&gt; {right_key}ã€‚'ï¼‰ï¼‰ ; ';
 ï¼ƒèª­ã¿å–ã‚Šå¯èƒ½ãªå½¢å¼ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼š
 ï¼ƒUPDATE $ table_name
 ï¼ƒSET left_key = left_key &lt;OLD.left_keyã®å ´åˆ
 ï¼ƒTHEN left_key
 ï¼ƒãã®ä»–ã®å ´åˆright_key &lt;OLD.right_key
 ï¼ƒTHEN left_key-1 
 ï¼ƒELSE left_key-2
 ï¼ƒEND
 ï¼ƒENDã€
 ï¼ƒparent_id = right_key &lt;OLD.right_key AND `level` = OLD.level + 1ã®å ´åˆ
 ï¼ƒTHEN OLD.parent_id
 ï¼ƒELSE parent_id
 ï¼ƒENDã€
 ï¼ƒ `level` = right_key &lt;OLD.right_keyã®å ´åˆ
 ï¼ƒTHEN `ãƒ¬ãƒ™ãƒ«`-1 
 ï¼ƒELSE `ãƒ¬ãƒ™ãƒ«`
 ï¼ƒENDã€
 ï¼ƒright_key = right_key &lt;OLD.right_keyã®å ´åˆ
 ï¼ƒTHEN right_key-1 
 ï¼ƒELSE right_key-2
 ï¼ƒEND
 ï¼ƒã©ã“
 ï¼ƒ[tree = OLD.tree AND]
 ï¼ƒï¼ˆright_key&gt; OLD.right_key OR
 ï¼ƒï¼ˆleft_key&gt; OLD.left_key AND right_key &lt;OLD.right_keyï¼‰ï¼‰;
         $ dbh-&gt; doï¼ˆ$ queryï¼‰||  return {success =&gt; 0ã€error =&gt; $ dbh-&gt; errstr};
     }
     return {æˆåŠŸ=&gt; 1};
 }
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     æ­£ç›´ã«è¨€ã†ã¨ã€çµæœã¨ã—ã¦è¿”ã™ã®ã«ä½•ãŒæ­£ã—ã„ã‹ã¯ã¾ã ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€æˆåŠŸã—ãŸã¨ã„ã†ãƒ•ãƒ©ã‚°ã ã‘ã§ååˆ†ãªã‚ˆã†ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚³ãƒ¼ãƒ‰ï¼ˆ8ï¼‰ <pre>     my $ delete = MY :: NestedSets-&gt; deleteï¼ˆ$ table_nameã€2ï¼‰;
     $ delete = MY :: NestedSets-&gt; deleteï¼ˆ$ table_nameã€3ã€ 'one'ï¼‰;
     $ delete = MY :: NestedSets-&gt; deleteï¼ˆ$ table_nameã€4ï¼‰;
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å®Ÿéš›ã«ã¯ãã‚Œã ã‘ã§ã™ã€‚ è¼ããƒ•ãƒ©ãƒ³ãƒãƒ«ã®å¸ƒã§æ‹­ã„ã¦ã€è¡Œã£ã¦ãã ã•ã„ã€‚ </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J65482/index.html">FBIã¯1æ—¥ã‚ãŸã‚Š200,000ã®æŒ‡ç´‹ã‚’åˆ†æã—ã¾ã™</a></li>
<li><a href="../J65483/index.html">42æšã®ãƒ•ãƒ­ãƒƒãƒ”ãƒ¼ãƒ‡ã‚£ã‚¹ã‚¯</a></li>
<li><a href="../J65487/index.html">Yandexã¯ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¬¡ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ã‚ã‚‹Arzamas 1.2ã®ãƒ†ã‚¹ãƒˆã‚’ç™ºè¡¨ã—ã¾ã—ãŸ</a></li>
<li><a href="../J65492/index.html">å¥½ãã§ã¯ãªã‹ã£ãŸ</a></li>
<li><a href="../J65493/index.html">Habrã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ</a></li>
<li><a href="../J65498/index.html">ãƒ­ã‚·ã‚¢ã§ã®é›»å­ãƒãƒãƒ¼ã®å¼•ãå‡ºã—æ–¹æ³•ã®æ¦‚è¦</a></li>
<li><a href="../J65499/index.html">ASUS Eee PC 1004DN-DVDãƒ‰ãƒ©ã‚¤ãƒ–ã‚’æ­è¼‰ã—ãŸæœ€åˆã®ãƒãƒƒãƒˆãƒ–ãƒƒã‚¯ã®è²©å£²ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ</a></li>
<li><a href="../J65503/index.html">Pythonã§2ãƒ¡ã‚¬ãƒã‚¤ãƒˆã®ãƒ¡ãƒ¢ãƒªã§100ä¸‡å€‹ã®32ãƒ“ãƒƒãƒˆæ•´æ•°ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹</a></li>
<li><a href="../J65504/index.html">ãƒˆãƒ©ãƒ³ã‚¹ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ</a></li>
<li><a href="../J65512/index.html">dNaNoã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>