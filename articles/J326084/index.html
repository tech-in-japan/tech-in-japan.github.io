<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•µğŸ» âŒ ğŸ›µ ç™»éŒ²ãŠã‚ˆã³SMSã‚’ä½¿ç”¨ã—ãªã„ç¾åœ¨ã®è„†å¼±æ€§ã®ç›£æŸ» ğŸŒ´ ğŸ‘Š ğŸ‘ˆğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã‚¨ãƒ³ãƒˆãƒªãƒ¼  
  
  ISãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’è³¼èª­ã—ãŸã“ã¨ãŒã‚ã‚‹äººãªã‚‰èª°ã§ã‚‚çŸ¥ã£ã¦ã„ã‚‹ã‚ˆã†ã«ã€1æ—¥ã«ç™ºè¦‹ã•ã‚Œã‚‹è„†å¼±æ€§ã®æ•°ã¯ã€ãã®äººãŒãã‚Œã‚‰ã‚’è§£æã™ã‚‹èƒ½åŠ›ã‚’è¶…ãˆã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ ç‰¹ã«ã‚µãƒ¼ãƒãƒ¼ãŒå¤šæ•°ã‚ã‚‹å ´åˆã€ç‰¹ã«OSã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å‹•ç‰©åœ’ãŒã‚ã‚‹å ´åˆã€‚ 
  
 
  
 ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã§ã¯ã€ã“ã®å•é¡Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>ç™»éŒ²ãŠã‚ˆã³SMSã‚’ä½¿ç”¨ã—ãªã„ç¾åœ¨ã®è„†å¼±æ€§ã®ç›£æŸ»</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/326084/"><h2> ã‚¨ãƒ³ãƒˆãƒªãƒ¼ </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/94e/2ba/f9f/94e2baf9f78449f3aea373e05165928c.png" align="left" height="180">  ISãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’è³¼èª­ã—ãŸã“ã¨ãŒã‚ã‚‹äººãªã‚‰èª°ã§ã‚‚çŸ¥ã£ã¦ã„ã‚‹ã‚ˆã†ã«ã€1æ—¥ã«ç™ºè¦‹ã•ã‚Œã‚‹è„†å¼±æ€§ã®æ•°ã¯ã€ãã®äººãŒãã‚Œã‚‰ã‚’è§£æã™ã‚‹èƒ½åŠ›ã‚’è¶…ãˆã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ ç‰¹ã«ã‚µãƒ¼ãƒãƒ¼ãŒå¤šæ•°ã‚ã‚‹å ´åˆã€ç‰¹ã«OSã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å‹•ç‰©åœ’ãŒã‚ã‚‹å ´åˆã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã§ã¯ã€ã“ã®å•é¡Œã‚’ã©ã®ã‚ˆã†ã«è§£æ±ºã—ãŸã‹ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ ãã—ã¦ã€ã¯ã„ã€Perl <b>*ã¯</b>ç”Ÿãã¦ã„ã¾ã™:) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> ç›®æ¨™ã¨ç›®çš„ </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­è¨ˆã™ã‚‹éš›ã€ <a href="https://habr.com/users/mkhlystun/" class="user_link">mkhlystun</a> <b>**ã¨ç§ã¯</b> 2ã¤ã®ä¸¦è¡Œå•é¡Œ<b>ã‚’</b>è§£æ±ºã—ã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®åé›† </li><li> ã‚·ã‚¹ãƒ†ãƒ ã®ç¾åœ¨ã®è„†å¼±æ€§ã«é–¢ã™ã‚‹æƒ…å ±ã®åé›† </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã‚Œã‚‰ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¯ä¸¡æ–¹ã¨ã‚‚å…±é€šã®ç›®æ¨™ã‚’è¿½æ±‚ã—ã¾ã—ãŸï¼šæ›´æ–°ã‚’æ­£ã—ãå„ªå…ˆé †ä½ä»˜ã‘ã—ã€ä¿è¨¼ã•ã‚ŒãŸãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã§ã“ã‚Œã‚‰ã®æ›´æ–°ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> ä½œæ¥­ã‚¹ã‚­ãƒ¼ãƒ  </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/200/c43/403/200c43403a2541a4a82c4857e1b7218b.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  1æ™‚é–“ã«1å›ã€å„ãƒ›ã‚¹ãƒˆã¯ç¾åœ¨ã®ãƒ‘ã‚±ãƒƒãƒˆã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã€ãã®ã‚­ãƒ¥ãƒ¼ã‚’é€ä¿¡ã—ã¾ã™ </li><li> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚­ãƒ¥ãƒ¼ã‹ã‚‰å‰Šé™¤ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é…ç½®ã•ã‚Œã¾ã™ </li><li>  3æ™‚é–“ã«1å›ã€ãƒ­ãƒœãƒƒãƒˆãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ç›£æŸ»ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä»‹ã—ã¦ãƒ‘ã‚±ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ </li><li>  1æ—¥ã®çµæœã«å¿œã˜ã¦ã€é–¢å¿ƒã®ã‚ã‚‹ã™ã¹ã¦ã®äººã«é€ä¿¡ã•ã‚Œã‚‹ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã™ </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> åŸºæœ¬ã‚¹ã‚­ãƒ¼ãƒ  </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">pkgs.sql</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">hosts</span></span> ( hostname <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>, os <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), pkg_id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>[] ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> hosts_pkg_id_idx <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">hosts</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> gin (pkg_id); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> pkg ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SERIAL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNIQUE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> pkg_name_idx <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> pkg <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> btree (<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> vulners ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>, cvss_score <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, cvss_vector <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), description <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, cvelist <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> v2p ( pkg_id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> pkg(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>), vuln_id <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> vulners(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) );</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ›ã‚¹ãƒˆã®æƒ…å ±ã¯<i>ãƒ›ã‚¹ãƒˆ</i>ãƒ†ãƒ¼ãƒ–ãƒ«ã«å…¥åŠ›ã•ã‚Œï¼ˆ1ãƒ›ã‚¹ãƒˆ= 1ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã€ <i>pkg</i>ã®æƒ…å ±ã¯æƒ…å ±ã®é‡è¤‡ã‚’é¿ã‘ã‚‹ãŸã‚ã«ä¸¦è¡Œã—ã¦å…¥åŠ›ã•ã‚Œã¾ã™ï¼ˆ1ãƒ‘ã‚±ãƒƒãƒˆ<i>-1</i>ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã€‚ ã‚¢ãƒ¬ã‚¤ã¯æ­´å²çš„ã«é¸æŠã•ã‚ŒãŸã‚‚ã®ã§ã‚ã‚Šã€ãã‚Œã¨å…±ã«ç”Ÿãã‚‹ã“ã¨ã¯éå¸¸ã«å¯èƒ½ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     åŒæ™‚ã«ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç¾åœ¨ã®è„†å¼±æ€§ã«é–¢ã™ã‚‹æƒ…å ±ãŒè„†å¼±æ€§ãƒ†ãƒ¼ãƒ–ãƒ«ã«å…¥åŠ›ã•ã‚Œã€ <i>v2p</i>é€šä¿¡<i>ãƒ†ãƒ¼ãƒ–ãƒ«</i>ã¯å¤š<i>å¯¾å¤šã®</i>ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¨±å¯ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> ãƒ‘ã‚±ãƒƒãƒˆæƒ…å ±åé›† </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">grabber.pl</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl # (C) Ivan Agarkov 2016 use strict; use warnings; use JSON; # config our %grabs = ( 'centos|oraclelinux|redhat|fedora' =&gt; q(rpm -aq), 'debian|ubuntu' =&gt; q(dpkg-query -W -f='${Package} ${Version} ${Architecture}\n'), 'osx' =&gt; q(pkgutil --pkgs) ); our %unames = ( 'linux' =&gt; q(lsb_release -a), 'darwin' =&gt; q(echo "Distributor ID: OSX") ); # global vars our $hostname = `hostname -f`; our ($vercmd, $grabcmd, $operatingsystem, $version); # do uname my $uname = `uname`; chomp $uname; foreach (keys %unames) { $vercmd = $unames{$_} if $uname =~ /$_/i; } die "Version CMD not found" unless $vercmd; # do version check foreach (`$vercmd`) { chomp; /^Distributor ID:\s*(\S[\S\s]+)$/ and $operatingsystem = $1; /^Release:\s*(\S[\S\s]+)$/ and $version = $1; } die "Opetating System not found" unless $operatingsystem; foreach (keys %grabs) { $grabcmd = $grabs{$_} if $operatingsystem =~ /$_/i; } # grab pkgs die "Opetating System not found" unless $grabcmd; my @pkgs; foreach (`$grabcmd`) { chomp; push @pkgs, $_; } chomp $hostname; my $result = { hostname =&gt; $hostname, os =&gt; $version ? qq($operatingsystem $version) : $operatingsystem, pkgs =&gt; [ sort @pkgs ] }; # print JSON-&gt;new-&gt;encode($result); # done 1;</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perlã‚’çŸ¥ã‚‰ãªã„äººã®ãŸã‚ã«ï¼š <i>ãƒ›ã‚¹ãƒˆå-f</i> ã€ <i>lsb_release -a</i>ãŠã‚ˆã³<i>rpm -aq | dpkg-query -W</i>ã‚³ãƒãƒ³ãƒ‰ã¯å˜ç´”ã«é€£ç¶šã—ã¦å®Ÿè¡Œã•ã‚Œã€ã“ã‚Œã‚‰ã¯ã™ã¹ã¦JSONã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã•ã‚Œã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  JSONã‚’ãƒ™ãƒ¼ã‚¹ã«å¤‰æ›ã™ã‚‹ </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">transform.pl</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl # (C) Ivan Agarkov 2016 use strict; use warnings; use JSON; use DBI; use constant DB =&gt; 'dbi:Pg:dbname=pkgs'; # 0. create connection my $dbh = DBI-&gt;connect( DB, "", "", { RaiseError =&gt; 1, AutoCommit =&gt; 0 } ); # 1. read from stdin and parse my $data = JSON-&gt;new-&gt;decode( join( "", &lt;STDIN&gt; ) ); # if data == array parse foeach if ( ref($data) eq "ARRAY" ) { foreach (@$data) { parse_host($_); } } else { parse_host($data); } # Done 1; ### SUBS ### sub parse_host { $_ = shift; # do parse packages my ( $hostname, $os, @pkgs ) = ( $_-&gt;{hostname}, $_-&gt;{os}, @{ $_-&gt;{pkgs} } ); my @pkgids; eval { foreach (@pkgs) { my $sth = $dbh-&gt;prepare("SELECT id FROM pkg WHERE name=?"); $sth-&gt;execute( ($_) ); if ( my ($id) = $sth-&gt;fetchrow_array ) { push @pkgids, int($id); } else { $dbh-&gt;do( "INSERT INTO pkg (name) VALUES(?)", undef, $_ ); push @pkgs, $_; } } }; $dbh-&gt;rollback and die "$@" if $@; $dbh-&gt;commit; # do parse host eval { my $sth = $dbh-&gt;prepare("SELECT os FROM hosts WHERE hostname=?"); $sth-&gt;execute( ($hostname) ); if ( my ($os2) = $sth-&gt;fetchrow_array ) { if ( lc($os2) ne lc($os) ) { $dbh-&gt;do( "UPDATE hosts SET os=? WHERE hostname=?", undef, $os, $hostname ); } } else { $dbh-&gt;do( "INSERT INTO hosts (hostname, os) VALUES(?, ?)", undef, $hostname, $os ); } }; $dbh-&gt;rollback and die "$@" if $@; $dbh-&gt;commit; # do set packages eval { $dbh-&gt;do( "UPDATE hosts SET pkg_id=? WHERE hostname=?", undef, [@pkgids], $hostname ); }; $dbh-&gt;rollback and die "$@" if $@; $dbh-&gt;commit; }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ã‚­ãƒ¥ãƒ¼ã‹ã‚‰å—ä¿¡ã—ãŸjsonã‚’å—ä¿¡ã—ã€æ¬¡ã®3ã¤ã®æ®µéšã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åˆ†è§£ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -æœ€åˆã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’é…ç½®ã—ã€ãã®ä¸€æ„æ€§ã‚’ç¢ºèªã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -æ¬¡ã«ã€ãƒ›ã‚¹ãƒˆã‚’é…ç½®ã—ã€å¿…è¦ã«å¿œã˜ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -æ¬¡ã«ã€ã‚¢ãƒ¬ã‚¤ã‚’ä»‹ã—ã¦ãƒ›ã‚¹ãƒˆã¨ãƒ‘ã‚±ãƒƒãƒˆã‚’ãƒã‚¤ãƒ³ãƒ‰ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> ç›£æŸ» </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èãæ–¹æ³•ã‚’æ¢ã—ã¦ã„ãŸã¨ãã€ã‚ã‚‹ç¨®ã®ä¼šè­°ã§<a href="http://vulners.com/">vulnersã¨å‘¼ã°ã‚Œã‚‹</a>ååˆºã‚’è¦‹ã‚‹ã¾ã§ã€é•·ã„é–“ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä¸¦ã¹æ›¿ãˆã¦ã„ã¾ã—ãŸã€‚ ã“ã‚Œã¯<a href="https://habr.com/users/isox/" class="user_link">isox</a>ã¨<a href="https://habr.com/users/videns/" class="user_link">vidensãŒè¡Œã†</a>è„†å¼±æ€§ã‚¢ã‚°ãƒªã‚²ãƒ¼ã‚¿ãƒ¼<a href="https://habr.com/users/videns/" class="user_link">ã§ã™</a> ã€‚ ç§ã¯å½¼ã‚‰ã«é€£çµ¡ã—ã€åŠ©ã‘ã‚’æ±‚ã‚ã¾ã—ãŸã€‚ ãã®çµæœãŒ<a href="https://vulners.com/audit">Audit API</a>ã§ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ç›£æŸ»API</b> <div class="spoiler_text"> è„†å¼±æ€§ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€jsonã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸blobã‚’åé›†ã—ã¦<i>/ api / v3 / audit / audit /ã«</i>é€ä¿¡ã™ã‚‹ã ã‘ã§ååˆ†ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql">POST /api/v3/audit/audit/ HTTP/<span class="hljs-number"><span class="hljs-number">1.0</span></span> Host: vulners.com Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: application/<span class="hljs-type"><span class="hljs-type">json</span></span> Content-Length: <span class="hljs-number"><span class="hljs-number">377</span></span> { "os":"CentOS", "version":"7", "package":["kernel-3.10.0-229.el7.x86_64"]}</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å¿œç­”ã¨ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã¯ç¾åœ¨ã®è„†å¼±æ€§ã®ãƒªã‚¹ãƒˆã‚’æ¬¡ã®å½¢å¼ã§jsonã«è¿”ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs ruby">{ <span class="hljs-string"><span class="hljs-string">"result"</span></span>: <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-string"><span class="hljs-string">"data"</span></span>: { <span class="hljs-string"><span class="hljs-string">"packages"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>: { <span class="hljs-string"><span class="hljs-string">"CESA-2015:2152"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"package"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"providedVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"0:3.10.0-229.el7"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"3.10.0-327.el7"</span></span>, <span class="hljs-string"><span class="hljs-string">"providedPackage"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinPackage"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-327.el7.x86_64.rpm"</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"lt"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinID"</span></span>: <span class="hljs-string"><span class="hljs-string">"CESA-2015:2152"</span></span> } ], <span class="hljs-string"><span class="hljs-string">"CESA-2015:1978"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"package"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"providedVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"0:3.10.0-229.el7"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"3.10.0-229.20.1.el7"</span></span>, <span class="hljs-string"><span class="hljs-string">"providedPackage"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinPackage"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.20.1.el7.src.rpm"</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"lt"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinID"</span></span>: <span class="hljs-string"><span class="hljs-string">"CESA-2015:1978"</span></span> }, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> skipped ], <span class="hljs-string"><span class="hljs-string">"CESA-2016:0064"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"package"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"providedVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"0:3.10.0-229.el7"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"3.10.0-327.4.5.el7"</span></span>, <span class="hljs-string"><span class="hljs-string">"providedPackage"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-229.el7.x86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinPackage"</span></span>: <span class="hljs-string"><span class="hljs-string">"kernel-3.10.0-327.4.5.el7.src.rpm"</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"lt"</span></span>, <span class="hljs-string"><span class="hljs-string">"bulletinID"</span></span>: <span class="hljs-string"><span class="hljs-string">"CESA-2016:0064"</span></span> }, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> skipped ], <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> skipped ], <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> skipped <span class="hljs-string"><span class="hljs-string">"cvss"</span></span>: { <span class="hljs-string"><span class="hljs-string">"score"</span></span>: <span class="hljs-number"><span class="hljs-number">10.0</span></span>, <span class="hljs-string"><span class="hljs-string">"vector"</span></span>: <span class="hljs-string"><span class="hljs-string">"AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"</span></span> }, <span class="hljs-string"><span class="hljs-string">"cvelist"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"CVE-2014-9644"</span></span>, <span class="hljs-string"><span class="hljs-string">"CVE-2016-2384"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> skipped ], <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"F777"</span></span> } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      APIã‚’å®Ÿè¡Œã—ãŸå¾Œã€OSã«ã‚ˆã£ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒªã‚¹ãƒˆã‚’ãƒ—ãƒƒã‚·ãƒ¥ã—ã€ãã‚Œã«å¿œã˜ã¦è„†å¼±æ€§ã®ãƒªã‚¹ãƒˆã‚’å—ã‘å–ã£ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å…¥ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">audit.pl</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl # (C) Ivan Agarkov 2016 use strict; use warnings; use lib 'perl5'; use HTTP::Tiny; use DBI; use JSON; use constant VULNERS_AUDIT_API =&gt; 'http://vulners.com/api/v3/audit/audit/'; use constant VULNERS_ID_API =&gt; 'http://vulners.com/api/v3/search/id/'; use constant DB =&gt; 'dbi:Pg:dbname=pkgs'; our %VULNS; our $dbh; our %pkgs = (); # 0. connect to DB $dbh = DBI-&gt;connect( DB, "", "", { RaiseError =&gt; 1, AutoCommit =&gt; 0 } ); # get all OS variations my @os = get_os(); # for each OS get all packages and ask vulners for its vulnerabilities foreach my $os (@os) { eval { my ( $o, $ver ) = split( / /, $os ); my $res = HTTP::Tiny-&gt;new-&gt;request( 'POST', VULNERS_AUDIT_API, { headers =&gt; { 'Content-Type' =&gt; 'application/json' }, content =&gt; JSON-&gt;new-&gt;encode( { os =&gt; $o, version =&gt; $ver, package =&gt; [ get_packages($os) ] } ) } ); if ( !$res-&gt;{success} ) { die "HTTP Error: $res-&gt;{content}"; } my $data = JSON-&gt;new-&gt;decode( $res-&gt;{content} ); my $vulns = $data-&gt;{data}-&gt;{packages}; return undef unless defined $vulns; foreach ( keys %$vulns ) { my $o = $vulns-&gt;{$_}; if ( defined( $pkgs{$_} ) ) { $VULNS{ $pkgs{$_} } = [ keys %$o ]; } } }; print $@ if $@; } # Now get info on each vuln ID ( CESA, USN, etc ) ... my @result; my $res = HTTP::Tiny-&gt;new-&gt;request( 'POST', VULNERS_ID_API, { headers =&gt; { 'Content-Type' =&gt; 'application/json' }, content =&gt; JSON-&gt;new-&gt;encode( { id =&gt; [ map {@$_} values %VULNS ] } ) } ); if ( !$res-&gt;{success} ) { die "HTTP Error: $res-&gt;{content}"; } my $data = JSON-&gt;new-&gt;decode( $res-&gt;{content} ); foreach ( values %{ $data-&gt;{data}-&gt;{documents} } ) { push @result, { id =&gt; $_-&gt;{id}, cvss_score =&gt; $_-&gt;{cvss}-&gt;{score}, cvss_vector =&gt; $_-&gt;{cvss}-&gt;{vector}, description =&gt; $_-&gt;{description}, cvelist =&gt; join( ', ', @{ $_-&gt;{cvelist} } ), }; } # Insert the data to DB eval { $dbh-&gt;do( "DELETE FROM v2p", undef ); $dbh-&gt;do( "DELETE FROM vulners", undef ); # insert prepared data to vulners table foreach (@result) { $dbh-&gt;do( "INSERT INTO vulners (id, cvss_score, cvss_vector, description, cvelist) VALUES (?,?,?,?,?)", undef, $_-&gt;{id}, $_-&gt;{cvss_score}, $_-&gt;{cvss_vector}, $_-&gt;{description}, $_-&gt;{cvelist} ); } # and link pkg and vuls into v2p foreach my $pkg_id ( keys %VULNS ) { foreach my $vuln_id ( @{ $VULNS{$pkg_id} } ) { $dbh-&gt;do( "INSERT INTO v2p(pkg_id,vuln_id) VALUES(?,?)", undef, $pkg_id, $vuln_id ); } } }; $dbh-&gt;rollback and die "Error $@" if $@; $dbh-&gt;commit; # All done 1; ### SUBS #### sub get_os { my @os; my $sth = $dbh-&gt;prepare("SELECT DISTINCT os FROM hosts"); $sth-&gt;execute(); while ( my ($os) = $sth-&gt;fetchrow_array ) { push @os, $os; } return @os; } sub get_packages { my $os = shift; my $sth = $dbh-&gt;prepare( "select DISTINCT p.id,p.name FROM pkg p RIGHT JOIN hosts h ON (p.id=ANY(h.pkg_id)) WHERE h.os=?" ); $sth-&gt;execute( ($os) ); my @pkgs; while ( my ( $id, $name ) = $sth-&gt;fetchrow_array ) { $pkgs{$name} = $id; push @pkgs, $name; } return @pkgs; }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼š 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -ãƒ›ã‚¹ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰OSã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -å„OSã«ã¤ã„ã¦ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -ç›£æŸ»APIã«ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã—ã€è„†å¼±æ€§ã®ãƒªã‚¹ãƒˆï¼ˆIDï¼‰ã‚’å–å¾—ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -Api IDã§è„†å¼±æ€§ã‚’é€ä¿¡ã—ã€å„ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§å—ä¿¡ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -ãƒ†ãƒ¼ãƒ–ãƒ«è„†å¼±æ€§ã®è„†å¼±æ€§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ›¸ãè¾¼ã¿ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -v2pãƒ†ãƒ¼ãƒ–ãƒ«ã®é€šä¿¡ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨è„†å¼±æ€§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ›¸ãè¾¼ã¿ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> å ±å‘Šæ›¸ </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ç§ãŸã¡ã®ä¸»ãªç›®æ¨™ã¯å„ªå…ˆåº¦ã®é«˜ã„ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ãƒ›ã‚¹ãƒˆã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹ã“ã¨ã ã£ãŸã®ã§ã€æœ€åˆã«ä½œæˆã—ãŸãƒ¬ãƒãƒ¼ãƒˆã¯ã€ŒCVSSã‚¹ã‚³ã‚¢ã®åˆè¨ˆ<b>***ã«</b>åŸºã¥ã„ã¦é¸æŠã•ã‚ŒãŸã€Œã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ä¸Šä½10ãƒ›ã‚¹ãƒˆã€ã€ã§ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">report.pl</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl # (C) Ivan Agarkov 2016 use strict; use warnings; use lib 'perl5'; use HTTP::Tiny; use DBI; use JSON; use constant DB =&gt; 'dbi:Pg:dbname=pkgs'; our $dbh; our @hosts; # 0. connect to DB $dbh = DBI-&gt;connect( DB, "", "", { RaiseError =&gt; 1, AutoCommit =&gt; 0 } ); # get top10 hosts my $sth = $dbh-&gt;prepare("SELECT h.hostname,SUM(v.cvss_score) as sum FROM hosts h INNER JOIN pkg p ON(p.id=ANY(h.pkg_id)) INNER JOIN v2p vp ON(vp.pkg_id=p.id) INNER JOIN vulners v ON (v.id=vp.vuln_id) GROUP BY h.hostname ORDER BY sum DESC LIMIT 10"); $sth-&gt;execute(); while (my ($host, $sum) = $sth-&gt;fetchrow_array) { push @hosts, { hostname =&gt; $host, score =&gt; $sum, pkgs =&gt; [] }; } foreach (@hosts) { $sth = $dbh-&gt;prepare("SELECT p.name,SUM(v.cvss_score) AS score FROM pkg p RIGHT JOIN hosts h ON (p.id=ANY(h.pkg_id)) INNER JOIN v2p ON (v2p.pkg_id=p.id) INNER JOIN vulners v ON (v.id=v2p.vuln_id) WHERE h.hostname=? GROUP BY p.name ORDER BY score DESC LIMIT 10"); $sth-&gt;execute(($_-&gt;{hostname})); while(my ($pkg,$sum) = $sth-&gt;fetchrow_array) { push @{$_-&gt;{pkgs}}, { package =&gt; $pkg, score =&gt; $sum }; } } print &lt;&lt;EOF TOP 10 SERVERS TO UPDATE EOF ; foreach (@hosts) { print &lt;&lt;EOF -------------------------------------------------- Hostname: $_-&gt;{hostname} Score : $_-&gt;{score} Packages: EOF ; foreach (@{$_-&gt;{pkgs}}) { print &lt;&lt;EOF Name : $_-&gt;{package} Score: $_-&gt;{score} EOF } }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã®ã‚³ãƒ¼ãƒ‰ã¯å˜ç´”ã«ä¸Šä½10å€‹ã®ãƒ›ã‚¹ãƒˆã‚’å–å¾—ã—ã€ãã‚Œãã‚ŒãŒä¸Šä½10å€‹ã®ãƒ‘ã‚±ãƒƒãƒˆã‚’åˆè¨ˆé€Ÿåº¦ã§å–å¾—ã—ã¾ã™ã€‚ ãã®å¾Œã€ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¦æ›´æ–°ã§ãã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> ä½¿ç”¨å¹´ã®çµæœ </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1å¹´ä»¥ä¸Šã«ã‚ãŸã£ã¦ã€Vulnersã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¦ã„ã¾ã™ã€‚ ç¾åœ¨ã€å½¼ã‚‰ã¯30,000ä»¥ä¸Šã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å¸¸ã«ç›£æŸ»ã—ã¦ã„ã¾ã™ã€‚ å¬‰ã—ã„ã“ã¨ã«ã€è¦‹ã¤ã‹ã£ãŸã™ã¹ã¦ã®ãƒã‚°ã¯ã™ãã«ä¿®æ­£ã•ã‚Œã€å„1,000ã®å‡¦ç†é€Ÿåº¦ã¯30ç§’ã‹ã‚‰400ãƒŸãƒªç§’ã«å¢—åŠ ã—ã¾ã—ãŸã€‚ ã“ã®ãƒˆãƒ”ãƒƒã‚¯ãŒã€Œ...ç™»éŒ²ã¨SMSãªã—ã§ã€ã¨å‘¼ã°ã‚Œã‚‹ã®ã¯å½¼ã‚‰ã®ãŠã‹ã’ã§ã™ï¼‰ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ“ã‚¸ãƒã‚¹ç›®æ¨™ã«é–¢ã—ã¦ã¯ã€ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥ã«ã‚ˆã£ã¦åˆã‚ã¦ã€çµ¶ãˆé–“ãªã„æ›´æ–°ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒç¾ã‚Œå§‹ã‚ã¾ã—ãŸã€‚ ã™ã¹ã¦ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã¯ã€å‹¤å‹™ä¸­ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã¨ã£ã¦éå¸¸ã«å¤§ããªä½œæ¥­ã§ã‚ã‚Šã€æœ€åˆã®10å€‹ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã¯éå¸¸ã«ç¾å®Ÿçš„ã§ã™ã€‚ å¹´é–“ã‚’é€šã—ã¦ã€åˆè¨ˆcvssã‚¹ã‚³ã‚¢ãŒ2å›ä»¥ä¸Šä½ä¸‹ã—ã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> è„šæ³¨ã¨èª¬æ˜ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>*</b> -ãã‚Œã¯æ­´å²çš„ã«èµ·ã“ã‚Šã€Perlã§è‡ªå‹•åŒ–ã®è¨˜è¿°ã‚’å§‹ã‚ã¾ã—ãŸãŒã€ã ã‚Œã‚‚ç§ã‚’æ­¢ã‚ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>**</b> -ãƒŸã‚·ãƒ£ã¯Habrã®ã‚ã¾ã‚Šã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ã¯ä¸å¯æ¬ ã§ã™:) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>***</b> -1.0ï¼ˆã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°å¯èƒ½ï¼‰ã‹ã‚‰10.0ï¼ˆé‡å¤§ãªè„†å¼±æ€§ï¼‰ã®ãƒ‡ã‚¸ã‚¿ãƒ«è„†å¼±æ€§ãƒã‚¶ãƒ¼ãƒ‰ãƒ¡ãƒˆãƒªãƒƒã‚¯ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>****</b> -ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã“ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š <a href="https://github.com/annmuor/freeaudit/">github.com/annmuor/freeaudit</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>PS</b>ãã—ã¦ãã‚Œã«ã‚‚ã‹ã‹ã‚ã‚‰ãš-Perlã¯ç”Ÿãã¦ã„ã¾ã™ï¼ </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J326072/index.html">Bitrix24ã¨ã®3CXçµ±åˆ-ç„¡æ–™ã®CRMãƒ—ãƒ©ã‚°ã‚¤ãƒ³</a></li>
<li><a href="../J326074/index.html">éåŒæœŸ/å¾…æ©Ÿï¼šç´„æŸã‚’å¿˜ã‚Œã‚‹6ã¤ã®ç†ç”±</a></li>
<li><a href="../J326076/index.html">ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯IPv4ã‚’ä½¿ç”¨ã—ãŸMikrotik 6to4ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</a></li>
<li><a href="../J326078/index.html">WindowsãŠã‚ˆã³Linuxç”¨ã®MASMã€TASMã€FASMã€NASM</a></li>
<li><a href="../J326082/index.html">Huawei HyperMetro-ãƒ†ã‚¹ãƒˆãŠã‚ˆã³å®Ÿè£…</a></li>
<li><a href="../J326088/index.html">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ™ãƒ¼ã‚¹ã®çµ±åˆã€‚ ä»–ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã®åˆ©ç‚¹ã¨é•ã„</a></li>
<li><a href="../J326094/index.html">Storage Performance Development Kitï¼ˆSPDKï¼‰ã®æ¦‚è¦</a></li>
<li><a href="../J326096/index.html">PostgreSQLã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹-1</a></li>
<li><a href="../J326098/index.html">CSSã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰</a></li>
<li><a href="../J3261/index.html">Googleã¯ãƒ™ãƒ«ã‚®ãƒ¼ã®å‡ºç‰ˆç¤¾ã«300ä¸‡ãƒ¦ãƒ¼ãƒ­ã®ç½°é‡‘ã‚’æ”¯æ‰•ã†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>