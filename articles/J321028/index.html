<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ½â€âš–ï¸ ğŸ‘²ğŸ¿ ğŸ§ åˆ¥ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨˜è¿°ã—ã€ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’æ§‹æˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ğŸ†’ ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ¿ ğŸ“ƒ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿå™¨ãƒ¡ãƒ¼ã‚«ãƒ¼ã¯ã€ã‚¤ãƒ³ãƒ‡ã‚£ã‚±ãƒ¼ã‚¿ã®è¨­å®šã¨åé›†ã®ãŸã‚ã®ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«APIã«å¾ã€…ã«ç§»è¡Œã—ã¦ã„ã¾ã™ã€‚NETCONF ã€ OpenConfig ã€MIBã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒã‚ã‚Šã€SNMPã‚’ä½¿ç”¨ã—ãŸåŒã˜æ§‹æˆãŒé•·ã„é–“å­˜åœ¨ã—ã¦ã„ã¾ã—ãŸã€‚ ãŸã ã—ã€ã“ã‚Œã‚‰ã®é‡è¦äº‹é …ã«ã¤ã„ã¦ã¯è§¦ã‚Œã¾ã›ã‚“ãŒã€ãƒãƒƒãƒˆãƒ¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>åˆ¥ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨˜è¿°ã—ã€ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’æ§‹æˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pc-administrator/blog/321028/"><p><img src="https://habrastorage.org/files/043/80f/c8a/04380fc8a7fd40d6b3f66428ea7b8b7b.jpg" alt="ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ"></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿå™¨ãƒ¡ãƒ¼ã‚«ãƒ¼ã¯ã€ã‚¤ãƒ³ãƒ‡ã‚£ã‚±ãƒ¼ã‚¿ã®è¨­å®šã¨åé›†ã®ãŸã‚ã®ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«APIã«å¾ã€…ã«ç§»è¡Œã—ã¦ã„ã¾ã™<a href="http://www.openconfig.net/">ã€‚NETCONF</a> ã€ <a href="http://www.openconfig.net/">OpenConfig</a> ã€MIBã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒã‚ã‚Šã€SNMPã‚’ä½¿ç”¨ã—ãŸåŒã˜æ§‹æˆãŒé•·ã„é–“å­˜åœ¨ã—ã¦ã„ã¾ã—ãŸã€‚ ãŸã ã—ã€ã“ã‚Œã‚‰ã®é‡è¦äº‹é …ã«ã¤ã„ã¦ã¯è§¦ã‚Œã¾ã›ã‚“ãŒã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿå™¨ã®æ§‹æˆã‚’è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³•ã‚’å…±æœ‰ã™ã‚‹ã ã‘ã§ã™ã€‚ãŸã¨ãˆã°ã€æ”¯åº—ã‚’å¤§é‡ã«é–‹è¨­ã™ã‚‹å ´åˆã¯ã€ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ä¾‹ã¨ã—ã¦ã€æ¶ç©ºã®ã‚»ãƒ³ãƒˆãƒ©ãƒ«ã‚ªãƒ•ã‚£ã‚¹ã§ã¯D-Link DFL-800ã‚’ä½¿ç”¨ã—ã€å‘¨è¾ºã§ã¯MikroTik RB951UI-2HnDã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ ç‰¹ã«ã€æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã®ã‚·ãƒŠãƒªã‚ªã«ã¤ã„ã¦è©±ã—ã¦ã„ã‚‹ãŸã‚ã€ãã‚Œã‚‰ã®é–“ã«IPsecãƒˆãƒ³ãƒãƒ«ã‚’æ§‹æˆã—ã¾ã™ã€‚ <a name="habracut"></a></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1 id="nastroyka-mikrotik">  MikroTikã‚’æ§‹æˆã™ã‚‹ </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  MikroTikã‚’æ§‹æˆã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã¯ã€æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰ã®ã‚»ãƒƒãƒˆã‚’å«ã‚€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚ èª¬æ˜ã•ã‚Œã¦ã„ã‚‹æ§‹æˆåŸç†ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®åŒæ§˜ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æŒã¤ä»–ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã«é©ã—ã¦ã„ã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> æœ€åˆã«ã€ <strong>/ export</strong>ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€æ—¢ã«æ§‹æˆæ¸ˆã¿ã§å‹•ä½œã—ã¦ã„ã‚‹MikroTikã®æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—ã¾ã™ã€‚ ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã»ã¨ã‚“ã©åŒã˜ã§ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨MACã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> åˆ¥ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã§æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ä¸€éƒ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ä¸€æ„ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã‚Œã«ã¯ã€ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã«çµ„ã¿è¾¼ã¾ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ<a href="http://wiki.mikrotik.com/wiki/Manual:Scripting">è¨€èªã®</a>æ©Ÿèƒ½ãŒé©ã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«ã€å€‹ã€…ã®è¨­å®šã‚’å¤‰æ•°ã«è»¢é€ã™ã‚‹ã“ã¨ãŒé©åˆ‡ã§ã™ã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚’ä½¿ç”¨ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¾‹ã‚’æ¬¡ã«ç¤ºã—ã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="dos hljs">local Gate "<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>" /ip route :<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([:len [/ip route <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> distance=<span class="hljs-number"><span class="hljs-number">1</span></span>]] = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>={add distance=<span class="hljs-number"><span class="hljs-number">1</span></span> gateway=$Gate; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>={<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> [<span class="hljs-built_in"><span class="hljs-built_in">find</span></span> distance=<span class="hljs-number"><span class="hljs-number">1</span></span>] gateway=$Gate}</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> å½“åˆã¯ã€æ§‹æˆã‚’ãƒªã‚»ãƒƒãƒˆã›ãšã«é©ç”¨ã§ãã‚‹ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹ã¨ã„ã†è€ƒãˆã§ã—ãŸã€‚ ã—ãŸãŒã£ã¦ã€ã‚³ãƒ¼ãƒ‰ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒˆã®å­˜åœ¨ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ãã®å¾Œã€ã‚¼ãƒ­ã‹ã‚‰ä½œæˆã•ã‚Œã‚‹ã‹ã€å¤‰æ›´ã•ã‚Œã¾ã™ã€‚ ãŸã ã—ã€æ–°ã—ã„ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã§ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å¤‰æ›´ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ§‹æˆã«çµ¶ãˆãšè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã“ã®è€ƒãˆã‚’æ”¾æ£„ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ ã™ã¹ã¦ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã¯éç¾å®Ÿçš„ã§ã‚ã‚Šã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’çµ¶ãˆãšæ›´æ–°ã™ã‚‹ã¨ã€è‡ªå‹•åŒ–ã®æ„å‘³ãŒå¤±ã‚ã‚Œã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªãGUIã§ãƒ«ãƒ¼ã‚¿ãƒ¼ã®å€‹ã€…ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’è¨­å®šã™ã‚‹æ–¹ãŒä¾¿åˆ©ã§ã™ã€‚ãã®å ´åˆã€ãƒ‡ãƒã‚¤ã‚¹ã®è©³ç´°ã«ç²¾é€šã—ã¦ã„ãªã„äººã§ã‚‚ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’æ§‹æˆã§ãã¾ã™ã€‚ ã•ã¾ã–ã¾ãªè³‡æ ¼ã®å¾“æ¥­å“¡ãŒå¯¾å¿œã§ãã‚‹ãƒªãƒ¢ãƒ¼ãƒˆã‚ªãƒ•ã‚£ã‚¹ã«å¿…è¦ãªã‚‚ã®ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  AutoITã§é–‹ç™ºã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã§GUIã‚’æç”»ã—ã¾ã™ã€‚ ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒã‚¹ã‚¯ï¼ˆ255.255.255.0 = / 24ï¼‰ã‚’å†è¨ˆç®—ã—ã€æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã«1è¡Œãšã¤å…¥åŠ›ã™ã‚‹æ©Ÿèƒ½ã‚‚è¿½åŠ ã—ã¾ã—ãŸã€‚ å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®é–‹ç™ºãƒ„ãƒ¼ãƒ«è‡ªä½“ã¯åŸºæœ¬çš„ãªã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å€‹äººçš„ã«ä½¿ã„æ…£ã‚ŒãŸã‚‚ã®ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p><img src="https://habrastorage.org/files/9f4/f4b/9d0/9f4f4b9d0f754870bd031afdbe1563e5.jpg" alt="ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ"></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  <em>çµæœã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</em> </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’å½¢æˆã™ã‚‹é–¢æ•°ã‚’ã•ã‚‰ã«è©³ã—ãèª¿ã¹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ä¸»ã«AutoITã‚­ãƒƒãƒˆã‹ã‚‰ã€å°†æ¥ã®ã‚³ãƒ³ãƒ•ã‚£ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’å‹•ä½œã•ã›ã‚‹ã«ã¯ã€æ¬¡ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li><p>  IPsecã‚­ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®RandomStringï¼ˆå«ã¾ã‚Œã¦ã„ãªã„ã€è‘—è€…<a href="http://autoit-script.ru/index.php%3Ftopic%3D13795.0">Altlans</a> ï¼‰; </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li><p>  IPã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®GuiIPAddressã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li><p>  GUIã‚’æ“ä½œã™ã‚‹ãŸã‚ã®GUIConstantsExã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ“ä½œã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  AutoITã§ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’æ“ä½œã™ã‚‹åŸå‰‡ã¯å…¬å¼<a href="https://www.autoitscript.com/autoit3/docs/guiref/GUIRef.htm">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰</a>ã•ã‚Œã¦ã„<a href="https://www.autoitscript.com/autoit3/docs/guiref/GUIRef.htm">ã¾ã™ãŒ</a> ã€ã™ãã«çµæœã«é€²ã¿ã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs php">$hgui = GUICreate(<span class="hljs-string"><span class="hljs-string">""</span></span> , <span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">600</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) $iploc1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">55</span></span>) $iplocnet1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">115</span></span>) $ipext1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">135</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">170</span></span>) $ipextnet1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">190</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">225</span></span>) $ipgate1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">245</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">" 1"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">280</span></span>) $DNS11 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">" 2"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">335</span></span>) $DNS21 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">355</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">390</span></span>) $secret1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">410</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"     "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">445</span></span>) $ports1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">"5000,8000"</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">480</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   :"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">515</span></span>) $mac1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">"00:00:00:00:00:00"</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">535</span></span>) $OK_Btn = GUICtrlCreateButton(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>, <span class="hljs-number"><span class="hljs-number">570</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>) _GUICtrlIpAddress_Set($iploc1, $iploc8) _GUICtrlIpAddress_Set($ipext1, $ipext8) _GUICtrlIpAddress_Set($iplocnet1, <span class="hljs-string"><span class="hljs-string">"255.255.255.0"</span></span>) _GUICtrlIpAddress_Set($ipextnet1, <span class="hljs-string"><span class="hljs-string">"255.255.255.252"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $secret8 = <span class="hljs-string"><span class="hljs-string">""</span></span> Then GUICtrlSetData($secret1,_Crypto_GetRandomString(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> GUICtrlSetData($secret1,$secret8) <span class="hljs-keyword"><span class="hljs-keyword">EndIf</span></span> GUISetState(@SW_SHOW) <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> $msg = GUIGetMsg() Select <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> $msg = $GUI_EVENT_CLOSE <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> $msg = $OK_Btn ;   <span class="hljs-string"><span class="hljs-string">""</span></span>     $iploc=_GUICtrlIpAddress_Get($iploc1) $iplocnet=_GUICtrlIpAddress_Get($iplocnet1) $DNS1=_GUICtrlIpAddress_Get($DNS11) $DNS2=_GUICtrlIpAddress_Get($DNS21) $ipext=_GUICtrlIpAddress_Get($ipext1) $ipextnet=_GUICtrlIpAddress_Get($ipextnet1) $ipgate=_GUICtrlIpAddress_Get($ipgate1) $secret=GUICtrlRead($secret1) $ports=GUICtrlRead($ports1) $mac=GUICtrlRead($mac1) $iploc2=_GUICtrlIpAddress_GetArray($iploc1) ;      $ipterm1 = $iploc2[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">2</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">".210"</span></span> $ipterm2 = $iploc2[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">2</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">".220"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $iploc = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $iplocnet=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $DNS1=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $DNS2=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $ipext=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $ipextnet=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $ipgate=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> StringLen($secret)=<span class="hljs-number"><span class="hljs-number">0</span></span> then MsgBox(<span class="hljs-number"><span class="hljs-number">4160</span></span>, <span class="hljs-string"><span class="hljs-string">"Information"</span></span>, <span class="hljs-string"><span class="hljs-string">"  "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> GUIDelete() ExitLoop <span class="hljs-keyword"><span class="hljs-keyword">EndIf</span></span> EndSelect WEnd</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ã•ã‚‰ã«ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚FileWriteLineã‚’ä½¿ç”¨ã—ã¦ã€å—ä¿¡ã—ãŸå€¤ã‚’æ–°ã—ã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«1è¡Œãšã¤å…¥åŠ›ã—ã¾ã™ã€‚ çµæœã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ§‹æˆã¯ã€MikroTikã«è»¢é€ã§ãã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">å…¨æ©Ÿèƒ½ãƒªã‚¹ãƒˆ</b> <div class="spoiler_text"><pre> <code class="hljs kotlin">#include &lt;RandomString.au3&gt; #include &lt;GuiIPAddress.au3&gt; #include &lt;GUIConstantsEx.au3&gt; #include &lt;File.au3&gt; _mikrot() func _mikrot ($iploc8=<span class="hljs-string"><span class="hljs-string">""</span></span>, $secret8=<span class="hljs-string"><span class="hljs-string">""</span></span>, $ipext8=<span class="hljs-string"><span class="hljs-string">""</span></span>) local $file = <span class="hljs-meta"><span class="hljs-meta">@TempDir</span></span> &amp;<span class="hljs-string"><span class="hljs-string">"\script.txt"</span></span> $hgui = GUICreate(<span class="hljs-string"><span class="hljs-string">""</span></span> , <span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">600</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) $iploc1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">55</span></span>) $iplocnet1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">115</span></span>) $ipext1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">135</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">170</span></span>) $ipextnet1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">190</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">225</span></span>) $ipgate1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">245</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">" 1"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">280</span></span>) $DNS11 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">" 2"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">335</span></span>) $DNS21 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">355</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">390</span></span>) $secret1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">410</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"     "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">445</span></span>) $ports1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">"5000,8000"</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">480</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   :"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">515</span></span>) $mac1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">"00:00:00:00:00:00"</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">535</span></span>) $OK_Btn = GUICtrlCreateButton(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>, <span class="hljs-number"><span class="hljs-number">570</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>) _GUICtrlIpAddress_Set($iploc1, $iploc8) _GUICtrlIpAddress_Set($ipext1, $ipext8) _GUICtrlIpAddress_Set($iplocnet1, <span class="hljs-string"><span class="hljs-string">"255.255.255.0"</span></span>) _GUICtrlIpAddress_Set($ipextnet1, <span class="hljs-string"><span class="hljs-string">"255.255.255.252"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $secret8 = <span class="hljs-string"><span class="hljs-string">""</span></span> Then GUICtrlSetData($secret1,_Crypto_GetRandomString(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>)) Else GUICtrlSetData($secret1,$secret8) EndIf GUISetState(<span class="hljs-meta"><span class="hljs-meta">@SW_SHOW</span></span>) While <span class="hljs-number"><span class="hljs-number">1</span></span> $msg = GUIGetMsg() Select Case $msg = $GUI_EVENT_CLOSE Exit Case $msg = $OK_Btn $iploc=_GUICtrlIpAddress_Get($iploc1) $iplocnet=_GUICtrlIpAddress_Get($iplocnet1) $DNS1=_GUICtrlIpAddress_Get($DNS11) $DNS2=_GUICtrlIpAddress_Get($DNS21) $ipext=_GUICtrlIpAddress_Get($ipext1) $ipextnet=_GUICtrlIpAddress_Get($ipextnet1) $ipgate=_GUICtrlIpAddress_Get($ipgate1) $secret=GUICtrlRead($secret1) $ports=GUICtrlRead($ports1) $mac=GUICtrlRead($mac1) $iploc2=_GUICtrlIpAddress_GetArray($iploc1) ;      $ipterm1 = $iploc2[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">2</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">".210"</span></span> $ipterm2 = $iploc2[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;$iploc2[<span class="hljs-number"><span class="hljs-number">2</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">".220"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $iploc = <span class="hljs-number"><span class="hljs-number">0</span></span> or $iplocnet=<span class="hljs-number"><span class="hljs-number">0</span></span> or $DNS1=<span class="hljs-number"><span class="hljs-number">0</span></span> or $DNS2=<span class="hljs-number"><span class="hljs-number">0</span></span> or $ipext=<span class="hljs-number"><span class="hljs-number">0</span></span> or $ipextnet=<span class="hljs-number"><span class="hljs-number">0</span></span> or $ipgate=<span class="hljs-number"><span class="hljs-number">0</span></span> or StringLen($secret)=<span class="hljs-number"><span class="hljs-number">0</span></span> then MsgBox(<span class="hljs-number"><span class="hljs-number">4160</span></span>, <span class="hljs-string"><span class="hljs-string">"Information"</span></span>, <span class="hljs-string"><span class="hljs-string">"  "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> GUIDelete() ExitLoop EndIf EndSelect WEnd $temp1=_Subnet($iploc, $iplocnet) $iplocnet=$temp1[<span class="hljs-number"><span class="hljs-number">1</span></span>]&amp;<span class="hljs-string"><span class="hljs-string">"/"</span></span>&amp;$temp1[<span class="hljs-number"><span class="hljs-number">6</span></span>] $temp1=_Subnet($ipext, $ipextnet) $ipext=$ipext&amp;<span class="hljs-string"><span class="hljs-string">"/"</span></span>&amp;$temp1[<span class="hljs-number"><span class="hljs-number">6</span></span>] If Not _FileCreate($file) Then MsgBox(<span class="hljs-number"><span class="hljs-number">4096</span></span>, <span class="hljs-string"><span class="hljs-string">"Error"</span></span>, <span class="hljs-string"><span class="hljs-string">"   :"</span></span> &amp; <span class="hljs-meta"><span class="hljs-meta">@error</span></span>) EndIf FileOpen ( $file, <span class="hljs-number"><span class="hljs-number">2</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"local locIP "</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>&amp;$iploc&amp;<span class="hljs-string"><span class="hljs-string">""";") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local Net """</span></span>&amp;$iplocnet&amp;<span class="hljs-string"><span class="hljs-string">""";") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local DNS1 """</span></span>&amp; $DNS1 &amp; <span class="hljs-string"><span class="hljs-string">""";") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local DNS2 """</span></span>&amp;$DNS2&amp;<span class="hljs-string"><span class="hljs-string">""";") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local IP """</span></span>&amp;$ipext&amp;<span class="hljs-string"><span class="hljs-string">"""") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local Gate """</span></span>&amp;$ipgate&amp;<span class="hljs-string"><span class="hljs-string">"""") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local MAC """</span></span>&amp;$mac&amp;<span class="hljs-string"><span class="hljs-string">"""") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local secret """</span></span>&amp;$secret&amp;<span class="hljs-string"><span class="hljs-string">"""") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local BankPorts """</span></span>&amp;$ports&amp;<span class="hljs-string"><span class="hljs-string">""" ") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local term1 """</span></span>&amp;$ipterm1&amp;<span class="hljs-string"><span class="hljs-string">"""") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, "local term2 """</span></span>&amp;$ipterm2&amp;<span class="hljs-string"><span class="hljs-string">""" ") FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface set ether1 name=ether1-gateway;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface set ether2 name=ether2-master-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface set ether3 name=ether3-slave-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface set ether4 name=ether4-slave-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface set ether5 name=ether5-slave-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface ethernet set ether3-slave-local master-port=ether2-master-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface ethernet set ether4-slave-local master-port=ether2-master-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface ethernet set ether5-slave-local master-port=ether2-master-local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface bridge add name=bridge-local disabled=no auto-mac=no protocol-mode=rstp;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':local bMACIsSet 0;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':foreach k in=[/interface find] do={:local tmpPort [/interface get </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$k</span></span></span><span class="hljs-string"> name];') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$bMACIsSet</span></span></span><span class="hljs-string"> = 0) do={:if ([/interface get </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$k</span></span></span><span class="hljs-string"> type] = "ether") do={/interface bridge set "bridge-local" admin-mac=[/interface ethernet get </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tmpPort</span></span></span><span class="hljs-string"> mac-address];') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':set bMACIsSet 1;}}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if (!(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tmpPort</span></span></span><span class="hljs-string">~"bridge" || </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tmpPort</span></span></span><span class="hljs-string">~"ether1" || </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tmpPort</span></span></span><span class="hljs-string">~"slave")) do={') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface bridge port add bridge=bridge-local interface=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tmpPort</span></span></span><span class="hljs-string">;}} ') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface wireless set [ find name=wlan1 ] band=2ghz-b/g/n channel-width=20/40mhz-Ce country=japan disabled=no distance=indoors mode=ap-bridge ssid=MikroTik wireless-protocol=802.11;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/interface wireless security-profiles') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set [ find default=yes ] authentication-types=wpa-psk group-ciphers=tkip \') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' mode=dynamic-keys unicast-ciphers=tkip wpa-pre-shared-key=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' MegaWiFiKey wpa2-pre-shared-key=MegaWiFiKey') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip ipsec proposal set [ find default=yes ] auth-algorithms=md5 lifetime=1h') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip pool') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add name=default-dhcp ranges=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "1". "-". "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "00");') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip dhcp-server add address-pool=default-dhcp disabled=no interface=bridge-local name=default') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip dhcp-server network add address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Net</span></span></span><span class="hljs-string"> comment="default configuration" dns-server="</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">,8.8.8.8" gateway=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string"> netmask=24') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip dns') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set allow-remote-requests=yes servers=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$DNS1</span></span></span><span class="hljs-string">". ",". "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$DNS2</span></span></span><span class="hljs-string">")') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip firewall address-list') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip firewall address-list find list=local]] = 0) do={add address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Net</span></span></span><span class="hljs-string"> list=local;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '} else={set [find list=local] address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Net</span></span></span><span class="hljs-string">;}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip firewall address-list find list=office]] = 0) do={add address=10.0.0.0/24 list=office;}') ;   FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip firewall address-list find list=remote]] = 0) do={add address=1.2.3.4 list=remote comment=office1.domain.ru;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add address=1.2.3.5 list=remote comment=office2.domain.ru;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add address=10.0.0.0/24 list=remote;}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip address') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add address="</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">/24" interface=bridge-local') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip address find interface=ether1-gateway]] = 0) do={add address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IP</span></span></span><span class="hljs-string"> interface=ether1-gateway;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '} else={set [find interface=ether1-gateway] address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$IP</span></span></span><span class="hljs-string">;}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip route') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip route find distance=1]] = 0) do={add distance=1 gateway=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Gate</span></span></span><span class="hljs-string">;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '} else={set [find distance=1] gateway=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Gate</span></span></span><span class="hljs-string">}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':delay 1000ms;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip ipsec peer') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip ipsec proposal set default auth-algorithms=md5 enc-algorithms=3des') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip ipsec peer find lifetime=8h]] = 0) do={add address=1.2.3.4/32 lifetime=8h nat-traversal=yes secret=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$secret</span></span></span><span class="hljs-string"> enc-algorithm=3des hash-algorithm=md5 comment=office;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '} else={set [/ip ipsec peer find lifetime=8h] address=1.2.3.5/32 nat-traversal=yes secret=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$secret</span></span></span><span class="hljs-string"> enc-algorithm=3des hash-algorithm=md5 comment=office;}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip ipsec policy') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip ipsec proposal set default auth-algorithms=md5 enc-algorithms=3des') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip ipsec policy find dst-address=10.0.0.0/24]] = 0) do={add dst-address=10.0.0.0/24 sa-dst-address=188.93.243.170 sa-src-address=[/ip route get [find gateway=ether1-gateway] pref-src] src-address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Net</span></span></span><span class="hljs-string"> tunnel=yes comment=office proposal=default;') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '} else={set [find dst-address=10.0.0.0/24] sa-dst-address=1.2.3.4 sa-src-address =[/ip route get [find gateway=ether1-gateway] pref-src] src-address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Net</span></span></span><span class="hljs-string"> tunnel=yes comment=office;} ') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip service') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set telnet disabled=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set ftp disabled=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set www port=80') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set api disabled=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set api-ssl disabled=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set www-ssl disabled=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/system clock manual') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set time-zone=+03:00') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/system leds') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set 0 interface=wlan1') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/system ntp client') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set enabled=yes primary-ntp=61.67.210.241 secondary-ntp=205.171.76.135') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/system script') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/system script find name=ipsec]] != 0) do={') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'remove ipsec') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '}') ;  IPsec   . ; keepalive     ;     FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add name=ipsec policy=reboot,read,write,policy,test,password,sniff,sensitive \') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' source=":local RemoteGw \"  DFL\";\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local LocalGw [/ip route get [find gateway=\"bridge-local\"] pref-src];\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local currentIP [/ip route get [find gateway=\"ether1-gateway\"] pref-s\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' rc];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local Ip1 [:resolve office1.domain.ru];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local Ip2 [:resolve office2.domain.ru];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### Check office IPs ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local Ip [/ip firewall address-list get [find comment=office1.dom\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' ain.ru] address];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip firewall address-list set [find comment=office1.domain.ru] addr\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' ess=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:set Ip [/ip firewall address-list get [find comment=office2.domain\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' .ru] address];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip firewall address-list set [find comment=office2.domain.ru] addr\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' ess=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### Check ipsec status ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local Status [/ping \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$RemoteGw</span></span></span><span class="hljs-string"> count=1 src-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LocalGw</span></span></span><span class="hljs-string">];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### ipsec is down ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Status</span></span></span><span class="hljs-string">=0) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### ping Ip2 and Ip1 ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local StatusIp1 [/ping \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string"> count=2 src-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$currentIP</span></span></span><span class="hljs-string">];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local StatusIp2 [/ping \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string"> count=2 src-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$currentIP</span></span></span><span class="hljs-string">];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp1</span></span></span><span class="hljs-string">&gt;0 or \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp2</span></span></span><span class="hljs-string">&gt;0) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp1</span></span></span><span class="hljs-string">&gt;0) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### Ping Ip1 ok ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec policy set [find sa-dst-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">] sa-dst-address \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec peer set [find address=\"\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">/32\"] address \"\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">/32\";\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:log info (\"Reset tunnel: Status IP Office1: \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp1</span></span></span><span class="hljs-string">\");\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n} else={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### Ping Ip1 NOT ok ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec policy set [find sa-dst-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">] sa-dst-address \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec peer set [find address=\"\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">/32\"] address \"\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">/32\";\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:log info (\"Reset tunnel: Status IP Office2: \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp2</span></span></span><span class="hljs-string">\");\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec installed-sa flush;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec remote-peers kill-connections;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:local Status [/ping \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$RemoteGw</span></span></span><span class="hljs-string"> count=2 src-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$LocalGw</span></span></span><span class="hljs-string">];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Status</span></span></span><span class="hljs-string">=0) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:log info (\"check for misconfiguration\");\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### Check local IP ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:set Ip [/ip ipsec policy get [find comment=office] sa-src-address];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$currentIP</span></span></span><span class="hljs-string">) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec policy set [find comment=office] sa-src-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$currentIP</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:log info (\"misconfiguration: policy, local address\");\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n### Check remote IP ###\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:set Ip [/ip ipsec policy get [find comment=office] sa-dst-address];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string"> and \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp1</span></span></span><span class="hljs-string">&gt;0) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec policy set [find comment=office] sa-dst-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n} else={/ip ipsec policy set [find comment=office] sa-dst-address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">;\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' }\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:log info (\"misconfiguration: policy, remote address\");\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:set Ip [/ip ipsec peer get [find comment=office] address];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">.\"/32\" and \</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip2</span></span></span><span class="hljs-string">.\"/32\") do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$StatusIp1</span></span></span><span class="hljs-string">&gt;0) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n/ip ipsec peer set [find comment=office] address=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n} else={/ip ipsec peer set [find comment=office] address=\"\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip1</span></span></span><span class="hljs-string">/32\";}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n:log info (\"misconfiguration: peer\");\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n} else={:log info (\"Ipsec tunnel status: OK\");}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n} else={:log info (\"Ipsec tunnel status: Office is DOWN!\");}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' \n} else={:log info (\"Ipsec tunnel status: OK\");}"') ; ntp,     FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/system script find name=ntp]] != 0) do={') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'remove ntp') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add name=ntp policy=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'ftp,reboot,read,write,policy,test,password,sniff,sensitive source=":local \') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'ntp1 [:resolve pool.ntp.org];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n:local ntp2 [:resolve time.windows.com];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n:local Ip [/system ntp client get primary-ntp];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ntp1</span></span></span><span class="hljs-string">) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n/system ntp client set primary-ntp=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ntp1</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n}\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n:set Ip [/system ntp client get secondary-ntp];\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n:if (\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Ip</span></span></span><span class="hljs-string">!=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ntp2</span></span></span><span class="hljs-string">) do={\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n/system ntp client set secondary-ntp=\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ntp2</span></span></span><span class="hljs-string">;\r\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '\n}"') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/system scheduler') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/system scheduler find name=ipsec-test]] = 0) do={') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add interval=3m name=ipsec-test on-event="/system script run ipsec" policy=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' reboot,read,write,policy,test,password,sniff,sensitive') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' }') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/system scheduler find name=ntp]] = 0) do={') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add interval=1d name=ntp on-event="/system script run ntp" policy=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' reboot,read,write,policy,test,password,sniff,sensitive') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' }') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip firewall nat') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=srcnat comment=ipsec dst-address-list=office out-interface=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' ether1-gateway src-address-list=local') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add action=masquerade chain=srcnat comment=bank1 src-address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$term1</span></span></span><span class="hljs-string"> dst-port=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$BankPorts</span></span></span><span class="hljs-string"> out-interface=ether1-gateway protocol=tcp disable=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add action=masquerade chain=srcnat comment=bank2 src-address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$term2</span></span></span><span class="hljs-string"> dst-port=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$BankPorts</span></span></span><span class="hljs-string"> out-interface=ether1-gateway protocol=tcp disable=yes') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add action=masquerade chain=srcnat comment="outbound icmp" out-interface=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' ether1-gateway protocol=icmp') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add action=masquerade chain=srcnat comment="default configuration" disabled=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' yes out-interface=ether1-gateway') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip firewall filter') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=input comment="remote admin" dst-port=80,22,8291 src-address-list=remote in-interface=\') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ' ether1-gateway protocol=tcp') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=input comment=icmp protocol=icmp') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=input comment="established, related" connection-state=established') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=input connection-state=related') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add action=drop chain=input comment="drop other" in-interface=ether1-gateway') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=forward comment="established, related" connection-state=established') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add chain=forward connection-state=related') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'add action=drop chain=forward comment="drop other" connection-state=invalid') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/ip dhcp-server lease') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip dhcp-server lease find address=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "1")]]&gt;0) do={') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set [/ip dhcp-server lease find address=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "1")] address=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "1") mac-address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$MAC</span></span></span><span class="hljs-string">;}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, ':if ([:len [/ip dhcp-server lease find address=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "1")]] = 0) do={add address=("</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$locIP</span></span></span><span class="hljs-string">". "1") mac-address=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$MAC</span></span></span><span class="hljs-string">;}') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, '/user') FileWriteLine ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, 'set [find name=admin] password=MegaPassW0rd') fileclose(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">) run("notepad "&amp;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">) EndFunc ;   . Func _Subnet(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sIp</span></span></span><span class="hljs-string">, </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sNetmask</span></span></span><span class="hljs-string">) Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskbinary</span></span></span><span class="hljs-string"> Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[5] Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[5] Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[5] Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[7] Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetadd</span></span></span><span class="hljs-string"> Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmask</span></span></span><span class="hljs-string"> Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastadd</span></span></span><span class="hljs-string"> ; Reads IP and Netmask to an array </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string"> = StringSplit(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sIp</span></span></span><span class="hljs-string">, ".") </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string"> = StringSplit(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sNetmask</span></span></span><span class="hljs-string">, ".") ; Validates IP address For </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string"> = 1 To 4 If Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &lt; 0 Or Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &gt; 255 Then SetError(1) Return (-1) EndIf Next ; Converts netmask into a decimal </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskdec</span></span></span><span class="hljs-string"> = (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[1] * 16777216) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[2] * 65536) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[3] * 256) + </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[4] ; Converts decimal netmask into binary (ex. 11111111111111111100000000000000) While </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskdec</span></span></span><span class="hljs-string"> &lt;&gt; 0 </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$binmod</span></span></span><span class="hljs-string"> = Mod(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskdec</span></span></span><span class="hljs-string">, 2) </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskbinary</span></span></span><span class="hljs-string"> = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$binmod</span></span></span><span class="hljs-string"> &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskbinary</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskdec</span></span></span><span class="hljs-string"> = Int(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskdec</span></span></span><span class="hljs-string"> / 2) WEnd ; Determines the "slash" value of the netmask </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$maskslash</span></span></span><span class="hljs-string"> = StringInStr(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskbinary</span></span></span><span class="hljs-string">, "0", 1) - 1 ; Validates the "slash" value and netmask value If StringInStr(StringRight(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskbinary</span></span></span><span class="hljs-string">, 32 - </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$maskslash</span></span></span><span class="hljs-string">), "1") Then If </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[4] = "255" Then </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$maskslash</span></span></span><span class="hljs-string"> = 32 Else SetError(1) Return (-1) EndIf EndIf ; Creates arrays conatining subnet address, wilcard, and broadcast addresses For </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string"> = 1 To </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[0] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">] = BitAND(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">], </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">] = BitNOT(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$netmaskarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">] - 256) </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">] = BitOR(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">], </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) Next ; Creates strings conatining subnet address, wilcard, and broadcast addresses </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetadd</span></span></span><span class="hljs-string"> = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[1] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[2] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[3] &amp; "." &amp;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[4] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmask</span></span></span><span class="hljs-string"> = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[1] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[2] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[3] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[4] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastadd</span></span></span><span class="hljs-string"> = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[1] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[2] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[3] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[4] If </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$maskslash</span></span></span><span class="hljs-string"> = 32 Then </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iprange</span></span></span><span class="hljs-string"> = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[1] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[2] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[3] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[4] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$hosts</span></span></span><span class="hljs-string"> = 1 Else ; Determines the IP range for this subnet </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iprange</span></span></span><span class="hljs-string"> = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[1] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[2] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[3] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetaddarray</span></span></span><span class="hljs-string">[4] + 1 &amp; _ "-" &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[1] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[2] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[3] &amp; "." &amp; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastaddarray</span></span></span><span class="hljs-string">[4] - 1 ; Calculates number of available hosts on this subnet </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$hosts</span></span></span><span class="hljs-string"> = (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[4] + 1) * (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[3] + 1) * (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[2] + 1) * (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmaskarray</span></span></span><span class="hljs-string">[1] + 1) - 2 EndIf </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[1] = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subnetadd</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[2] = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadcastadd</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[3] = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$invmask</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[4] = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iprange</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[5] = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$hosts</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">[6] = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$maskslash</span></span></span><span class="hljs-string"> Return (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubnetinfo</span></span></span><span class="hljs-string">) EndFunc Func _SameSub(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sIp</span></span></span><span class="hljs-string">, </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubadd</span></span></span><span class="hljs-string">, </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sBroadadd</span></span></span><span class="hljs-string">) Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[5] Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[5] Dim </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[5] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string"> = StringSplit(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sIp</span></span></span><span class="hljs-string">, ".") </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string"> = StringSplit(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sSubadd</span></span></span><span class="hljs-string">, ".") </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string"> = StringSplit(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$sBroadadd</span></span></span><span class="hljs-string">, ".") For </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string"> = 1 To 4 If Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &lt; 0 Or Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &gt; 255 Then SetError(1) Return (-1) EndIf If Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &lt; 0 Or Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &gt; 255 Then SetError(1) Return (-2) EndIf If Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &lt; 0 Or Number(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">]) &gt; 255 Then SetError(1) Return (-3) EndIf Next </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ipint</span></span></span><span class="hljs-string"> = (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[1] * 16777216) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[2] * 65536) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[3] * 256) + </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$iparray</span></span></span><span class="hljs-string">[4] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddint</span></span></span><span class="hljs-string"> = (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[1] * 16777216) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[2] * 65536) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[3] * 256) + </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddarray</span></span></span><span class="hljs-string">[4] </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddint</span></span></span><span class="hljs-string"> = (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[1] * 16777216) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[2] * 65536) + (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[3] * 256) + </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddarray</span></span></span><span class="hljs-string">[4] If </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ipint</span></span></span><span class="hljs-string"> &gt; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$subaddint</span></span></span><span class="hljs-string"> And </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ipint</span></span></span><span class="hljs-string"> &lt; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$broadaddint</span></span></span><span class="hljs-string"> Then Return (1) Else Return (0) EndIf EndFunc</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ãŸå¾Œã€MikroTikã§ä¾¿åˆ©ãªæ–¹æ³•ã§çµæœã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ï¼š/ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ä¿å­˜ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã€å›³ã«ç¤ºã™ã‚ˆã†ã«è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p><img src="https://habrastorage.org/files/cec/677/1c5/cec6771c51224a5fa7a517ddda4eb847.jpg" alt="ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ"></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ã“ã‚Œã§ã€æ–°ã—ã„MikroTikã‚’æ§‹æˆã™ã‚‹ã«ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã€GUIã§å€‹ã€…ã®è¨­å®šã‚’æŒ‡å®šã—ã€æ§‹æˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å–å¾—ã—ã¦ãƒ«ãƒ¼ã‚¿ãƒ¼ã«æ¸¡ã™ã ã‘ã§ååˆ†ã§ã™ã€‚ ææ¡ˆã•ã‚Œã¦ã„ã‚‹ã‚»ãƒ³ãƒˆãƒ©ãƒ«ã‚ªãƒ•ã‚£ã‚¹ã®ãƒ«ãƒ¼ã‚¿ãƒ¼ã®æ§‹æˆã‚’å¿µé ­ã«ç½®ã„ã¦ãã ã•ã„ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1 id="nastroyka-d-link-dfl">  D-Link DFLã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  DFLæ§‹æˆã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰è¡Œã†æ–¹ãŒä¾¿åˆ©ã§ã™ã€‚ ã“ã®ã‚¿ã‚¤ãƒ—ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã¯ã€ <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">Puttyã®</a>ä½œæˆè€…ãŒæä¾›ã™ã‚‹<strong>Plink</strong>ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ãªã©ã€è‡ªå‹•åŒ–ã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> é–‹ã„ã¦ã„ã‚‹ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ã™ã‚‹ã¨ã„ã†æ¦‚å¿µã¯ç†æƒ³çš„ã¨ã¯è¨€ãˆã¾ã›ã‚“ãŒã€D-Link DFLã®å ´åˆã€ç‹¬è‡ªã®ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã€ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ ä¾‹ã¨ã—ã¦ã€å‰è¿°ã®æ©Ÿèƒ½ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨â€‹â€‹ã™ã‚‹æ©Ÿèƒ½ã‚’åˆ†æã—ã¾ã™ã€‚  MikroTikã‚’ã‚¼ãƒ­ã‹ã‚‰è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€DFLã§IPsecãƒˆãƒ³ãƒãƒ«ã‚’ä½œæˆã—ã€ãã‚Œã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã«å«ã‚ã¦ã€çµ„ã¿è¾¼ã¿ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã™ã‚‹ã ã‘ã§ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p><img src="https://habrastorage.org/files/1b2/cfb/d8f/1b2cfbd8fc1048288be4f484c65fb745.jpg" alt="ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ"></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  <em>ã“ã®å ´åˆã®DFLã¯æœ€åˆã‹ã‚‰è¨­å®šã™ã‚‹å¿…è¦ãŒãªã„ãŸã‚ã€è¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¯ã¯ã‚‹ã‹ã«ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚</em> </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  SSHçµŒç”±ã§ãƒ«ãƒ¼ã‚¿ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è»¢é€ã™ã‚‹ãŸã‚ã®<strong>Pscp</strong>ã¨<strong>Plink</strong>ãŒå¿…è¦ã§ã™-ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹ã‚’æ›¸ãè¾¼ã‚€ã ã‘ã§ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $_plink_loc = <span class="hljs-string"><span class="hljs-string">"\\server\share\plink.exe"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $scploc=<span class="hljs-string"><span class="hljs-string">"\\server\share\pscp.exe"</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  PlinkãŠã‚ˆã³Pscpã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ç‰¹æ®Šãªç‚¹ãŒã‚ã‚Šã¾ã™ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€æœ€åˆã«æ©Ÿå™¨ã‚’æ¥ç¶šã¾ãŸã¯äº¤æ›ã™ã‚‹ã¨ãã«ã€ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«æŒ‡ç´‹ã‚’ä½œæˆã™ã‚‹ã‚ˆã†æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ã€ŒYã€ã‚’æ¸¡ã™ã“ã¨ã§ã€è¦æ±‚ã‚’ãƒã‚¤ãƒ‘ã‚¹ã§ãã¾ã™ã€‚ </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs mel">$_plinkhandle = Run(@comspec &amp; <span class="hljs-string"><span class="hljs-string">" /c "</span></span> &amp; $_plink_loc &amp; <span class="hljs-string"><span class="hljs-string">" -ssh admin@"</span></span> &amp; $_plinkserver &amp;<span class="hljs-string"><span class="hljs-string">" -pw MegaPass"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,@SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>) sleep (<span class="hljs-number"><span class="hljs-number">500</span></span>) StdinWrite($_plinkhandle, <span class="hljs-string"><span class="hljs-string">"y"</span></span>&amp; @CR)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  DFLã¯ã€ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¬ãƒ™ãƒ«ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‡¦ç†ã—ã¾ã™ã€‚ ã™ã¹ã¦ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’ãƒªã‚¹ãƒˆã›ãšã«ã‚°ãƒ«ãƒ¼ãƒ—ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã§ã‚ã‚‹ãŸã‚ã€DFLã§ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦é¸æŠã—ã¦å¤‰æ›´ã—ã¾ã™ã€‚     : </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">script -create InterfaceGroup VPNs -name=vpns.sgs</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>     SCP.     script.sgs          ,      D-Link  SCP   . </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">script -execute -name=script.sgs</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>          </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">script -remove -name=script.sgs</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><pre> <code class="hljs perl">func _dfl($lanip8=<span class="hljs-string"><span class="hljs-string">""</span></span>,$PSK8=<span class="hljs-string"><span class="hljs-string">""</span></span>,$ipext8=<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $file = @TempDir &amp;<span class="hljs-string"><span class="hljs-string">"\script.sgs"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $file1 = @TempDir &amp;<span class="hljs-string"><span class="hljs-string">"\script1.sgs"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FileExists($file) then FileDelete($file) EndIf <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FileExists($file1) then FileDelete($file1) EndIf ;  .      <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $_plink_loc = <span class="hljs-string"><span class="hljs-string">"\\server\share\plink.exe"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $scploc=<span class="hljs-string"><span class="hljs-string">"\\server\share\pscp.exe"</span></span> Local $_plinkserver = <span class="hljs-string"><span class="hljs-string">" DFL"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $magazname <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $magaznumber <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $lanip <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $ipext <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $PSK $hgui = GUICreate(<span class="hljs-string"><span class="hljs-string">" DFL"</span></span> , <span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">270</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"    "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) $lanip1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span>) $ipext1 = _GUICtrlIpAddress_Create($hgui, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">65</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">90</span></span>) $secret1 = GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">110</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">130</span></span>) $name1=GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   (77  NN88)"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">170</span></span>) $number1=GUICtrlCreateInput(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">190</span></span>) $OK_Btn = GUICtrlCreateButton(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>,<span class="hljs-number"><span class="hljs-number">230</span></span> , <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $PSK8 = <span class="hljs-string"><span class="hljs-string">""</span></span> Then GUICtrlSetData($secret1,_Crypto_GetRandomString(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>)) Else GUICtrlSetData($secret1,$PSK8) EndIf _GUICtrlIpAddress_Set($ipext1, $ipext8) _GUICtrlIpAddress_Set($lanip1, $lanip8) GUISetState(@SW_SHOW) While <span class="hljs-number"><span class="hljs-number">1</span></span> $msg = GUIGetMsg() Select Case $msg = $GUI_EVENT_CLOSE Exit Case $msg = $OK_Btn $lanip=_GUICtrlIpAddress_Get($lanip1) $ipext=_GUICtrlIpAddress_Get($ipext1) $PSK=GUICtrlRead($secret1) $magazname=GUICtrlRead($name1) $magaznumber=GUICtrlRead($number1) $lanip2=_GUICtrlIpAddress_GetArray($lanip1) ;   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $lanip = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $ipext=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> StringLen($PSK)=<span class="hljs-number"><span class="hljs-number">0</span></span> then MsgBox(<span class="hljs-number"><span class="hljs-number">4160</span></span>, <span class="hljs-string"><span class="hljs-string">"Information"</span></span>, <span class="hljs-string"><span class="hljs-string">"  "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> StringRegExp($magazname,<span class="hljs-string"><span class="hljs-string">"[0-9a-zA-Z_]"</span></span>) =<span class="hljs-number"><span class="hljs-number">0</span></span> then MsgBox(<span class="hljs-number"><span class="hljs-number">4160</span></span>, <span class="hljs-string"><span class="hljs-string">"Information"</span></span>, <span class="hljs-string"><span class="hljs-string">" !"</span></span>) Else <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $lanip2[<span class="hljs-number"><span class="hljs-number">3</span></span>]&lt;&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> Then MsgBox(<span class="hljs-number"><span class="hljs-number">4160</span></span>, <span class="hljs-string"><span class="hljs-string">"Information"</span></span>, <span class="hljs-string"><span class="hljs-string">"    .1  !"</span></span>) Else GUIDelete() ExitLoop EndIf EndIf EndIf EndSelect WEnd $_plinkhandle = Run(@comspec &amp; <span class="hljs-string"><span class="hljs-string">" /c "</span></span> &amp; $_plink_loc &amp; <span class="hljs-string"><span class="hljs-string">" -ssh admin@" &amp; $_plinkserver &amp;"</span></span> -pw MegaPass<span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">",@SW_HIDE,7) sleep (500) ;DFL  .      . ;        , ... StdinWrite($_plinkhandle, "</span></span><span class="hljs-keyword"><span class="hljs-keyword">y</span></span><span class="hljs-string"><span class="hljs-string">"&amp; @CR) sleep (500) StdinWrite($_plinkhandle, "</span></span>script -remove -name=vpns.sgs <span class="hljs-string"><span class="hljs-string">"&amp; @CR) sleep (500) StdinWrite($_plinkhandle, "</span></span>script -remove -name=script.sgs <span class="hljs-string"><span class="hljs-string">"&amp; @CR) sleep (500) ;      -  . StdinWrite($_plinkhandle, "</span></span>script -create InterfaceGroup VPNs -name=vpns.sgs <span class="hljs-string"><span class="hljs-string">"&amp; @CR) sleep (500) StdinWrite($_plinkhandle, "</span></span>Exit <span class="hljs-string"><span class="hljs-string">" &amp; @CR) sleep (250) ProcessClose("</span></span>plink.exe<span class="hljs-string"><span class="hljs-string">") RunWait(@comspec &amp; "</span></span> /c <span class="hljs-string"><span class="hljs-string">" &amp; $scploc &amp; "</span></span> -pw MegaPass admin@"&amp;$_plinkserver&amp;<span class="hljs-string"><span class="hljs-string">":script/vpns.sgs "</span></span> &amp; $file,<span class="hljs-string"><span class="hljs-string">""</span></span>,@SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>) $line = FileReadLine($file,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> $lannet=StringMid($lanip,<span class="hljs-number"><span class="hljs-number">1</span></span>,StringLen($lanip)-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;<span class="hljs-string"><span class="hljs-string">"0/24"</span></span> FileOpen ( $file, <span class="hljs-number"><span class="hljs-number">2</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"cc AddressFolder VpnAdresses"</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"add IP4Address Pool"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" Address="</span></span>&amp;$lannet&amp;<span class="hljs-string"><span class="hljs-string">" -silent"</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"add IP4Address Ip"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" Address="</span></span>&amp;$ipext&amp;<span class="hljs-string"><span class="hljs-string">" -silent"</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"add IP4Address Router"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" Address="</span></span>&amp;$lanip&amp;<span class="hljs-string"><span class="hljs-string">" -silent"</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"cc .."</span></span>) FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"add PSK Key_"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" Type=ASCII PSKAscii="</span></span>&amp;$PSK&amp;<span class="hljs-string"><span class="hljs-string">" Comments="</span></span>&amp;$PSK&amp;<span class="hljs-string"><span class="hljs-string">" -silent"</span></span>) ;  DFL   FileWriteLine ( $file, <span class="hljs-string"><span class="hljs-string">"add IPsecTunnel Magaz_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" LocalNetwork=InterfaceAddresses/lannet RemoteNetwork=VpnAdresses/Pool"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" RemoteEndpoint=VpnAdresses/Ip"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" IKEAlgorithms=High IPsecAlgorithms=High AuthMethod=PSK PSK=Key_"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" PFS=PFS KeepAlive=Manual KeepAliveSourceIP=VpnAdresses/Router_Main KeepAliveDestinationIP=VpnAdresses/Router"</span></span>&amp;$magaznumber&amp;<span class="hljs-string"><span class="hljs-string">"_"</span></span>&amp;$magazname&amp;<span class="hljs-string"><span class="hljs-string">" index=57 -silent"</span></span>) $line=StringReplace ( $line, <span class="hljs-string"><span class="hljs-string">"add"</span></span>, <span class="hljs-string"><span class="hljs-string">"set"</span></span> ,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> ) $line=StringReplace ( $line, <span class="hljs-string"><span class="hljs-string">" -silent"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> ) $line=StringReplace ( $line, <span class="hljs-string"><span class="hljs-string">" -force"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> ) $line=_StringInsert($line, <span class="hljs-string"><span class="hljs-string">", "</span></span>&amp; <span class="hljs-string"><span class="hljs-string">"Magaz_"</span></span>&amp;$magazname, -<span class="hljs-number"><span class="hljs-number">1</span></span>) FileWriteLine ( $file, $line) FileCLose($file) FileCopy($file,$file1) RunWait(@comspec &amp; <span class="hljs-string"><span class="hljs-string">" /c "</span></span> &amp; $scploc &amp; <span class="hljs-string"><span class="hljs-string">" -pw MegaPass "</span></span> &amp; $file1 &amp; <span class="hljs-string"><span class="hljs-string">" admin@"&amp;$_plinkserver&amp;"</span></span>:script/script.sgs<span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">",@SW_HIDE,7) $_plinkhandle = Run(@comspec &amp; "</span></span> /c <span class="hljs-string"><span class="hljs-string">" &amp; $_plink_loc &amp; "</span></span> -ssh admin@" &amp; $_plinkserver &amp;<span class="hljs-string"><span class="hljs-string">" -pw QfJatp123"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,@SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">sleep</span></span> (<span class="hljs-number"><span class="hljs-number">500</span></span>) StdinWrite($_plinkhandle, <span class="hljs-string"><span class="hljs-string">"script -execute -name=script.sgs "</span></span>&amp; @CR) <span class="hljs-keyword"><span class="hljs-keyword">sleep</span></span> (<span class="hljs-number"><span class="hljs-number">250</span></span>) StdinWrite($_plinkhandle, <span class="hljs-string"><span class="hljs-string">"activate "</span></span>&amp; @CR) <span class="hljs-keyword"><span class="hljs-keyword">sleep</span></span> (<span class="hljs-number"><span class="hljs-number">10000</span></span>) StdinWrite($_plinkhandle, <span class="hljs-string"><span class="hljs-string">"commit "</span></span>&amp; @CR) <span class="hljs-keyword"><span class="hljs-keyword">sleep</span></span> (<span class="hljs-number"><span class="hljs-number">250</span></span>) StdinWrite($_plinkhandle, <span class="hljs-string"><span class="hljs-string">"exit "</span></span>&amp; @CR) <span class="hljs-keyword"><span class="hljs-keyword">sleep</span></span> (<span class="hljs-number"><span class="hljs-number">250</span></span>) ProcessClose(<span class="hljs-string"><span class="hljs-string">"plink.exe"</span></span>) EndFunc</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ,         . </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1 id="pashalka-rezervnoe-kopirovanie-d-link-dfl"> :   D-Link DFL </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>       DFL   : full.bak  config.bak.  ,        .          SCP    .             â€“     . </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs mel">#include &lt;Date.au3&gt; #Include &lt;File.au3&gt; Local $_plinkserver = <span class="hljs-string"><span class="hljs-string">" dfl"</span></span> local $scploc=<span class="hljs-string"><span class="hljs-string">"\\server\share\pscp.exe"</span></span> local $path=@ScriptDir&amp;<span class="hljs-string"><span class="hljs-string">"\" $date1=@YEAR&amp;@MON&amp;@MDAY local $file = $path &amp;"</span></span>config-<span class="hljs-string"><span class="hljs-string">"&amp;$date1&amp;"</span></span>.bak<span class="hljs-string"><span class="hljs-string">" $handle=Run(@comspec &amp; "</span></span> /c <span class="hljs-string"><span class="hljs-string">" &amp; $scploc &amp; "</span></span> -pw MegaPass admin@"&amp;$_plinkserver&amp;<span class="hljs-string"><span class="hljs-string">":config.bak "</span></span> &amp; $file,<span class="hljs-string"><span class="hljs-string">""</span></span>,@SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>) sleep (<span class="hljs-number"><span class="hljs-number">500</span></span>) StdinWrite($_plinkhandle, <span class="hljs-string"><span class="hljs-string">"y"</span></span>&amp; @CR) sleep (<span class="hljs-number"><span class="hljs-number">500</span></span>) $file = $path &amp;<span class="hljs-string"><span class="hljs-string">"full-"</span></span>&amp;$date1&amp;<span class="hljs-string"><span class="hljs-string">".bak"</span></span> RunWait(@comspec &amp; <span class="hljs-string"><span class="hljs-string">" /c "</span></span> &amp; $scploc &amp; <span class="hljs-string"><span class="hljs-string">" -pw MegaPass admin@"</span></span>&amp;$_plinkserver&amp;<span class="hljs-string"><span class="hljs-string">":full.bak "</span></span> &amp; $file,<span class="hljs-string"><span class="hljs-string">""</span></span>,@SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>) ;   ;  ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FileExists($path &amp;<span class="hljs-string"><span class="hljs-string">"full-"</span></span>&amp;$date1&amp;<span class="hljs-string"><span class="hljs-string">".bak"</span></span>) and FileExists($file = $path &amp;<span class="hljs-string"><span class="hljs-string">"config-"</span></span>&amp;$date1&amp;<span class="hljs-string"><span class="hljs-string">".bak"</span></span>) Then $files = _FileListToArray($path, <span class="hljs-string"><span class="hljs-string">"*.bak"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,True) $date=@YEAR&amp;<span class="hljs-string"><span class="hljs-string">"/"</span></span>&amp;@MON&amp;<span class="hljs-string"><span class="hljs-string">"/"</span></span>&amp;@MDAY $newdate=_DateAdd(<span class="hljs-string"><span class="hljs-string">"D"</span></span>,<span class="hljs-number"><span class="hljs-number">-14</span></span>,$date) $formatdate=StringSplit($newdate,<span class="hljs-string"><span class="hljs-string">"/"</span></span>) $newdate=$formatdate[<span class="hljs-number"><span class="hljs-number">1</span></span>]&amp;$formatdate[<span class="hljs-number"><span class="hljs-number">2</span></span>]&amp;$formatdate[<span class="hljs-number"><span class="hljs-number">3</span></span>]&amp;@HOUR&amp;@MIN&amp;@SEC If IsArray($files) Then For $i = <span class="hljs-number"><span class="hljs-number">1</span></span> To UBound($files) - <span class="hljs-number"><span class="hljs-number">1</span></span> $aTime = FileGetTime( $files[$i], <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) If $aTime &lt; $newdate Then FileDelete($files[$i]) EndIf Next EndIf EndIf</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p><img src="https://habrastorage.org/files/e56/3d9/562/e563d95629e0446582c83c8292bae3c3.jpg" alt="ç”»åƒã®ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ"></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>      DFL. </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1 id="itogo"> åˆè¨ˆ </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> ,         ,  -    .         SNMP   <a href="http://wiki.mikrotik.com/wiki/Manual:API">API  </a> .                   Mikrotik .  ,   . </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p> <strong>           â€“    !</strong> </p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J321016/index.html">ML Boot Camp IIIã®ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°</a></li>
<li><a href="../J321018/index.html">ã‚¯ãƒ©ã‚¦ãƒ‰ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../J321020/index.html">ITãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã¯ã©ã®ã‚ˆã†ã«åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ SearchInformé–‹ç™ºãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼Dmitry Gatsura</a></li>
<li><a href="../J321024/index.html">ã‚¯ãƒ©ã‚¹ã‚¯ãƒ©ã‚¹</a></li>
<li><a href="../J321026/index.html">è³¢ããªã‚Šã€ã‚¯ã‚¨ã‚¹ãƒˆã‚’2å€é€Ÿãé–‹ãæ–¹æ³•ã‚’å­¦ã‚“ã æ–¹æ³•</a></li>
<li><a href="../J321032/index.html">é–‹ç™ºã§ã®Sketchode 2ã®ä½¿ç”¨ï¼šæ¦‚è¦</a></li>
<li><a href="../J321034/index.html">Ruby on Railsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¤‡é›‘ã•ã®ç®¡ç†ã€‚ ãƒ‘ãƒ¼ãƒˆ3</a></li>
<li><a href="../J321036/index.html">ã™ã¹ã¦ã®å§‹ã¾ã‚Šï¼šé–‹ç™ºè€…ã¯æœ€åˆã«ä½œæˆã—ãŸã‚²ãƒ¼ãƒ ã‚’æ€ã„å‡ºã—ã¾ã™</a></li>
<li><a href="../J321038/index.html">æœ€åˆã®Unityã‚²ãƒ¼ãƒ ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼-ã‚¢ã‚¤ãƒ‡ã‚¢ã‹ã‚‰ãƒªãƒªãƒ¼ã‚¹ã¾ã§</a></li>
<li><a href="../J321040/index.html">ãƒ­ã‚·ã‚¢ã®4Gapï¼šãƒ­ã‚·ã‚¢ãŠã‚ˆã³ä¸–ç•Œã§ã®4Gãƒãƒƒãƒˆãƒ¯â€‹â€‹ãƒ¼ã‚¯ã®åˆ†å¸ƒ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>