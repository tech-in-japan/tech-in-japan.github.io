<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â›µï¸ ğŸš¶ ğŸ‘¨ğŸ¾â€ğŸ“ OLTPã‚²ãƒ¼ãƒ  â˜®ï¸ ğŸ“¦ ğŸ </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ€è¿‘ã€é«˜æ€§èƒ½ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã®ãƒ†ãƒ¼ãƒãŒHabrÃ©ã§ä¸€èˆ¬çš„ã«ãªã‚Šã¾ã—ãŸã€‚ ã¾ãŸã€ã“ã®æ–¹å‘ã§å°‘ã—å®Ÿé¨“ã—ã€ç ”ç©¶ã®ç¾åœ¨ã®çµæœã‚’å…±æœ‰ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ 
  
 
  
 ä»¶åã€ŒHelloã€worldï¼ã€ã¯æœ€ã‚‚å˜ç´”ãªOLTPã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ 
  
 
  
  
  
  
  
 
  
 
  
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>OLTPã‚²ãƒ¼ãƒ </h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/69974/"> æœ€è¿‘ã€é«˜æ€§èƒ½ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã®ãƒ†ãƒ¼ãƒãŒHabrÃ©ã§ä¸€èˆ¬çš„ã«ãªã‚Šã¾ã—ãŸã€‚ ã¾ãŸã€ã“ã®æ–¹å‘ã§å°‘ã—å®Ÿé¨“ã—ã€ç ”ç©¶ã®ç¾åœ¨ã®çµæœã‚’å…±æœ‰ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ä»¶å<em>ã€ŒHelloã€worldï¼ã€</em>ã¯æœ€ã‚‚å˜ç´”ãªOLTPã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="http://img201.imageshack.us/img201/909/mainb.jpg"></div>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã®ã‚ˆã†ãªã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆãƒˆãƒ¬ãƒ©ãƒ³ã‚¹ã®è¦ä»¶ãŒé‡è¦ã§ã™ã€‚ ã—ãŸãŒã£ã¦ã€å•é¡Œã®è§£æ±ºç­–ã®æ¤œç´¢ã¯ã€Cã€C ++ã€fastcgiã€nginxã€lighttpdã€oracleã®æ–¹å‘ã§å®Ÿè¡Œã•ã‚Œã¾ã—ãŸã€‚ ã¾ãšã€ã“ã‚Œã‚‰ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã§OLTPã‚’æ§‹ç¯‰ã™ã‚‹ã•ã¾ã–ã¾ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è©¦ã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ãƒ”ãƒ¼ã‚¯è² è·ã‚’æ¸¬å®šã™ã‚‹ã“ã¨ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ãã—ã¦ã€å•é¡Œã®æ¡ä»¶ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     æ¬¡ã®å½¢å¼ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼štransfer X cu  ï¼ˆãŠé‡‘ã€ã‚ãªãŸã¯ã©ã†æ€ã„ã¾ã—ãŸã‹ï¼‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆAã‹ã‚‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆBã¸ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯æ¬¡ã®å½¢å¼ã§ã™ </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>server.com/paysys.request?account=123&amp;operator=456&amp;money=789</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã¤ã¾ã‚Šã€ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼456ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼123ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«789ã®ãŠé‡‘ã‚’è»¢é€ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯3ã¤ã®ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã¿ãŒã‚ã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://img201.imageshack.us/img201/9679/tablesp.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <sub>ï¼ˆå›³1. DBæ§‹é€ ï¼‰</sub> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ‰‹é †ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã‚ˆã‚Šã‚‚ãã‚Œã»ã©è¤‡é›‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; begin o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) then o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> else <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; insert <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) values ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">procedure</font> PROCESS_TRANS(p_account_id <font color="#0000ff">in</font> number, p_operator_id <font color="#0000ff">in</font> number, p_sum <font color="#0000ff">in</font> number, o_result <font color="#0000ff">out</font> number) <font color="#0000ff">is</font> l_cnt  number; <font color="#0000ff">cursor</font> cur_account <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_account <font color="#0000ff">where</font> id = p_account_id <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> balance; <font color="#0000ff">cursor</font> cur_operator <font color="#0000ff">is</font> <font color="#0000ff">select</font> id <font color="#0000ff">from</font> pay_operator <font color="#0000ff">where</font> id = p_operator_id <font color="#0000ff">and</font> total &gt;= p_sum <font color="#0000ff">for</font> <font color="#0000ff">update</font> <font color="#0000ff">of</font> total; <font color="#0000ff">begin</font> o_result := -1; <font color="#008000">-- tansaction begins</font> <font color="#0000ff">select</font> <font color="#0000ff">count</font> (1) <font color="#008000">-- if such operator exist?</font> <font color="#0000ff">into</font> l_cnt <font color="#0000ff">from</font> pay_operator opr <font color="#0000ff">where</font> opr.id = p_operator_id; <font color="#0000ff">if</font> (l_cnt != 1) <font color="#0000ff">then</font> o_result := -2; <font color="#008000">-- Operator not found!</font> <font color="#0000ff">return</font> ; <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">open</font> cur_account; <font color="#0000ff">open</font> cur_operator; <font color="#0000ff">fetch</font> cur_account <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- need to fetch to update rows later</font> <font color="#0000ff">fetch</font> cur_operator <font color="#0000ff">into</font> l_cnt; <font color="#008000">-- 0/1 row in cursor as selected by prim_key</font> <font color="#0000ff">if</font> cur_account%notfound <font color="#0000ff">then</font> o_result := -3; <font color="#008000">-- Account not found!</font> elsif cur_operator%notfound <font color="#0000ff">then</font> o_result := -4; <font color="#008000">-- Operator has not enough money</font> <font color="#0000ff">else</font> <font color="#0000ff">update</font> pay_account <font color="#0000ff">set</font> balance = (balance + p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_account; <font color="#0000ff">update</font> pay_operator <font color="#0000ff">set</font> total = (total - p_sum) <font color="#0000ff">where</font> <font color="#0000ff">current</font> <font color="#0000ff">of</font> cur_operator; <font color="#0000ff">insert</font> <font color="#0000ff">into</font> pay_transaction ( id, account_id, operator_id, money, datetime ) <font color="#0000ff">values</font> ( pay_transaction_seq.nextval, p_account_id, p_operator_id, p_sum, sysdate ); <font color="#0000ff">commit</font> ; o_result := 1; <font color="#008000">-- transaction successfully finished!</font> <font color="#0000ff">end</font> <font color="#0000ff">if</font> ; <font color="#0000ff">close</font> cur_account; <font color="#0000ff">close</font> cur_operator; <font color="#0000ff">end</font> ;</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å¤šæ•°ã®åŒæ™‚æ¥ç¶šã‚’å‚™ãˆãŸé«˜è² è·ã®ã‚µãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®æœ€ã‚‚ã‚¤ãƒ‡ã‚ªãƒ­ã‚®ãƒ¼çš„ã‹ã¤å®Ÿéš›çš„ã«æ­£ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¯ã‚µã®å®Ÿè£…ã§ã™ï¼ˆ <a href="http://www.kegel.com/c10k.html">C10Kã®å•é¡Œ</a> ï¼‰ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å½¼ã‚‰ã¯ã€ã€Œéä¼çµ±çš„ãªã€ <em>Oracle 10.2 Express Edition</em>ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦æ¡ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚  <em>ç´„2ãƒŸãƒªç§’ã§</em>å®Ÿè¡Œã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ›´æ–°ï¼‰ã€‚  OracleãŒãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã—ãŸã¨ãï¼ˆæ˜ã‚‰ã‹ã«<em>dbwrãŒ</em>å¤‰æ›´ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ–ãƒ­ãƒƒã‚¯ã‚’ãƒãƒƒãƒ•ã‚¡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰æ›¸ãè¾¼ã‚“ã§ã„ãŸã¨ãï¼‰ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯<em>20ãƒŸãƒªç§’</em>ã¾ã§é…å»¶ã—ã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ã€ãƒ¡ãƒ¼ã‚«ãƒ¼ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ ã“ã‚Œã‚‰ã®ã†ã¡ã€ã‚¿ã‚¹ã‚¯ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯ã€2ã¤ã®ã‚¸ãƒ§ãƒ¼ã‚¯ãŒè“„ç©ã•ã‚Œã¾ã—ãŸã€‚ <ul><li>  Oracle Call InterfaceÂ© </li><li>  Oracle C ++ Call Interfaceï¼ˆC ++ï¼‰ </li></ul>  OCIã®æœ€é«˜ã®ä¼çµ±ã§ã‚ã‚‹OCCIã¯ã€ã¯ã‚‹ã‹ã«è¦–è¦šçš„ã§ä½¿ã„ã‚„ã™ã„ã§ã™ã€‚ ãŸã ã—ã€ãã®ä½ãƒ¬ãƒ™ãƒ«ã®å¯¾å¿œã«ã¯å¦å®šã§ããªã„åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚OCIã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€1ã¤ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å‡¦ç†ã®ä¸€éƒ¨ã¨ã—ã¦è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã‚’æŒã¤å¤šé‡åŒ–ã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«å¿…è¦ãªéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼ˆéåŒæœŸï¼‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚ å¤šãã®äººã¯ã€ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã‚³ãƒ¼ãƒ«ã®å¯èƒ½æ€§ã®ãŸã‚ã«ã€ã‹ãªã‚Šé¢å€’ãªã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã€OCCIã‚½ãƒ¼ã‚¹ã‚’é–‹ãã‚ˆã†ã«Oracleã«è¦æ±‚ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ä¸æº€ã«æ€ã£ã¦ã„ã¾ã™ãŒã€ç§ãŒçŸ¥ã‚‹é™ã‚Šã€å½¹ã«ç«‹ã¡ã¾ã›ã‚“ã€‚ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é¢ã§ã¯ã€2äººã®å…„å¼Ÿã¯éå¸¸ã«ã‚ãšã‹ã«ç•°ãªã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> æˆåˆ† </h4><ul><li>  Oracle XE 10.2 </li><li>  Nginx 0.7.62 </li><li>  Lighttpd 1.4.23 </li></ul> ä»–ã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŒãªã„ãŸã‚ã€ <em>Acer 5920G</em>ãƒ©ãƒƒãƒ—ãƒˆãƒƒãƒ—ä¸Šã®<em>VMWareã®</em>ä¸‹ã§<em>Ubuntu 9.04ã«</em>ä½ã‚“ã§ã„ã¾ã—ãŸã€‚ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒåŒã˜ç’°å¢ƒã§å®Ÿè¡Œã•ã‚ŒãŸãŸã‚ã€ãƒªã‚½ãƒ¼ã‚¹ã®ä¸è¶³ï¼ˆä¸¡æ–¹ã®æ„å‘³ã§ï¼‰ãŒæ¯”è¼ƒãƒ†ã‚¹ãƒˆã®çµæœã®å®¢è¦³æ€§ã«å½±éŸ¿ã‚’ä¸ãˆãªã„ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Oracleã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ã¯ã€Tom Kiteã‹ã‚‰é ãé›¢ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨OSã¯ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«ã‚ã¾ã‚Šç…©ã‚ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ ãƒ•ãƒ«ã‚µãƒ¼ãƒãƒ¼ã«ç§»è¡Œã™ã‚‹ã¨ãã¯å¿™ã—ããªã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å®Ÿé¨“ã®ç´”åº¦ã‚’é«˜ã‚ã‚‹ãŸã‚ã€å„ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã€œ100kã‚¨ãƒ³ãƒˆãƒªãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> ä½“é¨“ </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãã®ã‚ˆã†ãªã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã¯ï¼Ÿ  FastCGIãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«åŸºã¥ãæœ€ã‚‚ç°¡å˜ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è€ƒãˆãŸã®ã¯ç§ãŸã¡ãŒæœ€åˆã§ã—ãŸã€‚  FastCGIãŒãã®ç¥–å…ˆCGIã¨æ¯”è¼ƒã—ã¦å¥½æ„çš„ã«æ¯”è¼ƒã•ã‚Œã‚‹æ–¹æ³•ã‚’ã‚‚ã†ä¸€åº¦èª¬æ˜ã™ã‚‹ä¾¡å€¤ã¯ãªã„ã¨æ€ã„ã¾ã™ã€‚ é«˜è² è·ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã“ã®é•ã„ãŒåŸºæœ¬ã§ã™ã€‚ åˆ¥ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ãŸã„ã¨æ€ã„ã¾ã™ãŒã€ã™ãã«ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      FastCGIä»•æ§˜ã¯ã€è¤‡æ•°ã®è¦æ±‚ã®å¤šé‡åŒ–å‡¦ç†ã‚’åŒæ™‚ã«å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¥ç¶šã®ä¿å­˜ã‚’è¦å®šã—ã¦ã„ã¾ã™ã€‚ ç°¡å˜ã«è¨€ãˆã°ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã§éåŒæœŸæ“ä½œã‚’å‘¼ã³å‡ºã—ã¦ã€ä»–ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é™ã‹ã«ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼æ™‚é–“ã‚’ä¸ãˆã€ãƒãƒ¼ãƒªãƒ³ã‚°ã‚µã‚¤ã‚¯ãƒ«ã®æ¬¡ã®åå¾©ã§ã€å‘¼ã³å‡ºã•ã‚ŒãŸæ“ä½œã®çµæœã‚’å–å¾—ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¿œç­”ã‚’æ¸¡ã—ã¦ã€æ¥ç¶šã‚’é–‰ã˜ã¾ã™ã€‚ æ®‹å¿µãªãŒã‚‰ã€nginxã¨lighttpdï¼ˆãŠã‚ˆã³libfcgiã¨fastcgippãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã¯ã¾ã ã“ã‚Œã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ãŸã‚ã€æ¬¡ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹å‰ã«æ¥ç¶šã‚’é–‰ã˜ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãŸã ã—ã€ã“ã®ä¾‹ã§ã¯ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å¤§å¹…ãªä½ä¸‹ã‚’å¿ƒé…ã›ãšã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å¯¾ã—ã¦1ã¤ã®çŸ­ã„ã‚¯ã‚¨ãƒªã®ã¿ã‚’åŒæœŸçš„ã«å®Ÿè¡Œã§ãã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Nginxã¨lighttpdã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€2ã¤ã®æ–¹æ³•ã§FastCGIã¨ã‚„ã‚Šå–ã‚Šã§ãã¾ã™ã€‚TCPãƒãƒ£ãƒãƒ«ã¨Unixãƒ‰ãƒ¡ã‚¤ãƒ³ã‚½ã‚±ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã§ã™ã€‚ æœ€åˆã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®åˆ©ç‚¹ã¯FastCGIã‚µãƒ¼ãƒãƒ¼ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã®å¯èƒ½æ€§ã§ã‚ã‚Šã€æ¬ ç‚¹ã¯ãƒ‡ãƒ¼ã‚¿è»¢é€ã®æ¯”è¼ƒçš„é«˜ã„ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã§ã™ï¼ˆãã‚Œã«ã‚‚ã‹ã‹ã‚ã‚‰ãšTCPã‚¹ã‚¿ãƒƒã‚¯ï¼‰ã€‚ ãŸã ã—ã€UDSã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ã¿å‹•ä½œã™ã‚‹ãŸã‚ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2ç•ªç›®ã®æ–¹æ³•ã«ã¤ã„ã¦ã€å¤šãã®ã€Œæš–ã‹ã„ã€è¨€è‘‰ã‚’è¿°ã¹ãŸã„ã¨æ€ã„ã¾ã™ã€‚ æœ€åˆã®ãƒ†ã‚¹ãƒˆå¾Œã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®10åˆ†ã®1ãŒFastCGIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆ°é”ã—ã€200ä»¥ä¸Šã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ä¸Šï¼‰ã‹ã‚‰ã®åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå±Šãã¾ã—ãŸã€‚ ã‚­ãƒ£ãƒƒãƒã¯ã‚«ãƒ¼ãƒãƒ«å¤‰æ•°net.unux.max_dgram_qlenã«ã‚ã‚Šã¾ã—ãŸã€‚ã“ã‚Œã¯ã€ã‚½ã‚±ãƒƒãƒˆã¸ã®æ›¸ãè¾¼ã¿æ™‚ã®è¦æ±‚ã‚­ãƒ¥ãƒ¼ã®ã‚µã‚¤ã‚ºã‚’åˆ¶é™ã—ã¾ã™ã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯10ã§ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æå¤±ã‚’èª¬æ˜ã—ã¦ã„ã¾ã—ãŸã€‚ å€¤ã‚’10000ã«è¨­å®šã™ã‚‹ã¨ã€ã™ã¹ã¦ãŒæ­£å¸¸ã«æˆ»ã‚‹ã¯ãšã§ã™ã€‚ ã—ã‹ã—ã€ãã“ã«ã‚ã‚Šã¾ã—ãŸã€‚ ã»ã¼10åˆ†ã®1ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç¢ºå®Ÿã«è½ã¡ã€nginxã¯ãƒ­ã‚¸ãƒƒã‚¯ã«<em>ã€Œconnectï¼ˆï¼‰to socket failedï¼ˆ11ï¼šResource temporary unavailableï¼‰ã€</em>ã¨ã„ã†æã‚ã—ã„è¨€è‘‰ã‚’æ›¸ãã¾ã—ãŸã€‚ ãƒ­ã‚·ã‚¢èªã§ã¯ã€å¤šæ•°ã®åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã‚‹ãŸã‚ã€ã‚½ã‚±ãƒƒãƒˆã¯ã€Œçª’æ¯ã€ã—ã¦ã„ã¾ã—ãŸã€‚ ã“ã®å•é¡Œã¯ã¾ã è§£æ±ºã§ãã¦ã„ã¾ã›ã‚“ã€‚ ç”Ÿç”£æ€§ã¯å‘ä¸Šã—ã¾ã—ãŸãŒã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ç´„10ï¼…ãŒã‚³ãƒ¼ãƒ‰<em>ã€Œ502ã€ã§</em>å®Œäº†ã—ãŸã¨ãã«ã€èª°ãŒãã‚Œã‚’å¿…è¦ã¨ã—ã¾ã™ã‹ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  FastCGIã‚µãƒ¼ãƒãƒ¼ï¼š </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     <ol><li>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * bind_address = <font color="#A31515">"ï¼š9000"</font> ; </li><li>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * db_user_name = <font color="#A31515">"orauser"</font> ; </li><li>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * db_password = <font color="#A31515">"pass"</font> ; </li><li>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * db_conn_str = <font color="#A31515">"compï¼š1521 / xe"</font> ; </li><li></li><li>  <font color="#0000ff">int</font> mainï¼ˆ <font color="#0000ff">int</font> argcã€ <font color="#0000ff">char</font> * <font color="#0000ff">const</font> argv []ï¼‰ </li><li>  { </li><li>  oracleï¼šocci <font color="#0000ff">åå‰ç©ºé–“</font> <font color="#0000ff">ã‚’ä½¿ç”¨ã—</font> <font color="#0000ff">ã¾ã™</font> ã€‚ </li><li></li><li>  <font color="#0000ff">int</font> listenQueueBacklog = 4000; </li><li>  FCGX_Requestãƒªã‚¯ã‚¨ã‚¹ãƒˆ; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆFCGX_Initï¼ˆï¼‰ï¼‰ </li><li>  exitï¼ˆ1ï¼‰; </li><li></li><li>  <font color="#0000ff">int</font> listen_socket = FCGX_OpenSocketï¼ˆbind_addressã€listenQueueBacklogï¼‰; </li><li>  <font color="#0000ff">if</font> ï¼ˆlisten_socket &lt;0ï¼‰ </li><li>  exitï¼ˆ1ï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆfchmodï¼ˆlisten_socketã€S_IROTH | S_IWOTHï¼‰ï¼‰ </li><li>  exitï¼ˆ1ï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆFCGX_InitRequestï¼ˆï¼†requestã€listen_socketã€0ï¼‰ï¼‰exitï¼ˆ1ï¼‰; </li><li></li><li> ç’°å¢ƒ* env = Environment :: createEnvironmentï¼ˆEnvironment :: DEFAULTï¼‰; </li><li> æ¥ç¶š* conn = env-&gt; createConnectionï¼ˆdb_user_nameã€db_passwordã€db_conn_strï¼‰; </li><li> ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ* stmt = conn-&gt; createStatementï¼ˆ </li><li>  <font color="#A31515">ã€ŒBEGIN PAY_SYS.PROCESS_TRANSï¼ˆï¼šv1 ,: v2 ,: v3 ,: v4ï¼‰; END;ã€</font>  ï¼‰; </li><li></li><li>  <font color="#0000ff">while</font> ï¼ˆFCGX_Accept_rï¼ˆï¼†requestï¼‰== 0ï¼‰ </li><li>  { </li><li>  <font color="#0000ff">bool</font> noException = <font color="#0000ff">false</font> ã€succesful = <font color="#0000ff">false</font> ; </li><li></li><li>  <font color="#0000ff">ãƒ­ãƒ³ã‚°</font>ã‚¹ã‚¿ãƒ¼ãƒˆ= GetTickCountï¼ˆï¼‰; </li><li>  <font color="#0000ff">char</font> * <font color="#0000ff">params</font> = FCGX_GetParamï¼ˆ <font color="#A31515">"QUERY_STRING"</font> ã€request.envpï¼‰; </li><li>  <font color="#0000ff">int</font> operatorIDã€accountIDã€moneySumã€result = -1; </li><li></li><li>  operatorID = GetIntParamï¼ˆ <font color="#0000ff">params</font> ã€ <font color="#A31515">"operator ="</font> ï¼‰; </li><li>  accountID = GetIntParamï¼ˆ <font color="#0000ff">params</font> ã€ <font color="#A31515">"account ="</font> ï¼‰; </li><li>  moneySum = GetIntParamï¼ˆ <font color="#0000ff">params</font> ã€ <font color="#A31515">"money ="</font> ï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆoperatorID &lt;= 0 || accountID &lt;= 0 || moneySum &lt;= 0ï¼‰ </li><li>  { </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚å‡ºåŠ›ã€ <font color="#A31515">ã€ŒHTTP / 1.0 503 Params Error \ nã€</font> ï¼‰; </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚å‡ºåŠ›ã€ <font color="#A31515">ã€Œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ï¼štext / html \ r \ n \ r \ nã€</font> ï¼‰; </li><li>  FCGX_FPrintFï¼ˆrequestã€‚Outã€ <font color="#A31515">"wrong params &lt;br&gt; \ n"</font> ï¼‰; </li><li>  FCGX_Finish_rï¼ˆï¼†ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰; </li><li>  <font color="#0000ff">ç¶šã‘ã‚‹</font> ; </li><li>  } </li><li></li><li>  <font color="#0000ff">è©¦ã—ã¦ã¿ã‚‹</font> </li><li>  { </li><li>  stmt-&gt; setIntï¼ˆ1ã€accountIDï¼‰; </li><li>  stmt-&gt; setIntï¼ˆ2ã€operatorIDï¼‰; </li><li>  stmt-&gt; setIntï¼ˆ3ã€moneySumï¼‰; </li><li>  stmt-&gt; registerOutParamï¼ˆ4ã€OCCIINTã€ <font color="#0000ff">sizeof</font> ï¼ˆçµæœï¼‰ï¼‰; </li><li>  stmt-&gt; executeï¼ˆï¼‰; </li><li> çµæœ= stmt-&gt; getIntï¼ˆ4ï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆçµæœ== 1ï¼‰ </li><li>  succesful = <font color="#0000ff">true</font> ; </li><li>  } </li><li>  <font color="#0000ff">catch</font> ï¼ˆSQLExceptionãŠã‚ˆã³sqlExcpï¼‰ </li><li>  { </li><li>  error_logï¼ˆsqlExcp.getMessageï¼ˆï¼‰ã€‚c_strï¼ˆï¼‰ï¼‰; </li><li>  } </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆæˆåŠŸï¼‰ </li><li>  { </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚å‡ºåŠ›ã€ <font color="#A31515">ã€ŒHTTP / 1.0 200 OK \ nã€</font> ï¼‰; </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚å‡ºåŠ›ã€ <font color="#A31515">ã€Œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ï¼štext / html \ r \ n \ r \ nã€</font> ï¼‰; </li><li>  FCGX_FPrintFï¼ˆrequestã€‚Outã€ <font color="#A31515">ã€ŒSQL result =ï¼…dã€</font> ã€resultï¼‰; </li><li>  } </li><li>  <font color="#0000ff">ä»–ã«</font> </li><li>  { </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚Outã€ <font color="#A31515">"HTTP / 1.0 503 DatabaseError \ n"</font> ï¼‰; </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚å‡ºåŠ›ã€ <font color="#A31515">ã€Œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ï¼štext / html \ r \ n \ r \ nã€</font> ï¼‰; </li><li>  FCGX_FPrintFï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚å‡ºåŠ›ã€ <font color="#A31515">ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€</font> ï¼‰; </li><li>  error_logï¼ˆ <font color="#A31515">"db error"</font> ï¼‰; </li><li>  } </li><li></li><li>  FCGX_Finish_rï¼ˆï¼†ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰; </li><li>  } </li><li></li><li>  conn-&gt; terminateStatementï¼ˆstmtï¼‰; </li><li>  env-&gt; terminateConnectionï¼ˆconnï¼‰; </li><li> ç’°å¢ƒ:: terminateEnvironmentï¼ˆenvï¼‰; </li><li></li><li>  0ã‚’<font color="#0000ff">è¿”ã—</font>ã¾ã™ã€‚ </li><li>  } </li></ol>  <font color="gray">*ã“ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€ <font color="gray">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ©ã‚¤ã‚¿ãƒ¼ã§</font>å¼·èª¿è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚</font> </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> åˆè¨ˆ </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ä½¿ç”¨ã•ã‚ŒãŸåŒ…å›²ã¨abã€‚ ãƒ¡ãƒ¢ãƒªã®å•é¡Œã«ã‚ˆã‚Šã€Siegeã¯1ç§’ã‚ãŸã‚Š380ã‚’è¶…ãˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãã£ã±ã‚Šã¨æ‹’å¦ã—ã€1000ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã€Œçµã‚Šè¾¼ã‚“ã ã€ãŒã€éå‰°ãªæ•°ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ã‚±ãƒƒãƒˆã«è¨€åŠã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     çµæœã®ä¿¡é ¼æ€§ã®ãŸã‚ã«ã€ãƒ†ã‚¹ãƒˆã¯100ã€200ã€300ã€400ã®åŒæ™‚10,000ã‚¯ã‚¨ãƒªã®ã‚¹ã‚­ãƒ¼ãƒ ã«å¾“ã£ã¦å®Ÿè¡Œã•ã‚Œã¾ã—ãŸã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚«ãƒ¼ãƒãƒ«è¨­å®šã‚’ä½¿ç”¨ã—ãŸã“ã®ãƒã‚·ãƒ³ä¸Šã®FastCGIã®å ´åˆã€è² è·ã¯ã€å¤±ã‚ã‚ŒãŸè¦æ±‚ã®10ï¼…ã®ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã—ãã„å€¤ã‚’å…‹æœã™ã‚‹ã®ã«ååˆ†ã§ã—ãŸã€‚  lighttpd + fastcgiã®æŸã¯200ä»¶ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã€Œã¤ã¾ãšãã€å§‹ã‚ã¾ã—ãŸãŒã€nginxã®æŸã¯æœ€å¤§300ã®åŒæ™‚æ¥ç¶šã‚’ç¶­æŒã—ã¾ã—ãŸã€‚  400ã‚’è¶…ãˆã‚‹åŒæ™‚æ¥ç¶šã®è² è·ã§ã¯ã€ä¸¡æ–¹ã®FastCGIãƒãƒªã‚¢ãƒ³ãƒˆãŒã€Œapr_pollï¼šæŒ‡å®šã•ã‚ŒãŸã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒæœŸé™åˆ‡ã‚Œï¼ˆ70007ï¼‰ã€ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§è½ã¡ã¾ã—ãŸãŒã€nginxãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯abã‚’ä»‹ã—ãŸ1000ã®åŒæ™‚æ¥ç¶šã§æ‚²é³´ã‚’ä¸Šã’ã‚‹ã“ã¨ãªãåˆ†è§£ã•ã‚Œã¾ã—ãŸã€‚ ãƒ†ã‚¹ãƒˆã¯å†ã³ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã§å®Ÿè¡Œã•ã‚Œã¾ã—ãŸã€‚ æ˜ç¢ºã«ã™ã‚‹ãŸã‚ã«ã€æ¸¬å®šçµæœã‚’ã‚°ãƒ©ãƒ•å½¢å¼ã§è¡¨ç¤ºã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãã®ãŸã‚ã€ã‚°ãƒ©ãƒ•ã®ç½²åã«å¿œã˜ã¦ã€æ¨ªè»¸-åŒæ™‚è¦æ±‚æ•°ã€ç¸¦è»¸-ã«ãªã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://img225.imageshack.us/img225/5023/longestrequest.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <sub>ï¼ˆå›³2.æœ€é•·ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ç§’ï¼‰</sub> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://img225.imageshack.us/img225/707/meantime.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <sub>ï¼ˆå›³3.å¹³å‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†æ™‚é–“ã€ç§’ï¼‰</sub> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://img201.imageshack.us/img201/1341/rps.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <sub>ï¼ˆå›³4. 1ç§’é–“ã«å‡¦ç†ã•ã‚Œã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ•°ï¼‰</sub> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://img233.imageshack.us/img233/3711/testtime.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <sub>ï¼ˆå›³5. 10,000ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ã«ã‹ã‹ã£ãŸæ™‚é–“ã€ç§’ï¼‰</sub> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2> ãŠã‚ã‚Šã« </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     é™ã‚‰ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã§ã¯ç´ æ™´ã‚‰ã—ã„çµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸãŒã€æ¯”è¼ƒãƒ†ã‚¹ãƒˆã¯éå¸¸ã«æˆåŠŸã—ãŸã¨ä¿¡ã˜ã¦ã„ã¾ã™ã€‚ ãƒ†ã‚¹ãƒˆçµæœã¯å®Œå…¨ã§ã‚ã‚‹ã¨ä¸»å¼µã—ã¦ã„ã¾ã›ã‚“ãŒã€ä¸€èˆ¬çš„ã«ã€ç§ãŸã¡ã®æ„è¦‹ã§ã¯ã€æœŸå¾…ã‚’ç¢ºèªã—ã¾ã™ã€‚ å›½å†…ã®ã‚¢ã‚¹ãƒªãƒ¼ãƒˆã¯ã€æœ€å°é™ã®è¿½åŠ è£…å‚™ã§è‡ªä¿¡ã‚’æŒã£ã¦ãƒªãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚ å½¼ã¨å½¼ã®ã‚³ãƒ¼ãƒã¯å¤§ããªæ•¬æ„ã‚’æ‰•ã£ã¦ã„ã¾ã™ï¼  FastCGIã¨é€£å‹•ã—ã¦ã€å½¼ã¯å†ã³å°ã•ãªå¤–å›½ã®æ•µã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ç§ãŸã¡ã®å®Ÿé¨“ã§ã¯ã€éåŒæœŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å‘¼ã³å‡ºã—ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã¾ã ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å‡¦ç†ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®è¤‡æ•°ã®å‘¼ã³å‡ºã—ã«è¤‡é›‘ã«ã—ã€å®Œå…¨ãªãƒãƒ«ãƒãƒ—ãƒ¬ã‚¯ã‚µã‚’å®Ÿè£…ã™ã‚‹ã¨ã€ãƒ†ã‚¹ãƒˆçµæœãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚  FastCGIã§ã¯ã€ã“ã‚Œã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ãŒã€nginxãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å®Ÿè¡Œã§ãã¾ã™ã€‚å®Ÿé¨“ã‚’å®Œå…¨ã«ã™ã‚‹ãŸã‚ã«ã€pocoã€asioã€pionãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«åŸºã¥ã„ã¦ç‹¬è‡ªã®HTTPãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’å‘¼ã³å‡ºã—ã¦ã€ã€Œå®Ÿé¨“çš„ã€ãªã‚‚ã®ã®ãƒ©ãƒ³ã‚¯ã«å…¥ã‚Œã¾ã™... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ä¸€èˆ¬çš„ã«ã€ <em>ç¶™ç¶šã™ã‚‹ã«ã¯...</em> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>UPD</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Nginxãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€é™çš„ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ã‚µãƒ¼ãƒãƒ¼æ‹¡å¼µæ©Ÿèƒ½ã§ã™ã€‚  SSLã‚„FastCGIãªã©ã®çµ„ã¿è¾¼ã¿æ©Ÿèƒ½ã‚‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ ãƒ—ãƒ©ã‚¹-é€Ÿåº¦ã€ãƒã‚¤ãƒŠã‚¹-å®Ÿè¡Œä¸­ã®ãƒã‚·ãƒ³ã§ã®æ›´æ–°ã®è¤‡é›‘ã•ã€‚ ã™ã°ã‚‰ã—ã„ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãŒ<a href="http://www.evanmiller.org/">ã“ã“ã«ã‚ã‚Šã¾ã™</a> ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ç°¡å˜ãªä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ å¤‰æ›´ã«ã¤ã„ã¦ã¯ã€OCI Cãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ORACLEã‚’æ“ä½œã—ã¦ãã ã•ã„ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     <ol><li>  <font color="#008000">// nginx.confãŠã‚ˆã³ã‚¨ãƒ©ãƒ¼å‡¦ç†ã«ã‚ˆã‚‹è¨­å®šã®ã‚µãƒãƒ¼ãƒˆãªã—ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³</font> </li><li></li><li>  #include &lt;ngx_config.h&gt; </li><li>  #include &lt;ngx_core.h&gt; </li><li>  #include &lt;ngx_http.h&gt; </li><li>  #include &lt; <font color="#0000ff">string</font> .h&gt; </li><li>  #include &lt;oci.h&gt; </li><li></li><li>  <font color="#0000ff">const</font> text * db_user_name =ï¼ˆ <font color="#0000ff">const</font> text *ï¼‰ <font color="#A31515">"orauser"</font> ; </li><li>  <font color="#0000ff">const</font> text * db_password =ï¼ˆ <font color="#0000ff">const</font> text *ï¼‰ <font color="#A31515">"pass"</font> ; </li><li>  <font color="#0000ff">const</font> text * db_conn_str =ï¼ˆ <font color="#0000ff">const</font> text *ï¼‰ <font color="#A31515">"compï¼š1521 / xe"</font> ; </li><li>  <font color="#0000ff">const</font> text * command =ï¼ˆ <font color="#0000ff">const</font> text *ï¼‰ </li><li>  <font color="#A31515">ã€ŒBEGIN PAY_SYS.PROCESS_TRANSï¼ˆï¼šv1 ,: v2 ,: v3 ,: v4ï¼‰; END;ã€</font>  ; </li><li></li><li>  OCIEnv * env; </li><li>  OCISvcCtx *ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€‚ </li><li>  OCISession *ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€‚ </li><li>  OCIServer *ã‚µãƒ¼ãƒãƒ¼ã€‚ </li><li>  OCIError *ã‚¨ãƒ©ãƒ¼ã€‚ </li><li>  OCIStmt *ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€‚ </li><li>  OCIBind * bnd1ã€* bnd2ã€* bnd3ã€* bnd4; </li><li></li><li>  <font color="#0000ff">int</font> operatorIDã€accountIDã€sumã€result; </li><li>  <font color="#0000ff">static</font> <font color="#0000ff">char</font> * ngx_http_payment_initï¼ˆngx_conf_t * cfã€ </li><li>  ngx_command_t * cmdã€ <font color="#0000ff">void</font> * confï¼‰; </li><li></li><li>  <font color="#008000">// nginx.confã®å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®é…åˆ—</font> </li><li>  <font color="#0000ff">static</font> ngx_command_t ngx_http_payment_commands [] = </li><li>  { <font color="#008000">//æŒ‡å®šã•ã‚ŒãŸå ´æ‰€ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å«ã‚€ãƒ¡ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’1ã¤ã ã‘è¨­å®šã™ã‚‹</font> </li><li>  {ngx_stringï¼ˆ <font color="#A31515">"payment_enabled"</font> ï¼‰ã€ </li><li>  NGX_HTTP_LOC_CONF | NGX_CONF_NOARGSã€ </li><li>  ngx_http_payment_initã€ </li><li>  NGX_HTTP_LOC_CONF_OFFSETã€ </li><li>  0 </li><li>  NULL}ã€ </li><li>  ngx_null_command <font color="#008000">//é…åˆ—ã‚’çµ‚äº†ã—ã¾ã™</font> </li><li>  }; </li><li>  <font color="#008000">//ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€ä½¿ç”¨ã—ãªã„</font> </li><li>  <font color="#0000ff">static</font> ngx_http_module_t ngx_http_payment_module_ctx = </li><li>  { </li><li>  NULLã€ <font color="#008000">/ *äº‹å‰è¨­å®š* /</font> </li><li>  NULLã€ <font color="#008000">/ *æ§‹æˆå¾Œ* /</font> </li><li>  NULLã€ <font color="#008000">/ *ãƒ¡ã‚¤ãƒ³æ§‹æˆã®ä½œæˆ* /</font> </li><li>  NULLã€ <font color="#008000">/ *ãƒ¡ã‚¤ãƒ³æ§‹æˆã®åˆæœŸåŒ–* /</font> </li><li>  NULLã€ <font color="#008000">/ *ã‚µãƒ¼ãƒãƒ¼æ§‹æˆã®ä½œæˆ* /</font> </li><li>  NULLã€ <font color="#008000">/ *ã‚µãƒ¼ãƒãƒ¼æ§‹æˆã®ãƒãƒ¼ã‚¸* /</font> </li><li>  NULLã€ <font color="#008000">/ *ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆã®ä½œæˆ* /</font> </li><li>  NULL <font color="#008000">/ *ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆã®ãƒãƒ¼ã‚¸* /</font> </li><li>  }; </li><li>  <font color="#008000">//ã™ã¹ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’å«ã‚€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨˜è¿°å­</font> </li><li>  ngx_module_t ngx_http_payment_module = </li><li>  { </li><li>  NGX_MODULE_V1ã€ </li><li>  ï¼†ngx_http_payment_module_ctxã€ <font color="#008000">/ *ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ* /</font> </li><li>  ngx_http_payment_commandsã€ <font color="#008000">/ *ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–* /</font> </li><li>  NGX_HTTP_MODULEã€ <font color="#008000">/ *ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—* /</font> </li><li>  NULLã€ <font color="#008000">/ * init master * /</font> </li><li>  NULLã€ <font color="#008000">/ *åˆæœŸåŒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«* /</font> </li><li>  NULLã€ <font color="#008000">/ *åˆæœŸåŒ–ãƒ—ãƒ­ã‚»ã‚¹* /</font> </li><li>  NULLã€ <font color="#008000">/ *åˆæœŸåŒ–ã‚¹ãƒ¬ãƒƒãƒ‰* /</font> </li><li>  NULLã€ <font color="#008000">/ *çµ‚äº†ã‚¹ãƒ¬ãƒƒãƒ‰* /</font> </li><li>  NULLã€ <font color="#008000">/ *ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†* /</font> </li><li>  NULLã€ <font color="#008000">/ *çµ‚äº†ãƒã‚¹ã‚¿ãƒ¼* /</font> </li><li>  NGX_MODULE_V1_PADDING </li><li>  }; </li><li></li><li>  <font color="#0000ff">void</font> SetCallParamsï¼ˆ <font color="#0000ff">int</font> operã€ <font color="#0000ff">int</font> accountã€ <font color="#0000ff">int</font> moneyï¼‰ </li><li>  { </li><li>  <font color="#0000ff">if</font> ï¼ˆbnd1ï¼= 0ï¼‰OCIHandleFreeï¼ˆï¼ˆdvoid *ï¼‰bnd1ã€OCI_HTYPE_BINDï¼‰; </li><li>  <font color="#0000ff">if</font> ï¼ˆbnd2ï¼= 0ï¼‰OCIHandleFreeï¼ˆï¼ˆdvoid *ï¼‰bnd2ã€OCI_HTYPE_BINDï¼‰; </li><li>  <font color="#0000ff">if</font> ï¼ˆbnd3ï¼= 0ï¼‰OCIHandleFreeï¼ˆï¼ˆdvoid *ï¼‰bnd3ã€OCI_HTYPE_BINDï¼‰; </li><li>  <font color="#0000ff">if</font> ï¼ˆbnd4ï¼= 0ï¼‰OCIHandleFreeï¼ˆï¼ˆdvoid *ï¼‰bnd4ã€OCI_HTYPE_BINDï¼‰; </li><li></li><li>  <font color="#008000">//ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ã¦ã€æœ‰åŠ¹ãªãƒã‚¤ãƒ³ã‚¿ãƒ¼ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™</font> </li><li> çµæœ= 0; </li><li>  operatorID = oper; </li><li>  accountID =ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€‚ </li><li> åˆè¨ˆ=ãŠé‡‘; </li><li></li><li>  <font color="#008000">//ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’SQLå‘¼ã³å‡ºã—ã«ãƒã‚¤ãƒ³ãƒ‰ã—ã¾ã™</font> </li><li>  OCIBindByPosï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ï¼†bnd1ã€ã‚¨ãƒ©ãƒ¼ã€1ã€ãŠã‚ˆã³accountIDã€ </li><li>  <font color="#0000ff">sizeof</font> ï¼ˆaccountIDï¼‰ã€SQLT_INTã€ï¼ˆdvoid *ï¼‰0ã€ </li><li>  ï¼ˆub2 *ï¼‰0ã€ï¼ˆub2 *ï¼‰0ã€ï¼ˆub4ï¼‰0ã€ï¼ˆub4 *ï¼‰0ã€OCI_DEFAULTï¼‰; </li><li>  OCIBindByPosï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ï¼†bnd2ã€ã‚¨ãƒ©ãƒ¼ã€2ã€ï¼†operatorIDã€ </li><li>  <font color="#0000ff">sizeof</font> ï¼ˆoperatorIDï¼‰ã€SQLT_INTã€ï¼ˆdvoid *ï¼‰0ã€ </li><li>  ï¼ˆub2 *ï¼‰0ã€ï¼ˆub2 *ï¼‰0ã€ï¼ˆub4ï¼‰0ã€ï¼ˆub4 *ï¼‰0ã€OCI_DEFAULTï¼‰; </li><li>  OCIBindByPosï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ï¼†bnd3ã€ã‚¨ãƒ©ãƒ¼ã€3ã€ï¼†åˆè¨ˆã€ <font color="#0000ff">sizeof</font> ï¼ˆåˆè¨ˆï¼‰ã€SQLT_INTã€ </li><li>  ï¼ˆdvoid *ï¼‰0ã€ï¼ˆub2 *ï¼‰0ã€ï¼ˆub2 *ï¼‰0ã€ï¼ˆub4ï¼‰0ã€ </li><li>  ï¼ˆub4 *ï¼‰0ã€OCI_DEFAULTï¼‰; </li><li>  OCIBindByPosï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ï¼†bnd4ã€ã‚¨ãƒ©ãƒ¼ã€4ã€ï¼†çµæœã€ <font color="#0000ff">sizeof</font> ï¼ˆçµæœï¼‰ã€SQLT_INTã€ </li><li>  ï¼ˆdvoid *ï¼‰0ã€ï¼ˆub2 *ï¼‰0ã€ï¼ˆub2 *ï¼‰0ã€ï¼ˆub4ï¼‰0ã€ï¼ˆub4 *ï¼‰0ã€OCI_DEFAULTï¼‰; </li><li>  } </li><li>  <font color="#008000">//ãƒ¡ã‚¤ãƒ³ãƒãƒ³ãƒ‰ãƒ©ã€ã™ã¹ã¦ã®ä½œæ¥­ã¯ã“ã“ã§è¡Œã‚ã‚Œã¾ã™</font> </li><li>  <font color="#0000ff">é™çš„</font> ngx_int_t ngx_http_payment_handlerï¼ˆngx_http_request_t * rï¼‰ </li><li>  { </li><li>  <font color="#008000">//æœ¬ä½“ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™</font> </li><li>  ngx_int_t rc = ngx_http_discard_request_bodyï¼ˆrï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆrcï¼= NGX_OK &amp;&amp; rcï¼= NGX_AGAINï¼‰ </li><li>  { </li><li>  ngx_log_errorï¼ˆNGX_LOG_ERRã€r-&gt; connection-&gt; logã€0ã€ </li><li>  <font color="#A31515">ã€Œngx_http_discard_request_bodyï¼ˆï¼‰ã«å¤±æ•—ã—ã¾ã—ãŸã€</font> ï¼‰; </li><li>  <font color="#0000ff">return</font> rc; </li><li>  } </li><li></li><li>  <font color="#008000">// nginxã®è¡Œã¯ã€é•·ã•ãƒ‡ãƒ¼ã‚¿ã®ãƒšã‚¢ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚</font> </li><li>  <font color="#008000">//å¾“æ¥ã®Cã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚¼ãƒ­ã‚¨ãƒ³ãƒ‰ã¨ã—ã¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“</font> </li><li>  <font color="#008000">//ãƒ‘ãƒ¼ã‚µãƒ¼ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã‚ˆã†ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™</font> </li><li>  <font color="#0000ff">const</font> <font color="#0000ff">int</font> buflen = 100; </li><li>  <font color="#0000ff">char</font> buf [buflen + 1]; </li><li>  <font color="#0000ff">int</font> len =ï¼ˆr-&gt; args.len &lt;buflenï¼‰ï¼Ÿ  r-&gt; args.lenï¼šbuflen; </li><li>  buf [len] = <font color="#A31515">'\ 0'</font> ; </li><li>  ngx_memcpyï¼ˆbufã€r-&gt; args.dataã€r-&gt; args.lenï¼‰; </li><li></li><li>  <font color="#0000ff">int</font>æˆåŠŸ= 0; </li><li>  <font color="#0000ff">int</font> <font color="#0000ff">æ¼”ç®—å­</font> ã€abonentã€moneyã€result = -1; </li><li></li><li>  <font color="#008000">//æœ€ã‚‚å˜ç´”ãªãƒ‘ãƒ¼ã‚µãƒ¼ã‚’å‘¼ã³å‡ºã—ã¾ã™</font> </li><li>  <font color="#0000ff">operator</font> = GetIntParamï¼ˆbufã€ <font color="#A31515">"operator ="</font> ï¼‰; </li><li>  abonent = GetIntParamï¼ˆbufã€ <font color="#A31515">"abonent ="</font> ï¼‰; </li><li>  money = GetIntParamï¼ˆbufã€ <font color="#A31515">"money ="</font> ï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆ <font color="#0000ff">æ¼”ç®—å­</font> &gt; 0 &amp;&amp; abonent&gt; 0 &amp;&amp; money&gt; 0ï¼‰ </li><li>  { </li><li>  SetCallParamsï¼ˆ <font color="#0000ff">operator</font> ã€abonentã€moneyï¼‰; </li><li></li><li>  <font color="#0000ff">int</font> retCode = OCIStmtExecuteï¼ˆ </li><li> ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ã‚¨ãƒ©ãƒ¼ã€ï¼ˆub4ï¼‰1ã€ï¼ˆub4ï¼‰0ã€ </li><li>  ï¼ˆOCISnapshot *ï¼‰NULLã€ï¼ˆOCISnapshot *ï¼‰NULLã€ </li><li>  ï¼ˆub4ï¼‰OCI_COMMIT_ON_SUCCESSï¼‰; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆretCode == OCI_SUCCESSï¼‰ </li><li> æˆåŠŸ= 1; </li><li>  } </li><li></li><li>  r-&gt; headers_out.content_type.len = <font color="#0000ff">sizeof</font> ï¼ˆ <font color="#A31515">"text / html"</font> ï¼‰-1; </li><li>  r-&gt; headers_out.content_type.data =ï¼ˆu_char *ï¼‰ <font color="#A31515">"text / html"</font> ; </li><li>  r-&gt; headers_out.content_length_n = 0; </li><li></li><li>  <font color="#0000ff">if</font> ï¼ˆæˆåŠŸ== 1ï¼‰ </li><li>  r-&gt; headers_out.status = NGX_HTTP_OK; </li><li>  <font color="#0000ff">ä»–ã«</font> </li><li>  r-&gt; headers_out.status = NGX_HTTP_INTERNAL_SERVER_ERROR; </li><li></li><li>  <font color="#008000">// ...å¿œç­”ã®æœ¬æ–‡ã‚’å½¢æˆã—ã€nginxã«æ¸¡ã—ã¾ã™.. emillerã®ä¾‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„</font> </li><li>  } </li><li></li><li>  <font color="#0000ff">static</font> <font color="#0000ff">char</font> * ngx_http_payment_initï¼ˆngx_conf_t * cfã€ </li><li>  ngx_command_t * cmdã€ </li><li>  <font color="#0000ff">void</font> * our_confï¼‰ </li><li>  { </li><li>  <font color="#008000">// nginxãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¨­å®šã—ã¾ã™</font> </li><li>  ngx_http_core_loc_conf_t * core_conf = </li><li>  ngx_http_conf_get_module_loc_confï¼ˆcfã€ngx_http_core_moduleï¼‰; </li><li>  core_conf-&gt; handler = ngx_http_payment_handler; </li><li></li><li>  <font color="#008000">//ã‚ªãƒ©ã‚¯ãƒ«</font> </li><li>  bnd1 =ï¼ˆOCIBind *ï¼‰0; </li><li>  bnd2 =ï¼ˆOCIBind *ï¼‰0; </li><li>  bnd3 =ï¼ˆOCIBind *ï¼‰0; </li><li>  bnd4 =ï¼ˆOCIBind *ï¼‰0; </li><li></li><li>  OCIEnvCreateï¼ˆï¼ˆOCIEnv **ï¼‰ï¼†envã€ï¼ˆub4ï¼‰OCI_DEFAULTã€ </li><li>  ï¼ˆdvoid *ï¼‰0ã€ï¼ˆdvoid *ï¼ˆ*ï¼‰ï¼ˆdvoid *ã€size_tï¼‰ï¼‰0ã€ </li><li>  ï¼ˆdvoid *ï¼ˆ*ï¼‰ï¼ˆdvoid *ã€dvoid *ã€size_tï¼‰ï¼‰0ã€ </li><li>  ï¼ˆ <font color="#0000ff">void</font> ï¼ˆ*ï¼‰ï¼ˆdvoid *ã€dvoid *ï¼‰ï¼‰0ã€ï¼ˆsize_tï¼‰0ã€ï¼ˆdvoid **ï¼‰0ï¼‰; </li><li>  <font color="#008000">/ *ã‚µãƒ¼ãƒãƒ¼ãƒãƒ³ãƒ‰ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã¾ã™* /</font> </li><li>  OCIHandleAllocï¼ˆï¼ˆdvoid *ï¼‰envã€ï¼ˆdvoid **ï¼‰ï¼†serverã€ </li><li>  OCI_HTYPE_SERVERã€0ã€ï¼ˆdvoid **ï¼‰0ï¼‰; </li><li>  <font color="#008000">/ *ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã¾ã™* /</font> </li><li>  OCIHandleAllocï¼ˆï¼ˆdvoid *ï¼‰envã€ï¼ˆdvoid **ï¼‰ï¼†ã‚¨ãƒ©ãƒ¼ã€ </li><li>  OCI_HTYPE_ERRORã€0ã€ï¼ˆdvoid **ï¼‰0ï¼‰; </li><li>  <font color="#008000">/ *ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½œæˆ* /</font> </li><li>  <font color="#0000ff">int</font> retCode = OCIServerAttachï¼ˆã‚µãƒ¼ãƒãƒ¼ã€ã‚¨ãƒ©ãƒ¼ã€db_conn_strã€ </li><li>  strlenï¼ˆï¼ˆ <font color="#0000ff">const</font> <font color="#0000ff">char</font> *ï¼‰db_conn_strï¼‰ã€OCI_DEFAULTï¼‰; </li><li></li><li>  <font color="#008000">/ *ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒ³ãƒ‰ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã¾ã™* /</font> </li><li>  retCode = OCIHandleAllocï¼ˆï¼ˆdvoid *ï¼‰envã€ï¼ˆdvoid **ï¼‰ï¼†contextã€ </li><li>  OCI_HTYPE_SVCCTXã€0ã€ï¼ˆdvoid **ï¼‰0ï¼‰; </li><li>  <font color="#008000">/ *ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ³ãƒ‰ãƒ«ã®ã‚µãƒ¼ãƒãƒ¼å±æ€§ã‚’è¨­å®š* /</font> </li><li>  retCode = OCIAttrSetï¼ˆï¼ˆdvoid *ï¼‰ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€OCI_HTYPE_SVCCTXã€ </li><li>  ï¼ˆdvoid *ï¼‰ã‚µãƒ¼ãƒãƒ¼ã€ï¼ˆub4ï¼‰0ã€OCI_ATTR_SERVERã€ã‚¨ãƒ©ãƒ¼ï¼‰; </li><li>  <font color="#008000">/ *ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒãƒ³ãƒ‰ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã¾ã™* /</font> </li><li>  retCode = OCIHandleAllocï¼ˆï¼ˆdvoid *ï¼‰envã€ï¼ˆdvoid **ï¼‰ï¼†sessionã€ </li><li>  OCI_HTYPE_SESSIONã€0ã€ï¼ˆdvoid **ï¼‰0ï¼‰; </li><li>  <font color="#008000">//ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¾ã™</font> </li><li>  retCode = OCIAttrSetï¼ˆï¼ˆdvoid *ï¼‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€OCI_HTYPE_SESSIONã€ </li><li>  ï¼ˆ <font color="#0000ff">void</font> *ï¼‰db_user_nameã€ï¼ˆub4ï¼‰strlenï¼ˆï¼ˆ <font color="#0000ff">const</font> <font color="#0000ff">char</font> *ï¼‰db_user_nameï¼‰ã€ </li><li>  OCI_ATTR_USERNAMEã€ã‚¨ãƒ©ãƒ¼ï¼‰; </li><li>  retCode = OCIAttrSetï¼ˆï¼ˆdvoid *ï¼‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€OCI_HTYPE_SESSIONã€ </li><li>  ï¼ˆ <font color="#0000ff">void</font> *ï¼‰db_passwordã€ï¼ˆub4ï¼‰strlenï¼ˆï¼ˆ <font color="#0000ff">const</font> <font color="#0000ff">char</font> *ï¼‰db_passwordï¼‰ã€ </li><li>  OCI_ATTR_PASSWORDã€ã‚¨ãƒ©ãƒ¼ï¼‰; </li><li>  <font color="#008000">//ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹</font> </li><li>  retCode = OCISessionBeginï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€ã‚¨ãƒ©ãƒ¼ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ </li><li>  OCI_CRED_RDBMSã€OCI_DEFAULTï¼‰; </li><li></li><li>  <font color="#008000">/ *ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ³ãƒ‰ãƒ«ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³å±æ€§ã‚’è¨­å®š* /</font> </li><li>  retCode = OCIAttrSetï¼ˆï¼ˆdvoid *ï¼‰ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€OCI_HTYPE_SVCCTXã€ </li><li>  ï¼ˆdvoid *ï¼‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ï¼ˆub4ï¼‰0ã€ </li><li>  OCI_ATTR_SESSIONã€ã‚¨ãƒ©ãƒ¼ï¼‰; </li><li>  OCIHandleAllocï¼ˆï¼ˆdvoid *ï¼‰envã€ï¼ˆdvoid **ï¼‰ï¼†ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ </li><li>  OCI_HTYPE_STMTã€ï¼ˆsize_tï¼‰0ã€ï¼ˆdvoid **ï¼‰0ï¼‰; </li><li>  OCIStmtPrepareï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã€ã‚¨ãƒ©ãƒ¼ã€ã‚³ãƒãƒ³ãƒ‰ã€ï¼ˆub4ï¼‰strlenï¼ˆï¼ˆ <font color="#0000ff">char</font> *ï¼‰ã‚³ãƒãƒ³ãƒ‰ï¼‰ã€ </li><li>  ï¼ˆub4ï¼‰OCI_NTV_SYNTAXã€ï¼ˆub4ï¼‰OCI_DEFAULTï¼‰; </li><li>  <font color="#0000ff">return</font> NGX_CONF_OK; </li><li>  } </li></ol>  <font color="gray">*ã“ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€ <font color="gray">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ©ã‚¤ã‚¿ãƒ¼ã§</font>å¼·èª¿è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚</font> </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J69968/index.html">AaaaaAAaaaAAAaaAAAAaaAAAAA !!! -é‡åŠ›ã«å¯¾ã™ã‚‹ç„¡è¬€ãªç„¡è¦–ï¼</a></li>
<li><a href="../J69970/index.html">posterousã«ãƒã‚¹ã‚¿ãƒ¼ãƒ†ãƒ¼ãƒãŒç™»å ´</a></li>
<li><a href="../J69971/index.html">ãƒ¤ãƒ­ã‚¹ãƒ©ãƒ•ãƒ»ã‚°ãƒ¬ã‚·ãƒ­ãƒ•ã®ãƒ«ãƒ¼ãƒ«</a></li>
<li><a href="../J69972/index.html">ã‚·ãƒ³ãƒ—ãƒ«ãƒã‚¦ã‚¹ã‚²ãƒ¼ãƒ </a></li>
<li><a href="../J69973/index.html">ç„¡æ–™ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åç™»éŒ²</a></li>
<li><a href="../J69976/index.html">Googleãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ•°å¼ã‚¨ãƒ‡ã‚£ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</a></li>
<li><a href="../J69977/index.html">Googleç¿»è¨³</a></li>
<li><a href="../J6998/index.html">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆã‚¢</a></li>
<li><a href="../J69983/index.html">MySQLã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—ï¼šä½¿ç”¨æ©Ÿèƒ½</a></li>
<li><a href="../J69985/index.html">ç‰¹å®šã®ã‚¹ã‚¿ã‚¤ãƒ«ã«åŸºã¥ã„ã¦éŸ³æ¥½ã‚’ç”Ÿæˆã™ã‚‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>