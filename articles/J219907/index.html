<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏼 👨🏼‍🌾 🥌 PHP拡張dom_varimport：ネストされた配列のDOMDocumentへの迅速な変換 👰🏼 🏯 🤟🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="一部のプロジェクトでは、メインテンプレートエンジンとしてXSLTを使用しています。 XSLTのよく知られている欠点（たとえば、冗長性、相対的な遅さなど）に加えて、「標準」言語、「副作用」やパターンマッチングがないというイデオロギー、必要に応じてテンプレートからヘルパークラスメソッドを呼び出す機能もあ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>PHP拡張dom_varimport：ネストされた配列のDOMDocumentへの迅速な変換</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><img src="https://habrastorage.org/getpro/habr/post_images/e41/a33/ca1/e41a33ca1a164ee6c2d0cc2bc8b4a758.jpg" width="200" align="left"> 一部のプロジェクトでは、メインテンプレートエンジンとしてXSLTを使用しています。  XSLTのよく知られている欠点（たとえば、冗長性、相対的な遅さなど）に加えて、「標準」言語、「副作用」やパターンマッチングがないというイデオロギー、必要に応じてテンプレートからヘルパークラスメソッドを呼び出す機能もあります。 （exslt拡張経由）。 少し前に、 <a href="http://dklab.ru/lib/Dklab_ShortXSLT/">ShortXSLT</a>ライブラリをレイアウトしました。これにより、かさばる&lt;xsl：value-of select = "/ root / abc" /&gt;および&lt;xsl：choose&gt; ... &lt;/ xsl：choose&gt;の代わりに{/ root / abc}および{if ...} ... {elseif} ... {/ if}パフォーマンスを損なうことなく、冗長性の問題は部分的に解決されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     しかし、今はXSLTの長所と短所については話していません（この技術の反対者と支持者が豊富に見つかると確信しています）。  XSLTテンプレートを使用して<b>既存の</b>プロジェクトで使用するのに便利な1つの手法を説明し、この手法を優れたパフォーマンスで実装するライブラリへのリンクを提供したいと思います。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  XMLテキスト表現の生成をバイパスして、データをXSLTに渡す </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ページに表示するオブジェクトのネストされたPHPリストを生成するコントローラーがあるとします。 この配列をXMLに変換し、XSLTテンプレートの入力に移動する必要があります。 このPHP構造からXMLへの変換が各コントローラーで手動で実行されなかった場合は便利ですが、テキストのXML表現をバイパスして、XSLTテンプレートを直接PHPデータに適用できる抽象化の中間層がありました。 したがって、エラーの可能性を減らし、手紙を減らします。 データのXML表現をバイパスして、XSLTテンプレートを直接操作できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     少し前に、CでPHP拡張<a href="http://dklab.ru/lib/dom_varimport/">dom_varimport</a> （ <a href="https://github.com/DmitryKoterov/dom_varimport">GitHubに</a>も<a href="https://github.com/DmitryKoterov/dom_varimport">投稿されています</a> ）を書きました。 これには同じ名前の関数が含まれ、その入力にはDOMDocumentオブジェクトとネストのPHP配列が提供されます。 この関数は、渡されたDOMDocumentを入力配列のXML表現で満たし、非常に<b>高速に処理</b>します。純粋なPHPで記述されたコード<b>より</b>も約<b>20倍高速</b>です。 数千のプロパティとオブジェクトが添付されたサイズが約1 MBの大きなドキュメントは、約1〜2ミリ秒で形成されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     たとえば、呼び出し： <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> $ doc = new DOMDocument（）;
 dom_varimport（
     $ doc
    配列（
         "some_key" =&gt; 111、
         123、
         0.5、
         "arr" =&gt;配列（ "1a" =&gt; "1a"）、
         "obj" =&gt;（オブジェクト）配列（ "prop" =&gt; "val"）、
        本当
        偽
         「b」=&gt; null、
         「空」=&gt;配列（）、
     ）、
     「root」//オプション、デフォルトは「root」
 ）;
 $ doc-&gt; formatOutput = true;
 echo $ doc-&gt; saveXML（）;  //これはデバッグ専用です。実際には、saveXML（）を呼び出す必要はありません。
</pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このXMLドキュメントを印刷します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> &lt;？xml version = "1.0"？&gt;
 &lt;ルート&gt;
     &lt;some_key key = "some_key"&gt; 111 &lt;/ some_key&gt; &lt;！-プレーンキー=値-&gt;
     &lt;item key = "0"&gt; 123 &lt;/ item&gt; &lt;！-数値キーは「item」タグです-&gt;
     &lt;item key = "1"&gt; 0.5 &lt;/ item&gt; &lt;！-double-&gt;
     &lt;arr key = "arr"&gt; &lt;！-ネストされた配列-&gt;
         &lt;item key = "1a"&gt; 1a &lt;/ item&gt; &lt;！-無効なタグ名は「item」に変換されます-&gt;
     &lt;/ arr&gt;
     &lt;obj key = "obj"&gt; &lt;！-ネストされたオブジェクト-&gt;
         &lt;prop key = "prop"&gt; val &lt;/ prop&gt;
     &lt;/ obj&gt;
     &lt;item key = "2"&gt; 1 &lt;/ item&gt; &lt;！-trueは1に変換-&gt;
     &lt;item key = "3" /&gt; &lt;！-falseは空の文字列に変換します-&gt;
     &lt;b key = "b" /&gt; &lt;！-nullも空の文字列に変換-&gt;
     &lt;empty key = "empty" /&gt; &lt;！-空の配列は空の要素です-&gt;
 &lt;/ root&gt;
</pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     配列キーとオブジェクトプロパティは、おそらく同じ名前のXML要素になります（ただし、名前がXML要素に対して有効でない場合は、代わりに「item」が使用されます）。 このようなXMLドキュメントは、デバッグ時に非常に読みやすく、非常にコンパクトです。 そのため、出力でDOMDocumentオブジェクトを取得します。これは既にXSLTProcessorに渡すことができます。  XMLテキスト表現はどこにも現れず、どこでも解析されません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> 拡張機能のインストール方法 </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     拡張機能はCで記述されているため、GCCおよびphp5-src（またはphp5-devel）などのパッケージがインストールされているマシンでコンパイルする必要があります。 これはまったく怖いものではありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> git clone https://github.com/DmitryKoterov/dom_varimport.git
 cd dom_varimport
 phpize
 ./configure
作る
テストする
 make install＃またはモジュール/ dom_varimport.soを手動でコピーします
 phpize --clean
</pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      「make install」ステップは省略できます。バイナリファイルモジュール/ dom_varimport.soを取得し、他のマシンを含め、PHP拡張機能（/ usr / lib / php5など）を含むディレクトリにコピーするだけです。 最後に、/ etc / php5 / conf.d / dom_varimport.iniの拡張機能を接続し、php5-fpmまたはapacheを再起動する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>拡張子= /usr/lib/php5/dom_varimport.so
</pre></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J219881/index.html">サンクトペテルブルクのTizen Developer Lab</a></li>
<li><a href="../J219889/index.html">そして再びDripstat</a></li>
<li><a href="../J219895/index.html">WCF +クロスドメインAjax呼び出し（CORS）+承認</a></li>
<li><a href="../J219899/index.html">C ++のWebサイト（CppCMS）。 パート1</a></li>
<li><a href="../J219901/index.html">NASAツイートの宇宙の美しさ</a></li>
<li><a href="../J219909/index.html">インディーズgamedevの基本的なルール。 パート3</a></li>
<li><a href="../J21991/index.html">Vkontakte-グリッチ？</a></li>
<li><a href="../J219911/index.html">暗号化-FSTEC！</a></li>
<li><a href="../J219913/index.html">MongoDB：$またはVS $ in-より高速に動作するのは何ですか？</a></li>
<li><a href="../J219919/index.html">「軌道」-近くの惑星の開発のための宇宙プログラムのシミュレーター</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>