<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚴🏾 ☘️ 🤕 Go：MySQLから大きなテーブルのフェッチを高速化 👰🏿 🧜🏻 🎅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Goを使用して、ほぼ1年間広告ネットワークを作成しています。 Intel i7-7700サーバー、16Gb RAM、256Gb SSDで開発しています。 また、1日に1回実行されるスクリプトでは、過去1日間のすべてのインプレッションを選択し、複数のオブジェクト（ウェブサイト、キャンペーン、バナー）の...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Go：MySQLから大きなテーブルのフェッチを高速化</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/358522/">  Goを使用して、ほぼ1年間広告ネットワークを作成しています。  Intel i7-7700サーバー、16Gb RAM、256Gb SSDで開発しています。 また、1日に1回実行されるスクリプトでは、過去1日間のすべてのインプレッションを選択し、複数のオブジェクト（ウェブサイト、キャンペーン、バナー）の毎日の統計を一度に再計算するタスクが表示されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Goイディオムでは、すべてが非常に簡単に行われます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Hit <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { siteID, zoneID, poolID, mediaID, campaignID <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span> } rows, err := db.Query(<span class="hljs-string"><span class="hljs-string">"SELECT siteID, zoneID, poolID, mediaID, campaignID FROM "</span></span>+where) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(<span class="hljs-string"><span class="hljs-string">"Query fail"</span></span>, err) } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> rows.Close() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ( c <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span> h Hit ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rows.Next() { rows.Scan(&amp;h.siteID, &amp;h.zoneID, &amp;h.poolID, &amp;h.mediaID, &amp;h.campaignID) campCounter.Inc(h.campaignID) siteCounter.Inc(h.siteID) zoneCounter.Inc(h.zoneID) poolCounter.Inc(h.poolID) mediaCounter.Inc(h.mediaID) c++ } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := rows.Err(); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(<span class="hljs-string"><span class="hljs-string">"Scan Rows err"</span></span>, err) } log.Println(name, <span class="hljs-string"><span class="hljs-string">" "</span></span>, c, <span class="hljs-string"><span class="hljs-string">" "</span></span>, where, <span class="hljs-string"><span class="hljs-string">"in"</span></span>, time.Since(now))</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すべてが機能します。 また、ほぼ5600万レコードの36秒のサンプリング速度。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql">hit_20180507 <span class="hljs-number"><span class="hljs-number">55928930</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">1525640400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">1525726799</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">36.331342451</span></span>s</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>goツールのpprof</b>パフォーマンスアナライザーの<b>内部</b>では、次のようなものが表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs go"> flat flat% sum% cum cum% <span class="hljs-number"><span class="hljs-number">7130</span></span>ms <span class="hljs-number"><span class="hljs-number">18.32</span></span>% <span class="hljs-number"><span class="hljs-number">18.32</span></span>% <span class="hljs-number"><span class="hljs-number">10800</span></span>ms <span class="hljs-number"><span class="hljs-number">27.75</span></span>% runtime.mallocgc <span class="hljs-number"><span class="hljs-number">2380</span></span>ms <span class="hljs-number"><span class="hljs-number">6.12</span></span>% <span class="hljs-number"><span class="hljs-number">24.43</span></span>% <span class="hljs-number"><span class="hljs-number">5710</span></span>ms <span class="hljs-number"><span class="hljs-number">14.67</span></span>% fmt.(*pp).doPrintf <span class="hljs-number"><span class="hljs-number">2140</span></span>ms <span class="hljs-number"><span class="hljs-number">5.50</span></span>% <span class="hljs-number"><span class="hljs-number">29.93</span></span>% <span class="hljs-number"><span class="hljs-number">13300</span></span>ms <span class="hljs-number"><span class="hljs-number">34.17</span></span>% github.com/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>-sql-driver/mysql.(*textRows).readRow <span class="hljs-number"><span class="hljs-number">1800</span></span>ms <span class="hljs-number"><span class="hljs-number">4.62</span></span>% <span class="hljs-number"><span class="hljs-number">34.56</span></span>% <span class="hljs-number"><span class="hljs-number">2170</span></span>ms <span class="hljs-number"><span class="hljs-number">5.58</span></span>% runtime.mapassign_fast32 <span class="hljs-number"><span class="hljs-number">1700</span></span>ms <span class="hljs-number"><span class="hljs-number">4.37</span></span>% <span class="hljs-number"><span class="hljs-number">38.93</span></span>% <span class="hljs-number"><span class="hljs-number">1700</span></span>ms <span class="hljs-number"><span class="hljs-number">4.37</span></span>% runtime.heapBitsSetType <span class="hljs-number"><span class="hljs-number">1170</span></span>ms <span class="hljs-number"><span class="hljs-number">3.01</span></span>% <span class="hljs-number"><span class="hljs-number">41.93</span></span>% <span class="hljs-number"><span class="hljs-number">36350</span></span>ms <span class="hljs-number"><span class="hljs-number">93.40</span></span>% main.loadHits <span class="hljs-number"><span class="hljs-number">1110</span></span>ms <span class="hljs-number"><span class="hljs-number">2.85</span></span>% <span class="hljs-number"><span class="hljs-number">44.78</span></span>% <span class="hljs-number"><span class="hljs-number">8500</span></span>ms <span class="hljs-number"><span class="hljs-number">21.84</span></span>% runtime.convT2Eslice <span class="hljs-number"><span class="hljs-number">1070</span></span>ms <span class="hljs-number"><span class="hljs-number">2.75</span></span>% <span class="hljs-number"><span class="hljs-number">47.53</span></span>% <span class="hljs-number"><span class="hljs-number">1970</span></span>ms <span class="hljs-number"><span class="hljs-number">5.06</span></span>% fmt.(*fmt).fmt_integer <span class="hljs-number"><span class="hljs-number">950</span></span>ms <span class="hljs-number"><span class="hljs-number">2.44</span></span>% <span class="hljs-number"><span class="hljs-number">49.97</span></span>% <span class="hljs-number"><span class="hljs-number">1380</span></span>ms <span class="hljs-number"><span class="hljs-number">3.55</span></span>% github.com/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>-sql-driver/mysql.readLengthEncodedString <span class="hljs-number"><span class="hljs-number">930</span></span>ms <span class="hljs-number"><span class="hljs-number">2.39</span></span>% <span class="hljs-number"><span class="hljs-number">52.36</span></span>% <span class="hljs-number"><span class="hljs-number">1060</span></span>ms <span class="hljs-number"><span class="hljs-number">2.72</span></span>% runtime.freedefer <span class="hljs-number"><span class="hljs-number">930</span></span>ms <span class="hljs-number"><span class="hljs-number">2.39</span></span>% <span class="hljs-number"><span class="hljs-number">54.75</span></span>% <span class="hljs-number"><span class="hljs-number">930</span></span>ms <span class="hljs-number"><span class="hljs-number">2.39</span></span>% runtime.mapaccess1_fast32 <span class="hljs-number"><span class="hljs-number">910</span></span>ms <span class="hljs-number"><span class="hljs-number">2.34</span></span>% <span class="hljs-number"><span class="hljs-number">57.09</span></span>% <span class="hljs-number"><span class="hljs-number">2070</span></span>ms <span class="hljs-number"><span class="hljs-number">5.32</span></span>% runtime.deferreturn <span class="hljs-number"><span class="hljs-number">860</span></span>ms <span class="hljs-number"><span class="hljs-number">2.21</span></span>% <span class="hljs-number"><span class="hljs-number">59.30</span></span>% <span class="hljs-number"><span class="hljs-number">1220</span></span>ms <span class="hljs-number"><span class="hljs-number">3.13</span></span>% runtime.scanobject</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      mysql。（* TextRows）.readRowを使用して、MySQLテキストプロトコルで作業していることがわかります。それぞれ、変換された文字列はuin32型に変換されます。 しかし、そもそもメモリ割り当て機能があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここで何を加速できますか？ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     偶然、データベースドライバからのバイトがコピーせずにユーザーに転送されることを保証<a href="https://golang.org/pkg/database/sql/">するRawBytes</a>タイプに出会い<a href="https://golang.org/pkg/database/sql/">ました</a> 。 まあ何。  Scanをsql.RawBytesフィールドを持つ中間構造に抽出し、急いで書かれた関数bu2を使用して[bytes]をuint32に変換して、エラーチェックを除外します（データベースからのテキストで検索しないため）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b2u</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint32</span></span></span></span> { n := <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, c := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> b { n = n*<span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) + <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(c-<span class="hljs-string"><span class="hljs-string">'0'</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> HitRaw <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { siteID, zoneID, poolID, mediaID, campaignID sql.RawBytes }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その結果、処理時間は28秒に短縮され、すでに200万行/秒になりました！ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そして、プロファイラーはすでにそのような写真を提供しています 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs go"> <span class="hljs-number"><span class="hljs-number">4690</span></span>ms <span class="hljs-number"><span class="hljs-number">15.68</span></span>% <span class="hljs-number"><span class="hljs-number">15.68</span></span>% <span class="hljs-number"><span class="hljs-number">7630</span></span>ms <span class="hljs-number"><span class="hljs-number">25.51</span></span>% runtime.mallocgc <span class="hljs-number"><span class="hljs-number">2400</span></span>ms <span class="hljs-number"><span class="hljs-number">8.02</span></span>% <span class="hljs-number"><span class="hljs-number">23.70</span></span>% <span class="hljs-number"><span class="hljs-number">2700</span></span>ms <span class="hljs-number"><span class="hljs-number">9.03</span></span>% runtime.mapaccess1_fast32 <span class="hljs-number"><span class="hljs-number">1660</span></span>ms <span class="hljs-number"><span class="hljs-number">5.55</span></span>% <span class="hljs-number"><span class="hljs-number">29.25</span></span>% <span class="hljs-number"><span class="hljs-number">1660</span></span>ms <span class="hljs-number"><span class="hljs-number">5.55</span></span>% runtime.heapBitsSetType <span class="hljs-number"><span class="hljs-number">1640</span></span>ms <span class="hljs-number"><span class="hljs-number">5.48</span></span>% <span class="hljs-number"><span class="hljs-number">34.74</span></span>% <span class="hljs-number"><span class="hljs-number">28110</span></span>ms <span class="hljs-number"><span class="hljs-number">93.98</span></span>% main.loadHits <span class="hljs-number"><span class="hljs-number">1590</span></span>ms <span class="hljs-number"><span class="hljs-number">5.32</span></span>% <span class="hljs-number"><span class="hljs-number">40.05</span></span>% <span class="hljs-number"><span class="hljs-number">1860</span></span>ms <span class="hljs-number"><span class="hljs-number">6.22</span></span>% runtime.mapassign_fast32 <span class="hljs-number"><span class="hljs-number">1300</span></span>ms <span class="hljs-number"><span class="hljs-number">4.35</span></span>% <span class="hljs-number"><span class="hljs-number">44.40</span></span>% <span class="hljs-number"><span class="hljs-number">12450</span></span>ms <span class="hljs-number"><span class="hljs-number">41.62</span></span>% github.com/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>-sql-driver/mysql.(*textRows).readRow <span class="hljs-number"><span class="hljs-number">1140</span></span>ms <span class="hljs-number"><span class="hljs-number">3.81</span></span>% <span class="hljs-number"><span class="hljs-number">48.21</span></span>% <span class="hljs-number"><span class="hljs-number">2090</span></span>ms <span class="hljs-number"><span class="hljs-number">6.99</span></span>% runtime.deferreturn <span class="hljs-number"><span class="hljs-number">1060</span></span>ms <span class="hljs-number"><span class="hljs-number">3.54</span></span>% <span class="hljs-number"><span class="hljs-number">51.76</span></span>% <span class="hljs-number"><span class="hljs-number">1470</span></span>ms <span class="hljs-number"><span class="hljs-number">4.91</span></span>% github.com/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>-sql-driver/mysql.readLengthEncodedString <span class="hljs-number"><span class="hljs-number">1050</span></span>ms <span class="hljs-number"><span class="hljs-number">3.51</span></span>% <span class="hljs-number"><span class="hljs-number">55.27</span></span>% <span class="hljs-number"><span class="hljs-number">1050</span></span>ms <span class="hljs-number"><span class="hljs-number">3.51</span></span>% main.b2u <span class="hljs-number"><span class="hljs-number">1040</span></span>ms <span class="hljs-number"><span class="hljs-number">3.48</span></span>% <span class="hljs-number"><span class="hljs-number">58.74</span></span>% <span class="hljs-number"><span class="hljs-number">1130</span></span>ms <span class="hljs-number"><span class="hljs-number">3.78</span></span>% database/sql.convertAssign <span class="hljs-number"><span class="hljs-number">910</span></span>ms <span class="hljs-number"><span class="hljs-number">3.04</span></span>% <span class="hljs-number"><span class="hljs-number">61.79</span></span>% <span class="hljs-number"><span class="hljs-number">8640</span></span>ms <span class="hljs-number"><span class="hljs-number">28.89</span></span>% runtime.convT2Eslice <span class="hljs-number"><span class="hljs-number">730</span></span>ms <span class="hljs-number"><span class="hljs-number">2.44</span></span>% <span class="hljs-number"><span class="hljs-number">64.23</span></span>% <span class="hljs-number"><span class="hljs-number">2540</span></span>ms <span class="hljs-number"><span class="hljs-number">8.49</span></span>% database/sql.(*Rows).Scan</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まあ、スタートとして悪くない。 さらに、MySQLドライバーを調査するために登りました。MySQLドライバーは、Go専用に記述されており、ソケットを使用して低レベルのプロトコル自体を実装しています。 そして、2番目のMySQLプロトコルはバイナリであることが判明しました。 理論的には、MySQLサーバー応答の生成がより速くなります。 したがって、ドライバーは、変換関数text-integerを呼び出しません。 バイナリプロトコルを使用するには、db.Queryからdb.Prepareに切り替える必要があります-stsm.Query-ソースコードへの最小限の変更と完了までに26.70秒。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="go hljs">stmtOut, err := db.Prepare(sqlQ) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> stmtOut.Close() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(<span class="hljs-string"><span class="hljs-string">"prepare"</span></span>, err, sqlQ) } rows, err := stmtOut.Query() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(<span class="hljs-string"><span class="hljs-string">"query"</span></span>, err, sqlQ) } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> rows.Close()</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     プロファイラーは、プロトコルが実際にバイナリ（* binaryRows）.readRowであることを示していますが、RawBytesで読み取る場合、テキストに変換してから元に戻します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs swift"> flat flat% sum% cum cum% 2910ms <span class="hljs-number"><span class="hljs-number">10.79</span></span>% <span class="hljs-number"><span class="hljs-number">10.79</span></span>% 3310ms <span class="hljs-number"><span class="hljs-number">12.27</span></span>% runtime.mallocgc 2280ms <span class="hljs-number"><span class="hljs-number">8.45</span></span>% <span class="hljs-number"><span class="hljs-number">19.24</span></span>% 2600ms <span class="hljs-number"><span class="hljs-number">9.64</span></span>% runtime.mapaccess1_fast32 1960ms <span class="hljs-number"><span class="hljs-number">7.27</span></span>% <span class="hljs-number"><span class="hljs-number">26.51</span></span>% 7070ms <span class="hljs-number"><span class="hljs-number">26.21</span></span>% database/sql.convertAssign 1530ms <span class="hljs-number"><span class="hljs-number">5.67</span></span>% <span class="hljs-number"><span class="hljs-number">32.18</span></span>% 1810ms <span class="hljs-number"><span class="hljs-number">6.71</span></span>% runtime.mapassign_fast32 1460ms <span class="hljs-number"><span class="hljs-number">5.41</span></span>% <span class="hljs-number"><span class="hljs-number">37.60</span></span>% 6660ms <span class="hljs-number"><span class="hljs-number">24.69</span></span>% github.com/go-sql-driver/mysql.(*binaryRows).readRow 1420ms <span class="hljs-number"><span class="hljs-number">5.27</span></span>% <span class="hljs-number"><span class="hljs-number">42.86</span></span>% 26680ms <span class="hljs-number"><span class="hljs-number">98.92</span></span>% main.loadHits 1210ms <span class="hljs-number"><span class="hljs-number">4.49</span></span>% <span class="hljs-number"><span class="hljs-number">47.35</span></span>% 3010ms <span class="hljs-number"><span class="hljs-number">11.16</span></span>% strconv.<span class="hljs-type"><span class="hljs-type">AppendInt</span></span> 1100ms <span class="hljs-number"><span class="hljs-number">4.08</span></span>% <span class="hljs-number"><span class="hljs-number">51.43</span></span>% 1320ms <span class="hljs-number"><span class="hljs-number">4.89</span></span>% strconv.formatBits 950ms <span class="hljs-number"><span class="hljs-number">3.52</span></span>% <span class="hljs-number"><span class="hljs-number">54.95</span></span>% 1650ms <span class="hljs-number"><span class="hljs-number">6.12</span></span>% runtime.deferreturn 820ms <span class="hljs-number"><span class="hljs-number">3.04</span></span>% <span class="hljs-number"><span class="hljs-number">57.99</span></span>% 820ms <span class="hljs-number"><span class="hljs-number">3.04</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">ValueOf</span></span> 810ms <span class="hljs-number"><span class="hljs-number">3.00</span></span>% <span class="hljs-number"><span class="hljs-number">60.99</span></span>% 4120ms <span class="hljs-number"><span class="hljs-number">15.28</span></span>% runtime.convT2E64 750ms <span class="hljs-number"><span class="hljs-number">2.78</span></span>% <span class="hljs-number"><span class="hljs-number">63.77</span></span>% 4240ms <span class="hljs-number"><span class="hljs-number">15.72</span></span>% database/sql.asBytes</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      uint32構造体をすぐにスキャンしましょう！ もう何も変換する必要はありません。全体変換のみです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     結果は悲しかった-49.827306314sつまり、減速は一般的に恐ろしい。 最速の結果を得るための優れた理論的根拠にも関わらず、可能な限り最も退屈なバージョン。 問題は何ですか？ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私たちは見ます： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs swift"> 4620ms <span class="hljs-number"><span class="hljs-number">9.22</span></span>% <span class="hljs-number"><span class="hljs-number">9.22</span></span>% 29230ms <span class="hljs-number"><span class="hljs-number">58.32</span></span>% database/sql.convertAssign 3610ms <span class="hljs-number"><span class="hljs-number">7.20</span></span>% <span class="hljs-number"><span class="hljs-number">16.42</span></span>% 4010ms <span class="hljs-number"><span class="hljs-number">8.00</span></span>% runtime.mallocgc 3010ms <span class="hljs-number"><span class="hljs-number">6.01</span></span>% <span class="hljs-number"><span class="hljs-number">22.43</span></span>% 8610ms <span class="hljs-number"><span class="hljs-number">17.18</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.(*rtype).<span class="hljs-type"><span class="hljs-type">Name</span></span> 2980ms <span class="hljs-number"><span class="hljs-number">5.95</span></span>% <span class="hljs-number"><span class="hljs-number">28.37</span></span>% 5600ms <span class="hljs-number"><span class="hljs-number">11.17</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.(*rtype).<span class="hljs-type"><span class="hljs-type">String</span></span> 2770ms <span class="hljs-number"><span class="hljs-number">5.53</span></span>% <span class="hljs-number"><span class="hljs-number">33.90</span></span>% 3330ms <span class="hljs-number"><span class="hljs-number">6.64</span></span>% runtime.mapaccess1_fast32 2570ms <span class="hljs-number"><span class="hljs-number">5.13</span></span>% <span class="hljs-number"><span class="hljs-number">39.03</span></span>% 2570ms <span class="hljs-number"><span class="hljs-number">5.13</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">ValueOf</span></span> 1760ms <span class="hljs-number"><span class="hljs-number">3.51</span></span>% <span class="hljs-number"><span class="hljs-number">42.54</span></span>% 1980ms <span class="hljs-number"><span class="hljs-number">3.95</span></span>% runtime.mapassign_fast32 1640ms <span class="hljs-number"><span class="hljs-number">3.27</span></span>% <span class="hljs-number"><span class="hljs-number">45.81</span></span>% 6630ms <span class="hljs-number"><span class="hljs-number">13.23</span></span>% github.com/go-sql-driver/mysql.(*binaryRows).readRow 1540ms <span class="hljs-number"><span class="hljs-number">3.07</span></span>% <span class="hljs-number"><span class="hljs-number">48.88</span></span>% 3870ms <span class="hljs-number"><span class="hljs-number">7.72</span></span>% strconv.<span class="hljs-type"><span class="hljs-type">FormatInt</span></span> 1240ms <span class="hljs-number"><span class="hljs-number">2.47</span></span>% <span class="hljs-number"><span class="hljs-number">51.36</span></span>% 49600ms <span class="hljs-number"><span class="hljs-number">98.96</span></span>% main.loadHits 1150ms <span class="hljs-number"><span class="hljs-number">2.29</span></span>% <span class="hljs-number"><span class="hljs-number">53.65</span></span>% 1150ms <span class="hljs-number"><span class="hljs-number">2.29</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">Value</span></span>.<span class="hljs-type"><span class="hljs-type">Type</span></span> 1120ms <span class="hljs-number"><span class="hljs-number">2.23</span></span>% <span class="hljs-number"><span class="hljs-number">55.89</span></span>% 1120ms <span class="hljs-number"><span class="hljs-number">2.23</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">Value</span></span>.<span class="hljs-type"><span class="hljs-type">Elem</span></span> 1070ms <span class="hljs-number"><span class="hljs-number">2.13</span></span>% <span class="hljs-number"><span class="hljs-number">58.02</span></span>% 30950ms <span class="hljs-number"><span class="hljs-number">61.75</span></span>% database/sql.(*<span class="hljs-type"><span class="hljs-type">Rows</span></span>).<span class="hljs-type"><span class="hljs-type">Scan</span></span> 1070ms <span class="hljs-number"><span class="hljs-number">2.13</span></span>% <span class="hljs-number"><span class="hljs-number">60.16</span></span>% 1070ms <span class="hljs-number"><span class="hljs-number">2.13</span></span>% strconv.<span class="hljs-type"><span class="hljs-type">ParseUint</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      strconv.ParseUintの存在から判断すると、2つの型の変換は文字列を介して行われます！ ほんと？  reflect-transformsは、実行時に最初の行にあります。  Rob Pikeがリフレクションの注意深い使用について語るのも不思議ではありません。 あなたは物事をすることができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      MySQLドライバーを研究した結果、バイナリプロトコルからすべてのデータがint64に変換されるという事実に出会いました。これを利用してみましょう。 スキャンイン構造 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> HitRaw <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { siteID, zoneID, poolID, mediaID, campaignID <span class="hljs-keyword"><span class="hljs-keyword">int64</span></span> } ... h.siteID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(raw.siteID) h.zoneID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(raw.zoneID) h.poolID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(raw.poolID) h.mediaID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(raw.mediaID) h.campaignID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(raw.campaignID)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     結果は33.98秒です。 この機能別レイアウト 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs swift"> 3600ms <span class="hljs-number"><span class="hljs-number">10.48</span></span>% <span class="hljs-number"><span class="hljs-number">10.48</span></span>% 14360ms <span class="hljs-number"><span class="hljs-number">41.79</span></span>% database/sql.convertAssign 2860ms <span class="hljs-number"><span class="hljs-number">8.32</span></span>% <span class="hljs-number"><span class="hljs-number">18.80</span></span>% 3340ms <span class="hljs-number"><span class="hljs-number">9.72</span></span>% runtime.mallocgc 2560ms <span class="hljs-number"><span class="hljs-number">7.45</span></span>% <span class="hljs-number"><span class="hljs-number">26.25</span></span>% 2920ms <span class="hljs-number"><span class="hljs-number">8.50</span></span>% runtime.mapaccess1_fast32 1660ms <span class="hljs-number"><span class="hljs-number">4.83</span></span>% <span class="hljs-number"><span class="hljs-number">31.08</span></span>% 6730ms <span class="hljs-number"><span class="hljs-number">19.59</span></span>% github.com/go-sql-driver/mysql.(*binaryRows).readRow 1540ms <span class="hljs-number"><span class="hljs-number">4.48</span></span>% <span class="hljs-number"><span class="hljs-number">35.56</span></span>% 33970ms <span class="hljs-number"><span class="hljs-number">98.86</span></span>% main.loadHits 1410ms <span class="hljs-number"><span class="hljs-number">4.10</span></span>% <span class="hljs-number"><span class="hljs-number">39.67</span></span>% 1690ms <span class="hljs-number"><span class="hljs-number">4.92</span></span>% runtime.mapassign_fast32 1340ms <span class="hljs-number"><span class="hljs-number">3.90</span></span>% <span class="hljs-number"><span class="hljs-number">43.57</span></span>% 1340ms <span class="hljs-number"><span class="hljs-number">3.90</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">ValueOf</span></span> 1290ms <span class="hljs-number"><span class="hljs-number">3.75</span></span>% <span class="hljs-number"><span class="hljs-number">47.32</span></span>% 4010ms <span class="hljs-number"><span class="hljs-number">11.67</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">Value</span></span>.<span class="hljs-type"><span class="hljs-type">Set</span></span> 940ms <span class="hljs-number"><span class="hljs-number">2.74</span></span>% <span class="hljs-number"><span class="hljs-number">50.06</span></span>% 15960ms <span class="hljs-number"><span class="hljs-number">46.45</span></span>% database/sql.(*<span class="hljs-type"><span class="hljs-type">Rows</span></span>).<span class="hljs-type"><span class="hljs-type">Scan</span></span> 900ms <span class="hljs-number"><span class="hljs-number">2.62</span></span>% <span class="hljs-number"><span class="hljs-number">52.68</span></span>% 900ms <span class="hljs-number"><span class="hljs-number">2.62</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">Value</span></span>.<span class="hljs-type"><span class="hljs-type">Elem</span></span> 840ms <span class="hljs-number"><span class="hljs-number">2.44</span></span>% <span class="hljs-number"><span class="hljs-number">55.12</span></span>% 840ms <span class="hljs-number"><span class="hljs-number">2.44</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">Value</span></span>.<span class="hljs-type"><span class="hljs-type">Type</span></span> 840ms <span class="hljs-number"><span class="hljs-number">2.44</span></span>% <span class="hljs-number"><span class="hljs-number">57.57</span></span>% 1500ms <span class="hljs-number"><span class="hljs-number">4.37</span></span>% runtime.deferreturn 810ms <span class="hljs-number"><span class="hljs-number">2.36</span></span>% <span class="hljs-number"><span class="hljs-number">59.92</span></span>% 810ms <span class="hljs-number"><span class="hljs-number">2.36</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.directlyAssignable 760ms <span class="hljs-number"><span class="hljs-number">2.21</span></span>% <span class="hljs-number"><span class="hljs-number">62.14</span></span>% 760ms <span class="hljs-number"><span class="hljs-number">2.21</span></span>% runtime.getitab 730ms <span class="hljs-number"><span class="hljs-number">2.12</span></span>% <span class="hljs-number"><span class="hljs-number">64.26</span></span>% 900ms <span class="hljs-number"><span class="hljs-number">2.62</span></span>% <span class="hljs-built_in"><span class="hljs-built_in">reflect</span></span>.<span class="hljs-type"><span class="hljs-type">Value</span></span>.assignTo 720ms <span class="hljs-number"><span class="hljs-number">2.10</span></span>% <span class="hljs-number"><span class="hljs-number">66.36</span></span>% 4060ms <span class="hljs-number"><span class="hljs-number">11.82</span></span>% runtime.convT2E64</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      sql.convertAssignがバイナリプロトコルを使用する利点をすべて減らすことがわかります。 データはテキストを介してコピーされませんが、内部の反映により、ユーザーのint64変数にコピーできるint64を決定することは依然として非常に困難です。 また、テキストとの間で数値をコピーすることは、reflect.directlyAssignable-reflect.Value.assignToよりも高速です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ウォームアップとして、b2u関数をGoアセンブラーに変換しようとしました。 アセンブラーは、ドライブとカセットレコーダーなしで学校で学んだ最初のBK-0011プログラミング言語の1つでした。  Goはほぼ最適なコードを生成しますが、アルゴリズムのトリックや非標準のASMコマンドを使用しない場合は、これらの関数を書くことに特別な意味はありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql">// func b2u(data []byte) uint32 // // memory layout <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the stack relative <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> FP // +<span class="hljs-number"><span class="hljs-number">0</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">slice</span></span> ptr // +<span class="hljs-number"><span class="hljs-number">8</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">slice</span></span> len // +<span class="hljs-number"><span class="hljs-number">16</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">slice</span></span> cap #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "textflag.h" <span class="hljs-type"><span class="hljs-type">TEXT</span></span> ·B2u(SB),NOSPLIT,<span class="hljs-meta"><span class="hljs-meta">$0</span></span><span class="hljs-number"><span class="hljs-number">-24</span></span> // data ptr MOVQ data+<span class="hljs-number"><span class="hljs-number">0</span></span>(FP), SI // data len MOVQ data+<span class="hljs-number"><span class="hljs-number">8</span></span>(FP), CX // result <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> AX MOVBLZX (SI), AX // - <span class="hljs-string"><span class="hljs-string">'0'</span></span> SUBL <span class="hljs-meta"><span class="hljs-meta">$48</span></span>, AX // <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> DECQ CX JZ AX2RET LOOPBYTE: //<span class="hljs-keyword"><span class="hljs-keyword">move</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one byte upper INCQ SI MOVBLZX (SI), BX //prev result *= <span class="hljs-number"><span class="hljs-number">10</span></span> IMULL <span class="hljs-meta"><span class="hljs-meta">$10</span></span>, AX // bx -= <span class="hljs-string"><span class="hljs-string">'0'</span></span> SUBL <span class="hljs-meta"><span class="hljs-meta">$48</span></span>, BX ADDL BX, AX // <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (cx<span class="hljs-comment"><span class="hljs-comment">--) DECQ CX JNZ LOOPBYTE AX2RET: MOVL AX, ret+24(FP) RET</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     テストによると、Goバージョンの2〜20％の加速が得られます。 数字の桁数に依存します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その結果、作業例は26.94秒に加速しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この記事の結論は、テキストを見たばかりの人-大量の整数データをMySQLからメモリに読み込む最速の方法-db.Prepare-stmt.Query-スキャンしてインターフェイス{}に変換し、uint32（hit.siteID。（Int64） ）上位ビットを削除せずにuint64で機能する符号なし整数に。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     つまり、標準的な例に示されているドライバーの操作方法は、常に最適とは限りません。 おそらく、開発者はドライバーの動作に注意を払うでしょう。これは、単純な言語とオーバーロードされていない言語の両方に多くの隠れた呼び出しとオーバーヘッドがあるためです。 結局のところ、データベースからのSELECT選択が表示されるテストのGoは<a href="https://www.techempower.com/benchmarks/">、パフォーマンスに影響しません</a> 。 さらに、すべての経験豊富なプログラマーが内部を掘り下げる時間と欲求を持っているわけではありません。 私の知る限り、このようなSELECTテストを行った人はいません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      UPD：コメントは、すぐに読めるように設計されたと思われる奇跡的なドライバー<a href="https://github.com/lazada/sqle">github.com/lazada/sqleの</a>例を提供しました。 結果は読み通したときでした 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      uint32変数のrows.Scan（＆h.siteID、＆h.zoneID、＆h.poolID、＆h.mediaID、＆h.campaignID）は非常に悲しい 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>55928930 time BETWEEN 1525640400 AND 1525726799 in 1m0.307942824s</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そして、プログラムが1分間何をしたかを見ると、彼らがこのケースを最適化することを考えていなかったことが明らかになります。 標準ドライバーが2回勝ちます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>flat flat% sum% cum cum% 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     4.63s 7.62% 7.62% 29.25s 48.11% database/sql.convertAssign 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     4.22s 6.94% 14.56% 4.68s 7.70% runtime.mallocgc 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2.97s 4.88% 19.44% 8.48s 13.95% reflect.(*rtype).Name 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2.96s 4.87% 24.31% 5.51s 9.06% reflect.(*rtype).String 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2.90s 4.77% 29.08% 41.28s 67.89% github.com/lazada/sqle.(*Rows).Scan 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2.51s 4.13% 33.21% 2.95s 4.85% runtime.mapaccess1_fast32 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2.38s 3.91% 37.12% 2.38s 3.91% reflect.ValueOf 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.92s 3.16% 40.28% 3.69s 6.07% runtime.assertE2I2 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.77s 2.91% 43.19% 1.77s 2.91% runtime.getitab 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.65s 2.71% 45.90% 7.04s 11.58% github.com/go-sql-driver/mysql.(*binaryRows).readRow 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.49s 2.45% 48.36% 1.86s 3.06% runtime.mapassign_fast32 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.35s 2.22% 50.58% 60.27s 99.13% main.loadHits 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.31s 2.15% 52.73% 4.01s 6.60% github.com/lazada/sqle.typeCheck 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.31s 2.15% 54.88% 4.19s 6.89% strconv.FormatInt 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.28s 2.11% 56.99% 2.88s 4.74% strconv.formatBits 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.25s 2.06% 59.05% 1.25s 2.06% reflect.(*rtype).Kind 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1.12s 1.84% 60.89% 31.05s 51.07% database/sql.(*Rows).Scan 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      []バイト変数でスキャンを読み取り、b2u（）を介してuint32に変換すると、44秒になります。 私の意見では、あなたはもはや標準的なデータベース/ SQLの人たちが書いた素晴らしい代替品をテストすることはできません。 加速に関するもう1つの神話は、実際のテストについて暴かれています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      UPD2：MySQLからの読み取り速度を理解するために、変換と計算を行わずにサイクルを作成しました 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rows.Next() { c++ }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     結果は11.9秒です。 したがって、27のうち15秒がハッシュマップの変換と操作に費やされます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      UPD3：記事を書き終えた後、Goの内部についての理解を深め始めました。私の鼻の真下に私のケースの錠剤が見つかりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://golang.org/pkg/database/sql/">golang.org/pkg/database/sql/#Rows.Scan</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     引数のタイプが* interface {}の場合、スキャンは変換せずに基礎となるドライバーによって提供された値をコピーします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これが、私が皆さんにお勧めするコードの最終バージョンです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> HitRaw <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { siteID, zoneID, poolID, mediaID, campaignID, status <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ( hit HitRaw h Hit ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rows.Next() { rows.Scan(&amp;hit.siteID, &amp;hit.zoneID, &amp;hit.poolID, &amp;hit.mediaID, &amp;hit.campaignID, &amp;hit.status) h.siteID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(hit.siteID.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>)) h.zoneID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(hit.zoneID.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>)) h.siteID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(hit.siteID.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>)) h.poolID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(hit.poolID.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>)) h.mediaID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(hit.mediaID.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>)) h.campaignID = <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(hit.campaignID.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>)) h.status = <span class="hljs-keyword"><span class="hljs-keyword">uint8</span></span>(hit.status.(<span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>))</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その結果、誰もが無関心になることはありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     同じ5,590万件のレコードの20.126921479。 そして、これは27秒後です。その時点で、私はnに到達したと思いました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そして、プロファイラーはすでにかなり良いレイアウトを提供しています-ほとんどの場合、プログラムはハッシュでカウンターを更新します。 バイナリデータは、ドライバーから直接待機している場所に送信されます。 アセンブラーはオプションであることが判明しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>flat flat% sum% cum cum% 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     3110ms 15.20% 15.20% 3460ms 16.91% runtime.mallocgc 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     2350ms 11.49% 26.69% 2700ms 13.20% runtime.mapaccess1_fast32 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1850ms 9.04% 35.73% 2150ms 10.51% runtime.mapassign_fast32 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1460ms 7.14% 42.86% 6670ms 32.60% github.com/go-sql-driver/mysql.(*binaryRows).readRow 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1420ms 6.94% 49.80% 20070ms 98.09% main.loadHits 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     1170ms 5.72% 55.52% 1190ms 5.82% database/sql.convertAssign 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     840ms 4.11% 59.63% 4300ms 21.02% runtime.convT2E64 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     710ms 3.47% 63.10% 2470ms 12.07% database/sql.(*Rows).Scan 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     680ms 3.32% 66.42% 1260ms 6.16% runtime.deferreturn 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     680ms 3.32% 69.75% 680ms 3.32% sync.(*RWMutex).RLock 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     650ms 3.18% 72.92% 650ms 3.18% runtime.aeshash32 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     630ms 3.08% 76.00% 630ms 3.08% sync.(*RWMutex).RUnlock 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J358510/index.html">タスクのライフサイクル</a></li>
<li><a href="../J358514/index.html">Rust 1.26リリース</a></li>
<li><a href="../J358516/index.html">AutoCAD用ターミナルサーバー</a></li>
<li><a href="../J358518/index.html">VimpelComの加入者は、春の法律のために月に13ルーブルを支払う</a></li>
<li><a href="../J358520/index.html">JavaおよびLinux-操作の機能</a></li>
<li><a href="../J358526/index.html">セグメント[0,1]のすべての実数に番号を付けます</a></li>
<li><a href="../J358528/index.html">LaravelプロジェクトのREST-API自動ドキュメントシステム</a></li>
<li><a href="../J358532/index.html">オープンウェビナー：「翻訳の難しさ：2および3バージョン」</a></li>
<li><a href="../J358536/index.html">Telegram v。Russiaの訴訟は、欧州人権裁判所で審理されます。 モスクワ市裁判所にも苦情が提出されました。</a></li>
<li><a href="../J358540/index.html">ミンスクで最初のアトラシアンユーザーグループ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>