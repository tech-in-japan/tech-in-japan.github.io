<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥒 😴 👛 管理者の生活を簡素化し、ADディレクトリで自動モードでユーザー名とコンピューター名を関連付けます 👩🏼‍💻 📷 🔝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、ハブラ！ 
  
 おそらく、すべてのシステム管理者がユーザーのコンピューター名の決定に問題を抱えていたと思われます。 つまり、従業員の名前は知っているが、彼がどんな種類のコンピューターを持っているのかは分からない。 そして、多くの場合、ユーザーにコンピューターの名前を判別させようとする...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>管理者の生活を簡素化し、ADディレクトリで自動モードでユーザー名とコンピューター名を関連付けます</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"> こんにちは、ハブラ！ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     おそらく、すべてのシステム管理者がユーザーのコンピューター名の決定に問題を抱えていたと思われます。 つまり、従業員の名前は知っているが、彼がどんな種類のコンピューターを持っているのかは分からない。 そして、多くの場合、ユーザーにコンピューターの名前を判別させようとすると、苦痛が生じます。 代わりに、コンピューター名ではなく、ユーザー名、メール、電話番号などに名前を付けます。 そして、システムに関する情報がどこにあるのかをユーザーに説明しようとすると、従業員の執念と激しい憎悪が生じます。 もちろん、デスクトップなどの目立つ場所にコンピュータ名を表示できるユーティリティを作成することもできますが、そのためには、この情報がある場所を毎回説明する必要があります。 問題を少し単純化しますが、完全には解決しません。 さらに、私はユーザーとすべてが彼が座っているコンピューターの名前を知らないという事実に傾いています。 その結果、コンピューター名の定義を現代的、便利、正確、そして最も重要なことには自動化することが決定されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/441/5f3/733/4415f373319fd72b0493e1122d50b16c.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     コンピューターへの接続は次のようになります。 さらに、管理者アカウントを使用してスナップインを開く必要さえありません。 これがすべてどのように機能し、インフラストラクチャでそれを行う方法に興味がある人は、catの下で歓迎します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     上記を達成するには、ADが何であるかを理解し、AD内のオブジェクトの構造を少なくとも大まかに理解し、スクリプトがどのように機能するかを理解し、猫を愛する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> 一般原則 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ユーザーの下から起動されたスクリプトは、それが実行されているコンピューターの名前を決定し、その代わりに現在のユーザーがADディレクトリーの属性の値を書き込みます。 さらに、管理者はこの属性値をどうするかを自由に決定できます。 この記事では、PowerShellスクリプトの例と、 <b>Active Directoryユーザーとコンピューター</b>スナップイン（以降ADUCと呼びます）にコンテキストメニュー項目を追加する例を示します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> 属性を作成する </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     多くの人は、一般に入手可能な録音を使用して、遠くまで行かず、賢明でもありませんでした。たとえば、ユーザーのWebページパラメーターは、デフォルトで自分で録音に使用できます。 しかし、私はこの考えが好きではありませんでした。二重の目的がなく、妥協を必要としないユーザー向けに特別な属性を作成したかったのです。 そして、状況が将来どのように発展し、この属性の使用を必要とするかを誰が知っていますか？ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、スキーマに新しい属性を作成するには、最初にスナップを追加する必要があります。 リモート管理パッケージがインストールされているコンピューターまたはドメインコントローラーでは<i><b>、</b></i>ローカル管理者<i><b>としてregsvr32 schmmgmt.dll</b></i>を実行する必要があり<i><b>ます</b></i> 。 このスナップインがデフォルトで登録されていない理由を説明するのは困難です。これは、無知に邪魔されないようにするためのようです。 それでも、DLLを登録することで追加できます。 その後、 <b>Active Directoryスキーマ</b>スナップインを開き、[ <b>属性]</b>セクションに移動します。 新しい属性を作成します。 ここでは、もちろん、属性は実験の場所ではなく、属性は一度作成されるだけなので、属性を削除したり名前を変更したりすることはできません。 この警告は、属性が追加されるすべての場所にありますが、それでも:)新しい属性を追加するには、 <i>スキーマ管理者</i>権限も必要です。 管理ユーザーが<i>エンタープライズ管理者</i>権限を持っている場合、これで十分です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     新しい属性を追加するには、OIDを入力する必要があります。 これはオブジェクトの一意の識別子です。 これについてはGoogleで読むことができますが、これ以上詳しくはしませんが、ユニークでなければなりません。  OIDの共通部分は受け入れられないものであり、だれかによって侵入された場合、将来的には解決できない問題が発生する可能性があります。  OIDは通常、1.2.840.113556以降の数字で始まります。 特に気にしませんでした  3番目の数字（840）は国コード、4番目は会社コード（Microsoft）です。存在しない国800のコードを入力し、ドットを介して2つの乱数を生成しました。 国のリストは<a href="http://www.oid-info.com/doc/country-OIDs.htm">ここにあります</a> 。 実際、この場合はITU-Tに連絡して一意のOIDを要求する必要がありますが、答えは私には届かず、ボトルに入って乱数に基づいて作成しませんでした。 その後、比較的一意の識別子を生成する<a href="http://gallery.technet.microsoft.com/scriptcenter/56b78004-40d0-41cf-b95e-6e795b2e8a06">スクリプト</a>を見つけましたが、手遅れでした:)） 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/182/38f/acf/18238facfe075dc4affd4f28a262c1cb.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     一般に、彼らはOIDで決定しました。 次に、構文属性を指定する必要があります。 私の構成では、これは<i>Unicode String</i>です。 また、もちろん、属性名が必要です。 この例では、 <b>LabelComputer</b>という名前を使用します。実際の構成では、もっと良いものを考え出すのが良いでしょう。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     属性を作成したら、クラスに追加する必要があります。  <b>ユーザー</b>クラスを選択し、[ <b>属性</b> ]タブに新しい属性を追加します。 これで、必要な権限を持つユーザーは、この属性をユーザーに書き込む権利を持ちます。 デフォルトでは、 <i>アカウントオペレーター</i>以上がこれらの権利を所有しています。 しかし、ユーザー自身がこの属性を編集できる状況に興味があります。 そのような目的のために、自分を擬人化する<b>SELF</b>という名前のユーザーがいます。  <b>LabelComputer</b>属性を書き込むために、 <b>SELF</b>ユーザーにすべてのユーザーの権利を与える必要があります。 なぜなら 誰もまだ相続をキャンセルしていません。必要に応じて上位に進み、権利を変更します。 ドメイン全体の権利を変更することをお勧めします<b>。DC</b> <b><i>= contoso、dc = comの</i></b>場合、 <b>ADUC</b>スナップイン<b>で</b>ドメインオブジェクトのセキュリティ設定を入力します。 権限タブに移動し、[ <b>詳細設定</b> ]ボタンをクリックします。  <b>SELF</b>ユーザーの権利を追加し、 <b>LabelComputer</b>属性の読み取りと書き込みを許可します。 ところで、リスト内の属性は、作成後すぐには表示されません。 属性の作成から、権利の割り当てリストおよびユーザー属性のプロパティに表示されるまでには時間がかかります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/ee0/788/151/ee07881515e2f87c87f92587e27641c7.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> マーキング </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その結果、権利を割り当てた属性を作成しました。 作業段階に進み、コンピューター名を属性値に追加する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このために、VBscriptが使用されます。 実践が示すように、MicrosoftはPowerShellをVBSの代わりにしようとはしていません。 なんて残念。 このようなタスクの場合、VBSはより高速でより汎用性があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     現在のユーザーにデータを書き込むスクリプト： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objSysInfo = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"ADSystemInfo"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objNetwork = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"WScript.Network"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objUser = <span class="hljs-built_in"><span class="hljs-built_in">GetObject</span></span>(<span class="hljs-string"><span class="hljs-string">"LDAP://"</span></span> &amp; objSysInfo.UserName) objUser.Put <span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>, objNetwork.ComputerName objUser.SetInfo</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     スクリプトはシンプルで原始的です。 ただし、スクリプトとモデルを拡張して、コンピューターだけでなく、たとえば関連性の時間を節約することもできますが、この例ではこれについては触れません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     グループポリシーを使用するスクリプトは、ログオン時に実行するように割り当てられます。 しかし、それだけではありません。 ある人が2台のコンピューターにログオンしているときに状況が発生する可能性がありますが、この場合でも、情報が関係するようにします。 これを行うには、コンピューターのロック解除イベントのトリガーを使用して、スケジューラにスクリプトの実行を追加します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/122/206/ecf/122206ecfa66b4ea7741c934094f6760.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この場合、ログインが複数のコンピューターで実行された場合でも、最後にブロック解除されたコンピューターが関連します。 失望は1つだけです。 この方法は、Vista +コンピューターでのみ機能します。 つまり、XPでは、スケジューラーでこのようなトリガーを設定することはできません。 また、残念ながら、VBSではコンピューターがロックされているかどうかを判断することもできません。 それ以外の場合は、コンピューターがロックされているかどうかを確認して、15分ごとにスクリプトを実行できます。  VBSでは、主観的な基準（セキュリティイベントログのエントリなど）によってのみ判断できますが、少なくともこのログを表示するには、通常のユーザーにアクセス許可を与える必要があります。 これは不便で適用性が低く、実際にXPは小さくなっています。このコンピューターのグループは無視でき、ログオンスクリプトで十分です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     なぜなら すべての入力ではなく、ローカルの入力のみにフラグを立てたいので、ローカルコンピューターではない端末や他のサーバーでの実行からログオンスクリプトを除外する必要があります。 これを実現するには、マージモード<a href="http://support.microsoft.com/kb/231287">でグループポリシー</a>を<a href="http://support.microsoft.com/kb/231287">閉じ</a> 、グループポリシーオブジェクトをパーソナルコンピューター、サーバーのない領域に適用します。 この方法は十分に悪く、リソースを浪費します。グループポリシーの閉鎖は、すべてのコンピューターではなく、絶対に必要な場合にのみ使用することをお勧めします。 しかし、おそらくこれは改善の次の段階になるでしょう。 それでも、この方法では、ログオンスクリプトとスケジューラ設定を使用して、必要なグループポリシーを実行するコンピューターを明確に制限します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  PowerShellサンプルデータ収集スクリプト </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     メインタスクが完了しました。 現在のコンピューターに関する情報がユーザーに表示され始めていることがわかり始めています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/2d4/61d/b2e/2d461db2eec3de7886e61ac5ae7e3c86.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     次に、このデータで何かをする必要があります。 たとえば、ユーザーがどのコンピューターに座っている便利なタブレットを作成します。 または、最近のログインにもかかわらず、どのユーザーが属性に値を持っていないか、グループポリシーがシステムで実行されているかどうか、または何らかの理由でユーザーに属性値をユーザーに書き込むための十分な権限がないかどうかを確認します。 これは、たとえばユーザーが権利の継承を無効にしている場合に発生します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     作業に役立つ3つのPowerShellスクリプトを作成しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> 値のないユーザーを検索する </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">Import-Module ActiveDirectory Get-ADObject -filter {(sAMAccountType -eq <span class="hljs-string"><span class="hljs-string">"805306368"</span></span>) -and (LabelComputer -notlike <span class="hljs-string"><span class="hljs-string">"*"</span></span>)} -Properties DisplayName,GivenName,SN,LabelComputer,cn,sAMAccountName,lastLogonTimestamp, OperatingSystem -SearchBase <span class="hljs-string"><span class="hljs-string">"OU= ,DC=contoso,dc=com"</span></span> | Select-Object @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DisplayName};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.sAMAccountName};Label=<span class="hljs-string"><span class="hljs-string">""</span></span>}, @{label=<span class="hljs-string"><span class="hljs-string">" "</span></span>;expression={[datetime]::FromFileTime(<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.lastLogonTimestamp)}} | Sort-Object <span class="hljs-string"><span class="hljs-string">" "</span></span>| Format-Table -Autosize Read-Host <span class="hljs-string"><span class="hljs-string">"      .     ..."</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このスクリプトは、ユーザーのみが表示される美しいテーブル、表示名、ログイン、最終ログイン日を作成します。 ここでは、不審なユーザーを確認し、最近のログインにもかかわらず、コンピューター名がまだ欠落している理由を理解しようとします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> タグ付きのすべてのコンピューター </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">Import-Module ActiveDirectory Get-ADObject -filter {(sAMAccountType -eq <span class="hljs-string"><span class="hljs-string">"805306368"</span></span>) -and (LabelComputer -like <span class="hljs-string"><span class="hljs-string">"*"</span></span>)} -Properties DisplayName,GivenName,SN,LabelComputer,cn,sAMAccountName,lastLogon -SearchBase <span class="hljs-string"><span class="hljs-string">"OU= ,DC=contoso,dc=com"</span></span> | Select-Object @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DisplayName};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.sAMAccountName};Label=<span class="hljs-string"><span class="hljs-string">""</span></span>}, @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.<span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{label=<span class="hljs-string"><span class="hljs-string">" "</span></span>;expression={[datetime]::FromFileTime(<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.lastLogon)}} | Sort-Object <span class="hljs-string"><span class="hljs-string">" "</span></span> | Format-Table -Autosize Read-Host <span class="hljs-string"><span class="hljs-string">"      .     ..."</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このスクリプトは前のものと似ていますが、タグ付けされたユーザーのリストを表示します。 マークされたユーザーの相対数を推定できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> ユーザーによるコンピューター名の検索 </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">Import-Module ActiveDirectory <span class="hljs-variable"><span class="hljs-variable">$exit</span></span> = 0 <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { Write-Host <span class="hljs-string"><span class="hljs-string">"   : , ,  , ,  .     ."</span></span> <span class="hljs-variable"><span class="hljs-variable">$us</span></span> = Read-Host -Prompt <span class="hljs-string"><span class="hljs-string">"   "</span></span> <span class="hljs-variable"><span class="hljs-variable">$find</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-variable"><span class="hljs-variable">$find</span></span> += <span class="hljs-string"><span class="hljs-string">'*'</span></span> + <span class="hljs-variable"><span class="hljs-variable">$us</span></span> + <span class="hljs-string"><span class="hljs-string">'*'</span></span> write-host = <span class="hljs-variable"><span class="hljs-variable">$find</span></span> Get-ADObject -filter {(sAMAccountType -eq <span class="hljs-string"><span class="hljs-string">"805306368"</span></span>) -and ((GivenName -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (sn -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (cn -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (DisplayName -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (LabelComputer -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ) -or (sAMAccountName -like <span class="hljs-variable"><span class="hljs-variable">$find</span></span> ))} -Properties DisplayName,GivenName,SN,LabelComputer,cn,sAMAccountName | Select-Object @{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DisplayName};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.sAMAccountName};Label=<span class="hljs-string"><span class="hljs-string">""</span></span>},@{Expression={<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.<span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>};Label=<span class="hljs-string"><span class="hljs-string">" "</span></span>} | Format-Table -Autosize } While (<span class="hljs-variable"><span class="hljs-variable">$us</span></span> -ne <span class="hljs-string"><span class="hljs-string">""</span></span>)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さて、そして、直接、検索。 検索がユーザーのすべての主要なパラメーターで行われるように。 見つかったテーブルを返します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すべてのスクリプトについて、出力はFormat-TableではなくExport-CSVで実行でき、すぐにCSVファイルを作成して、スプレッドシートエディターで既に分析できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      {{映画の始まりのレオナルド・ディカプリオの写真}} 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> スナップへのアイテムの追加 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     スクリプトは美しいですが、もっと自動化が必要です。 そして、コンテキストメニューをクリックすると、リモートコントロール用の<i>DameWare</i>プログラムが自動的にコンピューターに接続されるようにしたかったのです。 もちろん、任意の便利なプログラムを実行できます。したがって、必要に応じて、たとえばマシンをリモートで再起動できます。 ただし、 <i>DameWareの</i>例を検討してください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>ADUC</b>スナップインのコンテキストメニューの設定は、最初は見えますが、ADディレクトリにあるため、ローカル<b>に</b>はありません。 新しいアイテムを追加するには、AD構成エディターである<b>ADSI Edit</b>ユーティリティを使用する必要があります。  AD構成に接続する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/eb8/a23/b9e/eb8a23b9e21899d99f0f808ac4bff831.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     変更に必要な属性はオブジェクトにあります 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b><i>CN =ユーザーディスプレイ、CN = 419、CN = DisplaySpecifiers、CN =構成、DC = contoso、DC = com</i></b> また、 <b><i>CN = 419</i></b>は、ご<b><i>想像のとおり</i></b> 、言語です。 英語の<b>ADUC</b>スナップインのパラメーターを変更する必要がある場合、 <i><b>CN = 419</b></i>を<i><b>CN = 409に</b></i>変更する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/b19/02a/94d/b1902a94d181e2935f4013c5465ef8c9.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b><i>adminContextMenu</i></b>にアイテムを追加します。 私が理解するように、最初はソート番号であり、2番目は名前自体であり、3番目は実際に実行されるオブジェクトのアドレスです。 パラメーターはコンマで区切られます。  <b>ユーザー</b>オブジェクトの<b>ADUC</b>を再起動すると、新しく作成されたアイテムがコンテキストメニューに表示されます。 スクリプトはユーザーとして起動され、その代わりにスナップインが起動されます。 合計で、 <b>ADUC</b>のコンテキストメニューからプログラムを起動する<b>と、</b>スクリプトまたはプログラム<b>は</b>パラメーターで2つの値を<b>受け取り</b>ます。これらはオブジェクト<b>DN</b>とオブジェクトタイプです。 スクリプトでユーザー名を見つけるための最初のパラメーターのみに関心があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> WshShell = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> fs=<span class="hljs-built_in"><span class="hljs-built_in">createobject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> CompName <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> RunCMD <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> FilePath <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objAD = <span class="hljs-built_in"><span class="hljs-built_in">GetObject</span></span>(Wscript.arguments.Item(<span class="hljs-number"><span class="hljs-number">0</span></span>)) CompName = objAD.<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> (<span class="hljs-string"><span class="hljs-string">"LabelComputer"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> CompName = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> WScript.Echo <span class="hljs-string"><span class="hljs-string">"    "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> CompName = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> WScript.quit <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">MsgBox</span></span> (<span class="hljs-string"><span class="hljs-string">"   "</span></span> &amp; CompName &amp; <span class="hljs-string"><span class="hljs-string">"?"</span></span>,vbOKCancel+vbQuestion,<span class="hljs-string"><span class="hljs-string">"?"</span></span>) = vbCancel <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> WScript.quit <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> fs.FileExists (<span class="hljs-string"><span class="hljs-string">"C:\Program Files\DameWare\DameWare Mini Remote Control 7.5\DWRCC.exe"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> FilePath = <span class="hljs-string"><span class="hljs-string">"""C:\Program Files\DameWare\DameWare Mini Remote Control 7.5\DWRCC.exe"""</span></span> RunCMD = FilePath &amp;<span class="hljs-string"><span class="hljs-string">" -c: -h: -x: -m:"</span></span> &amp; CompName &amp; <span class="hljs-string"><span class="hljs-string">" -u:LocalAdmin -p:1072206713 -d:contoso"</span></span> RetCode = WshShell.Run (RunCMD,<span class="hljs-number"><span class="hljs-number">5</span></span>)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このスクリプトは、資格情報contoso \ LocalAdminを使用してDamwareプログラムを起動します。 このユーザーは、以前にユーザーのコンピューターのローカル管理者のリストに追加されていました。 実際、オプション-u：、-p :、および-d：を除外すると、現在のユーザーの代わりにDameWareが起動します。 ユーザーのコンピューターのローカル管理者権限がある場合、これは簡単です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     将来的には、このテーマを開発して、テクニカルサポート部門の電話をSIPソフトフォンに転送し、すべての作業スキームをプログラムに適合させて、着信コールで必要なすべてのサンプルが作成され、発信者に関するすべての情報がすぐに画面に表示されるようにします。 そして幸せが来るでしょう！ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここではユニークな知識は説明されていませんが、少なくともスクリプトの例がこの分野を理解する初心者に役立つことを願っています:)あなたはこれをすべて改善し続け、新しい属性を追加し、ユーザーだけでなくコンピューターにもラベルを追加してタイムスタンプを追加できます最新のコンピューターなどを保存する 各企業には独自のニーズがあります。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J19280/index.html">あなたのウェブサイトはいくらですか？</a></li>
<li><a href="../J192800/index.html">OSSEC：ビッグブラザーはあなたを見ています</a></li>
<li><a href="../J192804/index.html">GALAXY Note用のSamsung Mobile SDKおよびSamsung Smart App Challenge 2013</a></li>
<li><a href="../J19281/index.html">ホスティングのアドバイス...</a></li>
<li><a href="../J192814/index.html">KamaGames Studioブログへようこそ</a></li>
<li><a href="../J19282/index.html">「ITクラウド」</a></li>
<li><a href="../J192820/index.html">Unity3D + Kinect、または膝のアニメーション</a></li>
<li><a href="../J192824/index.html">EdXブレードについての何か</a></li>
<li><a href="../J192826/index.html">2回目のPythonミートアップ：PEPに何を期待するか、足を踏み入れる価値はありますか？</a></li>
<li><a href="../J192828/index.html">.NETプロジェクトの継続的統合：NAntおよび/またはMSBuild？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>