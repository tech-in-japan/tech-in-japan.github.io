<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ ğŸ•´ğŸ½ ğŸ…ğŸ» Mikrotikï¼šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãƒãƒ£ãƒãƒ«ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ğŸ‘ˆğŸ¾ ğŸ’  ğŸ§˜ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ãƒ¡ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒæ¶ˆãˆãŸã¨ãã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«åˆ‡ã‚Šæ›¿ãˆã€ãƒ¡ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒå†ã³æ©Ÿèƒ½ã—å§‹ã‚ãŸã‚‰ã™ãã«æˆ»ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ ãƒãƒ£ãƒãƒ«ã¯ä¸€åº¦ã«1ã¤ãšã¤ä½¿ç”¨å¯èƒ½ã§ã€ã“ã“ã§ã¯è² è·åˆ†æ•£ãŒè¡Œã‚ã‚Œãªã„ã“ã¨ã‚’ã™ãã«è¨€ã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ ä¸¡æ–¹ã®ãƒãƒ£ãƒãƒ«ã¯PPPæ¥ç¶šã§ã™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Mikrotikï¼šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãƒãƒ£ãƒãƒ«ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"> ãƒ¡ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒæ¶ˆãˆãŸã¨ãã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«åˆ‡ã‚Šæ›¿ãˆã€ãƒ¡ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒå†ã³æ©Ÿèƒ½ã—å§‹ã‚ãŸã‚‰ã™ãã«æˆ»ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚ ãƒãƒ£ãƒãƒ«ã¯ä¸€åº¦ã«1ã¤ãšã¤ä½¿ç”¨å¯èƒ½ã§ã€ã“ã“ã§ã¯è² è·åˆ†æ•£ãŒè¡Œã‚ã‚Œãªã„ã“ã¨ã‚’ã™ãã«è¨€ã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ ä¸¡æ–¹ã®ãƒãƒ£ãƒãƒ«ã¯PPPæ¥ç¶šã§ã™ï¼ˆç§ã®å ´åˆã€1ã¤ã¯æœ‰ç·šã§ã€2ã¤ç›®ã¯3Gãƒ›ã‚¤ãƒƒã‚¹ãƒ«ã§ã™ï¼‰ã€‚ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æœ€ã‚‚æŸ”è»Ÿãªç›£è¦–ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ç‰¹åˆ¥ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€ç‰¹ã«ãƒã‚§ãƒƒã‚¯ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¯ã€ç§ã«ã¨ã£ã¦å®Œå…¨ã«æ­£ã—ã„ã‚ã‘ã§ã¯ãªã„ã‹ã‚‰ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     åŸºæœ¬çš„ãªåŸå‰‡ã¯å˜ç´”ã§ã™ã€‚VPNãƒãƒ£ãƒãƒ«ã‚’ä¸Šã’ã¦ã‚‚ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒãã‚Œã‚’ä»‹ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã™ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ ã„ãã¤ã‹ã®å¤–éƒ¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã«pingã‚’é€ä¿¡ã—ã¦ç¢ºèªã—ã¾ã™ã€‚  pingãŒä½œæ¥­ã®æŒ‡æ¨™ã§ã¯ãªã„å ´åˆã«æ€ã„ä»˜ãã“ã¨ãŒã§ãã¾ã™ãŒã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ã€çŠ¶æ³ã«å¿œã˜ã¦ä»–ã®æ¤œè¨¼æ–¹æ³•ã‚’æŒ‡å®šã§ãã¾ã™ã€‚ ãã®ä»–ã®æ©Ÿèƒ½ï¼šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒãƒ£ãƒãƒ«ã¯ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚Šã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ãŒãªã„å ´åˆã«ã®ã¿æ¥ç¶šã—ã€ãã‚Œä»¥å¤–ã®æ™‚é–“ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ãŒã‚ªãƒ•ã«ãªã‚Šã¾ã™ã€‚ ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã«æˆ»ã‚‹ã¨ã€ãã®æ“ä½œæ€§ãŒæ­£ã—ããƒã‚§ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ä½¿ç”¨ã—ãŸpingã¨ã¯ç•°ãªã‚‹æ‰‹æ³•ã€‚ ã•ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®ãƒ«ãƒ¼ãƒˆè·é›¢ã¯å‹•çš„ã«å¤‰åŒ–ã—ã€å¸¸ã«ç­‰ã—ããªã„ãŸã‚ã€ãƒãƒ£ãƒãƒ«ãŒåŒæ™‚ã«æ©Ÿèƒ½ã™ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ãŒã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ãã®ã†ã¡ã®1ã¤ã«ã®ã¿å‘ã‘ã‚‰ã‚Œã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ç†è§£ã—ã¦ãã ã•ã„ã€‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¾ãŸã¯ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ã„ãšã‚Œã‹ãŒé™çš„ã‚’æä¾›ã™ã‚‹å ´åˆã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç°¡å˜ã«ã‚„ã‚Šç›´ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã—ãŸãŒã£ã¦ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«å¿…è¦ãªè¨­å®šã‚’ä¸€è²«ã—ã¦èª¬æ˜ã—ã€æ¬¡ã«ä½œæ¥­ã®ä¸»è¦ãªãƒã‚¤ãƒ³ãƒˆã‚’ç´°ã‹ãèª¬æ˜ã—ã¾ã™ã€‚ æœ€å¾Œã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¨ä½“ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ISP1ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰ã¨ISP2ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰ã®2ã¤ã®PPPæ¥ç¶šãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚ä¸¡æ–¹ã¨ã‚‚è¨­å®šã•ã‚Œã€åˆ¥ã€…ã«å‹•ä½œã—ã¾ã™ã€‚  <i>dial-on-demand = no</i>ãŠã‚ˆã³<i>add-default-route = yesã‚’ãã‚Œã‚‰</i>ã«è¨­å®šã—ã€ISP2ã®<i>default-route-distance</i>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ISP1ã‚ˆã‚Šã‚‚1ã¤å¤šãè¨­å®šã—<i>ã¾ã™</i> ã€‚  NATãªã©ã®æ¨™æº–çš„ãªã‚‚ã®ã‚’è¨­å®šã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡å…ƒã¨åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ä¸Šã§å¿œç­”ç”¨ã®ãƒ‘ã‚±ãƒƒãƒˆã¨æ¥ç¶šã‚’ãƒãƒ¼ã‚¯ã—ã€ãƒãƒ¼ã‚¯ã•ã‚ŒãŸãƒ‘ã‚±ãƒƒãƒˆã®ãƒ«ãƒ¼ãƒˆã‚’è¨­å®šã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">æº–å‚™ã™ã‚‹</b> <div class="spoiler_text"><pre><code class="bash hljs">/ip firewall mangle add action=mark-connection chain=forward connection-mark=no-mark \ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-interface=ISP1 new-connection-mark=ISP1 passthrough=no add action=mark-routing chain=prerouting connection-mark=ISP1 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-interface=\ bridge-local new-routing-mark=to_ISP1 passthrough=no add action=mark-connection chain=forward connection-mark=no-mark \ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-interface=ISP2 new-connection-mark=ISP2 passthrough=no add action=mark-routing chain=prerouting connection-mark=ISP2 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-interface=\ bridge-local new-routing-mark=to_ISP2 passthrough=no /ip firewall nat add action=masquerade chain=srcnat out-interface=ISP1 add action=masquerade chain=srcnat out-interface=ISP2 /ip route add distance=1 gateway=ISP1 routing-mark=to_ISP1 add distance=1 gateway=ISP2 routing-mark=to_ISP2</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã¾ãŸã€ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯192.168.xx.yyã€ã‚µãƒ–ãƒãƒƒãƒˆã¯192.168.xx.0 / 24ã§ã‚ã‚‹ã¨æƒ³å®šã—ã¦ã„ã¾ã™ã€‚ ã“ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®åå‰ã¨åŒæ§˜ã«ã€ç‹¬è‡ªã®ã‚‚ã®ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã‚Œã¯å…¨ä½“ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ã¯ãªãã€ã™ã¹ã¦ã®é †åºã«ã¤ã„ã¦ã§ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">å¤‰æ•°</b> <div class="spoiler_text"><pre> <code class="bash hljs">global FailoverTimes; global FailoverLastTime; global FailoverLastBackTime; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> ifMain <span class="hljs-string"><span class="hljs-string">"ISP1"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> ifRes <span class="hljs-string"><span class="hljs-string">"ISP2"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> scriptName <span class="hljs-string"><span class="hljs-string">"Failover"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> state 0; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> pingNum 0; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> pingRes; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> routeDist; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> routeDist2; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> tmp; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> ip { xxxx; yyyy; zzzz }; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> pingSrcAddr 192.168.xx.yy;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å¤‰æ•°ã‚’å®šç¾©ã—ã¾ã™ï¼š <i>ifMain</i>ãŠã‚ˆã³<i>ifResã«</i>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®åå‰ã‚’æ›¸ãè¾¼ã¿ã€ <i>pingSrcAddr</i>ã«ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆå¿…è¦ãªç†ç”±ã¯å¾Œã§æ˜ã‚‰ã‹ã«ãªã‚Šã¾ã™ï¼‰ã€ãŠã‚ˆã³<i>ip</i>é…åˆ—ã®ãƒãƒ£ãƒãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãŸã‚ã«pingã™ã‚‹3ã¤ã®å¤–éƒ¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ›¸ãè¾¼ã¿ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">å˜ä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [len [/system script job find <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> script=<span class="hljs-variable"><span class="hljs-variable">$scriptName</span></span>]] &gt; 1) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { error <span class="hljs-string"><span class="hljs-string">"single instance"</span></span> }; delay 15;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚³ãƒ”ãƒ¼ã‚’1ã¤ã ã‘å®Ÿè¡Œã—ã¾ã™ã€‚  RouterOSã®é–‹å§‹æ™‚ã«èµ·å‹•ã™ã‚‹å ´åˆã¯ã€æ¥ç¶šã‚’ç¢ºç«‹ã™ã‚‹æ™‚é–“ã‚’ä¸ãˆã¦ãã ã•ã„ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     å°‘ã—ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã€ä¸»è¦éƒ¨åˆ†ã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€åœæ­¢ã™ã‚‹ã‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã¾ã§ç„¡é™ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ ç„¡é™ãƒ«ãƒ¼ãƒ—ã§ã¯ã€ <i>çŠ¶æ…‹</i>å¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ç¾åœ¨ã®çŠ¶æ…‹ã‚’åˆ†æã—ã€å¿…è¦ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ ãã‚Œã‚‰ã‚’è€ƒæ…®ã—ã¦ãã ã•ã„ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">çŠ¶æ…‹0</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> &gt;= 3) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> 0; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;<span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span>) count=1] = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> [ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;0) count=2]; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span>+[ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;1) count=2]); <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span>+[ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;2) count=2]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$FailoverLastTime</span></span> <span class="hljs-string"><span class="hljs-string">"$[/system clock get date] $[/system clock get time]"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$FailoverTimes</span></span> ([tonum <span class="hljs-variable"><span class="hljs-variable">$FailoverTimes</span></span>] + 1) <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 1; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: state changed 0-&gt;1"</span></span>; } } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> + 1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { delay 15 }; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 0); }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     çŠ¶æ…‹0-ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ãŒæ©Ÿèƒ½ã—ã¦ã„ã‚‹ã¨ãã€‚  15ç§’ã”ã¨ã«1å›ã€æŒ‡å®šã•ã‚ŒãŸ3ã¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®1ã¤ã‚’é †ç•ªã«ãƒã‚§ãƒƒã‚¯ã—ã€å›ç­”ãŒãªã„å ´åˆã¯3ã¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã™ã¹ã¦ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚ è´è¦šéšœå®³è€…-ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒãƒ£ãƒãƒ«ã¸ã®ç§»è¡Œã‚’é–‹å§‹ã—ã¾ã™ã€‚ é…åˆ—å†…ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯3ã§ã‚ã‚‹ã“ã¨ãŒå³å¯†ã«ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚ãã†ã§ãªã„å ´åˆã¯ã€ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">çŠ¶æ…‹1</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 1) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [/interface l2tp-client get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> default-route-distance] &gt; 10) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { /interface ppp-client <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> default-route-distance=1; } /interface <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span>; beep frequency=2000 length=250ms; delay 500ms; beep frequency=2000 length=250ms; delay 500ms; delay 6; /interface <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> ([/interface ppp-client get <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> default-route-distance] + 1); /interface l2tp-client <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> default-route-distance=<span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span>; /interface <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 2; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: state changed 1-&gt;2"</span></span>; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     çŠ¶æ…‹1-ãƒãƒ£ãƒãƒ«ã®åˆ‡ã‚Šæ›¿ãˆã€‚ ã©ã®ç‰¹å®šã®PPPæ¥ç¶šãŒä½¿ç”¨ã•ã‚Œã‚‹ã‹ãŒé‡è¦ã§ã™ã€‚ ã“ã®ä¾‹ã§ã¯ã€ISP1ã¯l2tp-clientã§ã‚ã‚Šã€ISP2ã¯ppp-clientã§ã™ã€‚ ä»–ã®å ´åˆã¯ã€ <i>default-route-distanceã®</i>è¡Œã§ãã‚Œã‚‰ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Š<i>ã¾ã™</i> ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒãƒ£ãƒãƒ«ã‚’ã‚ªãƒ³ã«ã—ãŸå¾Œã€7ç§’é–“å¾…æ©Ÿã—ã¾ã™ã€‚ ã“ã‚Œã¯ç§ã«ã¨ã£ã¦ååˆ†ãªæ™‚é–“ã§ã‚ã‚Šã€ãã®é–“ã«3Gæ¥ç¶šãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚ ã“ã®é–“ã€ç¾åœ¨ã®æ¥ç¶šã¨æ–°ã—ã„æ¥ç¶šã¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§ãƒãƒ³ã‚°ã—ã¾ã™ãŒã€ãƒ¡ã‚¤ãƒ³VPNã¯ã¾ã åˆ‡æ–­ã•ã‚Œã¦ãŠã‚‰ãšã€å®›å…ˆåˆ°é”ä¸èƒ½ãƒ«ãƒ¼ã‚¿ãƒ¼ã®å¿œç­”ã¯æœ€å°é™ã«æŠ‘ãˆã‚‰ã‚Œã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã‚¢ãƒãƒãƒ¥ã‚¢å‘ã‘ã®ã‚µã‚¦ãƒ³ãƒ‰è¡¨ç¤ºã¯ã€å¤œé–“ã«å‹•ä½œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ ãã†ã§ãªã„å ´åˆã¯ã€å‰Šé™¤ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã•ã‚‰ã«ã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã¯ã‚ªãƒ•ã«ãªã‚Šã€ãã®<i>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒˆè·é›¢ã¯</i>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒãƒ£ãƒãƒ«ã‚ˆã‚Š1å¤§ããè¨­å®šã•ã‚Œã€å†ã³ã‚ªãƒ³ã«ãªã‚Šã¾ã™ã€‚ ã“ã®ãŸã‚ã€äºˆç´„ã‚’ä»‹ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å¹²æ¸‰ã™ã‚‹ã“ã¨ãªãã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®å¾©å¸°ã‚’å¾…ã¤ã“ã¨ãŒã§ãã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ä»Šå¾Œã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã«åˆ‡ã‚Šæ›¿ãˆã¦äºˆç´„ã‚’åˆ‡æ–­ã™ã‚‹ã¨ã€ <i>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒˆè·é›¢</i>ãŒ1ãšã¤å¢—åŠ ã—ã¾ã™ã€‚ãƒ«ãƒ¼ãƒˆè·é›¢ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ãŸã³ã«ã€PPPæ¥ç¶šãŒé †æ¬¡å¢—åŠ ã—ã¾ã™ã€‚ ãã‚Œã‚‰ãŒè¡Œãéããªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€ã“ã“ã§ç¾åœ¨ã®å€¤ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã€10ã‚’è¶…ãˆã‚‹ã¨1ã®ãƒªã‚»ãƒƒãƒˆãŒç™ºç”Ÿã—ã¾ã™ï¼ˆãŸã¨ãˆã°ã€ç†è«–çš„ã«ã¯æœ€å¤§ç´„250ï¼‰ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">çŠ¶æ…‹2</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 2) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [len [interface find <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> name=<span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> and running] ] = 1) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> [ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;0) src-address=<span class="hljs-variable"><span class="hljs-variable">$pingSrcAddr</span></span> count=2]; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span>+[ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;1) src-address=<span class="hljs-variable"><span class="hljs-variable">$pingSrcAddr</span></span> count=2]); <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span>+[ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;2) src-address=<span class="hljs-variable"><span class="hljs-variable">$pingSrcAddr</span></span> count=2]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> &gt; 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 3; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: state changed 2-&gt;3"</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 2) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { delay 15 }; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 2); }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     çŠ¶æ…‹2-ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®å¾©å…ƒã‚’å¾…æ©Ÿã—ã¦ã„ã¾ã™ã€‚ ä¿è­·åŒºã®çŠ¶æ…‹ãŒãŠã‚‚ã—ã‚ããªã„ã“ã¨ã¯æ³¨ç›®ã«å€¤ã—ã¾ã™ã€‚ å½¼ãŒæ¥ç¶šã—ãªã‹ã£ãŸå ´åˆã€ä½•ã‚‚ã™ã‚‹ã“ã¨ã¯ãªãã€å½¼ã®ãŸã‚ã®ã™ã¹ã¦ã®æ¡ä»¶ãŒä½œæˆã•ã‚Œã¾ã™ã€‚å®Ÿéš›ã€ç§ãŸã¡ã¯ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒ³ãƒãƒ«ã«ã®ã¿èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã“ã§ã¯ã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®VPNãŒå¼•ãä¸Šã’ã‚‰ã‚Œã‚‹ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã€ãã®å¾Œã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªäºˆç´„ã‚’ä½¿ç”¨ã—ã¦å¤–éƒ¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®pingãŒè©¦è¡Œã•ã‚Œã¾ã™ã€‚ ãã‚Œã¯é›£ã—ããªã‚Šã¾ã™ãŒã€æ­£ã—ã„ã§ã™ã€‚  <i>ping xx.xx.xx.xx interface = $ ifMain</i>ã‚’è¨˜è¿°ã—ãŸå ´åˆã€é–‹ç™ºè€…ã«ã‚ˆã‚‹ã¨ã€ã“ã‚Œã¯æ©Ÿèƒ½ã™ã‚‹å ´åˆã¨æ©Ÿèƒ½ã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ ã“ã“ã§ã€pingã¯ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ ãã‚Œã¯å¸¸ã«ãã“ã«ã‚ã‚‹ã¨ä»®å®šã•ã‚Œã€ãã†ã§ãªã‘ã‚Œã°ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒå¿…è¦ã§ã™ã€‚ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒå‹•çš„ã«æä¾›ã™ã‚‹ãŸã‚ã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®å¤–éƒ¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚ ãƒ«ãƒ¼ãƒˆãŒéã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆãƒ«ãƒ¼ãƒˆè·é›¢ãŒãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚ˆã‚Šã‚‚å¤§ãã„ï¼‰å ´åˆã§ã‚‚ã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã‚’ä»‹ã—ã¦ã“ã®ã‚ˆã†ãªpingã‚’é€ä¿¡ã™ã‚‹ã‚ˆã†ã«ãƒ«ãƒ¼ã‚¿ãƒ¼ã«æŒ‡ç¤ºã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</b> <div class="spoiler_text"><pre> <code class="bash hljs">/ip firewall mangle add action=mark-routing chain=output comment=Failover_script_rule \ dst-address=!192.168.xx.0/24 new-routing-mark=to_ISP1 passthrough=no \ protocol=icmp src-address=192.168.xx.yy /ip route rule add action=lookup-only-in-table routing-mark=to_ISP1 src-address=\ 192.168.xx.yy/32 table=to_ISP1</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã“ã§ä½¿ç”¨ã•ã‚Œã‚‹pingãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯éæ¨™æº–ã§ã™ã€‚ ã“ã‚Œã¯ã€ãƒ«ãƒ¼ã‚¿ãƒ¼è‡ªä½“ã‹ã‚‰å¤–éƒ¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®å‡ºåŠ›ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã§ã™ã€‚ é€šå¸¸ã€ã“ã®ã‚ˆã†ãªå ´åˆã€ãƒ«ãƒ¼ã‚¿ãƒ¼ã¯ãƒ‘ã‚±ãƒƒãƒˆãŒ<i>src-addressã«</i>å‘ã‹ã†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã—<i>ã¾ã™</i> ã€‚ ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’<i>src-address</i>ã¨ã—ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€lokalkaãŒåº§ã£ã¦ã„ã‚‹ã®ã¨åŒã˜NATã«å¯¾ã—ã¦ãã‚Œã‚’å–ã‚Šå‡ºã™ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚ ã•ã‚‰ã«ã€ã“ã®ã‚ˆã†ãªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®<i>ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ã‚¯ã§</i>ã‚¿ã‚°ä»˜ã‘ã•ã‚Œã€ãƒ‘ã‚±ãƒƒãƒˆã¯ãƒ©ãƒ™ãƒ«ä»˜ãã®ãƒ«ãƒ¼ãƒˆã®ãŸã‚ã«ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã‚’é€šéã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2ç•ªç›®ã®ãƒ«ãƒ¼ãƒ«ã‚‚å¿…è¦ã§ã™ã€‚ ã“ã‚ŒãŒãªã„ã¨ã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒ³ãƒãƒ«ãŒçªç„¶å†ã³è½ã¡ãŸå ´åˆã€ <i>to_ISP1</i>ã¨ãƒãƒ¼ã‚¯ã•ã‚ŒãŸpingã§ã‚‚ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒãƒ£ãƒ³ãƒãƒ«ãƒ©ãƒ™ãƒ«ãªã—ã§ãƒ«ãƒ¼ãƒˆã«æ²¿ã£ã¦ç§»å‹•ã—ã€ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒ³ãƒãƒ«ã«æ­£ã—ãæˆ»ã‚Šã¾ã›ã‚“ã€‚ ã“ã‚Œã¯ã€RouterOSãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã§ã™ã€‚ãƒãƒ£ãƒãƒ«ãŒæ¥ç¶šã•ã‚Œã¦ã„ãªã„å ´åˆã€ãƒ«ãƒ¼ãƒˆã¯ãƒãƒ¼ã‚¯ã•ã‚Œã¦ã„ã¦ã‚‚ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚ å°‘ã—æ˜ç¢ºã«ã™ã‚‹ãŸã‚ã«ã€ <i>çŠ¶æ…‹</i> = 2ã‚’æƒ³å®šã—<i>ã¾ã™ã€‚</i>ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã¯ã‚¢ãƒƒãƒ—ã—ã¦ã„ã¾ã™ãŒã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯é€šéã—ã¾ã›ã‚“ã€‚ ã“ã®å ´åˆã€pingã«6ç§’ã‹ã‹ã‚Šã¾ã™ã€‚ ã—ãŸãŒã£ã¦ã€ã“ã®æ™‚ç‚¹ã§ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ãŒã‚ªãƒ•ã«ãªã£ã¦ã„ã‚‹å ´åˆã€pingã¯ãƒªã‚¶ãƒ¼ãƒ–ã‚’é€šéã—å§‹ã‚ã¾ã™ã€‚  2ç•ªç›®ã®ãƒ«ãƒ¼ãƒ«ã¯ã“ã‚Œã‚’é™¤å¤–ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ«ãƒ¼ã‚¿ãƒ¼ã‹ã‚‰LANã¸ã®pingã¯ãƒãƒ¼ã‚¯ã•ã‚Œã¦ãŠã‚‰ãšã€é€šå¸¸ã©ãŠã‚Šå‹•ä½œã™ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">çŠ¶æ…‹3</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 3) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { /interface <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> ([/interface l2tp-client get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> default-route-distance] + 1); /interface ppp-client <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> default-route-distance=<span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 0; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$FailoverLastBackTime</span></span> <span class="hljs-string"><span class="hljs-string">"$[/system clock get date] $[/system clock get time]"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: state changed 3-&gt;0"</span></span>; beep frequency=500 length=500ms; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     çŠ¶æ…‹3-ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã¸ã®ç§»è¡Œã€‚  pingãŒãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã‚’é€šéã—å§‹ã‚ãŸã‚‰ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—VPNã‚’ã‚ªãƒ•ã«ã™ã‚‹ã ã‘ã§ã€ãƒ¡ã‚¤ãƒ³VPNãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ æ¬¡ã«ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®<i>default-route-distanceã‚’</i>ãƒ¡ã‚¤ãƒ³ã‚ˆã‚Šã‚‚1å¤§ããå¤‰æ›´ã—ã€éŸ³å£°ä¿¡å·ã‚’é€ã‚Šã¾ã™ã€‚  PPPæ¥ç¶šã®ã‚¿ã‚¤ãƒ—ã«æ³¨æ„ã‚’æ‰•ã„ã€å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã®æ™‚ç‚¹ã§ã€ã‚µã‚¤ã‚¯ãƒ«ã¯é–‰ã˜ã¦çŠ¶æ…‹0ã«æˆ»ã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã“ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ãã«ã€ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">åˆæœŸçŠ¶æ…‹</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> [/interface l2tp-client get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> default-route-distance]; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$routeDist2</span></span> [/interface ppp-client get <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> default-route-distance]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> &lt; <span class="hljs-variable"><span class="hljs-variable">$routeDist2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [/interface get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> running] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 0; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 1; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [/interface get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> disabled] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { /interface <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> &gt; <span class="hljs-variable"><span class="hljs-variable">$routeDist2</span></span> and [/interface get <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> disabled] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 2; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 3; } } <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: initial state </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$state</span></span></span><span class="hljs-string">"</span></span>;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã“ã§ã¯ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚‚ä¸€è¦‹è¤‡é›‘ã§ã™ã€‚  ISP1ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã€ISP2ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã€ãŠã‚ˆã³ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ«ãƒ¼ãƒˆè·é›¢é–¢ä¿‚ã‚’æŒã¤3ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒåˆ†æã•ã‚Œã¾ã™ã€‚ åˆæœŸçŠ¶æ…‹1ãŠã‚ˆã³3ã¯éæ¨™æº–ã§ã‚ã‚Šã€æ§‹æˆãŒæ­£ã—ããªã„ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ãŒã€ã“ã®å ´åˆã€ä¸å¿…è¦ãªåˆ‡ã‚Šæ›¿ãˆã«ã‚ˆã£ã¦ã‚‚ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªä½“ãŒã™ã¹ã¦ã‚’å¾©å…ƒã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">é™¤å¤–æ¡ä»¶</b> <div class="spoiler_text"> é™¤å¤–ã—ãŸæ¡ä»¶ãŒã‚‚ã†1ã¤ã‚ã‚Šã¾ã™ã€‚ ã»ã¨ã‚“ã©ã®å ´åˆã€ã»ã¨ã‚“ã©ã®äººã«ã¯ã»ã¨ã‚“ã©å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚ ç§ã®ISP1ã¯ã€IPã§ã¯ãªãåå‰ã§VPNã‚’æ¥ç¶šã—ã¦ã“ã®åå‰ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€åŒã˜ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®DNSã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«è§£æ±ºã•ã‚Œã¾ã™ã€‚ ã¾ãŸã€ç‰¹å®šã®DNSã‚’ç¤ºã™è§£æ±ºã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ”¯æ´ã—ãªã„å ´åˆã€ISP1ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒåˆ©ç”¨å¯èƒ½ã«ãªã£ãŸå¾Œã§ã‚‚ã€æ¥ç¶šã—ã¾ã›ã‚“ã€‚ ãƒ‰ãƒ¡ã‚¤ãƒ³åã¯è§£æ±ºã•ã‚Œã¾ã›ã‚“ãŒã€DNSãƒªã‚¶ãƒ¼ãƒ–ã¯å¼•ãç¶šãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ ã“ã‚Œã¯ä½™åˆ†ã§ã™ã€‚ çŠ¶æ…‹ï¼š 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 2) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (([ping DNSip1 count=1] &gt; 0) or ([ping DNSip2 count=1] &gt; 0)) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$tmp</span></span> 0; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { resolve VPNaddress server=DNSip1; } on-error= { }; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { resolve VPNaddress server=DNSip2; } on-error= { }; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { resolve VPNaddress } on-error= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$tmp</span></span> 1; }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$tmp</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 3; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: state changed 2-&gt;3"</span></span>; delay 5; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 2) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { delay 15 }; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 2); }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DNSip1ã€DNSip2ã€VPNaddressã®ä»£ã‚ã‚Šã«ã€å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ç½®ãæ›ãˆã¾ã™ã€‚ ä»¥ä¸‹ã®ã™ã¹ã¦ã®çŠ¶æ…‹ã¯ã€ãã‚Œãã‚Œ+1ã‚·ãƒ•ãƒˆã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã‚Œã¯åŸºæœ¬çš„ã«ã™ã¹ã¦ã€6.26ãŠã‚ˆã³RB951G-2HnDã§é–‹ç™ºãŠã‚ˆã³ãƒ‡ãƒãƒƒã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚ ä»–ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯-ç§ã¯ç´„æŸã—ã¾ã›ã‚“ã€ãã—ã¦ãƒãƒ¼ãƒ ã®å‰ã« 'ï¼š'ãŒãªã„ã“ã¨ã‚’æ®‹å¿µã«æ€ã„ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ç§ã®æ§‹æˆã§ã¯ã€ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨çµ„ã¿åˆã‚ã›ã¦ã€1åˆ†ã«1å›ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¾“ã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹åˆ¥ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ©Ÿèƒ½ã—ã¾ã™ã€‚ å½¼ã¯ã€ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã€å¤‰æ›´ã•ã‚ŒãŸã¨ãã«ãƒ¡ãƒ¼ãƒ«ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã•ã‚‰ã«é€ä¿¡ã—ã¾ã™ã€‚ ã“ã‚Œã¯å°ã•ãªä¾‹ã§ã™ãŒã€æœ€åˆã®éƒ¨åˆ†ã®ã¿ã§ã™ï¼š 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼</b> <div class="spoiler_text"><pre> <code class="bash hljs">global FailoverDisabled; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [len [/system script job find <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> script=<span class="hljs-string"><span class="hljs-string">"Failover"</span></span>]] = 0 and <span class="hljs-variable"><span class="hljs-variable">$FailoverDisabled</span></span> != 1) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { execute script=<span class="hljs-string"><span class="hljs-string">"Failover"</span></span>; } on-error= { <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: Failed to execute Failover"</span></span> }; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¯ã€ãƒ•ã‚§ãƒ¼ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®èµ·å‹•ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã¾ãŸã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã‚ˆã‚Šã€ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒäºˆæœŸã›ãšå†èµ·å‹•ã—ãŸå ´åˆã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯è‡ªå‹•çš„ã«å†èµ·å‹•ã•ã‚Œã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ãƒ•ã‚§ãƒ¼ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¨ä½“</b> <div class="spoiler_text"><pre> <code class="bash hljs">global FailoverTimes; global FailoverLastTime; global FailoverLastBackTime; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> ifMain <span class="hljs-string"><span class="hljs-string">"ISP1"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> ifRes <span class="hljs-string"><span class="hljs-string">"ISP2"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> scriptName <span class="hljs-string"><span class="hljs-string">"Failover"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> state 0; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> pingNum 0; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> pingRes; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> routeDist; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> routeDist2; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> tmp; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> ip { xxxx; yyyy; zzzz }; <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> pingSrcAddr 192.168.xx.yy; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [len [/system script job find <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> script=<span class="hljs-variable"><span class="hljs-variable">$scriptName</span></span>]] &gt; 1) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { error <span class="hljs-string"><span class="hljs-string">"single instance"</span></span> }; delay 15; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> [/interface l2tp-client get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> default-route-distance]; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$routeDist2</span></span> [/interface ppp-client get <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> default-route-distance]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> &lt; <span class="hljs-variable"><span class="hljs-variable">$routeDist2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [/interface get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> running] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 0; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 1; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( [/interface get <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span> disabled] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { /interface <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> <span class="hljs-variable"><span class="hljs-variable">$ifMain</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$routeDist</span></span> &gt; <span class="hljs-variable"><span class="hljs-variable">$routeDist2</span></span> and [/interface get <span class="hljs-variable"><span class="hljs-variable">$ifRes</span></span> disabled] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 2; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 3; } } <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: initial state </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$state</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> &gt;= 3) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> 0; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;<span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span>) count=1] = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> [ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;0) count=2]; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span>+[ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;1) count=2]); <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span>+[ping (<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>-&gt;2) count=2]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingRes</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$FailoverLastTime</span></span> <span class="hljs-string"><span class="hljs-string">"$[/system clock get date] $[/system clock get time]"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$FailoverTimes</span></span> ([tonum <span class="hljs-variable"><span class="hljs-variable">$FailoverTimes</span></span>] + 1) <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$state</span></span> 1; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> info <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$scriptName</span></span></span><span class="hljs-string">: state changed 0-&gt;1"</span></span>; } } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> (<span class="hljs-variable"><span class="hljs-variable">$pingNum</span></span> + 1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 0) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>= { delay 15 }; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-variable"><span class="hljs-variable">$state</span></span> = 0); } <span class="hljs-comment"><span class="hljs-comment"># endof if state = 0 if ($state = 1) do= { if ( [/interface l2tp-client get $ifMain default-route-distance] &gt; 10) do= { /interface ppp-client set $ifRes default-route-distance=1; } /interface enable $ifRes; beep frequency=2000 length=250ms; delay 500ms; beep frequency=2000 length=250ms; delay 500ms; delay 6; /interface disable $ifMain; set $routeDist ([/interface ppp-client get $ifRes default-route-distance] + 1); /interface l2tp-client set $ifMain default-route-distance=$routeDist; /interface enable $ifMain; set $state 2; log info "$scriptName: state changed 1-&gt;2"; } if ($state = 2) do= { do { if ( [len [interface find where name=$ifMain and running] ] = 1) do= { set $pingRes [ping ($ip-&gt;0) src-address=$pingSrcAddr count=2]; set $pingRes ($pingRes+[ping ($ip-&gt;1) src-address=$pingSrcAddr count=2]); set $pingRes ($pingRes+[ping ($ip-&gt;2) src-address=$pingSrcAddr count=2]); if ($pingRes &gt; 0) do= { set $state 3; log info "$scriptName: state changed 2-&gt;3"; } } if ($state = 2) do= { delay 15 }; } while ($state = 2); } # endof if state = 2 if ($state = 3) do= { /interface disable $ifRes; set $routeDist ([/interface l2tp-client get $ifMain default-route-distance] + 1); /interface ppp-client set $ifRes default-route-distance=$routeDist; set $state 0; set $FailoverLastBackTime "$[/system clock get date] $[/system clock get time]"; log info "$scriptName: state changed 3-&gt;0"; beep frequency=500 length=500ms; } # bad programming protection delay 1; } while= ( true );</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J252713/index.html">ãƒãƒ¼ã‚¹ã‚¹ãƒˆãƒ¼ãƒ³ã§ã®æ¥½ã—ã„æ•°å­¦</a></li>
<li><a href="../J252717/index.html">HPãƒã‚¤ãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ‰ä»®æƒ³åŒ–ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </a></li>
<li><a href="../J252721/index.html">ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ã®ä½¿ç”¨æ–¹æ³•</a></li>
<li><a href="../J252725/index.html">Skypeæ¤œé–²</a></li>
<li><a href="../J252727/index.html">ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥</a></li>
<li><a href="../J25273/index.html">å¤©æ–‡å­¦ã«ãŠã‘ã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ã‚½ãƒ¼ã‚·ãƒ³ã‚°ï¼šéŠ€æ²³ã®åˆ†é¡</a></li>
<li><a href="../J252731/index.html">Microsoft Azure RemoteAppã«åŸºã¥ã„ãŸVDIã®æ‰‹é–“ãªã—</a></li>
<li><a href="../J252733/index.html">ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ï¼šç™ºä¿¡è€…IDã¨åœ°åŸŸã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
<li><a href="../J252737/index.html">Xpom-Xpumï¼ SDK-Google Chromeæ‹¡å¼µæ©Ÿèƒ½ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®IDE</a></li>
<li><a href="../J252741/index.html">RFC2544æ¨™æº–ãƒ†ã‚¹ãƒˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>