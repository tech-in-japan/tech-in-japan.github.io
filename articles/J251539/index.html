<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍👩‍👦 🧚🏽 👶 Arduinoの別のサーモスタット、ただしOpenThermを使用 💪🏾 🈹 ♈️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="見出しの最初の部分を読んでいる間、あなたの多くはおそらく考えました-長い間苦しんでいるArduinoの別のサーモスタット。 そして...それは本当です-はい、これは別のボイラー、別の家のための別のサーモスタットですが、真実は部分的にしかありません-私はデバイス自体に集中したくない記事では-それらは本...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Arduinoの別のサーモスタット、ただしOpenThermを使用</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><img height="200" width="200" src="https://habrastorage.org/files/531/057/338/53105733876d4483b6f08190f00b19b8.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     見出しの最初の部分を読んでいる間、あなたの多くはおそらく考えました-長い間苦しんでいるArduinoの別のサーモスタット。 そして...それは本当です-はい、これは別のボイラー、別の家のための別のサーモスタットですが、真実は部分的にしかありません-私はデバイス自体に集中したくない記事では-それらは本当にたくさんあります（記事） もちろん、サーモスタットについて説明しますが、マイクロコントローラー自体をボイラーに接続する方法について詳しくお話したいと思います。 だから、誰が気に-してください... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> すべての始まり </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず第一に、私はまったくプログラマーではなく、実際のマイクロコントローラーとは何の関係もなかったと言いたいです。  MK AVR（そして実際にはMK）を初めて知ったのは高校に戻ったときで、この不思議なことがどのように機能するかを知りたいと思いました。 私はいくつかの記事を読みましたが、それ以来、DDRとPORTという2つの単語で説明できる文章しか覚えていませんでした。 それから5年目の大学がありました。「プログラミングマイコン」で、私たち全員が仮想環境でMSC51と出会いました。 既に中断、タイマー、その他すべてがありました。 さて、このような豊富な知識により、私は問題に直面しました。 この自伝的ノートを終了し、さらに興味深い部分に進みます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     だから、実際には、サーモスタットの作成を開始したもの-ガスボイラーで自律暖房を設置した後、私は、多くのように、一般的な問題に遭遇しました-家の温度は外の天気に非常に依存していました-霜-アパートは寒いので、クーラントの温度を上げる必要がありますバッテリー、ウォームアップ-逆に。 タンバリンとのそのようなダンスはあまり私には似合いませんでした、なぜなら ボイラーの調整は、ドアの後ろに設置され、ドアが電子レンジで支えられており、その上にゴミの山が置かれているため、複雑でした。 さて、あなたは理解しています-卵の中の針、アヒルの中の卵など 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この問題は非常に簡単に解決されました-OTCセンサー（外気温度補正）は、ボイラーに接続し、街路の温度に応じてクーラントの温度を自動的に調整できるようにします。 問題は解決されたように見えましたが、ボイラーのサービスマニュアル（Ferolli Domiproject C24D）を読むとすぐに私の希望が打ち砕かれました-このモデルの外部温度センサーの接続は提供されません。 それだけですか？ それだけです そして今、おそらく、終了することは可能ですが、夏にはコントロールボードが雷雨で燃え尽きてしまい、わかりにくい方法でサービスマンと話します（ボードは後で修理されました）OTCをボイラーに接続できるかどうかを尋ねましたか？ 彼は、外部サーモスタットを使用して接続すると答えました。 それは私の記憶に預けられましたが、寒い天気が始まる前に、それとまったく同じ問題に本当に集中しませんでした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     同じサービスマニュアルに目を通しましたが、すでにサーモスタットの接続方法を確認する目的で、「OpenThermコントローラー」が同じ端末に接続されていることに気付きました。 それから私は気づいた-ここにある！  「OpenTherm Arduino」をGoogleで検索すると、再び気分を害しました。 メッセージモニターはありましたが、そうではありません-聞く必要はありません。何もありません-サーモスタットが必要です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     それから、記事<a href="http://habrahabr.ru/post/214257/">habrahabr.ru/post/214257に出会いましたが</a> 、その終わりは私を混乱させました-オシロスコープのない著者は、ボイラーをマイクロコントローラーに接続できませんでした。 そして、MKに精通した人が働かなかった場合、私は何をしようとするべきですか？！  Opentherm v2.2プロトコルの詳細な説明がインターネットで見つかりました。これは私の熱意をさらに冷やしました-プロトコルの物理レベルはやや洗練されました-ボイラーからのデータが現在のレベル（5-7mA-低、17-23mA-高）で送信される電流ループ、およびサーモスタットからボイラーまでの電圧レベル（&lt;7V-低レベル、15-18V-高）、これにはペアリング回路が必要になります。私は電子機器に非常に近いです。 さらに、データはマンチェスターコードによって送信されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ただ一つの結論があります-気にしないで-ただ電子レンジと規範を動かしてください。 しかし、私は性格に1つの特徴があります-あなたがあなたの頭に何らかのアイデアを置くと、遅かれ早かれそれが実現します-はい、私はそれを忘れます（このアイデア）が、それでもどこにも行かないでしょうXBMCのメディアセンター、それに対するサテライト、DVBカード、その他多くの多くのもの）。 あなたは寝ていて、マンチェスターのコードを受け入れる方法についての計画がすでに頭の中で循環しています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そこで、OT / +プロトコルの仕組みを簡単に説明します（OTの種類については、上記の記事で説明しています）。 デバイス間の通信は、要求と応答の形式で行われます。 イニシエーターはサーモスタットのみです。  1秒間に少なくとも1回要求を送信し、20〜800ミリ秒の応答を待ちます。 メッセージ自体は、1つの開始ビットと1つの停止ビットを持つ32ビットです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      MSG-TYPE-メッセージタイプ-サーモスタットの場合： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      0x0-READ-DATA-データの読み取り。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      0x1-WRITE-DATA-書き込み。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ボイラー用： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      0x4-READ-ACK-読み取りを確認します（答えが入っています）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      0x5-WRITE-ACK-記録を確認します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      0x6-データ無効-データが正しくありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      0x7-UNKNOWN-DATAID-そのようなDATA-IDはありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DATA-ID-パラメーターの識別子。 最初の128個は予約されており、それらのほとんどはすでに仕様で指定されており、残りの128個は各ベンダーがその裁量で使用しています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DATA-VALUE-パラメーター値自体。 パラメーター自体に応じて、異なる形式になる場合があります。  2つの8ビットフラグ値、符号なし16ビット整数、固定小数点付き分数など パラメーターごとに、値のタイプが定義されています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     各OTデバイスに対して、パラメーターのセットが定義されています。これは必ずサポートする必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <table><tbody><tr><td> データID </td><td> 説明 </td><td> サーモスタット </td><td> ボイラー </td></tr><tr><td>  0 </td><td> デバイスステータスフラグ </td><td>  DATA-VALUEフィールドの上位バイトに必要な機能を設定して、読み取り要求を送信する必要があります </td><td>  DATA-VALUEフィールドの下位バイトにステータスビットを設定して、リクエストに応答する必要があります </td></tr><tr><td>  1 </td><td> 希望のクーラント温度を設定する </td><td> 希望の温度値で書き込み要求を送信する必要があります </td><td> 必要な温度の設定の確認で応答する必要があります </td></tr><tr><td>  3 </td><td> ボイラー構成 </td><td> パラメーターを読み取る必要があります </td><td> 要求に応答し、応答で送信されるすべての機能をサポートする必要があります </td></tr><tr><td>  14 </td><td> 最大火炎変調 </td><td> オプションのパラメーター </td><td> 実装する必要があります </td></tr><tr><td>  17 </td><td> 現在の火炎変調レベル </td><td> オプションのパラメーター </td><td> 実装する必要があります </td></tr><tr><td>  25 </td><td> クーラント温度 </td><td> オプションのパラメーター </td><td> 実装する必要があります </td></tr></tbody></table>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     他のすべてのパラメーターに対する答えは、ボイラーの製造元の要求に応じています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     知らない人にとっての火炎変調とは何かを少し説明します。 最新のガスボイラーはすべて、炉内の火炎レベルを制御することができます-これは変調と呼ばれます。 バーナーの出力が大きいほど、熱媒体の加熱が速くなり、出力が大きすぎるとボイラーの常時オン/オフ（クロック）が少なくなり、設定温度に達することができなくなります。 ボイラーが停止せず、所定レベルのクーラントを維持するのに十分な強度で燃焼する最適な動作モードが考慮されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ご覧のとおり、すべてが非常に簡単です-実装を記述し、ボイラーの制御を取得します。 しかし、悪魔は、彼らが言うように、ささいなことにあります。 物理レベルを思い出してください-ボイラーからのデータは現在のレベルで、電圧レベルでボイラーに送信されます-これは電子工学に慣れていない人を混乱させます。 ボイラーを搭載していますか？ それでは、電圧を制御する方法は？ ボイラーからArduinoにワイヤを接続することはできません。 知っている人にとっては、答えは明らかです-これは電流ループであり、ペアリング回路は非常に簡単です。 私は真ん中のどこかにいるので、インターネットに登って、愛好家がOpenTherm Gatewayを作ったotgw.tclcode.comというサイトを<a href="http://otgw.tclcode.com/">PIC</a>で見つけました。 ペアリング回路がありました。 それは思えます-PICを取りますが、ところで-良い試み、怠iness、しかしいいえ-私はそれではなく、私のものが欲しいです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     それだけです-それを取り、集めてください。 その後、詳細とセット全体の価格を尋ね始めましたが、マンチェスターのコードという形でまだ障害がありました-それを受け入れるためにどちらの側に近づくべきかはわかりませんでした。 これが私の物語の次の部分の始まりです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> マンチェスターコード </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Openthermプロトコルでは、マンチェスターコードを使用してデータを物理的に表します。または、Bi-Phase L.仕様で呼ばれています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     実際には、ここにあります： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/4f3/6f0/4b1/4f36f04b19a4462fa55ada6b8bb0e8aa.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     全体のポイントは、ビットが信号レベルではなく、期間中のレベル間の遷移によってエンコードされることです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/462/6b5/bab/4626b5bab7b146a9b89497a5d4c28710.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さらに、この同じ遷移は、期間の真ん中に正確には発生しませんが、どこかで発生します： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/0ab/68b/7aa/0ab68b7aa44a454ab38e355f0b136665.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ご覧のとおり、期間自体は1ms -10％+ 15％であり、移行はその中間にあります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これは私が長い間停止した場所です。 インターネットから何かをコピーしたいという欲求はありませんでした。 各プロジェクトには独自のつまずきがあり、あなたは単にライブラリの考えのないコピー・ペーストリストであるだけでなく、このプロジェクトを行う開発者だと感じていると判断しました。 これは実際、サーモスタットの心臓部です。OTと連携して、それをコピーするということは、デザイナーから別のおもちゃを組み立てることを意味し、独自の何かを作成することを意味しません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここで、割り込みとタイマーなど、MKについての私のわずかな知識をすべて適用したかったのです。 はい、遅延（）ですべてがはるかに簡単になりますが、まず、遅延（）を使用して受信するには送信が遅すぎますが、受信/送信中に他のアクションを並行して実行したいと思いました。すべてがまともで、男子生徒の工芸品ではありませんでした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まさにその変化を捉えることがどれほど美しいか、それが前線か後退かを問わず、それを別の角度から見るとすぐにすべてが明確になりました。 結局、期間の前半のレベルはビットの望ましい値です： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/10c/8e4/0b4/10c8e40b47654ee3928f6de111afbfe0.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最初のステップがあります-期間の前半（開始後250μs）のレベルを取得する-それがすべてデコードです。 しかし、ここでは次の失望が待っていました-期間の始まりをキャッチすることは常に可能というわけではありません：01または10の組み合わせがある場合、期間の間に顕著なものは何も起こりません。 明らかに、レベルは変更されません-さらに調べる必要があります。 そして、ここに2番目の啓示があります-期間の途中で常に遷移があります-それらは0と1にエンコードされます。したがって、それにアタッチすることができ、次のビットの値は期間の半分になります！ ここで、すべてが完全に明らかになりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すでにいくつかのビットを受け入れており、最初の期間のちょうど中間に位置していることを想像してください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/28f/888/27c/28f88827cc5f4f1a9991be470cd74a8f.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     入力信号の変化で割り込みを有効にするだけです。 これが起こるとすぐに、それはまさに私たちが期間の真ん中にいることを意味します。 信号の変更時に割り込みをオフにし、タイマーをリセットし、タイマー割り込みがトリガーされたときに、3/4周期後（OTの場合は750 µs）にタイマー割り込みを発生させ、入力レベルを記録し、タイマー割り込みを無効にします。残りのすべてのビットについて、もう一度繰り返します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最初のケースは特別なケースになります。なぜなら、 彼のレベルが3/4ではなく、1/4の期間になるのを待ちます 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     割り込みハンドラーはすぐにスケッチされ、ファームウェアが組み立てられましたが、オシロスコープと信号発生器なしでどのようにデバッグできますか？ 知識が大学から救い出されました-プロテウスでは、何が起こっているかを段階的に見ることができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私は見つけて、インストールし、ここにすべての練習の魅力がありました-割り込みをオンにする前に割り込みフラグを強制的に削除する必要があり、タイマーモードをFastPWMからCTCに変更する前にOCR2A / Bをロードすると、「このようなクールなスラリーが発生しました」プログラムで、しかしそれが鉄で判明したように、まだもっと楽しいです）。 さて、すぐに決定したその他のささいなこと。 この段階では鉄がなく、サーモスタットに特定の要件を設けていなかったことを思い出させてください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     マンチェスターコードを受信するコードフラグメントを次に示します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs ruby">inline void OpenTherm::receive(){ cli(); first=<span class="hljs-number"><span class="hljs-number">1</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//receiving</span></span> first bit buf=<span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//clear</span></span> buffer rx=<span class="hljs-number"><span class="hljs-number">1</span></span>; data_ready=<span class="hljs-number"><span class="hljs-number">0</span></span>; length=<span class="hljs-number"><span class="hljs-number">0</span></span>; parity=<span class="hljs-number"><span class="hljs-number">0</span></span>; PCICR<span class="hljs-params"><span class="hljs-params">|=bit(rx_pcie); //enabling Pin Change Interrupt </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span><span class="hljs-params"> RX port *rx_pcmsk|</span></span>=rx_bitmask; <span class="hljs-regexp"><span class="hljs-regexp">//enabling</span></span> Pin Change Interrupt <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> RX pin of rx Port TCCR2A=bit(WGM21);<span class="hljs-regexp"><span class="hljs-regexp">//mode</span></span> CTC TCCR2B=<span class="hljs-number"><span class="hljs-number">0</span></span>; OCR2A=TICKS_PER_MS*<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">75</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//interrupt</span></span> at <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">75</span></span>ms TCNT2=TICKS_PER_MS*<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//preload</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span>ms TIMSK2=bit(OCIE2A);<span class="hljs-regexp"><span class="hljs-regexp">//interrupt</span></span> on OC0A TIFR2=bit(OCF2A); sei(); bool OpenTherm::extIntHandler(){ *rx_pcmsk&amp;=~rx_bitmask; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>Disable PCINT <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> RX pin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (first) { first=<span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ TCNT2=<span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (length &gt; MSG_LENGTH){ data_ready=<span class="hljs-number"><span class="hljs-number">1</span></span>; TCCR2B=<span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//disable</span></span> Timer2 TIMSK2=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> TCCR2B=bit(CS22); <span class="hljs-regexp"><span class="hljs-regexp">//start</span></span> timer clk/<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }; void OpenTherm::timer2CompAHandler(){ uint32_t tmp_buf; tmp_buf=buf; tmp_buf=tmp_buf&lt;&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rx) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*rx_port &amp; rx_bitmask) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>Reading RX value tmp_buf=tmp_buf <span class="hljs-params"><span class="hljs-params">| 1; </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span><span class="hljs-params"> (length &gt; 1 ) parity^=1; //Don't calculate parity </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span><span class="hljs-params"> start bit } *rx_pcmsk|</span></span>=rx_bitmask; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>Re-enabling PCINT <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> RX pin TCCR2B=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//stop</span></span> Timer2 } length++; buf=tmp_buf; }; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     転送は、後で、完全に論理的かつ実際的に同じハンドラーに適合します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     タイマー2はすべて同じCTCモードで動作し、ミリ秒ごとにゼロ化されますゼロ化割り込みハンドラー（CTCモードのOC2A）では、次のビットに従って出力を切り替えます。 さらに、OC2B割り込みがアクティブになります。これは、正確に半周期（0.5ミリ秒）トリガーされ、出力状態を反転します。 それが転送のすべての知恵です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここでインターフェイス回路を組み立てて、3時間でその動作の原理を見つけました。これは非常に単純であることが判明し、回路を少し変更して、元のようにデータを反転ではなく直接送信しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="220" width="475" src="https://habrastorage.org/files/124/7c1/de3/1247c1de387b498aa75f126c5417f149.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さらに、信号発生器をHDLに書き込む必要がありました（書き込み方法、インターネットから取得して自分で変更する方法）。 マンチェスターコードで34ビットを手動でダイヤルします。これは4または5ではありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最後に、受信/送信が確立され、必要な機器を決定する時が来ました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> 装備品 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、エミュレータで動作するマンチェスターコードでOTメッセージを送受信するためのボイラー（Ferolli Domiproject C24D）とファームウェアがありました。 次のステップに進みましょう。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず、Arduinoのほぼすべてのデバイスに必要なものは何ですか？  Arduino自体ですか？ 間違った！ エンコーダーであり、常にボタンが付いています 私はいつもこのタイプの入力デバイスに常に惹かれているだけです。ぜひ試してみてください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     次に、サーモスタットは内部と外部の温度を取得する必要があります-これらの目的のために、2つのDS18B20センサーが非常に適しています。1つは熱い接着剤で満たされ、外側に置かれます。 当然、ディスプレイが必要です。ディスプレイがなければ、ラジオコンポーネントをjarに注いで、Silpoパッケージに包んで防ぐことができます-効果は同じです。 標準の文字生成LCD 20 * 4を使用することにしました-これで十分です、LCD用のI2Cポートエクスパンダー。 コントローラー自体は、Arduino Nanoで十分です（今度はプログラマーと一緒にPro Miniを使用しますが、その理由を説明します）。 さて、インターフェイス回路のいくつかの詳細。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     タイトルの写真からわかるように、何かがおかしかった。 売り手はすべてに対して非常に魅力的な価格を持っていたので、リストを少し変更することにしました。  2つのDS18B20の代わりに、1つを防水ケース+ DHT22に入れたので、部屋の湿度を上げることができるようになりました。  LCD 20 * 4は利用できず、Nokia 5110からディスプレイを取りましたが、ボタン付きのエンコーダーがなかったので、通常の+ 2ボタンを取りました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     受領後、すべてがはんだ付けされ、テストケースでテストされました。 まず、LEDを点滅させます（Arduinoボードを最初にオンにしたときにわかりますが、これは神聖です）。 すべてが期待どおりに機能したため、改善を開始できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Atmega 328にハードウェアSPIが存在するにもかかわらず、私はそれを放棄することにしました。 彼によって課された制限は私にはあまり喜ばれませんでした-MISOは自動的に入力用に設定され、SS-出力である必要があります-2つの出力を引いたため、ソフトウェアSPIを残します。 ライブラリからCEディスプレイ出力コントロールを削除し、LCDのGNDに直接接続します。 私は得る-のようなもの： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="500" width="750" src="https://habrastorage.org/files/a5b/861/18d/a5b86118d9054b268b2f24c796f68cc7.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Proteusでインターフェイス回路を配布し、ブレッドボードで同様のことを繰り返します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="750" width="500" src="https://habrastorage.org/files/67a/bf5/d2f/67abf5d2fd4a4bf0a5afbf10824daa7b.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ワイヤーの端には、標準のボイラーターミナルブロックがあります。これは非常に便利であることが判明しました。ツールを使用せずにカバーを外すことなく接続および切断できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     さて、これでプリミティブファームウェアを作成し、ボイラーとの通信を試すことができます。 私は書いて、点滅して、接続しています... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ボイラーは正常に機能し、記事を閉じることができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Trollface.jpg 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     当然、何も機能しません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     インターフェイスカードでテスターを突く-それは動作しません-入力は常に20Vです。 私は分解し、見て、そして笑います。 私は友人に支払いをはんだ付けしました。 私はすぐに対話を思い出しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -じゃあ、もっともっと？ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -いいえ、ほぼ完了しました。 今、この長いトラックをはんだ付けし、それだけです。 主なことは、次にこれら2つの隣接する連絡先を接続することを忘れないことです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     初めて忘れたと思う？ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、「製品」は修正され、接続され、確認されます。 レベルは正常で、コントローラーを接続できます。 接続-沈黙。 すべてが到着しました。 オシロスコープなしでやることはありません。 私は最初の記事の著者として終わります。 しかし、まだ少しの希望があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     受信に関する部分、つまり、期間の途中でタイマーをレベル変更にリセットすることを思い出します。 突然ゼロになるのは十分ではなく、着信信号のタイミングは一般に災害であると思います。つまり、レベルの4分の1のレベルを読み取る瞬間にそれをオフにし、ゼロからオンにすることを意味します。 それはその勝利でした-以前もMKと話をせずに、インターネットで見つけられなかったライブラリをゼロから書き、さらにオシロスコープなしで2度目に動作するようにしました。 私の喜びは際限がありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     幸福感から少し離れて、新しいパラメーターを読み取る必要があるたびにコントローラーをフラッシュする（サイクル内のテストファームウェアが同じパラメーターを1秒に1回読み取る）ことは、おそらくユーザーフレンドリーではないため、続行する必要があることに気付きました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     パラメータ値を取得する方法を学びました。この形式でのみ、サーモスタットではなく、リモートディスプレイです。 これが必要なものになるためには、ボイラーを制御する方法を学ぶ必要があり、ここでも私は驚きを待っていました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  OpenThermのデバッグと操作 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、最初の値-ボイラーのステータス-が受信されます。 すぐに私を混乱させたのは、ボイラーパネルの設定に関係なく、マイクロコントローラーを接続するときの温水温度がすぐに最大許容値になったことでした。メーカー（Ferolli Romeo W）の標準OTサーモスタットのマニュアルを後で読んだとき：接続すると、ハンドルのみが機能します対応する機能を有効/無効にし、他には影響しません。  DHW温度パラメーターの値はOT接続前と同じままであると仮定することは論理的でしたが、Honeywellプログラマー（ボードの製造元とボイラーの自動化の残りの部分）はこの問題について独自の意見を持っています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ボイラーを制御するプロセスは、正しいメッセージのシーケンスを見るために手にサーモスタットを持っていなかったという事実によって複雑になったため、目隠しに似ていました。 仕様では、明らかに、給湯の温度に関与していたDHWセットポイントパラメーターが見つかりました（以下、括弧内に呼び出されたパラメーターのDATA-ID、この場合は56を示します）。 撮影中、点滅中-ボタンをクリックすると、希望の温度が送信されました。 確認してください。 水温はすぐに正常になりました。CHSetpoint（1）-加熱回路の温度-すべてが開始された調整を開始します。 ここで私は3日間、長い間立ち往生しています。 どのように試しても、必要な温度が何であっても、ボイラーはそれを約30度に保ちました。 製造業者は他の人のサーモスタットの接続から自分自身を保護するという考えをすでに持っていました-唯一の明らかな決定は、ボイラーからメンバーIDを取得し（3）同じ答えをすることでした（2）。 そしてこれも助けにはならず、友人に状況を簡単に概説し、彼は仮定を持っていました： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      -あるベンダーがマスター（サーモスタット）デバイスとスレーブ（ボイラー）デバイスに異なるメンバーIDを使用している場合はどうでしょうか。 ボイラーの自動化が別のボイラーによって制御されていることに気付いたときに、ボイラーの自動化がどのように驚くかを数えますか 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     しかし、すべてがはるかに単純であることが判明しました。 パラメータMax CH Setpoint（57）-加熱回路の最高温度にありました。  DHW回線でのイベントの後、最大値があると仮定することは論理的でしたが、いいえ、30度の値がそこに設定されました。 その後、物事は著しく楽しくなりました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これが、サーモスタット自体の物語の始まりです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> サーモスタット </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     明らかに、ボイラーのパラメーターを大量に提供し、それらを変更できる必要があります。これがないと、別のサーモスタットを作成しても意味がありません。 すでに述べたように、各リクエストはおよそ1秒に1回送信する必要があります。最も論理的なのは、サイクルごとに1つの状態から別の状態に移行する有限状態マシンを記述することでした。 最終的に、オートマトンのブランチは次のようになりました3 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1.ボイラーの現在の状態、温度、および変調レベルが調査される作業ブランチ。 つまり、次のように表すことができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/cef/a02/126/cefa021268f2454b9c3ce6b87efcf881.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2.情報およびボイラー分岐：追加の温度センサー、流量センサーなど。  [情報]メニューを終了すると、最初のブランチに戻ります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      3.統計のブランチ：バーナーの稼働時間、ファン/ポンプの始動回数など。 終了時、段落2と同じ。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     パラメーターなしのupdate（）関数の呼び出しは、このすべての作業を担当します。  1秒間に約1回呼び出すだけで十分です。 彼女は前のリクエストの結果を受け取り、それに基づいて新しいリクエストを送信します。 ブランチを切り替えるには、目的のブランチの最初のパラメーターに等しいパラメーターで関数を呼び出す必要があります。 たとえば、更新（0）はメインブランチ（0-ボイラーステータスの要求）、更新（18）-パラメーター18（加熱回路の圧力の要求）で始まる2番目のブランチ、ブランチ3-パラメーター116（バーナーの開始数）に進みます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     他の引数値もあります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1-加熱回路の新しい温度を記録します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      56-DHW回路の新しい温度などを記録します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     可能なすべての引数は、更新関数の最後に表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     それで、すべての必要なパラメータが取得されましたが、軟膏にハエがありました-覚えておいて、私はテーブルの後に書いた-ボイラーメーカーのリクエストで他のすべてのパラメータ？ だから-それらの半分は私のボイラーでゼロであり、半分はまったく知られていない。 少なくとも誰かに役立つかもしれないが、彼は無駄にしか書いていない。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最も日常的で退屈な職業は、明らかにメニューを書くことでした。 約束どおり、サーモスタット自体については詳しく説明しません。すべては最終ファームウェアで見ることができます 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この記事の執筆中に最後に追加したのは、「たくさんの文字」を含む退屈な画面ではなく、グラフィックディスプレイ（モデルに似たもの-ロミオW）のように見えました。 さて、時計-アパートにはそれらの多くはなく、RTC DS323xだけが欠落しています-電源を切ると、時間を再設定する必要があります。 これを行うには、いくつかの文字を手動で描画し、フォントに追加する必要がありました。 結果はヘッダーの下の写真で確認できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="200" width="200" src="https://habrastorage.org/files/12f/ec1/531/12fec153167140e5a1253a20dfccbb8d.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">スケッチ</b> <div class="spoiler_text"><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">OpenTherm</span></span>.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">LCD5110_Basic</span></span>.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">OneWire</span></span>.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;dht.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;dallastemp.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;avr/eeprom.h&gt; //<span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">Power</span></span>.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">DHT22_PIN</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_3</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_INFO_1</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_INFO_2</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_1</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_2</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MODE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_EN</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW_EN</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ROOM</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_BRIGH</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ACTIVE</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MAX_MODULATION</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DAYS</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_HOURS</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MINUTES</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KP</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KI</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> dht internal_s; <span class="hljs-type"><span class="hljs-type">OneWire</span></span> ow(<span class="hljs-type"><span class="hljs-type">A1</span></span>); <span class="hljs-type"><span class="hljs-type">Dallastemp</span></span> external_s(&amp;ow); <span class="hljs-type"><span class="hljs-type">OpenTherm</span></span> ot(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-type"><span class="hljs-type">LCD5110</span></span> lcd(<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); //<span class="hljs-type"><span class="hljs-type">Power</span></span> sleep; extern uint8_t <span class="hljs-type"><span class="hljs-type">SmallFont</span></span>[]; extern uint8_t <span class="hljs-type"><span class="hljs-type">MediumNumbers</span></span>[]; extern uint8_t <span class="hljs-type"><span class="hljs-type">BigNumbers</span></span>[]; //<span class="hljs-type"><span class="hljs-type">Encoder</span></span> handling volatile uint32_t ts_enc=<span class="hljs-number"><span class="hljs-number">0</span></span>; volatile int8_t encoder=<span class="hljs-number"><span class="hljs-number">0</span></span>; //<span class="hljs-type"><span class="hljs-type">Clock</span></span> handling uint32_t clock_ts=<span class="hljs-number"><span class="hljs-number">0</span></span>,clock_delta=<span class="hljs-number"><span class="hljs-number">0</span></span>; uint8_t hour=<span class="hljs-number"><span class="hljs-number">0</span></span>,minute=<span class="hljs-number"><span class="hljs-number">0</span></span>,second=<span class="hljs-number"><span class="hljs-number">0</span></span>,day=<span class="hljs-number"><span class="hljs-number">0</span></span>; //<span class="hljs-type"><span class="hljs-type">Menu</span></span> <span class="hljs-type"><span class="hljs-type">Handling</span></span> uint8_t menu,item; int8_t pos=<span class="hljs-number"><span class="hljs-number">0</span></span>; const char* day_names[<span class="hljs-number"><span class="hljs-number">7</span></span>]={<span class="hljs-comment"><span class="hljs-comment">"Mon"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Tue"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Wed"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Thu"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Fri"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Sat"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Sun"</span></span>}; const char* mode_names[<span class="hljs-number"><span class="hljs-number">2</span></span>]={<span class="hljs-comment"><span class="hljs-comment">"Manual"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Auto"</span></span>}; //<span class="hljs-type"><span class="hljs-type">Misc</span></span> uint8_t display_enabled,cfg_enabled,button1=<span class="hljs-number"><span class="hljs-number">0</span></span>,button2=<span class="hljs-number"><span class="hljs-number">0</span></span>,item_tmp=<span class="hljs-number"><span class="hljs-number">0</span></span>,update_period=<span class="hljs-number"><span class="hljs-number">0</span></span>; float iSum; struct thermostat_config{ uint8_t address[<span class="hljs-number"><span class="hljs-number">8</span></span>]; ot_init_settings ot_settings; float indoor_target_temp; uint8_t active_time; uint8_t brightness; uint8_t mode; uint8_t <span class="hljs-type"><span class="hljs-type">Kp</span></span>; uint8_t <span class="hljs-type"><span class="hljs-type">Ki</span></span>; uint8_t reserved[<span class="hljs-number"><span class="hljs-number">8</span></span>]; }; //thermostat_config settings={{<span class="hljs-number"><span class="hljs-number">0x28</span></span>,<span class="hljs-number"><span class="hljs-number">0xFF</span></span>,<span class="hljs-number"><span class="hljs-number">0x53</span></span>,<span class="hljs-number"><span class="hljs-number">0x76</span></span>,<span class="hljs-number"><span class="hljs-number">0x60</span></span>,<span class="hljs-number"><span class="hljs-number">0x14</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0xFC</span></span>},{<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">70</span></span>,<span class="hljs-number"><span class="hljs-number">30.0</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>},<span class="hljs-number"><span class="hljs-number">22.0</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">130</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>}; thermostat_config settings; /* <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">INT0_vect</span></span>){ ot.extIntHandler(); } */ <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">PCINT0_vect</span></span>){ ot.extIntHandler(); } <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">PCINT1_vect</span></span>){ ot.extIntHandler(); } <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">PCINT2_vect</span></span>){ ot.extIntHandler(); } <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">TIMER2_COMPA_vect</span></span>){ ot.timer2CompAHandler(); } <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">TIMER2_COMPB_vect</span></span>){ ot.timer2CompBHandler(); } <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">WDT_vect</span></span>) { // sleep.watchdogEvent(); } <span class="hljs-type"><span class="hljs-type">ISR</span></span>(<span class="hljs-type"><span class="hljs-type">INT1_vect</span></span>){ display_enabled=settings.active_time; <span class="hljs-type"><span class="hljs-type">OCR1A</span></span>=settings.brightness; if((millis()-ts_enc &gt;<span class="hljs-number"><span class="hljs-number">20</span></span>) &amp;&amp; cfg_enabled) { ts_enc=millis(); if ((<span class="hljs-type"><span class="hljs-type">PIND</span></span>&amp;bit(<span class="hljs-number"><span class="hljs-number">4</span></span>))) { encoder++; } else { encoder--; } } } void fade_display(){ for(uint8_t i=settings.brightness;i&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>;i-=<span class="hljs-number"><span class="hljs-number">10</span></span>){ <span class="hljs-type"><span class="hljs-type">OCR1A</span></span>=i; delay(<span class="hljs-number"><span class="hljs-number">20</span></span>); } <span class="hljs-type"><span class="hljs-type">OCR1A</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; } void enc_setup(){ cli(); <span class="hljs-type"><span class="hljs-type">DDRD</span></span>&amp;=~(bit(<span class="hljs-number"><span class="hljs-number">3</span></span>)|bit(<span class="hljs-number"><span class="hljs-number">4</span></span>)); //set <span class="hljs-type"><span class="hljs-type">A</span></span> and <span class="hljs-type"><span class="hljs-type">B</span></span> to input <span class="hljs-type"><span class="hljs-type">EIMSK</span></span>|=bit(<span class="hljs-type"><span class="hljs-type">INT1</span></span>); <span class="hljs-type"><span class="hljs-type">EICRA</span></span>|=bit(<span class="hljs-type"><span class="hljs-type">ISC11</span></span>); <span class="hljs-type"><span class="hljs-type">EICRA</span></span>&amp;=~bit(<span class="hljs-type"><span class="hljs-type">ISC10</span></span>); <span class="hljs-type"><span class="hljs-type">EIFR</span></span>|=bit(<span class="hljs-type"><span class="hljs-type">INTF1</span></span>); sei(); } void button_setup(){ <span class="hljs-type"><span class="hljs-type">DDRC</span></span>&amp;=~(bit(<span class="hljs-number"><span class="hljs-number">2</span></span>)|bit(<span class="hljs-number"><span class="hljs-number">3</span></span>)); } void read_config(){ eeprom_read_block(&amp;settings, <span class="hljs-number"><span class="hljs-number">0</span></span>, sizeof(thermostat_config)); } void write_config(){ eeprom_write_block(&amp;settings, <span class="hljs-number"><span class="hljs-number">0</span></span>, sizeof(thermostat_config)); } void lcd_idle(){ char mod_lev[<span class="hljs-number"><span class="hljs-number">2</span></span>]={<span class="hljs-string"><span class="hljs-string">'\0'</span></span>,<span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; lcd.setFont(<span class="hljs-type"><span class="hljs-type">BigNumbers</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">":"</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">";"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>);//<span class="hljs-comment"><span class="hljs-comment">";"</span></span> - thermometer icon lcd.print(<span class="hljs-comment"><span class="hljs-comment">"0"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"0"</span></span>,<span class="hljs-number"><span class="hljs-number">34</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"&lt;=&gt;"</span></span>,<span class="hljs-number"><span class="hljs-number">42</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>);//<span class="hljs-comment"><span class="hljs-comment">"&lt;=&gt;"</span></span> - <span class="hljs-type"><span class="hljs-type">House</span></span> icon lcd.printNumI(hour,(hour&gt;<span class="hljs-number"><span class="hljs-number">9</span></span>)?<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumI(minute,(minute&gt;<span class="hljs-number"><span class="hljs-number">9</span></span>)?<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.setFont(<span class="hljs-type"><span class="hljs-type">SmallFont</span></span>); lcd.print(day_names[day],<span class="hljs-number"><span class="hljs-number">62</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumF(internal_s.temperature,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); switch(ot.status&amp;<span class="hljs-number"><span class="hljs-number">0x7</span></span>){ case <span class="hljs-type"><span class="hljs-type">OT_STATUS_CH</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"&gt;"</span></span>,<span class="hljs-number"><span class="hljs-number">78</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_STATUS_DHW</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"="</span></span>,<span class="hljs-number"><span class="hljs-number">78</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_STATUS_FAULT</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"?@"</span></span>,<span class="hljs-number"><span class="hljs-number">72</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); break; }; if (ot.status&amp;<span class="hljs-number"><span class="hljs-number">0x8</span></span>){ if (ot.modulation &lt; <span class="hljs-number"><span class="hljs-number">34</span></span>) *mod_lev=<span class="hljs-string"><span class="hljs-string">'^'</span></span>; else if (ot.modulation &lt; <span class="hljs-number"><span class="hljs-number">67</span></span>) *mod_lev=<span class="hljs-string"><span class="hljs-string">'_'</span></span>; else *mod_lev=<span class="hljs-string"><span class="hljs-string">'`'</span></span>; lcd.print(mod_lev,<span class="hljs-number"><span class="hljs-number">72</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); } lcd.setFont(<span class="hljs-type"><span class="hljs-type">MediumNumbers</span></span>); lcd.printNumF(external_s.getTemp(settings.address),<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumI(internal_s.temperature,<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); } void lcd_main(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Room: /"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumF(internal_s.temperature,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); if (settings.mode) lcd.printNumF(settings.indoor_target_temp,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); else lcd.print(<span class="hljs-comment"><span class="hljs-comment">" "</span></span>,<span class="hljs-number"><span class="hljs-number">54</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Hum: \%"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumF(internal_s.humidity,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Outdoor:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumF(external_s.getTemp(settings.address),<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Heat: /"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumF(ot.<span class="hljs-type"><span class="hljs-type">CH</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumF(settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"DHW: /"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumF(ot.<span class="hljs-type"><span class="hljs-type">DHW</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumF(ot.target_DHW,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">54</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); switch(ot.status&amp;<span class="hljs-number"><span class="hljs-number">0x7</span></span>){ case <span class="hljs-type"><span class="hljs-type">OT_STATUS_CH</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"CH "</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_STATUS_DHW</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"DHW "</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_STATUS_FAULT</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"FAULT:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); switch(ot.fault&amp;<span class="hljs-number"><span class="hljs-number">0x3D</span></span>){ case <span class="hljs-type"><span class="hljs-type">OT_FAULT_SERVICE</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"FAULT:SERV REQ"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_FAULT_LOW_WATER</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"FAULT:NO WATER"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_FAULT_GAS</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"FAULT:NO FLAME"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_FAULT_AIR_PRESSURE</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"FAULT:AIR PRES"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; case <span class="hljs-type"><span class="hljs-type">OT_FAULT_WATER_OV_TEMP</span></span>: lcd.print(<span class="hljs-comment"><span class="hljs-comment">"FAULT:WATER OT"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; } break; default: lcd.print(<span class="hljs-comment"><span class="hljs-comment">" "</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); break; }; if (ot.status&amp;<span class="hljs-number"><span class="hljs-number">0x8</span></span>) { lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Flame: %"</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI(ot.modulation,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); } } void lcd_menu(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" 1)Config"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" 2)Info"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" 3)Stats"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); } void lcd_config_1(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Mode:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(mode_names[(item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_MODE</span></span>)?item_tmp:settings.mode],<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH enabled:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_EN</span></span>)?item_tmp:ot.<span class="hljs-type"><span class="hljs-type">CH_enabled</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW enabled:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW_EN</span></span>)?item_tmp:ot.<span class="hljs-type"><span class="hljs-type">DHW_enabled</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH max t:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_MAX</span></span>)?item_tmp:ot.<span class="hljs-type"><span class="hljs-type">CH_max</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH temp:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH</span></span>)?item_tmp:ot.target_CH,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW temp:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW</span></span>)?item_tmp:ot.target_DHW,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); } void lcd_config_2(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Room temp:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumF((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_ROOM</span></span>)?(float)item_tmp/<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>:settings.indoor_target_temp,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Brightness:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_BRIGH</span></span>)?item_tmp:settings.brightness,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Light time:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_ACTIVE</span></span>)?item_tmp:settings.active_time,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Max modul:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_MAX_MODULATION</span></span>)?item_tmp:settings.ot_settings.max_modulation,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Days:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.print(day_names[(item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_DAYS</span></span>)?item_tmp:day],<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Hours:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_HOURS</span></span>)?item_tmp:hour,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); } void lcd_config_3(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Minutes"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_MINUTES</span></span>)?item_tmp:minute,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Kp"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_KP</span></span>)?item_tmp:settings.<span class="hljs-type"><span class="hljs-type">Kp</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Ki"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumI((item==<span class="hljs-type"><span class="hljs-type">LCD_ITEM_KI</span></span>)?item_tmp:settings.<span class="hljs-type"><span class="hljs-type">Ki</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); } void lcd_info_1(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH press:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumF(ot.<span class="hljs-type"><span class="hljs-type">CH_water_pressure</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW flow:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumF(ot.<span class="hljs-type"><span class="hljs-type">DHW_flow</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Ret.temp:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumF(ot.<span class="hljs-type"><span class="hljs-type">CH_return_temp</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Max cap.:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumI(ot.max_capacity,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Min mod.:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumI(ot.min_modulation,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW min lim:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">DHW_min_lim</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); } void lcd_info_2(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW lim:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">DHW_max_lim</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH lim:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">CH_min_lim</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH lim:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">CH_max_lim</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Int.Sum.:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumF(iSum,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); } void lcd_stats_1(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" Burn.st:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumI(ot.burner_starts,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CH pump:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">CH_pump_starts</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW p/v:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">DHW_pump_starts</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHW bur:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">DHW_burner_starts</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" B.hours:"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumI(ot.burner_op_hours,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" CHpump H"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">CH_pump_op_hours</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); } void lcd_stats_2(){ lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHWp/v H"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">DHW_pump_op_hours</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" DHWburn H"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.printNumI(ot.<span class="hljs-type"><span class="hljs-type">DHW_burner_op_hours</span></span>,<span class="hljs-type"><span class="hljs-type">RIGHT</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); } void update_clock(){ uint32_t tmp=millis()-clock_ts; clock_delta+=(tmp&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>)?tmp:<span class="hljs-number"><span class="hljs-number">0</span></span>; clock_ts=millis(); while (clock_delta &gt;= <span class="hljs-number"><span class="hljs-number">1000</span></span>){ second++; clock_delta-=<span class="hljs-number"><span class="hljs-number">1000</span></span>; if (second &gt; <span class="hljs-number"><span class="hljs-number">59</span></span>){ second=<span class="hljs-number"><span class="hljs-number">0</span></span>; minute++; if (minute &gt; <span class="hljs-number"><span class="hljs-number">59</span></span>){ minute=<span class="hljs-number"><span class="hljs-number">0</span></span>; hour++; if (hour &gt; <span class="hljs-number"><span class="hljs-number">23</span></span>){ hour=<span class="hljs-number"><span class="hljs-number">0</span></span>; day++; if (day&gt;<span class="hljs-number"><span class="hljs-number">6</span></span>) day=<span class="hljs-number"><span class="hljs-number">0</span></span>; } } } } } void update_display(){ lcd.clrScr(); lcd.setFont(<span class="hljs-type"><span class="hljs-type">SmallFont</span></span>); if (menu != <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span> &amp;&amp; menu != <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span>) { if (pos&gt;<span class="hljs-number"><span class="hljs-number">5</span></span>){ pos=<span class="hljs-number"><span class="hljs-number">0</span></span>; switch(menu){ case <span class="hljs-type"><span class="hljs-type">LCD_INFO_1</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_INFO_2</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_1</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_2</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_CONFIG_3</span></span>; break; default: pos=<span class="hljs-number"><span class="hljs-number">5</span></span>; } } if (pos&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>){ pos=<span class="hljs-number"><span class="hljs-number">5</span></span>; switch(menu){ case <span class="hljs-type"><span class="hljs-type">LCD_INFO_2</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_INFO_1</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_2</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_1</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_3</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>; break; default: pos=<span class="hljs-number"><span class="hljs-number">0</span></span>; } } }; switch(menu){ case <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span>: lcd_idle(); break; case <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>: lcd_main(); break; case <span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span>: lcd_menu(); break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span>: lcd_config_1(); break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>: lcd_config_2(); break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_3</span></span>: lcd_config_3(); break; case <span class="hljs-type"><span class="hljs-type">LCD_INFO_1</span></span>: lcd_info_1(); break; case <span class="hljs-type"><span class="hljs-type">LCD_INFO_2</span></span>: lcd_info_2(); break; case <span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_1</span></span>: lcd_stats_1(); break; case <span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_2</span></span>: lcd_stats_2(); break; }; if (menu != <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span> &amp;&amp; menu != <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>) if(! item) lcd.print(<span class="hljs-comment"><span class="hljs-comment">"\\"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,pos*<span class="hljs-number"><span class="hljs-number">8</span></span>); else lcd.print(<span class="hljs-comment"><span class="hljs-comment">"*"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,pos*<span class="hljs-number"><span class="hljs-number">8</span></span>); } void setup(){ lcd.<span class="hljs-type"><span class="hljs-type">InitLCD</span></span>(); lcd.setFont(<span class="hljs-type"><span class="hljs-type">SmallFont</span></span>); lcd.clrScr(); enc_setup(); button_setup(); read_config(); //sleep.measure_wdt(<span class="hljs-number"><span class="hljs-number">1</span></span>); // external_s.setRes(settings.address,<span class="hljs-type"><span class="hljs-type">TEMP_11_BIT</span></span>); // external_s.startConv(settings.address); analogWrite(<span class="hljs-number"><span class="hljs-number">9</span></span>,settings.brightness); display_enabled=settings.active_time; lcd.print(<span class="hljs-comment"><span class="hljs-comment">"OT init."</span></span>,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); ot.begin(&amp;settings.ot_settings); //sleep.measure_wdt(<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.clrScr(); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Slave OT ver.:"</span></span>,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.printNumF(ot.slave_ver,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Slave Memb. ID:"</span></span>,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>); lcd.printNumI(ot.member_id,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">"Slave CFG:"</span></span>,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>); lcd.printNumI(ot.sl_cfg,<span class="hljs-type"><span class="hljs-type">CENTER</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); } void loop(){ //<span class="hljs-type"><span class="hljs-type">DEBUG</span></span> //uint8_t type=<span class="hljs-number"><span class="hljs-number">0</span></span>,id=<span class="hljs-number"><span class="hljs-number">0</span></span>; //uint16_t data=<span class="hljs-number"><span class="hljs-number">0</span></span>; float ext_temp,int_temp,t_error; if (!update_period) { internal_s.read22(<span class="hljs-type"><span class="hljs-type">DHT22_PIN</span></span>); external_s.startConv(settings.address); } if(display_enabled){ <span class="hljs-type"><span class="hljs-type">OCR1A</span></span>=settings.brightness; if(! --display_enabled) { fade_display(); cfg_enabled=<span class="hljs-number"><span class="hljs-number">0</span></span>; menu=<span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span>; item=<span class="hljs-number"><span class="hljs-number">0</span></span>; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">0</span></span>); //main thread update_display(); } } if (cfg_enabled) delay (<span class="hljs-number"><span class="hljs-number">100</span></span>); else delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); //sleep <span class="hljs-number"><span class="hljs-number">1</span></span>s here // else sleep.sleep(); if (cfg_enabled || !update_period) { update_display(); } if ( (<span class="hljs-type"><span class="hljs-type">PINC</span></span>&amp;bit(<span class="hljs-number"><span class="hljs-number">2</span></span>)) &amp;&amp; button1) button1=<span class="hljs-number"><span class="hljs-number">0</span></span>; //if button released reset state if ( (<span class="hljs-type"><span class="hljs-type">PINC</span></span>&amp;bit(<span class="hljs-number"><span class="hljs-number">3</span></span>)) &amp;&amp; button2) button2=<span class="hljs-number"><span class="hljs-number">0</span></span>; //<span class="hljs-type"><span class="hljs-type">Esc</span></span> if (! (<span class="hljs-type"><span class="hljs-type">PINC</span></span>&amp;bit(<span class="hljs-number"><span class="hljs-number">2</span></span>)) &amp;&amp; ! button1) { button1=<span class="hljs-number"><span class="hljs-number">1</span></span>; display_enabled=settings.active_time; <span class="hljs-type"><span class="hljs-type">OCR1A</span></span>=settings.brightness; cfg_enabled=<span class="hljs-number"><span class="hljs-number">1</span></span>; switch(menu){ case <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>: if ((ot.status&amp;<span class="hljs-number"><span class="hljs-number">0x7</span></span>) == <span class="hljs-type"><span class="hljs-type">OT_STATUS_FAULT</span></span>) { delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.communicate(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">256</span></span>); } break; case <span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span>: case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>: case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_3</span></span>: if(! item) menu=<span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span>; else item=<span class="hljs-number"><span class="hljs-number">0</span></span>; break; default: menu=<span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span>; break; }; pos=<span class="hljs-number"><span class="hljs-number">0</span></span>; } //<span class="hljs-type"><span class="hljs-type">Enter</span></span> if (! (<span class="hljs-type"><span class="hljs-type">PINC</span></span>&amp;bit(<span class="hljs-number"><span class="hljs-number">3</span></span>)) &amp;&amp; ! button2) { button2=<span class="hljs-number"><span class="hljs-number">1</span></span>; display_enabled=settings.active_time; <span class="hljs-type"><span class="hljs-type">OCR1A</span></span>=settings.brightness; cfg_enabled=<span class="hljs-number"><span class="hljs-number">1</span></span>; if (! item){ //standart menu navigation switch(menu){ case <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span>: case <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_MENU</span></span>: switch(pos){ case <span class="hljs-number"><span class="hljs-number">0</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span>; break; case <span class="hljs-number"><span class="hljs-number">1</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_INFO_1</span></span>; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">18</span></span>); //start to get info break; case <span class="hljs-number"><span class="hljs-number">2</span></span>: menu=<span class="hljs-type"><span class="hljs-type">LCD_STATISTICS_1</span></span>; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">116</span></span>); //start to get stats break; } break; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_1</span></span>: if (!item) item=pos+<span class="hljs-number"><span class="hljs-number">1</span></span>; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_2</span></span>: if (!item) item=pos+<span class="hljs-number"><span class="hljs-number">7</span></span>; case <span class="hljs-type"><span class="hljs-type">LCD_CONFIG_3</span></span>: if (!item) item=pos+<span class="hljs-number"><span class="hljs-number">13</span></span>; switch(item){ case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MODE</span></span>: item_tmp=settings.mode; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_EN</span></span>: item_tmp=ot.<span class="hljs-type"><span class="hljs-type">CH_enabled</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW_EN</span></span>: item_tmp=ot.<span class="hljs-type"><span class="hljs-type">DHW_enabled</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_MAX</span></span>: item_tmp=ot.<span class="hljs-type"><span class="hljs-type">CH_max</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH</span></span>: item_tmp=settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW</span></span>: item_tmp=ot.target_DHW; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ROOM</span></span>: item_tmp=(uint8_t)(settings.indoor_target_temp*<span class="hljs-number"><span class="hljs-number">10</span></span> - <span class="hljs-number"><span class="hljs-number">100</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_BRIGH</span></span>: item_tmp=settings.brightness; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ACTIVE</span></span>: item_tmp=settings.active_time; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MAX_MODULATION</span></span>: item_tmp=settings.ot_settings.max_modulation; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DAYS</span></span>: item_tmp=day; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_HOURS</span></span>: item_tmp=hour; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MINUTES</span></span>: item_tmp=minute; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KP</span></span>: item_tmp=settings.<span class="hljs-type"><span class="hljs-type">Kp</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KI</span></span>: item_tmp=settings.<span class="hljs-type"><span class="hljs-type">Ki</span></span>; break; } break; case <span class="hljs-type"><span class="hljs-type">LCD_INFO_1</span></span>: break; case <span class="hljs-type"><span class="hljs-type">LCD_INFO_2</span></span>: break; }; if (!item) pos=<span class="hljs-number"><span class="hljs-number">0</span></span>; } else { //item save switch(item){ case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MODE</span></span>: settings.mode=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_EN</span></span>: ot.<span class="hljs-type"><span class="hljs-type">CH_enabled</span></span>=item_tmp; settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_enabled</span></span>=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW_EN</span></span>: ot.<span class="hljs-type"><span class="hljs-type">DHW_enabled</span></span>=item_tmp; settings.ot_settings.<span class="hljs-type"><span class="hljs-type">DHW_enabled</span></span>=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_MAX</span></span>: ot.<span class="hljs-type"><span class="hljs-type">CH_max</span></span>=item_tmp; settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_max_temp</span></span>=item_tmp; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">57</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH</span></span>: settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>=item_tmp; ot.target_CH=item_tmp; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">1</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW</span></span>: ot.target_DHW=item_tmp; settings.ot_settings.<span class="hljs-type"><span class="hljs-type">DHW_temp</span></span>=item_tmp; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">56</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ROOM</span></span>: settings.indoor_target_temp=(float)item_tmp/<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">10.0</span></span>; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_BRIGH</span></span>: settings.brightness=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ACTIVE</span></span>: settings.active_time=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MAX_MODULATION</span></span>: ot.max_modulation=item_tmp; settings.ot_settings.max_modulation=item_tmp; delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">14</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DAYS</span></span>: day=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_HOURS</span></span>: hour=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MINUTES</span></span>: minute=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KP</span></span>: settings.<span class="hljs-type"><span class="hljs-type">Kp</span></span>=item_tmp; break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KI</span></span>: settings.<span class="hljs-type"><span class="hljs-type">Ki</span></span>=item_tmp; break; } write_config(); item_tmp=<span class="hljs-number"><span class="hljs-number">0</span></span>; item=<span class="hljs-number"><span class="hljs-number">0</span></span>; } } /* ot.complete(&amp;type,&amp;id,&amp;data); lcd.setFont(<span class="hljs-type"><span class="hljs-type">SmallFont</span></span>); lcd.print(<span class="hljs-comment"><span class="hljs-comment">" / /"</span></span>,<span class="hljs-type"><span class="hljs-type">LEFT</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI(type,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI(id,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); lcd.printNumI(data,<span class="hljs-number"><span class="hljs-number">36</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>); //debug */ if (encoder !=<span class="hljs-number"><span class="hljs-number">0</span></span> ) { if (menu != <span class="hljs-type"><span class="hljs-type">LCD_MAIN</span></span>) if(!item) pos=constrain(pos+encoder,<span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>); else switch (item){ case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MODE</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_EN</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW_EN</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH_MAX</span></span>: item_tmp=constrain(item_tmp+encoder,ot.<span class="hljs-type"><span class="hljs-type">CH_min_lim</span></span>,ot.<span class="hljs-type"><span class="hljs-type">CH_max_lim</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_CH</span></span>: item_tmp=constrain(item_tmp+encoder,ot.<span class="hljs-type"><span class="hljs-type">CH_min_lim</span></span>,ot.<span class="hljs-type"><span class="hljs-type">CH_max_lim</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DHW</span></span>: item_tmp=constrain(item_tmp+encoder,ot.<span class="hljs-type"><span class="hljs-type">DHW_min_lim</span></span>,ot.<span class="hljs-type"><span class="hljs-type">DHW_max_lim</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ROOM</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">180</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_BRIGH</span></span>: item_tmp=constrain(item_tmp+encoder*<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_ACTIVE</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MAX_MODULATION</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_DAYS</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_HOURS</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">23</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_MINUTES</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">59</span></span>); break; case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KP</span></span>: case <span class="hljs-type"><span class="hljs-type">LCD_ITEM_KI</span></span>: item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>); break; item_tmp=constrain(item_tmp+encoder,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>); break; } else if (settings.mode) settings.indoor_target_temp=constrain(settings.indoor_target_temp+encoder*<span class="hljs-number"><span class="hljs-number">0.1</span></span>,<span class="hljs-number"><span class="hljs-number">15.0</span></span>,<span class="hljs-number"><span class="hljs-number">28.0</span></span>); else settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>+=encoder*<span class="hljs-number"><span class="hljs-number">0.1</span></span>; encoder=<span class="hljs-number"><span class="hljs-number">0</span></span>; }; if (menu == <span class="hljs-type"><span class="hljs-type">LCD_IDLE</span></span> &amp;&amp; ! cfg_enabled &amp;&amp; !update_period--) { update_period=<span class="hljs-number"><span class="hljs-number">60</span></span>; update_clock(); int_temp=internal_s.temperature; ext_temp=external_s.getTemp(settings.address); t_error=settings.indoor_target_temp-int_temp; iSum=constrain(iSum+t_error,-ot.<span class="hljs-type"><span class="hljs-type">CH_max_lim</span></span>,ot.<span class="hljs-type"><span class="hljs-type">CH_max_lim</span></span>); if (settings.mode) settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>*(<span class="hljs-number"><span class="hljs-number">20.0</span></span> + (settings.indoor_target_temp-ext_temp)) + settings.<span class="hljs-type"><span class="hljs-type">Kp</span></span>*t_error + settings.<span class="hljs-type"><span class="hljs-type">Ki</span></span>*iSum/<span class="hljs-number"><span class="hljs-number">256</span></span>; if (settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span> &lt; ot.<span class="hljs-type"><span class="hljs-type">CH_min_lim</span></span>) ot.<span class="hljs-type"><span class="hljs-type">CH_enabled</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; else ot.<span class="hljs-type"><span class="hljs-type">CH_enabled</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>; settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>=constrain(settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>,ot.<span class="hljs-type"><span class="hljs-type">CH_min_lim</span></span>,ot.<span class="hljs-type"><span class="hljs-type">CH_max_lim</span></span>); if ((!settings.mode &amp;&amp; ot.target_CH != settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span> ) || (settings.mode &amp;&amp; abs(ot.target_CH - settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0.5</span></span>)){ ot.target_CH=settings.ot_settings.<span class="hljs-type"><span class="hljs-type">CH_temp</span></span>; // delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); ot.update(<span class="hljs-number"><span class="hljs-number">1</span></span>); return; } } ot.update(); }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長い間、私は、PIレギュレーターになることが判明するまで、冷却剤の必要な温度を計算する式を変えていました。設定では、係数の変更と積分成分の表示を追加しました。 PIコントローラー自体の前に、必要な温度を計算するために、最初の記事から式を取りましたが、積分成分がないと、温度は必要なものに対応しなかったか、大きな比例係数で必要なものに対応せず、前後にジャンプしました。しかし、Habrを読むと、実装されたPIDコントローラーの説明へのリンクがすぐにわかりました。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般に、2つの動作モードを作成しました</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。1）CHセットポイントの直接制御-結果はボイラーのリモートフロントパネルにすぎません（さらに、外部/内部の温度と湿度も表示されます）。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2）実際にOTCを備えたサーモスタット。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おそらく、OTCセンサーをオフにして曲線の傾きを調整することも追加します（係数（（settings.indoor_target_temp-ext_temp）で））が、この点はまだわかりません。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OTCセンサーの配置について少し説明します。</font><font style="vertical-align: inherit;">私は窓や壁に穴を開けたくありませんでしたが、この問題を考えると、誤ってMIDIコネクターの古いループに目を向けました。</font><font style="vertical-align: inherit;">考え直さずに、センサーワイヤーをはんだ付けし、ホットメルト接着剤で接続を密封しました（路上にあるため）。</font><font style="vertical-align: inherit;">直射日光によって加熱されないように、センサー自体をエアコンの外部ユニットの後ろの日陰に設置しました。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OTCインストール</font></font></b> <div class="spoiler_text"><img height="700" width="500" src="https://habrastorage.org/files/70c/738/0d1/70c7380d19dd47e8a3d8d8bcc3c76eeb.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="700" width="500" src="https://habrastorage.org/files/fe0/4dd/345/fe04dd345a424590822d143b5f9d3327.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="500" width="700" src="https://habrastorage.org/files/ffc/e31/7b6/ffce317b627b4da893b3f17c089cb4d1.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 省エネ </font></font></h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードをもう少し注意深く見ていた人は、おそらく未知のPowerライブラリに気づいたでしょう。実際、デバイス全体のエネルギー消費を削減することを期待していました。ポイントは、メインループの遅延（1000）ではなく、MKを1秒間スリープ状態にすることです。問題は、Timer2を実行してOpenThermメッセージを送受信するための特定のスリープモードが必要なことです。覚えているように、それらは非同期に発生します。しかし、残念ながら、ProteusはSleepではうまく機能せず、この部分をデバッグできませんでした。スリープは機能しており、ミリ秒（）の読み取り値は修正されています（このため、ウォッチドッグタイマーの精度の測定を実装しました）が、OTは機能しなくなります。この目的のために、Pro Miniを購入しました（その後、スタビライザーとLEDを取り外しました）-より小さなボード+ 3.3Vの動作が可能です。これにより、OTインターフェースから直接電源を供給できます。 Powerライブラリコードを持ち込み、興味がある人のために：</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title">Power.h</b> <div class="spoiler_text"><pre> <code class="hljs kotlin">#include &lt;avr/wdt.h&gt; #include &lt;avr/sleep.h&gt; #include &lt;Arduino.h&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Power</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: uint16_t wdt_delay; <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> uint32_t ts,delta; <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> uint8_t wdt_count; uint8_t calibration; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: void watchdogEvent(); void prepare_wdt(); void measure_wdt(uint8_t); void sleep(); };</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title">Power.cpp</b> <div class="spoiler_text"><pre> <code class="hljs rust">#include <span class="hljs-string"><span class="hljs-string">"Power.h"</span></span> void Power::watchdogEvent(){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (calibration) { delta+=millis()-ts; ts=millis(); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> wdt_disable(); wdt_count++; } void Power::prepare_wdt(){ wdt_reset(); WDTCSR|=<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;WDCE|<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;WDE; WDTCSR=<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;WDIE|<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;WDP2|<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;WDP1; } void Power::measure_wdt(uint8_t start){ cli(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (start){ prepare_wdt(); ts=millis(); calibration=<span class="hljs-number"><span class="hljs-number">1</span></span>; }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ calibration=<span class="hljs-number"><span class="hljs-number">0</span></span>; wdt_delay=delta/wdt_count; } sei(); } void Power::sleep(){ <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> volatile unsigned long timer0_millis; prepare_wdt(); set_sleep_mode (SLEEP_MODE_PWR_DOWN); sleep_enable(); wdt_count=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> sleep_cpu(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!wdt_count); timer0_millis+=wdt_delay; sleep_disable(); }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
        ,        –    ,   ,       : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/1bf/dfa/e62/1bfdfae62f964f738cad226be7fcaf03.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
        –        .       ,      : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="240" width="480" src="https://habrastorage.org/files/423/b9a/efd/423b9aefdb3f4e4d88278622bee4b30c.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
          –      ,        .   ,   3D-,      ,       ,           .   ,   : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     —   ,          ? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     — ? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     — , , ,   – . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
                  : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">写真</b> <div class="spoiler_text"><img height="500" width="750" src="https://habrastorage.org/files/c1e/840/774/c1e84077451548e8a98564ba09591432.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="230" width="250" src="https://habrastorage.org/files/aac/fa8/9a6/aacfa89a68cf4867bc7cae723dec3c7b.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img height="200" width="250" src="https://habrastorage.org/files/119/e8b/5ab/119e8b5ab86d4137b8e2e67e9648da2e.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><pre> <code class="hljs ruby"><span class="hljs-number"><span class="hljs-number">6</span></span><span class="hljs-symbol"><span class="hljs-symbol">x8:</span></span> <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0x66</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x7e</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x1e</span></span>, <span class="hljs-number"><span class="hljs-number">0xba</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ( ) <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ( ) <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x8c</span></span>, <span class="hljs-number"><span class="hljs-number">0x82</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    ( ) <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x82</span></span>, <span class="hljs-number"><span class="hljs-number">0x8c</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0xf0</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x6d</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0xdb</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-symbol"><span class="hljs-symbol">x14:</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0xfa</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x3a</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xf0</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xAA</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x3b</span></span>, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ,    ,   ,       update(),            ,   communicate() —    complete() —   
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4> 参照資料 </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="https://github.com/gavrilov-i/OpenTherm">github.com/gavrilov-i/OpenTherm</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://habrahabr.ru/post/214257/">habrahabr.ru/post/214257</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://otgw.tclcode.com/">otgw.tclcode.com</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://www.domoticaforum.eu/uploaded/Ard%2520M/Opentherm%2520Protocol%2520v2-2.pdf">www.domoticaforum.eu/uploaded/Ard%20M/Opentherm%20Protocol%20v2-2.pdf</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     PS  , ,     –    —  ,  .       , ..   ,   OpenTherm,     . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     PPS          ,     . ,   — +5, TX (   ), RX (   ) —  1,5, GND. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
        : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>      —   ,  .  RX  (  .     )  TX ( R3)  +5.        20.    R3   —    7 ( 5).  ,      .        . </blockquote></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J2515/index.html">州下院が著作権侵害の責任を強化</a></li>
<li><a href="../J251501/index.html">ユーザーがアドレスバーにgoogle.comと入力するとどうなりますか？ パート2</a></li>
<li><a href="../J251507/index.html">Apache Spark：内部には何がありますか？</a></li>
<li><a href="../J251529/index.html">子供向けVagrant、またはWindowsでWebアプリケーションを開発するためのカスタマイズされたサーバーを簡単に入手する方法</a></li>
<li><a href="../J251531/index.html">Pythonコードのフォーマット</a></li>
<li><a href="../J25154/index.html">ハブラボール</a></li>
<li><a href="../J251543/index.html">Unity3DゲームへのMVPの追加</a></li>
<li><a href="../J251547/index.html">セキュアなシスコ</a></li>
<li><a href="../J251549/index.html">ドメイン名の絵文字</a></li>
<li><a href="../J25155/index.html">ジレンマ。 （perlとphpの共有）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>