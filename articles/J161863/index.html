<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♊️ 💃🏼 👩🏾‍🎓 STM32 + Linux 👨‍🎨 🤾🏼 🏂🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="長い探索の後に鉄片の制御システムを開発するために、STM32 ARMマイクロコントローラー-STM32F103（「ムカデ」バージョン）を選択しました。 また、開発およびデバッグ用のブレッドボードとして-STM32P103（ただし、脚は少ないですが、コアは同じです）。 私はZhZhshkaで少しずつ「...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>STM32 + Linux</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"> 長い探索の後に鉄片の制御システムを開発するために、STM32 ARMマイクロコントローラー-STM32F103（「ムカデ」バージョン）を選択しました。 また、開発およびデバッグ用のブレッドボードとして-STM32P103（ただし、脚は少ないですが、コアは同じです）。 私はZhZhshkaで少しずつ「成功物語」をレイアウトしましたが、すべてをまとめて、Linuxでマイクロコントローラーをプログラミングすることの気持ちについて話しました。 プロジェクト自体は<a href="https://sourceforge.net/projects/ircontroller/">sourceforgeにあり</a>ます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず、一般について触れてから、詳細に進みます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、ブレッドボードモデル（または完成したデバイス-準備ができたら）に加えて、JTAGアダプターが必要になります。 私の場合、これはST-LINK / V2です。 もちろん、Ironでは十分ではありません。コードを何らかの方法でコンパイルし、コントローラーにアップロードする必要があります。 このために、ARM用gccコンパイラー（arm-none-eabi）およびST-LINKを操作するためのユーティリティー（stlinkと呼ばれる）がインストールされました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     サンプルとして、 <a href="https://github.com/h0rr0rrdrag0n/stm32vldiscovery-linux-template">このプロジェクト</a>を取り上げ<a href="https://github.com/h0rr0rrdrag0n/stm32vldiscovery-linux-template">ました</a> 。  <a href="https://www.olimex.com/Products/ARM/ST/STM32-P103/">ここから</a>簡単なデモプロジェクトをダウンロードし、最も簡単なものをコンパイルしようとしました。 そして、最初はMKの標準Helloworldでした：LEDの点滅。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私は最初から出会ったレーキをすぐに言わなければなりません：objcopyを忘れてしまいました。 プロジェクトをコンパイルしたら、必ずこのユーティリティを使用してバイナリを作成する必要があります。 そして、Makefilesから理解できない（そして一見不必要に思える）目標を捨てないでください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     便利なIDEとして、Geanyを使用します。 私は仕事で2台のモニターを持っているので、とても便利です。1台のモニターではコードでGeanyを開いており、もう1台ではmakeとcom（tinyserialからのターミナル）を実行するターミナルです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Makefile全体を検討するのではなく、Makefileで何を変更すべきかにのみ注意を払います。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre><code class="hljs swift"><span class="hljs-type"><span class="hljs-type">BIN</span></span>=testproject … <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/misc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_adc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_bkp.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_can.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_cec.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_crc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_dac.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_dbgmcu.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_dma.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_exti.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_flash.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_fsmc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_gpio.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_i2c.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_it.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_iwdg.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_pwr.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_rcc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_rtc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_sdio.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_spi.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_tim.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_usart.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> #~ <span class="hljs-type"><span class="hljs-type">STM32_LIBSRC</span></span>+=stm32_lib/stm32f10x_wwdg.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> … <span class="hljs-type"><span class="hljs-type">SRC</span></span>=hw_config.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> main.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> leds.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> interrupts.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> usb_desc.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> usb_istr.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> \ usb_prop.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> usb_pwr.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> onewire.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> … #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_bkp.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_can.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_cec.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_crc.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_dac.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_dbgmcu.o <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_dma.o <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_exti.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_flash.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_fsmc.o <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_gpio.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_i2c.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_it.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_iwdg.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_pwr.o <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_rcc.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_rtc.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_sdio.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_spi.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_tim.o <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_usart.o #~ <span class="hljs-type"><span class="hljs-type">OBJ</span></span>+=stm32f10x_wwdg.o</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  BIN-コンパイル後の結果のバイナリの名前 </li><li>  STM32_LIBSRCおよびOBJにはSTDPeriphLibライブラリプラグインが含まれています。未使用のものはコメント化する必要があります </li><li>  SRCにはユーザーソースのリストが含まれています </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     コードを作成したら、makeを実行します。 すべてが正常な場合、$（BIN）.binファイルが現在のディレクトリに表示されます。このファイルをUSBフラッシュドライブに書き込む必要があります。 記録はmake loadを使用して行われます。このビルドターゲットは、st-flashを呼び出してマイクロコントローラーをフラッシュするだけです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  USB </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そのため、まず、コンピューターとPCの間に接続を確立する必要があります。  RS-232が現代のコンピューターにないことを考慮して、USBを介したデバッグ通信を手配します。 ただし、「戦闘状態」では、MKshkaは別のコントローラーからRS-232コマンドを受信するため、USB &lt;-&gt; RS-232アダプターエミュレーターを整理する方向をすぐに確認することにしました。 このアプローチは、USB経由でデバイスとやり取りするために余分なコードを気にする必要がないため便利です（ただし、これは基本的ですが、面倒です！）。 はい、デバッグは簡単です。任意のシリアル端末エミュレータを使用してシリアルポートとしてデバイス/ dev / ttyACM0を開き、「通信」します。 はい、最初はターミナルエミュレータとして（これまでのところコンピューター側にソフトウェアはありません）私はtinyserialを使用しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="">ここから</a> 、エミュレータアダプタUSB &lt;-&gt; RS-232のコードをダウンロードしました。  2番目の側（RS-232）の操作性をすぐに確認できなかったため（接続する場所がありません）、未使用のUSARTコードは一時的にコメント化されました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      USBを使用するには、STMicroelectronicsのライブラリが使用されます。 ライブラリ自体のコードを詳しく調べなければ、すべてが非常に簡単です。ハードウェア（usb_desc。[Ch]ファイル）の記述子を再定義して、コンピューターがUSB &lt;-&gt; RS-232アダプターとして認識し、割り込みハンドラーを変更する必要がありますUSBイベント（少なくとも-受信したデータを処理し、アダプタとして透過的に動作するために、そこから受信したデータをUSB経由で転送するためにUSART割り込み処理を追加する必要があります）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     メッセージを送信するには、リングバッファのようなものを使用します。これは徐々にいっぱいになり、必要に応じてUSB経由で送信されます。  「通常のバッファ」のデータを読み取ります。 今のところ、短いコマンドのみを使用しているため、長いパッケージの処理は気にしませんでした。 その場合、USBからデータを受信するための割り込みハンドラーを少し複雑にする必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     一部のコマンド（たとえば、1-wireセンサーからの温度の読み取り）には非常に長い時間がかかるため、USBコマンドのハンドラーはそのような操作のフラグのみを変更し、main（）のメインループがこれらのフラグを処理します。 すばやく実行される操作（LEDを使用）は、この関数から直接呼び出されます。 デバッグの目的で、コマンドに「エコー」を追加し、簡単に解読します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">usb_handle_command</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cnt)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> command, *answer; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cnt; i++){ command = USB_Rx_Buffer[i]; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(command){ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_LED_ON: LED_On(); answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"On"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_LED_OFF: LED_Off(); answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Off"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_LED_BLINK: LED_OnBlink(); answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Blk"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_LED_DUTY_PLUS: LED_DutyPlus(); answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Shn"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_LED_DUTY_MINUS: LED_DutyMinus(); answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Fad"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_1W_GET_TEMP: FLAGS |= FLAG_READ_T; answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Read T"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_1W_GET_DEV: FLAGS |= FLAG_GETDEV; answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"find devices"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_1W_PRNT_DEV: FLAGS |= FLAG_PRINTDEV; answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Print devices"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_HALL_GET: FLAGS |= FLAG_PRINTHALL; answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Print Hall"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_ADC_GET: FLAGS |= FLAG_PRINTADC; answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Print ADC val"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: answer = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)<span class="hljs-string"><span class="hljs-string">"Unk"</span></span>; } newline(); prnt(answer); newline(); } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これで、ブレッドボードモデルをUSB経由でコンピューターに接続すると（実際、USB経由で給電されるため、常に私に接続されます）、device / dev / ttyACM0が表示され、通常のシリアルポートのように作業できます。 たとえば、シリアルターミナルを使用して開きます（上で言ったように、最初はtinyserialを使用します）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  LEDボタン </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     おそらく、新しい鉄片の研究の始めに「ダイオードで点滅」するのが伝統的なので、私は同じことをします。 同時に、「ユーザーボタン」で割り込みを切ると、LEDの動作モードが変更されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     点滅するだけでは面白くありません。明るさを変えるのは面白いです。 このためには、単純な「ソフト」PWMで十分です。  SysTickタイマーを10μsの期間設定します。  2つのカウンターを開始します。1つはLEDがオンになっているティック数用で、もう1つはLEDがオフになっているティック数用です。  LEDの輝度を変更するために、PWMデューティサイクルを変更する簡単な8レベルのスキームを作成しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これは何が起こったのです： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> LED_GetState(){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> led_state; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_Duty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> duty)</span></span></span></span>{ duty_cycle = duty; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_state == LEDSTATE_BLINK) LED_OnBlink(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_DutyPlus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(duty_cycle &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) duty_cycle++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_state == LEDSTATE_BLINK) LED_OnBlink(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_DutyMinus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(duty_cycle &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) duty_cycle--; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_state == LEDSTATE_BLINK) LED_OnBlink(); } <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> LED_GetBlinkState(<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> *blink_on, <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> *blink_off){ *blink_on = led_blink_on; *blink_off = led_blink_off; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> led_state; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_On</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ led_state = LEDSTATE_ON; led_blink_on = <span class="hljs-number"><span class="hljs-number">0</span></span>; led_blink_off = <span class="hljs-number"><span class="hljs-number">0</span></span>; GPIO_ResetBits(GPIOC, GPIO_Pin_12); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_Off</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ led_state = LEDSTATE_OFF; GPIO_SetBits(GPIOC, GPIO_Pin_12); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_OnBlink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ led_blink_off = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; duty_cycle; led_blink_on = <span class="hljs-number"><span class="hljs-number">0xff</span></span> - led_blink_off; led_ticks_on = <span class="hljs-number"><span class="hljs-number">0</span></span>; led_ticks_off = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_blink_off == <span class="hljs-number"><span class="hljs-number">0</span></span>){ LED_On(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_blink_on == <span class="hljs-number"><span class="hljs-number">0</span></span>) { LED_Off(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } led_state = LEDSTATE_BLINK; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LED_SysTick_Handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_state != LEDSTATE_BLINK) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_ticks_on == <span class="hljs-number"><span class="hljs-number">0</span></span>) GPIO_SetBits(GPIOC, GPIO_Pin_12); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_ticks_on &lt;= led_blink_on) { led_ticks_on++; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (led_ticks_off == <span class="hljs-number"><span class="hljs-number">0</span></span>){ GPIO_ResetBits(GPIOC, GPIO_Pin_12); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(led_ticks_off &lt;= led_blink_off){ led_ticks_off++; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } led_ticks_on = <span class="hljs-number"><span class="hljs-number">0</span></span>; led_ticks_off = <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      「ユーザーボタン」で、外部割り込みをハングさせました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> // <span class="hljs-keyword"><span class="hljs-keyword">Enable</span></span> the BUTTON Clock RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); // Configure Button pin <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING; GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_2MHz; GPIO_Init(GPIOA, &amp;GPIO_InitStructure); // <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> Button EXTI <span class="hljs-type"><span class="hljs-type">Line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Button GPIO Pin GPIO_EXTILineConfig(GPIO_PortSourceGPIOA, GPIO_PinSource0); // Configure Button EXTI <span class="hljs-type"><span class="hljs-type">line</span></span> EXTI_InitStructure.EXTI_Line = EXTI_Line0; EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt; EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising; EXTI_InitStructure.EXTI_LineCmd = <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>; EXTI_Init(&amp;EXTI_InitStructure); // <span class="hljs-keyword"><span class="hljs-keyword">Enable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> Button EXTI Interrupt <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the lowest priority NVIC_InitStructure.NVIC_IRQChannel = EXTI0_IRQn; NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = <span class="hljs-number"><span class="hljs-number">0x0F</span></span>; NVIC_InitStructure.NVIC_IRQChannelSubPriority = <span class="hljs-number"><span class="hljs-number">0x0F</span></span>; NVIC_InitStructure.NVIC_IRQChannelCmd = <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>; NVIC_Init(&amp;NVIC_InitStructure);</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そして、そのハンドラーは、LEDが「点滅」している場合は連続点灯モードに、逆に点灯している場合は「点滅」モードにするという事実に関与しています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EXTI0_IRQHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(EXTI_GetITStatus(EXTI_Line0) != RESET){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(LED_GetState() != LEDSTATE_BLINK) LED_OnBlink(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> LED_On(); EXTI_ClearITPendingBit(EXTI_Line0); } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  1線 </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://we.easyelectronics.ru/blog/STM32/">easyelectronics.ruの</a>どこかから1-wireを操作するためのコードを盗みました。 かなり変更しました。 まず、バスにぶら下がっているデバイスの検索機能を変更しました（何らかの理由で、オリジナルでは機能しませんでしたが、ロジックは非常に明確で正しいように見えました）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私が盗んだ例では、1-wireはUSARTを介して機能し、DMAは読み取り/書き込みに使用されました。 私はこのアイデアが本当に好きだったので、この方法で使用しました（ただし、1-wireプログラムプロトコルを編成することもできました）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1線バスをシリアルポートに接続するための標準的なスキームは、ショットキーダイオードの存在を意味します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/geektimes/post_images/7cc/fb2/46b/7ccfb246b740fe45ed8e4480a1877393.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     しかし、私はそのようなダイオードを持っていませんでした。 しかし、プッシュプルモードに加えて、USART_TXを担当するレッグをオープンドレインモードに切り替えることができることに気付きました。この場合、短絡は発生しません。  1-wireで作業するために、私はUSART3を使用しました（プレイしている間は十分な足があるので、再マップする必要はありません）。 図では、USART3（PB10およびPB11）の脚が10kΩの抵抗器を介して既に接地されていることがわかりました。抵抗器をはんだ付けする必要さえありませんでした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      onewire.cファイルの内容については詳しく説明しません。これはすでに何度も行われていますが、温度計を直接操作することのみに触れます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     デバイスの暖かい（-50°Cを超える）部品の温度を監視するために、単純なDS18S20センサーを使用することにしました（記載されている測定精度は0.5°Cを下回っていません）。 ブレッドボードにはんだ付けされたソケットを必要な結論に接続しました。これにより、いくつかの温度計を同時にMCに接続できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここで、例えば、温度計を使って作業するときに得られるもの： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="bash hljs">com /dev/ttyACM0 Ca <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>, Cx modem lines status [STATUS]: RTS CTS DTR //  <span class="hljs-string"><span class="hljs-string">'c'</span></span> : find devices Found 2 devices //  <span class="hljs-string"><span class="hljs-string">'p'</span></span> : Print devices device 0: 0x10 0x7c 0xee 0x8f 0x02 0x08 0x00 0x1c device 1: 0x10 0xad 0xbc 0x8f 0x02 0x08 0x00 0xf9 //  <span class="hljs-string"><span class="hljs-string">'t'</span></span> : Read T Device 0: 0x3b 0x00 0x4b 0x46 0xff 0xff 0x08 0x10 0x39 Device 1: 0x3a 0x00 0x4b 0x46 0xff 0xff 0x0c 0x10 0x41</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず、すべての温度計にマークを付けて、誰がどの識別子を持っているかを確認しました。 そして、私は彼らの証言が大きく異なるかどうか確かめることにしました。 温度-センサー応答の最初の2バイト。  7番目のバイトには、ADC温度計に組み込まれた温度変換からの「残り」が格納されます。 センサーのドキュメントによると、この残留物は温度値を明確にするのに役立ちます。 しかし、彼の善はヤギの乳のようであることが判明しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その過程で、センサー自体が発熱し、測定結果に影響します。 したがって、頻繁に問い合わせないでください。 さらに、センサーの測定値は最大0.5度まで異なっていました！ これを念頭に置く必要があります：複数のセンサーを使用して、0.5°C以下の精度で何かのセクション間の温度差を監視するような方法で使用する場合は、最初にすべてのセンサーを較正する必要があります。 また、センサーの応答ではなく、較正式に従って測定値を取得します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     実際のセンサー誤差は0.5°Cを超える場合があるため、センサーの精度は1°Cであると仮定することをお勧めします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> ホールセンサー </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     アナログホールセンサー-SS495Aを使用しています。 センサーの仕様はインターネットで確認できます。 出力レッグの通常状態では、電圧は約2.5 V（論理ユニットSTM32）であり、外部磁場の極性と大きさに応じて、0..5 V内で読み取り値が変化すると言うことができます。 出力電圧が5ボルトに達する可能性があるため、通常ではなく「5ボルト」（仕様でFRとして指定）コントローラー入力を使用する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      （特にこのセンサーの場合）センサーの「面」（マークされた面）から1 mm以内に作業面を置くと、磁石の出力にゼロ電圧が現れました。 さらに、論理ゼロのレベルは、飛行機のセンサーの平行にマークされた側の座標のかなり狭い領域に表示されます。 位置決め精度はかなりまともです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     実験のために、ブレッドボードに1つのセンサーをはんだ付けしました。 彼は電源を5Vに接続し、信号出力はPC10ポートにつながっていました。PC10ポートは5Vが印加されても燃えません。 ポートを絶えず引っ張らないようにするために、私はそれを中断しました（ボタンに似ています）。 割り込みハンドラーは対応するフラグを設定するだけです。メインループで、このフラグが設定されている場合（つまり、磁石がセンサーの「視野」に現れたか、離れた場合）、PC10があることを確認します。 ゼロがある場合（MPがある場合）、ターミナルに「Magnet」と書き込みます。それ以外の場合は「clear」と書き込みます。 ターミナルで「h」を押すことで、センサーがあるかどうかを強制的に確認することもできます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  ADC </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      「ウォームゾーン」に加えて、寒さ（上から最大75K）の温度を測定する必要があります。 これには、ADG506Aアナログスイッチに接続されたプラチナサーミスタが使用されます。 もちろん、「ネイティブ」のMSCコンバーターはどれほど悪いのかと思っていました。温度測定に使用できますか？ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ADCを使用したSTM32の例はすべて揃っているので、STDPeriphLibから例を取り上げました。  ADCを連続変換モードで実行し、結果をDMAを使用してメモリに保存します。 変換時間を最大（より正確に）に設定し、とりあえずADC入力PB0（ADC8）をハングさせます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> // <span class="hljs-number"><span class="hljs-number">0.</span></span> Configure ADC8 (PB0) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> analog <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> (clocking GPIOB sat <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> onewire.c) RCC_ADCCLKConfig(RCC_PCLK2_Div4); RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA1, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); RCC_APB2PeriphClockCmd(RCC_APB2Periph_ADC1 | RCC_APB2Periph_GPIOB, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AIN; GPIO_Init(GPIOB, &amp;GPIO_InitStructure); // <span class="hljs-number"><span class="hljs-number">1.</span></span> DMA <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> converted <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> (DMA1 clocking sat <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> at onewire.c) //RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA1, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); DMA_DeInit(DMA1_Channel1); DMA_InitStructure.DMA_PeripheralBaseAddr = ADC1_DR_Address; DMA_InitStructure.DMA_MemoryBaseAddr = (uint32_t)&amp;ADC_value; DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralSRC; DMA_InitStructure.DMA_BufferSize = <span class="hljs-number"><span class="hljs-number">1</span></span>; DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable; DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Disable; DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_HalfWord; DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_HalfWord; DMA_InitStructure.DMA_Mode = DMA_Mode_Circular; DMA_InitStructure.DMA_Priority = DMA_Priority_High; DMA_InitStructure.DMA_M2M = DMA_M2M_Disable; DMA_Init(DMA1_Channel1, &amp;DMA_InitStructure); DMA_Cmd(DMA1_Channel1, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); // <span class="hljs-number"><span class="hljs-number">2.</span></span> ADC1 config ADC_InitStructure.ADC_Mode = ADC_Mode_Independent; ADC_InitStructure.ADC_ScanConvMode = <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>; ADC_InitStructure.ADC_ContinuousConvMode = <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>; ADC_InitStructure.ADC_ExternalTrigConv = ADC_ExternalTrigConv_None; ADC_InitStructure.ADC_DataAlign = ADC_DataAlign_Right; ADC_InitStructure.ADC_NbrOfChannel = <span class="hljs-number"><span class="hljs-number">1</span></span>; ADC_Init(ADC1, &amp;ADC_InitStructure); // <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> ADC <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> ADC8 (PB0), ADC_RegularChannelConfig(ADC1, ADC_Channel_8, <span class="hljs-number"><span class="hljs-number">1</span></span>, ADC_SampleTime_239Cycles5); // <span class="hljs-keyword"><span class="hljs-keyword">Enable</span></span> ADC1 DMA ADC_DMACmd(ADC1, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); ADC_Cmd(ADC1, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); // Calibration <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ADC1 ADC_ResetCalibration(ADC1); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(ADC_GetResetCalibrationStatus(ADC1)); ADC_StartCalibration(ADC1); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(ADC_GetCalibrationStatus(ADC1)); ADC_SoftwareStartConvCmd(ADC1, <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span>); // turn <span class="hljs-keyword"><span class="hljs-keyword">conversion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     スイッチを使用するには、制御ポートの5ビットを設定する必要があります。 ビット変換を心配しないために、ポートCの最初の4ビットをアドレスとして使用し、5番目のビットをスイッチを含むキーとして使用しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> GPIO_InitStructure.GPIO_Pin = <span class="hljs-number"><span class="hljs-number">0x1f</span></span>; // first <span class="hljs-number"><span class="hljs-number">5</span></span> bits <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PC0 // PC0..PC3 - analog channel address, PC4 - analog <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> switch GPIO_InitStructure.GPIO_Speed = GPIO_Speed_2MHz; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; GPIO_Init(GPIOC, &amp;GPIO_InitStructure);</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここには割り込みはありませんが、interrupts.cファイルでは、コマンド（たとえば、コマンド 'a'）がセンサーの電圧を表示するときに新しいフラグの設定を追加する必要があります。  main（）で、このフラグの処理を追加します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> prntADC(){ uint32_t address; // addr = <span class="hljs-number"><span class="hljs-number">0</span></span>, EN = <span class="hljs-number"><span class="hljs-number">1</span></span> uint8_t *_2b = (uint8_t *) &amp;ADC_value; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(address = <span class="hljs-number"><span class="hljs-number">0x10</span></span>; address &lt; <span class="hljs-number"><span class="hljs-number">0x20</span></span>; address++){ // changhe channel address &amp; turn <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> switch GPIOC-&gt;BSRR = address; Delay(<span class="hljs-number"><span class="hljs-number">2</span></span>); // wait <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> AD <span class="hljs-keyword"><span class="hljs-keyword">conversion</span></span> prnt((uint8_t*)"Temperature "); printInt(address&amp;<span class="hljs-number"><span class="hljs-number">0x0f</span></span>); prnt((uint8_t*)" = "); printInt(_2b[<span class="hljs-number"><span class="hljs-number">1</span></span>]); printInt(_2b[<span class="hljs-number"><span class="hljs-number">0</span></span>]); newline(); // turn <span class="hljs-keyword"><span class="hljs-keyword">off</span></span> switch &amp; <span class="hljs-keyword"><span class="hljs-keyword">reset</span></span> bits GPIOC-&gt;BRR = (uint32_t)<span class="hljs-number"><span class="hljs-number">0x1f</span></span>; Delay(<span class="hljs-number"><span class="hljs-number">2</span></span>); } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     コマンドがループに到着すると、スイッチで目的のアドレスの設定を開始し、ADCが機能するまで数ミリ秒待機してから、結果の値を表示します。 次に、スイッチをオフにして（念のため）さらに数ミリ秒待機します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     別のブレッドボードに、スイッチのすべてのアナログ入力を小さなオーム（200..900オーム）の抵抗器で接続する単純な抵抗分圧器を組み立てました。 グランドをS1に接続し、STM32ブレッドボードから+ 3.3VをS16に接続しました。 外付けHDD（12V）から古いPSUでチップに電力を供給しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      STM32P103ブレッドボードでは、ADCの基準電圧は一般的な電源から取得されるため、精度は低くなります。値は20ユニットも変動することがあります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ここで、たとえば、2つの投票で何が起こったのか： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">コード</b> <div class="spoiler_text"><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">//  1 Temperature 0x00 = 0x00 0x00 Temperature 0x01 = 0x00 0x84 Temperature 0x02 = 0x00 0xaf Temperature 0x03 = 0x01 0xdb Temperature 0x04 = 0x03 0x10 Temperature 0x05 = 0x03 0xe4 Temperature 0x06 = 0x05 0xca Temperature 0x07 = 0x06 0x9b Temperature 0x08 = 0x07 0x4e Temperature 0x09 = 0x08 0xd6 Temperature 0x0a = 0x0a 0x04 Temperature 0x0b = 0x0a 0xb4 Temperature 0x0c = 0x0b 0xfc Temperature 0x0d = 0x0d 0xe0 Temperature 0x0e = 0x0e 0xb7 Temperature 0x0f = 0x0f 0xff //  2 Temperature 0x00 = 0x00 0x00 Temperature 0x01 = 0x00 0x7f Temperature 0x02 = 0x00 0xaf Temperature 0x03 = 0x01 0xdf Temperature 0x04 = 0x03 0x0f Temperature 0x05 = 0x03 0xe4 Temperature 0x06 = 0x05 0xcc Temperature 0x07 = 0x06 0x9d Temperature 0x08 = 0x07 0x5a Temperature 0x09 = 0x08 0xd6 Temperature 0x0a = 0x0a 0x01 Temperature 0x0b = 0x0a 0xb5 Temperature 0x0c = 0x0b 0xfc Temperature 0x0d = 0x0e 0x09 Temperature 0x0e = 0x0e 0xb0 Temperature 0x0f = 0x0f 0xec</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     一般に、安定した基準電圧源（およびそこから供給される測定回路）を追加するか、一般に外部ADCを使用する必要があります。 使用するセンサーの抵抗が低いため、アンプをはんだ付けする必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3> ステッピングモーター </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     それ以来、私は義理の男をいじり終えていません ブレッドボードに要素をインストールするとき、何も「離陸」しないと思います。 はんだ付けする必要があります。 そして、おそらく来年だけはんだ付けに対処します（まだラジオ部品を購入する必要があります）。 これまでのところ、ステッピングモーターの制御方法を簡単に説明します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ステップチェンジャー-1.2アンペアのVSS42を使用します。 これらは、ShD-L6208ドライバーで最も便利に管理されます。 この超小型回路で作業するときは、方向制御信号、作業イネーブル信号、およびクロックパルスのみを送信する必要があります。 コントローラー自体がPWMを調整し、モーター巻線に必要な電圧を設定します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     以下に注意する主なものを指摘します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  PWM調整は、センス抵抗両端の電圧降下を基準電圧Vrefと比較することにより行われます。 したがって、電流I <sub>max</sub>と抵抗R <sub>Senseの</sub>抵抗について<sub>、</sub>この低下は非常に簡単に計算できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>U <sub>ref</sub> = I <sub>max</sub> R <sub>センス</sub></b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     つまり  R <sub>Sense</sub> = 0.33 Ohmで電流制限を1.2 Aに設定するには、U <sub>ref</sub> = 0.4 Vに設定する必要があります<sub>。Vrefを</sub>宙に<sub>浮かせ</sub>たり、地面に押し付けたりしないでください。 </li><li> 低速/高速減衰モードは従来のコレクターエンジンにとって重要ですが、ステップディサイダーは高速減衰モードでのみ高速減衰を必要とします。 一般に、倒錯しない場合は、+ 5VをCONTROLレッグに印加するだけで十分です。  HALF / FULLでは、+ 5Vを単純に印加し、ハーフステップモードで動作します。 位相カウンターをリセットしたくない場合は、RESETフットでも同じことを行います（正直に言うと、各ステップに8クロックパルスを与える必要はありません）。 </li><li>  ENABLE入力は出力でもあります。L6208ドライバーで問題が発生した場合（過熱、電流サージ）、負荷の電圧を個別に切断し、ENABLEはそれをグランドに引き込みます。 つまり、ENABLEポートを制御するコントローラーのフットがオープンコレクター出力モードでアクティブになっている場合、緊急事態が発生したかどうかを確認できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      STM32仕様によると、オープンコレクタモードでは、ユニットがポート出力に供給されると、トランジスタは単に脚を地面に持ち上げます。 出力がゼロの場合、脚が再び引っ張られます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、コントローラーの足を+ 5V（足に<b>FT</b>を選択する必要があります）を、たとえば5Ωの抵抗器を通して引っ張り、それとENABLEの間に、たとえばキロオームの抵抗器を貼り付けます（そして<i>、コンデンサーでENABLEの足を地面にシャントする</i>こと<i>を忘れ</i>ないでください、そうでなければ、制御コントローラーを焼くことができます） ）、目的のエンジンのオン/オフを切り替えて、事故の有無を確認できます（このため、コントローラーの対応する足の落下脚で周辺の中断を切ることができます）。 </li><li> 仕様で太字で示されている導体は、できるだけ短く幅を広くする必要があります。 ただし、同時に、浮遊容量とインダクタンスを減らすように注意する必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      R <sub>Sense</sub>は、ドライバーのできるだけ近くに配置する必要があります。 それらからそれほど遠くないところに、コンデンサC₁とC₂（仕様による）があるはずです。比較電流がこの回路を流れるだけでなく、逆誘導電流も流れます（したがって、 <b>このチェーンにダイオードを含めることはできません</b> ）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
            <b></b>   C₁  ,             ( , ,  ,   ,      ). </li><li>     : <b>     </b> !       5        . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ,  ,   :  +5       .     , ,  ,         0.          .     .  ,  USB-,  ,  ... </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J161853/index.html">メカニカルキーボードMatias Tactile Pro 4.0の最短レビュー</a></li>
<li><a href="../J161855/index.html">ビットコインには公式の銀行があります</a></li>
<li><a href="../J161857/index.html">適切な目標設定の必要性</a></li>
<li><a href="../J161859/index.html">インフェルノシェル</a></li>
<li><a href="../J16186/index.html">プロジェクトに投資することは可能ですか？</a></li>
<li><a href="../J161865/index.html">ウクライナにWindowsストアがオープン</a></li>
<li><a href="../J161867/index.html">iOの引用ボタン</a></li>
<li><a href="../J161875/index.html">単純な視差スクロール技術</a></li>
<li><a href="../J161877/index.html">PhpStormのリンク解決プラグインの作成（IntelliJ IDEA）</a></li>
<li><a href="../J161879/index.html">ビデオ：MomはWindows 8、Ubuntu 12.10、Windows 1.0、Windows 3.1、Linux Mint Cinnamon 14、OSX 10.2、Elementary OS Luna、Kubuntu、Zorin OS 6.1、MS-DOS 6.22、Microsoft Bobを初めてテストします！</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>