<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🔧 🏴󠁧󠁢󠁳󠁣󠁴󠁿 ◾️ 最適化とZeptolabでの作業について少しだけ人命を救った方法 🧗🏻 🤱🏼 🥦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは 
  
 
  
 Mobiusで話す前に23derevoから、Zeptolabでの顧客開発プロセスについて少し話してほしいと頼まれました。 
  
 
  
  
  
 
  
 まず、C ++とフレームワークで記述します。どのクライアントデバイスからでもOpenGLコンテキストのみ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>最適化とZeptolabでの作業について少しだけ人命を救った方法</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"> こんにちは 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://habrahabr.ru/users/23derevo/" class="user_link">Mobius</a>で話す前に<a href="http://habrahabr.ru/users/23derevo/" class="user_link">23derevo</a>から、Zeptolabでの顧客開発プロセスについて少し話してほしいと頼まれました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/5d5/481/c50/5d5481c50ef64895b185a6537706b1fd.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず、C ++とフレームワークで記述します。どのクライアントデバイスからでもOpenGLコンテキストのみが必要です。 さらに、ゼロからインターフェイス、コントロールなどを構築します。 したがって、開発者をチームに連れて行くには、理論的には、プラスを知るだけで十分です。 実際には、これは少し間違っています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1> 仕事について </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      3人の開発者（CTO、iOS開発者、Android開発者）がいる場合でも、Zeptolabに来ました。 その前に、私はYandex SHADで勉強し、同時に、豊富な書式設定、ファイルおよび画像の保存オプションを備えた税関文書データベースを調べました-一般に、MSDNの一種で、税関のニーズにのみ対応しています。 これまで使用されてきましたが、今までアナログが発見され始めたばかりです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私は非常にクールな技術知識を持っていなかったので、グラフィックに携わり、OpenGLで小さなプロジェクトを書き、シェーダーを作成しました。 これは、一般に、モバイル開発ブランチの研究を始めるのに十分でした。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私の意見では、候補者（および一般的に開発者）にとって最も重要なことは、一般的な知能、技術的展望、および技術的思考です。 ところで、インタビューでは、丸いhatch化についての悪名高い仕事を頼まれました。 今、私は自分でインタビューを行い、同様の抽象的なタスクを与えています。 そのようなタスクのリストをめったに変更しないため、彼らはいくつかの候補者をいらいらさせます（ランダムに与えられた場合、共通のメトリックはありません-候補者に対してあまり正直ではありません）。 しかし、インタビューの境界を超えて「漏れ」ていることを考えると、通常、候補者が不正行為を行っているかどうかを確認するためのタスクをいくつか準備します。 すべてが論理的に整然と並んでいる場合、言語のいくつかの構文的特徴の無知は小規模の問題です。 構文は学習でき、プログラミングパターンも学習できますが、残念ながら、すぐに考える必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     一般に、エンコーダは開発者とは異なり、開発者は問題を解決するためのアイデアを思いつくことができます。 ある有名な大企業では、私の良き友人が働いています。 彼らのロシアのオフィスは、アルゴリズムを発明し、PythonまたはC＃でプロトタイプをテストしてから、インドと中国のユニットに結果を提供することに専念しています。 想像を絶する遠いコーダーはすでに存在しますが、最大限の知識と純粋なアジアの永続性により、説明されたアイデアを取り入れ、理想的には各デバイスのC ++またはCのマイクロコントローラーのコードに実装します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     大学のすぐ後に仕事を探している人には、Codeforcesで2000年の分野の評価を取得することをお勧めします。 少し黄色い場合は、たとえばGoogleに行く可能性が高くなります。 さらに、特定の技術が既に必要な（または十分な）レベルで「ローカルに」研究されている場合、そもそも独自の問題を考えて解決する能力であることを十分に理解できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1> アーティストについてのいくつかの言葉 </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最初にCocos2Dがありました。 それは良いフレームワークですが、実装の点で多くのことが私たちに合わなかったので、独自のシステムを書き始めました。 すぐに、C ++で非常にクールなアニメーションシステムとリソースの適切な準備を実装することができました。 簡単に言えば、アニメーションについてはすでに説明しました。Flashで準備し、FLAファイルを解析して、アプリケーションで同じアニメーションを再作成します。 私たちにとって最も重要なことは、常に品質を重視することです。 アニメーションの場合、これはスムーズです。アーティストは多くの場合、プログラマの後ろに立って、何が悪いのかを言います。 トレーニングなしでは、どこで何がけいれんしているのかが少しわかりませんが、アーティストは間違いなくそれを感じます。 普通の人は、何が間違っているのか理解できず、実際に、たとえそれを見たとしても、常にそれを説明することはできません。 しかし、彼は多くの場合、あまり意識的ではなく、それが「粗い」と感じます。 私たちのアーティストは自分自身の理想的な姿を実現し、何を変える必要があるかを専門用語で説明することができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/68b/070/cd5/68b070cd56f245adaa95b2503b34caea.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://mobiusconf.com/">会議では、</a>この品質の写真をどのように実現したかを正確に説明し、フレームワークの裏側にあるものを示します。 私たちの技術の進化、リソースの準備についてお話します。 コントロールがピクセルごとに正確に取得し、フォントを正しく準備し、低解像度のデバイスを考慮に入れることなどが非常に重要です。 繰り返しますが、会議で特定の例を示します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/dec/eff/727/deceff727ac44732b2703011db061a77.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     私にとって、おそらく最大の話題は、アーティストの後ろに立って、彼が何からも傑作を作成する方法を見ることです。 時には彼らも私たちを見て、私たちが何をしているかを理解しようとします。 開発中の私たちには、良いアーティストがほとんどいないようで、そのようなクールなアーティストを見つけるのは非現実的です。 彼らにとって、必要なことを理解している開発者は非現実的に小さいようです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/80d/466/c1a/80d466c1a4b640149f86acb6f905e408.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ところで、すべての彼らの誠実な人道教育で、技術的な部分に問題はありませんでした。 タスクは完全に定式化され、一般的なアーキテクチャを表します。 そのような面白いケースさえありました。私たちは、楽しみのために、開発者としてのアーティストとしてのCodeforcesのコンテストの写真を撮りました。 メガネ、複雑な顔、思考。 それで、その後、彼は突然JavaScriptでコードを書き始めました。 最初は、PhotoshopおよびFlash用の非常に単純なマクロがありました。 それから実際、数ヶ月間、彼は開発の進化の全歴史を経験し、新しい機会を発見しました。 ある時点で彼が思いついたのを覚えており、複雑なスクリプトを書くのに役立つ概念をかなり不器用に説明し始めました。しばらくして、ブレークポイントを設定して変数の値を調べたいと思いました。 それ自体がassert'ovの使用に達しました。 これに先立ち、私たちは彼のコードをこっそり笑うことがありました。インデントなしで1行の式に干渉し、少しワイルドに見えました。 そして、いつの間にか、彼は非常にクールなスクリプトを作成し始めました。 今、私たちは複雑な顔で写真を撮る人を考えています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     しかし、フレームワークに戻ります。 特に、絶え間ない改善に関連して、非常に多くのルーチンがあります。 フレームワークは開発中であり、新しいハードウェアが登場し、新しい要件があります。レガシーコードをタイムリーに処理したいと思います。 たとえば、最後の主要なタスクのうち、独自のパーティクルシステムが必要でした。 ユニティにあるものを見ました、アーティストはメガクールと言いますが、あなたはまだこれ、これ、そしてそれを必要としています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     その結果、タスクはパーティクルジェネレーターの作成だけでなく、便利なインターフェイスの実装まで削減されました。 複数の放射層があり、粒子は異なる法則に従って移動します。 それぞれに任意の式を使用すると、クライアントデバイスに非常に大きな負荷がかかり（実際、それぞれを個別に解析する必要があります）、一般的な式はアーティストのアイデアを実装するのに十分な柔軟性がありませんでした。 彼らは数学によって決定しました-係数を変更することで、少なくとも放物線、少なくとも正弦波を実行できる各粒子の一般的な式を導き出しました。 また、速度は低下せず、視覚的にも豊かです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1> チームで </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2週間に一度、私たちは自分自身を教えます。 仲間（そしてチームには21人の開発者がいます）は、他のプロジェクトでまだ使用していないか、他の企業では利用できない新しい何かを学んでいます。 彼らはみんなを集めて、面白いと思ったことを伝えます。 これらはさまざまなトピックになります。ユーザーのダウンロードを主観的に高速にする方法から、ポップアップの背後にある背景をすばやくぼかして終了するまで（King of Thievesで行われます）。 ミハイル・ミルザヤノフは定期的に私たちのオフィスに来ました（ところで、彼は私たちのチームをコーチし、ACM / ICPCで優勝しました）。 アルゴリズムとデータ構造に関する最もクールな講義の3つのブロックを読み、まれにしか知られていない構造とタスクを示しました（たとえば、彼が独自に世界で最初の1つ、ロシアで最初の1つを開いたセグメントツリーについて）。 トレーニングとして、スコットマイヤーズの3日間のトレーニング（Effective Modern C ++を書いた人）に行きました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/606/be5/2ba/606be52ba8144e49ad53c7e6f0d54541.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     問題の例から-2013年に、テクスチャアトラスのパッキングに関するNP困難な問題の解決策に関するかなり大きな記事が公開されました。  Codeforcesコンテストの1つの結果によると、強力なアルゴリズムの専門家がやってきました。 私はこの記事を読み、長い間考えてから、よく知られているアルゴリズムの改良版である独自のアルゴリズムを作成しました。  100％完全なパッケージングを行うと、以前のアルゴリズムの結果は120％を超え、同じデータセットの新しいアルゴリズムでは104％が表示され始めました。 実際には、これはメガバイトあたりのメモリ消費量の減少を意味します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     一般に、5億台のインストールでは、このようなことは非常に面白く見えます。 たとえば、PNGファイルで動作する画像を保存およびロードする最初のシステムであり、テストデバイスにレベルをロードするのに約15秒かかりました。 プロファイルされ、整理されます-ほとんどの場合、PNGデコードにかかりました。 このコードを書き直しました（新しい内部グラフィックスストレージ形式が必要でした）-同じテストデバイスで、読み込みに6秒かかりました。  9秒節約-すべてのゲームに新しいストレージシステムを導入しました。 基本的な指標としてゲームのダウンロードを20回カウントすると、少なくとも50人の命が救われたようです。 さらに、古い職場で同じことを行った初心者のアドバイスにより、このメカニズムはさらに20〜30％加速されました。これは、ある時点でプロセッサの単純な計算がブートシステムのボトルネックでなくなったため、すべてがストレージからの読み取り速度にかかったためです。 形式を変更しました。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     一般的に、最適化には非常に多くの作業があります。 ゲームは古いハードウェアでも動作し、フレームワークはiOS 4.3をサポートします（現在iOS 5：アフィリエイトコードが原因で、その後、libc ++の使用を開始しました。これは、iOS 5からフレームワークの2番目のバージョンでも利用可能です）。 私たちは、トップモデルの完全に新しいアプリケーションと実験の開発を行っています。なぜなら、開発の終わりまでに、それらは最も大規模なデバイスになるからです。しかし、「古いもの」を忘れないでください。 同じCut the Ropeで、ほとんどのリリースはコンテンツの更新です。 古いコードを台無しにしません。 新しいゲームはすでに視覚的にはるかに豊かですが、ハードウェア要件はより高くなっています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     プロトタイピングは非常に迅速に行われ、多くのスタジオよりも高速です。 ゲームデザイナーはコンセプトを発表し、1〜2日で開発者の1人が「夢の仕事」を行います。グラフィックスなしでプリミティブからプロトタイプをゼロから収集します。 これがゲームデザイナーを固定した後にボールと正方形をジャンプした場合、彼は仕事を続けます。 当然のことながら、通常のタスクよりもプロトタイプの数ははるかに少なくなりますが、チームの全員が遅かれ早かれ独自のものを作成するよう努めています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     繰り返しになりますが、もちろん、すべての基本的なことがある既製の調達プロジェクトでこれをすぐに行います。 ネイティブモバイルアプリケーションの開発に携わる人々にとって、これは単なる別の世界です。標準的なコントローラーはなく、リソースの準備は彼ら自身のものです。  Unityで働いていた人たち-彼らは「ボンネットの下」を掘ることにもっと興味があり、そこで行うのが難しいいくつかのことの実装を見ています。 一般に、ココナッツには高いレベルで類似点がありますが、ゲームを解析し、内部でどのように機能するかを見るのは依然として興味深いです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1> テストについて少し </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     最後に-友達と私の小さな議論。 以下のネタバレの下に、さまざまな人々のテストタスクからの5つのコードサンプルがあります。 コードは、すべての候補者の同意を得て公開されています。  （慎重に、ソースコードは非常に大きいです） 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">App.cpp</b> <div class="spoiler_text"><pre><code class="hljs pgsql">// // App.cpp // Asteroids // // Created <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> xxxx // // #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;string&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "App.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "RenderCommandPolygonConvex.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Vec2.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Color.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "GameMap.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "Camera.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MapDrawObjectPolygon.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MapObjectMovable.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "IMovable.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MovableObjectTouch.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MapObjectEmitter.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "EmitterLineContinuous.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MovableInDirection.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MapObjectHero.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MapObjectAsteroid.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "MapObjectDebris.h" const <span class="hljs-type"><span class="hljs-type">float</span></span> LOGIC_MAP_WIDTH = <span class="hljs-number"><span class="hljs-number">100</span></span>; const <span class="hljs-type"><span class="hljs-type">float</span></span> GAMEPLAY_ACCELERATION = <span class="hljs-number"><span class="hljs-number">0.003</span></span>; namespace { <span class="hljs-type"><span class="hljs-type">void</span></span> initAsteroidsEmitters(GameMapPtr gameMap, <span class="hljs-type"><span class="hljs-type">float</span></span> logicMapWidth, std::vector&lt;EmitterLineContinuousPtr&gt;&amp; asteroidEmitters) { for_each(asteroidEmitters.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(), asteroidEmitters.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(), [](EmitterLineContinuousPtr emitter){emitter-&gt;die();}); MapObjectEmitterPtr emitterMapObject(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectEmitter()); EmitterLineContinuousPtr emitter(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> EmitterLineContinuous(Vec2(-logicMapWidth*<span class="hljs-number"><span class="hljs-number">0.5</span></span>f, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(logicMapWidth*<span class="hljs-number"><span class="hljs-number">1.5</span></span>f, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, gameMap)); emitter-&gt;setParticlesMapObject(MapObjectAsteroidPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectAsteroid())); asteroidEmitters.push_back(emitter); emitterMapObject-&gt;setEmitter(emitter); gameMap-&gt;addMapObject(emitterMapObject, Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-10</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); MapObjectEmitterPtr emitterMapObject2(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectEmitter()); EmitterLineContinuousPtr emitter2(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> EmitterLineContinuous(Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(logicMapWidth, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, gameMap)); emitter2-&gt;setParticlesMapObject(MapObjectAsteroidPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectAsteroid())); emitterMapObject2-&gt;setEmitter(emitter2); asteroidEmitters.push_back(emitter2); gameMap-&gt;addMapObject(emitterMapObject2, Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-10</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); MapObjectEmitterPtr emitterMapObject3(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectEmitter()); EmitterLineContinuousPtr emitter3(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> EmitterLineContinuous(Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(logicMapWidth, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, gameMap)); emitter3-&gt;setParticlesMapObject(MapObjectDebrisPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectDebris())); emitterMapObject3-&gt;setEmitter(emitter3); asteroidEmitters.push_back(emitter3); gameMap-&gt;addMapObject(emitterMapObject3, Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-10</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); MapObjectEmitterPtr emitterMapObject4(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectEmitter()); EmitterLineContinuousPtr emitter4(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> EmitterLineContinuous(Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(logicMapWidth, <span class="hljs-number"><span class="hljs-number">0</span></span>), Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, gameMap)); emitter4-&gt;setParticlesMapObject(MapObjectAsteroidPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectAsteroid())); emitterMapObject4-&gt;setEmitter(emitter4); asteroidEmitters.push_back(emitter4); gameMap-&gt;addMapObject(emitterMapObject4, Vec2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-10</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); } } App::App() :time_(<span class="hljs-number"><span class="hljs-number">0</span></span>) { } <span class="hljs-type"><span class="hljs-type">void</span></span> App::updateAndRender(<span class="hljs-type"><span class="hljs-type">float</span></span> dtSec, std::vector&lt;RenderCommandBasePtr&gt;&amp; renderCommands) { <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>(dtSec); collectRenderData(renderCommands); } <span class="hljs-type"><span class="hljs-type">bool</span></span> App::touch(const std::vector&lt;TouchEvent&gt;&amp; events) const { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (events.empty()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gameMap_) gameMap_-&gt;touch(events); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-type"><span class="hljs-type">void</span></span> App::<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>(<span class="hljs-type"><span class="hljs-type">float</span></span> dtSec) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gameMap_) gameMap_-&gt;<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>(dtSec); tryRespawnHero(); updateGameplayAcceleration(); time_+= dtSec; } <span class="hljs-type"><span class="hljs-type">void</span></span> App::resetGameplay() { time_ = <span class="hljs-number"><span class="hljs-number">0</span></span>; ::initAsteroidsEmitters(gameMap_, LOGIC_MAP_WIDTH, asteroidEmitters_); } <span class="hljs-type"><span class="hljs-type">void</span></span> App::tryRespawnHero() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!hero_ || hero_-&gt;isReadyToDestruct() ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!gameMap_-&gt;hasObjectOfType(MAP_OBJECT_HERO_DEBRIS)) { resetGameplay(); hero_ = MapObjectHeroPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MapObjectHero(Rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, logicMapSize_.x, logicMapSize_.y))); gameMap_-&gt;addMapObject(hero_, Vec2(<span class="hljs-number"><span class="hljs-number">50</span></span>, logicMapSize_.y - <span class="hljs-number"><span class="hljs-number">10</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); } } } <span class="hljs-type"><span class="hljs-type">void</span></span> App::setScreenSize(<span class="hljs-type"><span class="hljs-type">int</span></span> screenW, <span class="hljs-type"><span class="hljs-type">int</span></span> screenH) { screenSize_ = Vec2(screenW, screenH); <span class="hljs-type"><span class="hljs-type">float</span></span> logicCellSize = screenW/LOGIC_MAP_WIDTH; logicMapSize_ = Vec2(screenW/logicCellSize, screenH/logicCellSize); CameraPtr camera = CameraPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Camera(logicCellSize, logicCellSize)); gameMap_ = GameMapPtr(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> GameMap(Size(logicMapSize_.x, logicMapSize_.y), camera)); gameMap_-&gt;setLiveAreaRect(Rect(-logicMapSize_.x/<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">-10</span></span>, logicMapSize_.x*<span class="hljs-number"><span class="hljs-number">2</span></span>, logicMapSize_.y + <span class="hljs-number"><span class="hljs-number">20</span></span>)); resetGameplay(); } <span class="hljs-type"><span class="hljs-type">void</span></span> App::collectRenderData(std::vector&lt;RenderCommandBasePtr&gt;&amp; renderCommands) const { gameMap_-&gt;collectRenderData(renderCommands); } <span class="hljs-type"><span class="hljs-type">void</span></span> App::updateGameplayAcceleration() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (auto emitter: asteroidEmitters_) { emitter-&gt;setSpeedParticles(emitter-&gt;getSpeedParticles() + time_*GAMEPLAY_ACCELERATION); } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">game.cpp</b> <div class="spoiler_text"><pre> <code class="hljs ruby">/* w,a,d    r   , space  *<span class="hljs-regexp"><span class="hljs-regexp">/ #include "stdafx.h" #include &lt;math.h&gt; #include &lt;vector&gt; #include &lt;iostream&gt; #include &lt;fstream&gt; #include &lt;glut.h&gt; using namespace std; const float Pi=3.14159265358; float winwid=400; float winhei=400; bool game_end=0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//bullet</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> float dx=<span class="hljs-number"><span class="hljs-number">0</span></span>,dy=<span class="hljs-number"><span class="hljs-number">0</span></span>; float bull_speed=<span class="hljs-number"><span class="hljs-number">6</span></span>; float betta=<span class="hljs-number"><span class="hljs-number">0</span></span>; bool fl1=<span class="hljs-number"><span class="hljs-number">0</span></span>, fl2=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ship/</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ float speed=0; float angle=0; float acsel=0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//asteroid</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ float ast_size=50; float aster_speed=3; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>-rand/<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ int kol_aster=0; class bullet { public: float dxb; float dyb; float angleb; bullet() { dxb=dx; dyb=dy; angleb=betta; } }; class asteroid { public: float anglea; float dx; float dy; float depth; int n; int i_big; int ifsmall; vector &lt;double&gt; x; vector &lt;double&gt; y; void create(int i,bool param); void create_small(int i,int j,bool param,float depth1,float dx1,float dy1); }; void asteroid:: create_small(int i,int j,bool param,float depth1,float dx1,float dy1) { ifsmall=0; int size=ast_size/</span></span><span class="hljs-number"><span class="hljs-number">2</span></span>; depth=depth1+(j+<span class="hljs-number"><span class="hljs-number">2</span></span>)*<span class="hljs-number"><span class="hljs-number">1.0</span></span>/(<span class="hljs-number"><span class="hljs-number">8.0</span></span>*(kol_aster)); dx=dx1; dy=dy1; i_big=i; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ int quat=rand()%4; int n1=rand()%2+1; int n2=rand()%2+1; int n3=rand()%2+1; int n4=rand()%2+1; n1=n2=n3=n4=1; n=n1+n2+n3+n4; double xi,yi; anglea=rand()%360; x.clear(); y.clear(); for (int i=0;i&lt;n1;i++) { xi=rand()%(size/</span></span><span class="hljs-number"><span class="hljs-number">2</span></span>)-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n2;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n3;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n4;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ } void asteroid:: create(int kol_exist,bool param) { int size=ast_size; int quat=rand()%4; int n1=rand()%2+1; int n2=rand()%2+1; int n3=rand()%2+1; int n4=rand()%2+1; n1=n2=n3=n4=1; n=n1+n2+n3+n4; double xi,yi; anglea=rand()%360; i_big=kol_exist; ifsmall=1; depth=(float)(kol_exist)/</span></span>((kol_aster)); dx=rand()<span class="hljs-string"><span class="hljs-string">%(int)</span></span>winwid -winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; dy=rand()<span class="hljs-string"><span class="hljs-string">%(int)</span></span>winhei -winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(quat==<span class="hljs-number"><span class="hljs-number">0</span></span>) dy=-ast_size-winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(quat==<span class="hljs-number"><span class="hljs-number">1</span></span>) dy=ast_size+winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(quat==<span class="hljs-number"><span class="hljs-number">2</span></span>) dx=-ast_size-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(quat==<span class="hljs-number"><span class="hljs-number">3</span></span>) dx=ast_size+winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.clear(); y.clear(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n1;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n2;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n3;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>+size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;n4;i++) { xi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; yi=rand()<span class="hljs-string"><span class="hljs-string">%(size/2)</span></span>-size/<span class="hljs-number"><span class="hljs-number">2</span></span>; x.push_back(xi); y.push_back(yi); } } vector &lt;bullet&gt; vecb; vector &lt;asteroid&gt; veca; void destroy_small_ast( int i) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">4</span></span> -  /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> bool create_big=<span class="hljs-number"><span class="hljs-number">1</span></span>; float up_boarder=(float)(veca[i].i_big)/((kol_aster)); float down_boarder=(float)(veca[i].i_big)/((kol_aster)); asteroid a_big; a_big.create(veca[i].i_big,<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(veca[i-<span class="hljs-number"><span class="hljs-number">1</span></span>].depth&gt;down_boarder) create_big=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i&lt;veca.size()-<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(veca[i+<span class="hljs-number"><span class="hljs-number">1</span></span>].depth&lt;up_boarder) create_big=<span class="hljs-number"><span class="hljs-number">0</span></span>; {<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (create_big==<span class="hljs-number"><span class="hljs-number">1</span></span>) {veca.insert(veca.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>()+veca[i].i_big,a_big); veca[veca[i].i_big].create(veca[i].i_big,<span class="hljs-number"><span class="hljs-number">1</span></span>); veca.erase(veca.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>()+i+<span class="hljs-number"><span class="hljs-number">1</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> veca.erase(veca.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>()+i);} } void destroy_aster(float dep) { dep=<span class="hljs-number"><span class="hljs-number">1</span></span>-<span class="hljs-number"><span class="hljs-number">2</span></span>*dep; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;veca.size();i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abs(dep-veca[i].depth)&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0001</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(veca[i].ifsmall==<span class="hljs-number"><span class="hljs-number">1</span></span>) { veca.resize(veca.size()+<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int j=<span class="hljs-number"><span class="hljs-number">0</span></span>;j&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>;j++) veca[veca.size()-j-<span class="hljs-number"><span class="hljs-number">1</span></span>].create_small(i,j,<span class="hljs-number"><span class="hljs-number">0</span></span>,veca[i].depth,veca[i].dx,veca[i].dy); veca.erase(veca.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>()+i); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {destroy_small_ast( i);<span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;} } } } void shoot() { float depth[<span class="hljs-number"><span class="hljs-number">5</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;vecb.size();i++) { glLoadIdentity(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ vecb[i].dxb+=(speed+bull_speed)*cos(Pi*(vecb[i].angleb)/</span></span><span class="hljs-number"><span class="hljs-number">180.0</span></span>); vecb[i].dyb+=(speed+bull_speed)*sin(Pi*(vecb[i].angleb)/<span class="hljs-number"><span class="hljs-number">180.0</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((vecb[i].dxb&gt;winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-params"><span class="hljs-params">||</span></span>(vecb[i].dxb&lt;-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-params"><span class="hljs-params">||</span></span>(vecb[i].dyb&lt;-winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-params"><span class="hljs-params">||</span></span> (vecb[i].dyb&gt;winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>)) {vecb.erase(vecb.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>()+i);i--;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ glReadPixels((vecb[i].dxb+winwid/</span></span><span class="hljs-number"><span class="hljs-number">2</span></span>),-vecb[i].dyb+winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,GL_DEPTH_COMPONENT,GL_FLOAT,depth); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (depth[<span class="hljs-number"><span class="hljs-number">0</span></span>]!=<span class="hljs-number"><span class="hljs-number">1</span></span>) { destroy_aster(depth[<span class="hljs-number"><span class="hljs-number">0</span></span>]); vecb.erase(vecb.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>()+i); i--; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ glTranslatef(vecb[i].dxb,vecb[i].dyb,0.0f); glColor3f(1.0f,1.0f,1.0f); glBegin(GL_LINES); glVertex3f( 0.0,0.0, 0.5f); glVertex3f(1.0,0.0, 0.5f); glEnd(); } } } } void aster_draw() { glColor3f(0.5f,1.0f,1.0f); glLoadIdentity(); for (int i=0;i&lt;veca.size();i++) { glBegin(GL_POLYGON); for(int j=0;j&lt;veca[i].n;j++) glVertex3f( veca[i].dx+veca[i].x[j],veca[i].dy+veca[i].y[j], veca[i].depth); glEnd(); veca[i].dx+=aster_speed*cos(Pi*(veca[i].anglea)/</span></span><span class="hljs-number"><span class="hljs-number">180.0</span></span>); veca[i].dy+=aster_speed*sin(Pi*(veca[i].anglea)/<span class="hljs-number"><span class="hljs-number">180.0</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    ,   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((veca[i].dx&gt;winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>+ast_size) <span class="hljs-params"><span class="hljs-params">||</span></span>(veca[i].dx&lt;-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>-ast_size) <span class="hljs-params"><span class="hljs-params">||</span></span>(veca[i].dy&lt;-winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>-ast_size) <span class="hljs-params"><span class="hljs-params">||</span></span> (veca[i].dy&gt;winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>+ast_size)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (veca[i].ifsmall==<span class="hljs-number"><span class="hljs-number">0</span></span>) {destroy_small_ast( i);i--;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> veca[i].create(i,<span class="hljs-number"><span class="hljs-number">1</span></span>); } } void asteroidsinit() { int k; k=rand()%<span class="hljs-number"><span class="hljs-number">6</span></span>+<span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(kol_aster!=<span class="hljs-number"><span class="hljs-number">0</span></span>) k=kol_aster; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> kol_aster=k; veca.resize(k); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;k;i++) veca[i].create(i,<span class="hljs-number"><span class="hljs-number">1</span></span>); } void draw_ship() { float depth[<span class="hljs-number"><span class="hljs-number">6</span></span>]; float dx1,dx2,dy1,dy2; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((dx&lt;winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dx&gt;-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dy&lt;winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dy&gt;-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)) glReadPixels((dx+winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>),-dy+winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,GL_DEPTH_COMPONENT,GL_FLOAT,depth); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> depth[<span class="hljs-number"><span class="hljs-number">0</span></span>]=<span class="hljs-number"><span class="hljs-number">1</span></span>; dx1=dx-<span class="hljs-number"><span class="hljs-number">10</span></span>*cos(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)-<span class="hljs-number"><span class="hljs-number">10</span></span>*sin(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)+winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; dy1=-dy+<span class="hljs-number"><span class="hljs-number">10</span></span>*sin(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)-<span class="hljs-number"><span class="hljs-number">10</span></span>*cos(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)+winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((dx1&lt;winwid-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dx1&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dy1&lt;winhei-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dy1&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)) glReadPixels(dx1,dy1,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,GL_DEPTH_COMPONENT,GL_FLOAT,depth+<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> depth[<span class="hljs-number"><span class="hljs-number">1</span></span>]=<span class="hljs-number"><span class="hljs-number">1</span></span>; dx2=dx-<span class="hljs-number"><span class="hljs-number">10</span></span>*cos(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)+<span class="hljs-number"><span class="hljs-number">10</span></span>*sin(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)+winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; dy2=-dy+<span class="hljs-number"><span class="hljs-number">10</span></span>*sin(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)+<span class="hljs-number"><span class="hljs-number">10</span></span>*cos(Pi*betta/<span class="hljs-number"><span class="hljs-number">180</span></span>)+winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((dx2&lt;winwid-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dx2&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dy2&lt;winhei-<span class="hljs-number"><span class="hljs-number">1</span></span>)&amp;&amp;(dy2&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)) glReadPixels(dx2,dy2,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,GL_DEPTH_COMPONENT,GL_FLOAT,depth+<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> depth[<span class="hljs-number"><span class="hljs-number">2</span></span>]=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ if(dx&gt;winwid/</span></span><span class="hljs-number"><span class="hljs-number">2</span></span>) dx=-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(dx&lt;-winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>) dx=winwid/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(dy&lt;-winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>) dy=winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(dy&gt;winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>) dy=-winhei/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ glColor3f(0.8f,0.0f,0.8f); glLoadIdentity(); glTranslatef(dx,dy,0.0f); glRotatef(betta,0.0f,0.0f,1.0f); glBegin(GL_TRIANGLES); glVertex3f( -10.0f,-10.0f, 1.0f); glVertex3f(-10.0f,10.0f, 1.0f); glVertex3f(0.0f,0.0f, 1.0f); if (fl2==1){ glVertex3f( -10.0f,-3.0f, 1.0f); glVertex3f(-10.0f,3.0f, 1.0f); glVertex3f(-15.0f,0.0f, 1.0f); } glEnd(); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> - /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((depth[<span class="hljs-number"><span class="hljs-number">0</span></span>]!=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-params"><span class="hljs-params">||</span></span>(depth[<span class="hljs-number"><span class="hljs-number">1</span></span>]!=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-params"><span class="hljs-params">||</span></span>(depth[<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-number"><span class="hljs-number">1</span></span>)) game_end=<span class="hljs-number"><span class="hljs-number">1</span></span>; } void display() { glClearDepth( <span class="hljs-number"><span class="hljs-number">1.0</span></span>f ); glClear(GL_COLOR_BUFFER_BIT <span class="hljs-params"><span class="hljs-params">| GL_DEPTH_BUFFER_BIT); aster_draw(); draw_ship(); shoot(); glutSwapBuffers(); } void Timer(int) { acsel--; </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span><span class="hljs-params">(speed&gt;10) speed=10; </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span><span class="hljs-params"> (fl1==1) {angle=betta;fl1=0;} </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span><span class="hljs-params"> (acsel==0) {fl2=0;} dx=dx+speed*cos(Pi*angle/180.0); dy=dy+speed*sin(Pi*angle/180.0); </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span><span class="hljs-params">(speed&gt;0)speed=speed-0.1; </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">else</span></span></span><span class="hljs-params"> speed=0; display(); </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span><span class="hljs-params">(game_end==0) glutTimerFunc(50,Timer,0); } void Initialize() { dx=0; dy=0; vecb.empty(); angle=betta=speed=0; glClearColor(0, 0, 0.0, 1.0); glMatrixMode(GL_PROJECTION); glLoadIdentity(); glOrtho(-winwid/2, winwid/2, winhei/2, -winhei/2, -1, 1); glMatrixMode(GL_MODELVIEW); glEnable(GL_DEPTH_TEST); glDepthFunc( GL_LEQUAL ); float depth[5]; glClearDepth( 1.0f ); //     glClear(GL_COLOR_BUFFER_BIT |</span></span> GL_DEPTH_BUFFER_BIT); asteroidsinit(); glutTimerFunc(<span class="hljs-number"><span class="hljs-number">500</span></span>,Timer,<span class="hljs-number"><span class="hljs-number">0</span></span>); } void keyboard(unsigned char key,int x,int y) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key==<span class="hljs-string"><span class="hljs-string">'w'</span></span>) {fl1=<span class="hljs-number"><span class="hljs-number">1</span></span>;speed++;fl2=<span class="hljs-number"><span class="hljs-number">1</span></span>;acsel=<span class="hljs-number"><span class="hljs-number">10</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key==<span class="hljs-string"><span class="hljs-string">'d'</span></span>) {betta+=<span class="hljs-number"><span class="hljs-number">7</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key==<span class="hljs-string"><span class="hljs-string">'a'</span></span>) betta-=<span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key==<span class="hljs-string"><span class="hljs-string">' '</span></span>) {bullet b1;vecb.push_back(b1);} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(key==<span class="hljs-string"><span class="hljs-string">'r'</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(game_end==<span class="hljs-number"><span class="hljs-number">1</span></span>) {game_end=<span class="hljs-number"><span class="hljs-number">0</span></span>;Initialize();}} } int main(int argc, char **argv)/<span class="hljs-regexp"><span class="hljs-regexp">/  { glutInit(&amp;argc, argv); glutInitDisplayMode(GLUT_DEPTH |GLUT_DOUBLE | GLUT_RGB); glutInitWindowSize(winwid, winhei); glutInitWindowPosition(200, 200); glutCreateWindow("Powder Toy"); Initialize(); glutDisplayFunc(display); glutKeyboardFunc(keyboard); glutMainLoop(); }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">game.cpp</b> <div class="spoiler_text"><pre> <code class="hljs rust">#include <span class="hljs-string"><span class="hljs-string">"game.h"</span></span> #include <span class="hljs-string"><span class="hljs-string">"logic.h"</span></span> Game::Game(unsigned width, unsigned height) : _asteroids(std::vector&lt;AsteroidFamily *&gt;()), _shots(std::vector&lt;Shot *&gt;()), _booms(std::vector&lt;Boom *&gt;()), _score(<span class="hljs-number"><span class="hljs-number">0</span></span>), _livesBonus(<span class="hljs-number"><span class="hljs-number">10000</span></span>), _level(<span class="hljs-number"><span class="hljs-number">0</span></span>), _isAsteroidsEmpty(<span class="hljs-literal"><span class="hljs-literal">true</span></span>), _gameOver(<span class="hljs-literal"><span class="hljs-literal">false</span></span>), _playerPoints(new std::vector&lt;Point&gt;(<span class="hljs-number"><span class="hljs-number">3</span></span>)), _shotsPoints(new std::vector&lt;Point&gt;(<span class="hljs-number"><span class="hljs-number">4</span></span>)), _boomPoints(new std::vector&lt;Point&gt;(<span class="hljs-number"><span class="hljs-number">8</span></span>)), _lastTimepoint(std::chrono::high_resolution_clock::now()), _lastShotTimepoint(std::chrono::high_resolution_clock::now()), _gameOverTimepoint(std::chrono::high_resolution_clock::now()), _timeMultiplier(<span class="hljs-number"><span class="hljs-number">0.0</span></span>f), _width(width), _height(height), _aspectRatio((float)width / (float)height), _render(new GL(&amp;_aspectRatio, &amp;_halfWidth, &amp;_halfHeight)), _controls(new Controls(&amp;_width, &amp;_height, &amp;_halfWidth, &amp;_halfHeight)) { _halfHeight = GAME_HEIGHT; _halfWidth = _aspectRatio * _halfHeight; _playerPoints = new std::vector&lt;Point&gt;(<span class="hljs-number"><span class="hljs-number">3</span></span>); (*_playerPoints)[<span class="hljs-number"><span class="hljs-number">0</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.6</span></span>f; (*_playerPoints)[<span class="hljs-number"><span class="hljs-number">0</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_playerPoints)[<span class="hljs-number"><span class="hljs-number">1</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.6</span></span>f; (*_playerPoints)[<span class="hljs-number"><span class="hljs-number">1</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_playerPoints)[<span class="hljs-number"><span class="hljs-number">2</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.6</span></span>f; (*_playerPoints)[<span class="hljs-number"><span class="hljs-number">2</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>f; _shotsPoints = new std::vector&lt;Point&gt;(<span class="hljs-number"><span class="hljs-number">4</span></span>); (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">0</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">0</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">1</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">1</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">2</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">2</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">3</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.02</span></span>f; (*_shotsPoints)[<span class="hljs-number"><span class="hljs-number">3</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.02</span></span>f; _boomPoints = new std::vector&lt;Point&gt;(<span class="hljs-number"><span class="hljs-number">8</span></span>); (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">0</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.1</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">0</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.1</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">1</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">1</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.4</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">2</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.1</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">2</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.2</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">3</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">3</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.4</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">4</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.2</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">4</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.1</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">5</span></span>].x = <span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">5</span></span>].y = -<span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">6</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.1</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">6</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.2</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">7</span></span>].x = -<span class="hljs-number"><span class="hljs-number">0.5</span></span>f; (*_boomPoints)[<span class="hljs-number"><span class="hljs-number">7</span></span>].y = <span class="hljs-number"><span class="hljs-number">0.5</span></span>f; Shot::SetStaticPoints(_shotsPoints); Boom::SetStaticPoints(_boomPoints); Random::Init(&amp;_halfWidth, &amp;_halfHeight); _player = new Player(_playerPoints, <span class="hljs-number"><span class="hljs-number">0.0</span></span>f, <span class="hljs-number"><span class="hljs-number">0.0</span></span>f); } Game::~Game() { delete _player; delete _render; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Shot *item : _shots) delete item; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Boom *item : _booms) delete item; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AsteroidFamily *item : _asteroids) delete item; delete _playerPoints; delete _shotsPoints; delete _boomPoints; } void Game::Refresh() { _controls-&gt;Refresh(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_score &gt;= _livesBonus) { _livesBonus += <span class="hljs-number"><span class="hljs-number">10000</span></span>; _player-&gt;SetLives(_player-&gt;GetLives() + <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_isAsteroidsEmpty) { _level++; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AsteroidFamily *item : _asteroids) delete item; _asteroids.clear(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (unsigned i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; (_level + <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-number"><span class="hljs-number">2</span></span>; ++i) _asteroids.push_back(Random::GenerateAsteroidFamily()); _isAsteroidsEmpty = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } _isAsteroidsEmpty = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; std::chrono::high_resolution_clock::time_point now = std::chrono::high_resolution_clock::now(); auto time_span = std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(now - _lastTimepoint).count(); _timeMultiplier = (float)time_span / <span class="hljs-number"><span class="hljs-number">16666666.67</span></span>f; _lastTimepoint = now; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_controls-&gt;GetHyperspace()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_gameOver) { Random::ChangePlayerCoords(_player); _controls-&gt;SetHyperspace(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(now - _gameOverTimepoint).count() &gt;= GAMEOVER_SCORE_TIME) { _player-&gt;SetCoord(<span class="hljs-number"><span class="hljs-number">0.0</span></span>f, <span class="hljs-number"><span class="hljs-number">0.0</span></span>f); _player-&gt;SetAngle(<span class="hljs-number"><span class="hljs-number">0.0</span></span>f); _player-&gt;SetLives(PLAYER_DEFAULT_LIVES); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AsteroidFamily *item : _asteroids) delete item; _asteroids.clear(); _isAsteroidsEmpty = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; _score = <span class="hljs-number"><span class="hljs-number">0</span></span>; _level = <span class="hljs-number"><span class="hljs-number">0</span></span>; _livesBonus = <span class="hljs-number"><span class="hljs-number">10000</span></span>; _gameOver = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; _controls-&gt;SetHyperspace(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_player-&gt;GetIsGhost() &amp;&amp; !_gameOver) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_player-&gt;GetIsRendering()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(now - _player-&gt;GetDeadTime()).count() &gt;= PLAYER_BLACKOUT_TIME) { _player-&gt;SetIsRendering(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(now - _player-&gt;GetDeadTime()).count() &gt;= PLAYER_GHOST_TIME) { _player-&gt;SetIsGhost(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_player-&gt;GetLives() &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; !_gameOver) { _gameOver = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; _gameOverTimepoint = now; _player-&gt;SetIsGhost(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); _player-&gt;Stop(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_player-&gt;GetIsRendering() &amp;&amp; !_gameOver) { RefreshObjectCoord(_player); _player-&gt;Refresh(_controls-&gt;GetAngle(), _controls-&gt;GetAcceleration()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_controls-&gt;GetShoot()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(now - _lastShotTimepoint).count() &gt;= NEXT_SHOT_TIME) { _shots.push_back(_player-&gt;GenerateShot()); _lastShotTimepoint = now; } } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (auto it = _shots.begin(); it != _shots.end();) { RefreshObjectCoord(*it); (*it)-&gt;Refresh(_timeMultiplier); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*it)-&gt;GetDistance() &gt;= std::min(_halfHeight, _halfWidth) * <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">1.2</span></span>f) { delete(*it); it = _shots.erase(it); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++it; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AsteroidFamily *item : _asteroids) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetLarge()-&gt;GetIsRendering()) { _isAsteroidsEmpty = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; RefreshObjectCoord(item-&gt;GetLarge()); item-&gt;GetLarge()-&gt;Refresh(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_player-&gt;GetIsGhost()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollision(_player, item-&gt;GetLarge())) { item-&gt;DestroyLarge(); _score += SCORE_LARGE; ProcessCollision(_player, item-&gt;GetLarge()); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetLarge()-&gt;GetIsRendering()) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (auto it = _shots.begin(); it != _shots.end();) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollision(*it, item-&gt;GetLarge())) { delete(*it); it = _shots.erase(it); item-&gt;DestroyLarge(); _booms.push_back(new Boom(item-&gt;GetLarge()-&gt;GetCoord().x, item-&gt;GetLarge()-&gt;GetCoord().y)); _score += SCORE_LARGE; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++it; } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetFirstSmall()-&gt;GetIsRendering()) { _isAsteroidsEmpty = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; RefreshObjectCoord(item-&gt;GetFirstSmall()); item-&gt;GetFirstSmall()-&gt;Refresh(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_player-&gt;GetIsGhost()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollision(_player, item-&gt;GetFirstSmall())) { item-&gt;GetFirstSmall()-&gt;SetIsRendering(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); _score += SCORE_SMALL; ProcessCollision(_player, item-&gt;GetFirstSmall()); } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetSecondSmall()-&gt;GetIsRendering()) { _isAsteroidsEmpty = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; RefreshObjectCoord(item-&gt;GetSecondSmall()); item-&gt;GetSecondSmall()-&gt;Refresh(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_player-&gt;GetIsGhost()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollision(_player, item-&gt;GetSecondSmall())) { item-&gt;GetSecondSmall()-&gt;SetIsRendering(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); _score += SCORE_SMALL; ProcessCollision(_player, item-&gt;GetSecondSmall()); } } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (auto it = _shots.begin(); it != _shots.end();) { <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> isFirstCollision = <span class="hljs-literal"><span class="hljs-literal">false</span></span>, isSecondCollision = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetFirstSmall()-&gt;GetIsRendering()) isFirstCollision = isCollision(*it, item-&gt;GetFirstSmall()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetSecondSmall()-&gt;GetIsRendering()) isSecondCollision = isCollision(*it, item-&gt;GetSecondSmall()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFirstCollision || isSecondCollision) { delete(*it); it = _shots.erase(it); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFirstCollision) { item-&gt;GetFirstSmall()-&gt;SetIsRendering(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); _booms.push_back(new Boom(item-&gt;GetFirstSmall()-&gt;GetCoord().x, item-&gt;GetFirstSmall()-&gt;GetCoord().y)); _score += SCORE_SMALL; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isSecondCollision) { item-&gt;GetSecondSmall()-&gt;SetIsRendering(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); _booms.push_back(new Boom(item-&gt;GetSecondSmall()-&gt;GetCoord().x, item-&gt;GetSecondSmall()-&gt;GetCoord().y)); _score += SCORE_SMALL; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++it; } } } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (auto it = _booms.begin(); it != _booms.end();) { (*it)-&gt;Refresh(_timeMultiplier); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*it)-&gt;GetDuration() &gt;= BOOM_MAX_DURATION) { delete(*it); it = _booms.erase(it); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++it; } } } void Game::RefreshObjectCoord(Object *object) { object-&gt;SetCoord(object-&gt;GetCoord().x + object-&gt;GetVelocity().x * _timeMultiplier, object-&gt;GetCoord().y + object-&gt;GetVelocity().y * _timeMultiplier); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (object-&gt;GetCoord().x &lt;= -_halfWidth) object-&gt;SetCoord(object-&gt;GetCoord().x + _halfWidth * <span class="hljs-number"><span class="hljs-number">2</span></span>, object-&gt;GetCoord().y); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (object-&gt;GetCoord().x &gt;= _halfWidth) object-&gt;SetCoord(object-&gt;GetCoord().x - _halfWidth * <span class="hljs-number"><span class="hljs-number">2</span></span>, object-&gt;GetCoord().y); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (object-&gt;GetCoord().y &lt;= -_halfHeight) object-&gt;SetCoord(object-&gt;GetCoord().x, object-&gt;GetCoord().y + _halfHeight * <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (object-&gt;GetCoord().y &gt;= _halfHeight) object-&gt;SetCoord(object-&gt;GetCoord().x, object-&gt;GetCoord().y - _halfHeight * <span class="hljs-number"><span class="hljs-number">2</span></span>); } void Game::Render() { Refresh(); _render-&gt;Clear(); _render-&gt;RenderControls(_controls); _render-&gt;SetColor(OBJECTS_COLOR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_player-&gt;GetIsRendering() &amp;&amp; !_gameOver) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_player-&gt;GetIsGhost()) _render-&gt;SetColor(PLAYER_GHOST_COLOR); _render-&gt;RenderPlayer(_player); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_gameOver) _render-&gt;SetColor(OBJECTS_GAMEOVER_COLOR); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> _render-&gt;SetColor(OBJECTS_COLOR); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (AsteroidFamily *item : _asteroids) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetLarge()-&gt;GetIsRendering()) { _render-&gt;RenderAsteroid(item-&gt;GetLarge()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetFirstSmall()-&gt;GetIsRendering()) { _render-&gt;RenderAsteroid(item-&gt;GetFirstSmall()); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item-&gt;GetSecondSmall()-&gt;GetIsRendering()) { _render-&gt;RenderAsteroid(item-&gt;GetSecondSmall()); } } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Shot *item : _shots) { _render-&gt;RenderShot(item); } _render-&gt;SetColor(BOOM_COLOR); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Boom *item : _booms) { _render-&gt;RenderBoom(item); } _render-&gt;SetColor(TEXT_COLOR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_gameOver) { _render-&gt;RenderScoreAndLives(_score, _player-&gt;GetLives()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _render-&gt;RenderGameOver(_score); } } <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> Game::isCollision(Player *player, Asteroid *asteroid) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> std::vector&lt;Point&gt; &amp;playerPoints = *(player-&gt;GetPoints()); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> std::vector&lt;Point&gt; &amp;asteroidPoints = *(asteroid-&gt;GetPoints()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TestAABB(player, asteroid)) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (unsigned i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; playerPoints.size(); i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (unsigned j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; asteroidPoints.size(); j++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Logic::IsLinesCross(playerPoints[i], playerPoints[(i + <span class="hljs-number"><span class="hljs-number">1</span></span> == playerPoints.size()) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : i + <span class="hljs-number"><span class="hljs-number">1</span></span>], asteroidPoints[j], asteroidPoints[(j + <span class="hljs-number"><span class="hljs-number">1</span></span> == asteroidPoints.size()) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : j + <span class="hljs-number"><span class="hljs-number">1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Logic::IsInside(asteroidPoints, playerPoints[<span class="hljs-number"><span class="hljs-number">0</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> Game::isCollision(Shot *shot, Asteroid *asteroid) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Logic::IsInside(*(asteroid-&gt;GetPoints()), shot-&gt;GetCoord())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> Game::TestAABB(Player *player, Asteroid *asteroid) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (player-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt; asteroid-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp;&amp; player-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; asteroid-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; player-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt; asteroid-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">3</span></span>] &amp;&amp; player-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">3</span></span>] &gt; asteroid-&gt;GetSizes()[<span class="hljs-number"><span class="hljs-number">2</span></span>]); } void Game::ProcessCollision(Player *player, Asteroid *asteroid) { _booms.push_back(new Boom(asteroid-&gt;GetCoord().x, asteroid-&gt;GetCoord().y)); player-&gt;SetIsRendering(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); player-&gt;SetIsGhost(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); player-&gt;SetLives(player-&gt;GetLives() - <span class="hljs-number"><span class="hljs-number">1</span></span>); player-&gt;SetCoord(<span class="hljs-number"><span class="hljs-number">0.0</span></span>f, <span class="hljs-number"><span class="hljs-number">0.0</span></span>f); player-&gt;SetDeadTime(std::chrono::high_resolution_clock::now()); } void Game::Resize(float width, float height) { _aspectRatio = (float)width / (float)height; _halfWidth = _aspectRatio * _halfHeight; _width = width; _height = height; _render-&gt;Resize(); } Controls *Game::GetControls() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _controls; } <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> Game::GetIsPaused() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _isPaused; } void Game::SetIsPaused(<span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> isPaused) { _isPaused = isPaused; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Game.cpp</b> <div class="spoiler_text"><pre> <code class="hljs lua">#include &lt;Game.h&gt; #include &lt;Controls.h&gt; #include &lt;tuple&gt; Game::Game() { isLevelRunning = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; ResetLogic(); RequestRestart(); Renderer::InitInternals(); Controls::Init(); Score::Init(); } Game&amp; Game::Get() { static Game instance; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> instance; } void Game::Restart() { objects.clear(); Score::OnRestart(); ResetLogic(); GameObject::Create&lt;Ship&gt;(); SpawnAsteroids(Constant::asteroidTargetCount); } //  ,       (<span class="hljs-literal"><span class="hljs-literal">false</span></span> -  ) bool Game::IsLevelRunning(float dt) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(wantRestart) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(restartTimer &lt; <span class="hljs-number"><span class="hljs-number">0.0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(isLevelRunning) { Restart(); wantRestart = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { restartTimer -= dt; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isLevelRunning; } void Game::Update() { float deltaTime = timer.Tick(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(IsLevelRunning(deltaTime)) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(auto&amp; go : objects) { go-&gt;Update(deltaTime); } DetectCollisions(deltaTime); DestroyRequestedObjects(); //     } Renderer::Draw(); } void Game::OnGLInit() { Renderer::InitGLContext(); } void Game::OnResolutionChange(int w, int h) { Renderer::OnResolutionChange(w, h); Controls::Resize(); Score::Resize(); } GameObject&amp; Game::AddGameObject(std::unique_ptr&lt;GameObject&gt; obj) { objects.push_back(std::move(obj)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *objects.back().get(); } void Game::DestroyRequestedObjects() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(auto i = objects.begin(); i != objects.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>();) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((*i)-&gt;isDestructionRequested()) { i = objects.erase(i); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++i; } } } void Game::DetectCollisions(float dt) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(auto a = objects.begin(); a != objects.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); ++a) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(auto b = std::<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(a); b != objects.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); ++b) { //    GameObject&amp; ra = **a; GameObject&amp; rb = **b; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(CollisionMask(ra, rb)) { //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(DetectCollision(ra, rb, dt)) { //  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(RefineCollision(ra, rb, dt)) { //  ra.OnCollision(rb); rb.OnCollision(ra); } } } } } } bool Game::CollisionMask(const GameObject&amp; a, const GameObject&amp; b) { //      ,       (<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !(a.isDestructionRequested() || b.isDestructionRequested()) &amp;&amp; //          ,   <span class="hljs-literal"><span class="hljs-literal">false</span></span> (a.CollisionMask(b.getStaticType()) || b.CollisionMask(a.getStaticType())); } //    ,    //      ,       dt bool Game::DetectCollision(const GameObject&amp; a, const GameObject&amp; b, float dt) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Constant::continuousCollisions) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a.getPosition() - b.getPosition()).getLength() &lt; a.getRadius() + b.getRadius() + (a.getVelocity().getLength() + b.getVelocity().getLength()) * dt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a.getPosition() - b.getPosition()).getLength() &lt; a.getRadius() + b.getRadius(); } } bool Game::RefineCollision(const GameObject&amp; a, const GameObject&amp; b, float dt) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Constant::refineCollisions) { const Model&amp; am = a.getModel(); const std::vector&lt;GLfloat&gt;&amp; av = am.getTransformed(); const std::vector&lt;GLubyte&gt;&amp; ai = am.getIndices(); const Vec2 aBackVel = a.getVelocity() * <span class="hljs-number"><span class="hljs-number">-1</span></span>; const Model&amp; bm = b.getModel(); const std::vector&lt;GLfloat&gt;&amp; bv = bm.getTransformed(); const std::vector&lt;GLubyte&gt;&amp; bi = bm.getIndices(); const Vec2 bBackVel = b.getVelocity() * <span class="hljs-number"><span class="hljs-number">-1</span></span>; //    ,      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; ai.size(); i += <span class="hljs-number"><span class="hljs-number">2</span></span>) { Vec2 a0(i, av, ai); Vec2 at = Vec2(i + <span class="hljs-number"><span class="hljs-number">1</span></span>, av, ai) - a0; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; bi.size(); j += <span class="hljs-number"><span class="hljs-number">2</span></span>) { Vec2 b0(j, bv, bi); Vec2 bt = Vec2(j + <span class="hljs-number"><span class="hljs-number">1</span></span>, bv, bi) - b0; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Constant::continuousCollisions ? // ,       t0, //     t0+dt,      - MovingSegmentCollision(a0, at, aBackVel, b0, bt, bBackVel, dt) : SegmentCollision(a0, at, b0, bt)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } bool Game::SegmentCollision(Vec2 p, Vec2 r, Vec2 q, Vec2 s) { //http://stackoverflow.com/a/<span class="hljs-number"><span class="hljs-number">565282</span></span>/<span class="hljs-number"><span class="hljs-number">2502024</span></span> float det = Vec2::CrossProd2D(r, s); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fabs(det) &gt; Constant::smallNumber) { Vec2 diff = q - p; float f = Vec2::CrossProd2D(diff, s / det); float g = Vec2::CrossProd2D(diff, r / det); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; f &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; g &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; g &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } bool Game::MovingSegmentCollision(Vec2 p, Vec2 r, Vec2 vp, Vec2 q, Vec2 s, Vec2 vq, float dt) { float det = Vec2::CrossProd2D(r, s); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fabs(det) &gt; Constant::smallNumber) { const Vec2 v = vq - vp; const Vec2 diff = q - p; //    : //q = q0 + v*t, t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-number"><span class="hljs-number">0</span></span>, dt] //(vx * sy - vy * sx) * t + ((qx - px) * sy - (qy - py) * sx) //  f  g  SegmentCollision    t. //    t  [<span class="hljs-number"><span class="hljs-number">0</span></span>, dt],    t, // f  g    [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]. ..  <span class="hljs-number"><span class="hljs-number">3</span></span>    t auto getInequation = [=](Vec2 dir)-&gt;std::tuple&lt;float, float&gt; { //<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;= a*t + cp &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span> float cp = Vec2::CrossProd2D(diff, dir / det); float a = Vec2::CrossProd2D(v, dir / det); float left = -cp, right = <span class="hljs-number"><span class="hljs-number">1</span></span> - cp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fabs(a) &lt; Constant::smallNumber) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(cp &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; cp &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>) { left = <span class="hljs-number"><span class="hljs-number">0</span></span>; right = dt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { left = dt + <span class="hljs-number"><span class="hljs-number">1</span></span>; right = <span class="hljs-number"><span class="hljs-number">-1</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { left /= a; right /= a; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) std::swap(left, right); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> std::make_tuple(left, right); }; float ls, rs, lr, rr; //ls &lt;= t &lt;= rs std::tie(ls, rs) = getInequation(s); //lr &lt;= t &lt;= rr std::tie(lr, rr) = getInequation(r); //  <span class="hljs-number"><span class="hljs-number">0</span></span> &lt;= t &lt;= dt float mx = std::<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-number"><span class="hljs-number">0.</span></span>f, std::<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(ls, lr)); float mn = std::<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>(dt, std::<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>(rs, rr)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mx &lt;= mn; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } void Game::RequestRestart(float t) { wantRestart = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; restartTimer = t; } void Game::Pause() { isLevelRunning = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; Controls::onPause(); } void Game::Resume() { isLevelRunning = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; Controls::onResume(); timer.Tick(); } void Game::SetPlayerPos(const Ship&amp; player) { playerPos = player.getPosition(); } Vec2 Game::GetPlayerPos() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> playerPos; } void Game::AddPoints(int pointsToAdd) { Score::AddPoints(pointsToAdd); } void Game::DecAsteroidCount(const Asteroid&amp; a) { asteroidCount<span class="hljs-comment"><span class="hljs-comment">--; if(asteroidCount == Constant::asteroidUfoCount * 2 &amp;&amp; !isUfoPresent) { GameObject::Create&lt;UFO&gt;(GetUfoSpawn()); } if(asteroidCount &lt;= Constant::asteroidRespawnCount * 2) { SpawnAsteroids(Constant::asteroidTargetCount - Constant::asteroidRespawnCount); } } //  2, .. asteroidCount      void Game::IncAsteroidCount(const Asteroid&amp; a) { asteroidCount += 2; } void Game::ResetLogic() { asteroidCount = 0; isUfoPresent = false; } void Game::SpawnAsteroids(int n) { for(int i = 0; i &lt; n; ++i) { GameObject::Create&lt;Asteroid&gt;(GetSpawnPosition()); } } //  ,      (    ) Transform Game::GetSpawnPosition() { std::uniform_real_distribution&lt;float&gt; zone(-Constant::asteroidSpawnZone, Constant::asteroidSpawnZone); Vec2 pos(Constant::worldRatio + 0.2, 1.2); if(fabs(playerPos.x) &gt; Constant::asteroidSpawnZone &amp;&amp; fabs(playerPos.y) &lt; Constant::asteroidSpawnZone) { pos.y = zone(Random::generator); } else if(fabs(playerPos.x) &lt; Constant::asteroidSpawnZone &amp;&amp; fabs(playerPos.y) &gt; Constant::asteroidSpawnZone) { pos.x = zone(Random::generator); } else { if(Random::flipCoin()) { pos.x = zone(Random::generator); } else { pos.y = zone(Random::generator); } } return Transform(pos); } Transform Game::GetUfoSpawn() { std::uniform_real_distribution&lt;float&gt; zone(-Constant::ufoZone, Constant::ufoZone); return Transform((Constant::worldRatio + 0.12) * (playerPos.x &gt; 0 ? -1 : 1), zone(Random::generator)); } void Game::OnUfoCreated(const UFO&amp; u) { isUfoPresent = true; } void Game::OnUfoDestroyed(const UFO&amp; u) { isUfoPresent = false; }</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">model_handler.cpp</b> <div class="spoiler_text"><pre> <code class="hljs rust">#include <span class="hljs-string"><span class="hljs-string">"model_handler.h"</span></span> #include &lt;time.h&gt; #include &lt;math.h&gt; #include &lt;cstdlib&gt; using namespace model; namespace { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> double tickTime = <span class="hljs-number"><span class="hljs-number">40.00</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> unsigned int asteroidNumber = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float projectileSpeed = <span class="hljs-number"><span class="hljs-number">10.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float smallAsteroidRadiusK = <span class="hljs-number"><span class="hljs-number">1.5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float minLargeAsteroidRadius = <span class="hljs-number"><span class="hljs-number">35.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float maxLargeAsteroidRadius = minLargeAsteroidRadius * smallAsteroidRadiusK - <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float minAsteroidSpeed = <span class="hljs-number"><span class="hljs-number">1.5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float maxAsteroidSpeed = <span class="hljs-number"><span class="hljs-number">6.5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float explosionK = <span class="hljs-number"><span class="hljs-number">50000.0</span></span>; } ModelHandler::ModelHandler(float worldWidth, float worldHeight): _isGameOver(<span class="hljs-literal"><span class="hljs-literal">false</span></span>), _worldWidth(worldWidth), _worldHeight(worldHeight), _tickTime(<span class="hljs-number"><span class="hljs-number">0</span></span>), _ship(ShipPtr(new Ship(Point(worldWidth / <span class="hljs-number"><span class="hljs-number">2.0</span></span>, worldHeight / <span class="hljs-number"><span class="hljs-number">2.0</span></span>)))) { srand(time(<span class="hljs-number"><span class="hljs-number">0</span></span>)); } void ModelHandler::newGame() { _asteroids.clear(); _projectiles.clear(); _ship.reset(new Ship(Point(_worldWidth / <span class="hljs-number"><span class="hljs-number">2.0</span></span>, _worldHeight / <span class="hljs-number"><span class="hljs-number">2.0</span></span>))); _isGameOver = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> ModelHandler::isGameOver() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _isGameOver; } void ModelHandler::update(double deltaTime) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (this-&gt;isGameOver()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; _tickTime += deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (_tickTime &gt; tickTime) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_asteroids.size() &lt; ::asteroidNumber) { this-&gt;addAsteroid(); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ObjectPtr&amp; obj: this-&gt;allObjects()) { obj-&gt;<span class="hljs-keyword"><span class="hljs-keyword">move</span></span>(); } this-&gt;checkObjects(&amp;_asteroids); this-&gt;checkObjects(&amp;_projectiles); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!this-&gt;withinBoundaries(_ship)) { this-&gt;removeShip(); } _tickTime -= tickTime; } } ShipPtr ModelHandler::ship() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _ship; } void ModelHandler::removeShip() { _isGameOver = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } void ModelHandler::removeAsteroid(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AsteroidPtr&amp; asteroid) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (asteroid-&gt;collisionRadius() &gt;= ::minLargeAsteroidRadius) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> model::Vector v1(asteroid-&gt;velocity() + model::Vector(-asteroid-&gt;velocity().y, asteroid-&gt;velocity().x)); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> model::Vector v2(asteroid-&gt;velocity() + model::Vector(asteroid-&gt;velocity().y, -asteroid-&gt;velocity().x)); this-&gt;addAsteroid(asteroid, v1); this-&gt;addAsteroid(asteroid, v2); } _asteroids.remove(asteroid); } void ModelHandler::addAsteroid(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AsteroidPtr&amp; asteroid) { _asteroids.push_back(asteroid); } std::list&lt;AsteroidPtr&gt; ModelHandler::asteroids() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _asteroids; } std::list&lt;ProjectilePtr&gt; ModelHandler::projectiles() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _projectiles; } void ModelHandler::removeProjectile(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ProjectilePtr&amp; projectile) { _projectiles.remove(projectile); } void ModelHandler::addProjectile() { Vector projectileSpeed = _ship-&gt;direction() * ::projectileSpeed + ship()-&gt;velocity(); _projectiles.push_back(ProjectilePtr(new Projectile(_ship-&gt;point(), projectileSpeed))); } void ModelHandler::processHit(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ProjectilePtr&amp; projectile, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AsteroidPtr&amp; asteroid) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (asteroid-&gt;collisionRadius() &gt;= ::minLargeAsteroidRadius) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Vector ox = asteroid-&gt;velocity().normaVector(); Vector explosionVector(ox.y, -ox.x); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ox * asteroid-&gt;velocity() &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { explosionVector = explosionVector * (-<span class="hljs-number"><span class="hljs-number">1.0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Vector v1(asteroid-&gt;velocity() + model::Vector(-asteroid-&gt;velocity().y, asteroid-&gt;velocity().x) + explosionVector * (-::explosionK / asteroid-&gt;mass())); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Vector v2(asteroid-&gt;velocity() + model::Vector(asteroid-&gt;velocity().y, -asteroid-&gt;velocity().x) + explosionVector * (::explosionK / asteroid-&gt;mass())); this-&gt;addAsteroid(asteroid, v1); this-&gt;addAsteroid(asteroid, v2); } _projectiles.remove(projectile); _asteroids.remove(asteroid); } std::list&lt;ObjectPtr&gt; ModelHandler::allObjects() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { std::list&lt;ObjectPtr&gt; objects; objects.insert(objects.end(), _asteroids.begin(), _asteroids.end()); objects.insert(objects.end(), _projectiles.begin(), _projectiles.end()); objects.push_back(_ship); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objects; } void ModelHandler::addAsteroid() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float r = common::rangeRand(::minLargeAsteroidRadius, ::maxLargeAsteroidRadius); Point point; <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> isCorrect = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!isCorrect) { point = randPoint(r); isCorrect = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AsteroidPtr&amp; asteroid : _asteroids) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float d = model::distance(asteroid-&gt;point(), point); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (d &lt; (asteroid-&gt;collisionRadius() + r)) { isCorrect = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float distToCenter = ::distance(point.x, point.y, _worldWidth / <span class="hljs-number"><span class="hljs-number">2.0</span></span>, _worldHeight / <span class="hljs-number"><span class="hljs-number">2.0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float vx = (_worldWidth / <span class="hljs-number"><span class="hljs-number">2.0</span></span> - point.x) / distToCenter * common::rangeRand(::minAsteroidSpeed, ::maxAsteroidSpeed); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float vy = (_worldHeight / <span class="hljs-number"><span class="hljs-number">2.0</span></span> - point.y) / distToCenter * common::rangeRand(::minAsteroidSpeed, ::maxAsteroidSpeed); _asteroids.push_back(AsteroidPtr(new Asteroid(point, r, Vector(vx, vy)))); } void ModelHandler::addAsteroid(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AsteroidPtr&amp; oldAsteroid, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Vector&amp; newVelocity) { Point point = oldAsteroid-&gt;point(); point.<span class="hljs-keyword"><span class="hljs-keyword">move</span></span>(newVelocity.normaVector() * oldAsteroid-&gt;collisionRadius()); _asteroids.push_back(AsteroidPtr(new Asteroid(point, oldAsteroid-&gt;collisionRadius() / ::smallAsteroidRadiusK, newVelocity))); } Point ModelHandler::randPoint(float r) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { float x = <span class="hljs-number"><span class="hljs-number">0</span></span>; float y = <span class="hljs-number"><span class="hljs-number">0</span></span>; switch (rand() % <span class="hljs-number"><span class="hljs-number">4</span></span>) { case <span class="hljs-number"><span class="hljs-number">0</span></span>: x = common::rangeRand(<span class="hljs-number"><span class="hljs-number">0</span></span> - r, _worldWidth + r); y = <span class="hljs-number"><span class="hljs-number">0</span></span> - r; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">1</span></span>: x = common::rangeRand(<span class="hljs-number"><span class="hljs-number">0</span></span> - r, _worldWidth + r); y = _worldHeight - r; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">2</span></span>: x = <span class="hljs-number"><span class="hljs-number">0</span></span> - r; y = common::rangeRand(<span class="hljs-number"><span class="hljs-number">0</span></span> - r, _worldHeight + r); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; case <span class="hljs-number"><span class="hljs-number">3</span></span>: x = _worldWidth + r; y = common::rangeRand(<span class="hljs-number"><span class="hljs-number">0</span></span> - r, _worldHeight + r); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Point(x, y); } <span class="hljs-built_in"><span class="hljs-built_in">bool</span></span> ModelHandler::withinBoundaries(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ObjectPtr&amp; obj) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (obj-&gt;x() &gt; (<span class="hljs-number"><span class="hljs-number">0</span></span> - _worldWidth * <span class="hljs-number"><span class="hljs-number">0.1</span></span>) &amp;&amp; obj-&gt;x() &lt; (_worldWidth * <span class="hljs-number"><span class="hljs-number">1.1</span></span>) &amp;&amp; obj-&gt;y() &gt; (<span class="hljs-number"><span class="hljs-number">0</span></span> - _worldHeight * <span class="hljs-number"><span class="hljs-number">0.1</span></span>) &amp;&amp; obj-&gt;y() &lt; (_worldHeight * <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); } template&lt;class T&gt; void ModelHandler::checkObjects(std::list&lt;T&gt;* objects) { typename std::list&lt;T&gt;::iterator it = objects-&gt;begin(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (it != objects-&gt;end()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!this-&gt;withinBoundaries(*it)) { it = objects-&gt;erase(it++); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++it; } } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の意見では、リストされたテストタスクの中で、1つだけが目立っています。</font><font style="vertical-align: inherit;">すべての著者をインタビューに招待しました。</font><font style="vertical-align: inherit;">ある候補者が他の候補者とどのように異なっていたか推測できますか？</font><font style="vertical-align: inherit;">私にとって、次のテストを見るとほとんど明らかですが、友人は信じていません。</font></font></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J25400/index.html">キビバイト</a></li>
<li><a href="../J254001/index.html">ベルリンで、開発者はスマートカーのビジョンを示しました</a></li>
<li><a href="../J254003/index.html">公共端末のセキュリティ分析</a></li>
<li><a href="../J254005/index.html">Chromeの拡張機能「Vkontakteから音声をダウンロード」を作成します</a></li>
<li><a href="../J254007/index.html">Chromeデベロッパーツールについて知っておくべき15のヒントとコツ</a></li>
<li><a href="../J254011/index.html">XenServerで失われたLVMボリュームを回復する</a></li>
<li><a href="../J254015/index.html">自宅での透視の経験</a></li>
<li><a href="../J254017/index.html">百倍同じこと</a></li>
<li><a href="../J25402/index.html">E：TextMate for Windowsのすべてのパス</a></li>
<li><a href="../J254025/index.html">マイクロソフトはストライキに行きます！ 会議への参加の詳細</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>