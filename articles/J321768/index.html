<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏾 👈🏿 🖕🏼 Visual StudioおよびIISExpressでデバッグするときにランタイムでWeb.configコンテンツを変更する ➖ 👨🏿‍🎓 ✡️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="技術的には、この記事は新しいものではなく、特定の問題を解決するためのwinapiフックのもう1つの便利なアプリケーションです。 
  
 
  
 Visual StudioでWebプロジェクトを操作するとき、不快な些細なことが1つあります-開発プロセス中に複数のブランチを使用し、それぞれが環境の独...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Visual StudioおよびIISExpressでデバッグするときにランタイムでWeb.configコンテンツを変更する</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/321768/"> 技術的には、この記事は新しいものではなく、特定の問題を解決するためのwinapiフックのもう1つの便利なアプリケーションです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Visual StudioでWebプロジェクトを操作するとき、不快な些細なことが1つあります-開発プロセス中に複数のブランチを使用し、それぞれが環境の独自のコピー（データベース、または外部サービスなど）を使用する必要がある場合、デバッグ時に構成ファイルに問題があります-IISExpressは、プロジェクトフォルダー内のメインweb.configのみを使用します。通常、すべての接続文字列にはデフォルト値が含まれ、ブランチ固有の設定はなく、起動時に変換は適用されません。 もちろん、自動または手動で強制的にweb.configに変換を適用できますが、最初に、変更されたファイルは保留中の変更で常にハングします。これにより、不要な変更がコミットされて他のブランチに移動するリスクが生じ、次に多くのファイルが作成されます構成ファイルへの変更をコミットする前に、そのような変換を手動で削除する必要があるため、編集する際に不便です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これを回避する方法を検討してください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ソリューションは非常に簡単です-IISExpressプロセスによる構成ファイルの読み取りをインターセプトする必要があり、ソースファイルの代わりに、別のファイル、対応する修正が行われ、ソース管理に追加されていない一時ファイルをスリップします。 プロジェクトの起動元のフォルダーに応じて適用する必要がある修正のリストは、たとえば単純なxmlファイルで指定できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これを行うには、次のものが必要です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     新しいプロセス、フック付き32ビットおよび64ビットdll、バックグラウンドユーティリティによって実行される32ビットおよび64ビットexeの作成を監視し、フック付きの対応するdllを対応するビット深度のプロセスにロードするバックグラウンドユーティリティ。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     バックグラウンドユーティリティは、ManagementEventWatcherクラスと、Win32_Processオブジェクトの種類と必要なプロセス名によるフィルタリングを使用した__InstanceOperationEventへの要求を使用して、WMIを通じてプロセスを監視します。  ____InstanceCreationEventイベントを受け取ることは、プロセスが作成されたことを意味し、その情報はEventArrivedEventArgs.NewEventから取得できます。 この場合、必要なのはProcessIdのみです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cs hljs">processWatcher.Query.QueryString = <span class="hljs-string"><span class="hljs-string">@"SELECT * FROM __InstanceOperationEvent WITHIN 1"</span></span> + <span class="hljs-string"><span class="hljs-string">"WHERE TargetInstance ISA 'Win32_Process' AND ("</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Join(<span class="hljs-string"><span class="hljs-string">" OR "</span></span>, processNames.Select(x =&gt; <span class="hljs-string"><span class="hljs-string">"TargetInstance.Name = '"</span></span> + x + <span class="hljs-string"><span class="hljs-string">".exe'"</span></span>)) + <span class="hljs-string"><span class="hljs-string">")"</span></span>; processWatcher.EventArrived += (sender, e) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.NewEvent.ClassPath.ClassName == <span class="hljs-string"><span class="hljs-string">"__InstanceCreationEvent"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> processId = (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)((ManagementBaseObject)e.NewEvent[<span class="hljs-string"><span class="hljs-string">"TargetInstance"</span></span>]) .Properties[<span class="hljs-string"><span class="hljs-string">"ProcessId"</span></span>].Value; <span class="hljs-comment"><span class="hljs-comment">// ... Do smth useful } };</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DLLを外部プロセスにロードするアルゴリズムは標準です-外部プロセスでは、VirtualAllocExを介してメモリがdllへのパスの下に割り当てられ、LoadLibraryアドレスをCreateRemoteThreadに渡すことでストリームが作成されます。 フック初期化コードがDllMainにある場合、追加のアクションは必要ありません。 ただし、バックグラウンドユーティリティは、32ビットプロセスと64ビットプロセスの両方に同時にdllを個別に実装することはできません。 理論的には、64ビットプロセスからCreateRemoteThreadを呼び出すと、もちろん32ビットプロセスでスレッドを作成できますが、この場合、LoadLibraryはスレッドの関数として使用されます。 そして、最も簡単な方法では、GetProcAddressを使用して、現在のプロセスと同じビット深度のアドレスのみを取得できます。  Kernel32.dllのベースアドレスは固定されているため、同じビット容量の異なるプロセスの場合、関数のアドレスは同じです。 もちろん理論的には、PEヘッダーを手動で解析し、実装に追加のプロセスを使用することはできませんが、これはより複雑です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     もちろん、CreateFileW関数をインターセプトする必要があります。 最初はすべてのコードを完全にC＃で記述しましたが、実際にはこのような基本的な機能をインターセプトすると、マネージコードがたとえばプロセスによって読み込まれたサードパーティライブラリによってDllMainから呼び出されたときに、ローダーロックなどでエラーが発生します。 したがって、Cネイティブdllで処理する必要のあるフックとフィルター呼び出しをインストールする必要がありました。Cネイティブdllは、.configファイルに対してCreateFileWが呼び出された場合にのみマネージdllを読み込み、そこからマネージコードを呼び出します。 フックをインストールするには、 <a href="https://www.codeproject.com/Articles/44326/MinHook-The-Minimalistic-x-x-API-Hooking-Libra">実績のある</a>サードパーティのライブラリ<a href="https://www.codeproject.com/Articles/44326/MinHook-The-Minimalistic-x-x-API-Hooking-Libra">MinHook</a>を使用しました。インターネットには多くの情報があり、その説明については詳しく説明しません。  「Cですべてを完全に実行し、.netアセンブリの束を作成しない方が簡単ではなかった」という質問を誰かが尋ねるかもしれませんが、たぶん退屈です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     フィルタリングロジックは、ファイルが存在すること、ディレクトリではなくファイルであること、名前にweb.configが含まれていること、windows \ microsoft.net \ ...フォルダーにないことを確認する必要があります（システム構成には関心がありません）。 これらのすべての条件が満たされた場合、インターセプターによって元のシステム関数CreateFileWへの呼び出しから受信したHANDLEと、このHANDLEの内容を読み取るマネージハンドラーへのすべてのCreateFileWパラメーターを転送します。 簡単にするために、元のHANDLEを使用して再帰を防ぐことをお勧めします。これにより、同じフックが機能するため、File.ReadAllTextで同じファイルを読み取ることになります。 さらに、受信したコンテンツでは、必要なすべての行が置き換えられ、変更されたコンテンツは、名前が上記のフィルター基準を満たさない一時ファイルに書き込まれます（繰り返しになりません）。  web.configを開いたときと同じパラメーターでこの一時ファイルに対してCreateFileWを呼び出し、CreateFileWインターセプターから受信したHANDLEを返します。 元のハンドルは不要になったため、閉じる必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">フック</b> <div class="spoiler_text"><pre> <code class="cpp hljs">HANDLE WINAPI _CreateFileW( LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile) { DWORD attributes = GetFileAttributesW(lpFileName); HANDLE result = CreateFileWOriginal(lpFileName, dwDesiredAccess, dwShareMode, lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, hTemplateFile); HANDLE newFile = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (attributes != INVALID_FILE_ATTRIBUTES &amp;&amp; (attributes &amp; FILE_ATTRIBUTE_DIRECTORY) == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; (StrStrI(lpFileName, <span class="hljs-string"><span class="hljs-string">L"web.config"</span></span>) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> || StrStrI(lpFileName, <span class="hljs-string"><span class="hljs-string">L"app.config"</span></span>) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) &amp;&amp; StrStrI(lpFileName, <span class="hljs-string"><span class="hljs-string">L"Windows"</span></span>) == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { fileHandler(result, &amp;newFile, dwDesiredAccess, dwShareMode, lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, hTemplateFile); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newFile != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { CloseHandle(result); result = newFile; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">マネージドハンドラー</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetUpdatedConfigF</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr handle, IntPtr newHandleAddress, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> access, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> share, IntPtr securityAttributes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> creationDisposition, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flagsAndAttributes, IntPtr templateFile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (config == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-number"><span class="hljs-number">260</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GetFinalPathNameByHandle(handle, path, (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)path.Capacity, <span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matchedSection = config.FirstOrDefault(x =&gt; path.ToString().IndexOf(x.Branch, StringComparison.OrdinalIgnoreCase) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (matchedSection == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> size = GetFileSize(handle, IntPtr.Zero); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (size == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> buffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[size]; <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> bytesRead; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ReadFile(handle, buffer, (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)buffer.Length, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> bytesRead, IntPtr.Zero)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> content = Encoding.UTF8.GetString(buffer); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> replacement <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> matchedSection.Replacements) content = content.Replace(replacement.Find, replacement.ReplaceWith); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tempFile = Path.GetTempFileName(); MoveFileEx(tempFile, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); File.WriteAllText(tempFile, content); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newHandle = CreateFileW(tempFile, access, share, securityAttributes, creationDisposition, flagsAndAttributes, templateFile); Marshal.WriteIntPtr(newHandleAddress, newHandle); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     フックを持つネイティブdllは、LoadLibraryおよびGetProcAddressを介してマネージdllからハンドラーを呼び出します。 これを行うには、静的メソッドを通常のdll関数としてエクスポートする必要があります。 これは、ildasmで逆アセンブルし、ilコードのメソッドに特別なオプションを追加し、それをdllにアセンブルすることにより、少しシャーマニスティックな方法で行われます。 これについてはインターネットでも多くの記事がありますが、繰り返しはしませんが、「。vtentry」を検索することで簡単に見つけることができます。 ソースコードには、この方法でアセンブリを処理する簡単なユーティリティが含まれています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      IISExpressに加えて、同様の問題はwcfsvchostを介して起動されたwcfサービスにも関連しています。 確かに、この場合、変換の使用は正常に機能しますが、すべてが一貫しているため、変換で余分なファイルを複製せず、Configuration Managerで何も切り替えないように、この場合も考慮します。 いくつかの違いがあります-wcfsvchostはプロセスの開始時にすぐに構成を読み取り、WMIイベントの到着が遅すぎ、必要以上にフックが設定されます。 ただし、構成ファイルへのパスはコマンドライン経由で渡されるため、親プロセスに埋め込み、CreateProcessWをインターセプトする必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この場合の親プロセスはdevenv.exe、つまり  Visual Studio この場合、初期システム関数CreateProcessWを呼び出す前に、マネージハンドラーで、プロセスが作成されるパラメーターの文字列と、修正された文字列が書き込まれる配列のアドレスを渡します。 ハンドラーでは、CommandLineToArgvWを呼び出すことで行がパラメーターに分割され、構成ファイルへのパスがそれらの間で決定され、修正された内容の一時ファイルが同じ方法で作成され、パラメーターのパスがそれに置き換えられます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">フック</b> <div class="spoiler_text"><pre> <code class="cpp hljs">BOOL WINAPI _CreateProcessW(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation) { BOOL result; LPWSTR buffer = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lpCommandLine != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> &amp;&amp; StrStrI(lpCommandLine, <span class="hljs-string"><span class="hljs-string">L".config"</span></span>) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { buffer = (LPWSTR)<span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(BUFFER_SIZE); <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, BUFFER_SIZE); processHandler(lpCommandLine, buffer); lpCommandLine = buffer; } result = CreateProcessWOriginal(lpApplicationName, lpCommandLine, lpProcessAttributes, lpThreadAttributes, bInheritHandles, dwCreationFlags, lpEnvironment, lpCurrentDirectory, lpStartupInfo, lpProcessInformation); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">free</span></span>(buffer); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">マネージドハンドラー</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetUpdatedConfigP</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr commandLine, IntPtr newCommandLine</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> commandLineText = Marshal.PtrToStringUni(commandLine); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numArgs; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> argArray = CommandLineToArgvW(commandLineText, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> numArgs); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argArray != IntPtr.Zero) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pointerArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntPtr[numArgs]; Marshal.Copy(argArray, pointerArray, <span class="hljs-number"><span class="hljs-number">0</span></span>, numArgs); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arguments = pointerArray.Select(x =&gt; Marshal.PtrToStringUni(x)).ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> configFile = arguments.FirstOrDefault(x =&gt; x.EndsWith(<span class="hljs-string"><span class="hljs-string">".config"</span></span>, StringComparison.OrdinalIgnoreCase)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matchedSection = config.FirstOrDefault(x =&gt; configFile.ToString() .IndexOf(x.Branch, StringComparison.OrdinalIgnoreCase) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (matchedSection != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; configFile != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; configFile.StartsWith(<span class="hljs-string"><span class="hljs-string">"/config:"</span></span>, StringComparison.OrdinalIgnoreCase) &amp;&amp; commandLineText.IndexOf(<span class="hljs-string"><span class="hljs-string">"wcfsvchost"</span></span>, StringComparison.OrdinalIgnoreCase) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { configFile = configFile.Substring(<span class="hljs-string"><span class="hljs-string">"/config:"</span></span>.Length); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> content = File.ReadAllText(configFile); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> replacement <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> matchedSection.Replacements) content = content.Replace(replacement.Find, replacement.ReplaceWith); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tempFile = Path.GetTempFileName(); MoveFileEx(tempFile, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); File.WriteAllText(tempFile, content); commandLineText = commandLineText.Replace(configFile, tempFile); } } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } Marshal.Copy(commandLineText.ToCharArray(), <span class="hljs-number"><span class="hljs-number">0</span></span>, newCommandLine, commandLineText.Length); }</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      → <a href="https://github.com/HermanKirshin/IISExpressConfigHook">記事のコード（完璧主義者にresしないでください-これは、エラー処理がなく、多くの仮定がある、急ぎで作られた最小限の作業バージョンです）</a> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J321756/index.html">PostgreSQLを使用したYandex.Mailの成功事例</a></li>
<li><a href="../J321758/index.html">Webシングルサインオン（Web SSO）とIDフェデレーションの統合の紹介</a></li>
<li><a href="../J321760/index.html">SUDOを信頼しないでください。</a></li>
<li><a href="../J321764/index.html">営業部門のテレフォニーの組織とCRMとの統合について</a></li>
<li><a href="../J321766/index.html">状態順によるコンテンツフィルタリング。 RosKomSvobodyの教育的妨害の事例</a></li>
<li><a href="../J321770/index.html">速い読書。 テキストの構造を知って、情報をすばやく吸収する方法</a></li>
<li><a href="../J321772/index.html">仮想クエストの熊手、パート1：ゲームデザイン、開発者、ヘルメットの選択</a></li>
<li><a href="../J321776/index.html">Sublime Text 3 + Vintageでロシア語のテキストを簡単に操作できます</a></li>
<li><a href="../J321780/index.html">トラフィックアービトラージのオファーとバーティカル</a></li>
<li><a href="../J321782/index.html">Template Matchingメソッドに基づいて、ビジネスドキュメントの認識されたページを分類するためのシンプルなテクノロジー</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>