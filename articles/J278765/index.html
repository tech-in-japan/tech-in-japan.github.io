<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‰‘ ğŸ”… ğŸ‘©ğŸ»â€ğŸ¤â€ğŸ‘¨ğŸ¼ AutoCADãŠã‚ˆã³RTree ğŸˆ ğŸ”• ğŸ˜³</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="AutoCADç”¨ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹å ´åˆã€å¤šãã®å ´åˆã€ä¸€é€£ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã§ã®è¿…é€Ÿãªç©ºé–“æ¤œç´¢ã®ã‚¿ã‚¹ã‚¯ã«ç›´é¢ã—ã¾ã™ã€‚ ä½•ã‚ˆã‚Šã‚‚ã€ã“ã®ã‚ˆã†ãªæ¤œç´¢ã¯Rãƒ„ãƒªãƒ¼ã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ 
  
 
  
 ãŸã¨ãˆã°ã€ã€Œæç”»ã•ã‚ŒãŸã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è§£æã—ï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨ãƒ†ã‚­ã‚¹ãƒˆã§æç”»ã•ã‚Œã¾ã™ï¼‰ã€ãã‚Œã‚‰ã‹ã‚‰ACADãƒ†ãƒ¼ãƒ–...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>AutoCADãŠã‚ˆã³RTree</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/278765/">  AutoCADç”¨ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹å ´åˆã€å¤šãã®å ´åˆã€ä¸€é€£ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã§ã®è¿…é€Ÿãªç©ºé–“æ¤œç´¢ã®ã‚¿ã‚¹ã‚¯ã«ç›´é¢ã—ã¾ã™ã€‚ ä½•ã‚ˆã‚Šã‚‚ã€ã“ã®ã‚ˆã†ãªæ¤œç´¢ã¯Rãƒ„ãƒªãƒ¼ã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãŸã¨ãˆã°ã€ã€Œæç”»ã•ã‚ŒãŸã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è§£æã—ï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨ãƒ†ã‚­ã‚¹ãƒˆã§æç”»ã•ã‚Œã¾ã™ï¼‰ã€ãã‚Œã‚‰ã‹ã‚‰ACADãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼ˆã“ã‚Œã‚‰ã¯_tableã‚³ãƒãƒ³ãƒ‰ã§ä½œæˆã•ã‚Œã¾ã™ï¼‰ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://sourceforge.net/projects/cspatialindexrt/">Rãƒ„ãƒªãƒ¼ã®</a>æ—¢è£½ã®<a href="https://sourceforge.net/projects/cspatialindexrt/">å®Ÿè£…ã‚’</a>ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚ãã®ä½¿ç”¨ã¯éå¸¸ã«ç°¡å˜ã§ã™ãŒã€ãã‚ŒãŒæ©Ÿèƒ½ã™ã‚‹ã‚¯ãƒ©ã‚¹ãŒå¿…è¦ã§ã™ã€‚  MyCellã¨å‘¼ã°ã‚Œã¾ã™ã€‚ æ¬¡ã«ã€ãƒ„ãƒªãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs pgsql">Me.wTree = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> RTree(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> MyCell)()</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã‚’è¿½åŠ ã™ã‚‹ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Me</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.wTree</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Add</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">nCell</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.GetRectangle</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">nCell</span></span>)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ã“ã“ã§ã¯ã€Rectangleã¯<a href="https://en.wikipedia.org/wiki/Minimum_bounding_rectangle">MBR</a>ã§ã™ã€‚ å›³é¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€Bounds As Autodesk.AutoCAD.DatabaseServices.Extents3dï¼Ÿãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤Drawableã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã™ã‚‹DBObjectã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚ ã€Œå…‰ã€ã¨ã€ŒèƒŒæ™¯ã€ã¨ã„ã†è¨€è‘‰ã§æ„å‘³ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®è¨€è‘‰ã«ã¯å¢ƒç•Œç·šã®å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ ãŸã ã—ã€DrawableType.Geometryã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å¢ƒç•Œç·šãŒã§ãã¾ã™ãŒã€XLineã¨Rayã‚’è¦‹ã‚‹ä¾¡å€¤ã¯ã‚ã‚Šã¾ã™ãŒ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Rãƒ„ãƒªãƒ¼ã‚’ä½œæˆã—ã¦å…¥åŠ›ã—ãŸã‚‰ã€æ¤œç´¢ã‚’é–‹å§‹ã—ã¾ã™ã€‚ã“ã‚Œã«ã¯2ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      MBRå†…ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Intersects(r <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> RTree.Rectangle) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic.List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> T)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     æ¤œç´¢ãƒã‚¤ãƒ³ãƒˆã®è¿‘ãã«ã‚ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Nearest(p <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> RTree.Point, furthestDistance <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Single) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic.List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> T)</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ã‚¯ãƒ©ã‚¹mycell</b> <div class="spoiler_text"><pre> <code class="hljs sql">Imports Autodesk.AutoCAD.DatabaseServices Imports Autodesk.AutoCAD.Geometry Imports RTree Public Class MyCell Public Box As Line '  Public Col As Integer Public Row As Integer Public Value As String Public Sub New() Box = Nothing Col = 0 Row = 0 Value = "" <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(nBox <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Line, wCol <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span>, wRow <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span>, nValue <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>) Box = nBox <span class="hljs-keyword"><span class="hljs-keyword">Col</span></span> = wCol <span class="hljs-keyword"><span class="hljs-keyword">Row</span></span> = wRow <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> = nValue <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetH() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> Box.EndPoint.Y - Box.StartPoint.Y <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetW() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> Box.EndPoint.X - Box.StartPoint.X <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetRectangle() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Rectangle <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Rectangle(Box.StartPoint.X, Box.StartPoint.Y, Box.EndPoint.X, Box.EndPoint.Y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ã‚¯ãƒ©ã‚¹MyTable</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">Imports MyAcAs = Autodesk.AutoCAD.ApplicationServices Imports Autodesk.AutoCAD.DatabaseServices Imports Autodesk.AutoCAD.EditorInput Imports Autodesk.AutoCAD.Geometry Imports RTree <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyTable <span class="hljs-string"><span class="hljs-string">'Public Shared MinColW As Double = 1 '</span></span><span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared MinRowH <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Double</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> Private vert, horz <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>) <span class="hljs-string"><span class="hljs-string">'    Public Cells(,) As MyCell '</span></span>  Friend wTree <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> RTree(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> MyCell) <span class="hljs-string"><span class="hljs-string">'    Public Enum Orent Vert '</span></span>  Horz <span class="hljs-string"><span class="hljs-string">'  None '</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Enum <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> isOrto(wL <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Orent <span class="hljs-string"><span class="hljs-string">'   -    Dim wValue As Double = wL.Angle / Math.PI Dim delta As Double = 0.05 wValue = wValue - Math.Truncate(wValue + delta / 2) If Math.Abs(wValue) &lt;= delta Then Return Orent.Horz ElseIf (Math.Abs(wValue) &lt; 0.5 + delta) And (Math.Abs(wValue) &gt; 0.5 - delta) Then Return Orent.Vert Else Return Orent.None End If End Function Private Shared Function CompareByX(l1 As Line, l2 As Line) As Integer If l1.StartPoint.X &gt; l2.StartPoint.X Then Return 1 ElseIf l1.StartPoint.X = l2.StartPoint.X Then Return 0 Else Return -1 End If End Function Private Shared Function CompareByY(l1 As Line, l2 As Line) As Integer If l1.StartPoint.Y &gt; l2.StartPoint.Y Then Return 1 ElseIf l1.StartPoint.Y = l2.StartPoint.Y Then Return 0 Else Return -1 End If End Function Private Shared Function GetSelect(ed As Editor) As ObjectId() '</span></span>       Dim PSResult <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> PromptSelectionResult Dim wTV() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> TypedValue = {<span class="hljs-built_in"><span class="hljs-built_in">New</span></span> TypedValue(DxfCode.<span class="hljs-keyword"><span class="hljs-keyword">Operator</span></span>, "&lt;or"), _ <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> TypedValue(DxfCode.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>, "LINE"), _ <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> TypedValue(DxfCode.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>, "LWPOLYLINE"), _ <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> TypedValue(DxfCode.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>, "TEXT"), _ <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> TypedValue(DxfCode.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>, "MTEXT"), _ <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> TypedValue(DxfCode.<span class="hljs-keyword"><span class="hljs-keyword">Operator</span></span>, "or&gt;")} Dim wSF <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> SelectionFilter(wTV) PSResult = ed.GetSelection(wSF) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> PSResult.Status = PromptStatus.OK <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> PSResult.<span class="hljs-keyword"><span class="hljs-keyword">Value</span></span>.GetObjectIds() <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Private Shared <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> PolyToLine(pl <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Polyline) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>) Dim wList <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>) Dim wL <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> pl.NumberOfVertices - <span class="hljs-number"><span class="hljs-number">2</span></span> wL = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Line(pl.GetPoint3dAt(i), pl.GetPoint3dAt(i + <span class="hljs-number"><span class="hljs-number">1</span></span>)) wList.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(wL) Next <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> wList <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Private Sub <span class="hljs-built_in"><span class="hljs-built_in">New</span></span>(nvert <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>), nhorz <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>)) <span class="hljs-string"><span class="hljs-string">' ""    Me.vert = nvert Me.horz = nhorz Dim CC, RC As Integer CC = Me.GetCols() RC = Me.GetRows() ReDim Me.Cells(CC, RC) Me.wTree = New RTree(Of MyCell)() Dim wLine As Line Dim nCell As MyCell For i = 0 To CC - 1 For j = 0 To RC - 1 wLine = Me.GetCellBox(i, j) nCell = New MyCell(wLine, i, j, "") Me.Cells(i, j) = nCell Me.wTree.Add(nCell.GetRectangle, nCell) Next Next End Sub Public Sub SetValue(wt As DBText) '</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> wt.Bounds IsNot <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Dim tExtent <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Extents3d = wt.Bounds Dim X, Y <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Double</span></span> X = (tExtent.MaxPoint.X + tExtent.MinPoint.X) / <span class="hljs-number"><span class="hljs-number">2</span></span> Y = (tExtent.MaxPoint.Y + tExtent.MinPoint.Y) / <span class="hljs-number"><span class="hljs-number">2</span></span> Dim wP <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> <span class="hljs-type"><span class="hljs-type">Point</span></span>(X, Y, <span class="hljs-number"><span class="hljs-number">0</span></span>) Dim wList <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> MyCell) = Me.wTree.Nearest(wP, wt.Height / <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> wList IsNot <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> wList.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> wList(<span class="hljs-number"><span class="hljs-number">0</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> = wt.TextString <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Sub SetValue(wt <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> MText) <span class="hljs-string"><span class="hljs-string">'  If wt.Bounds IsNot Nothing Then Dim tExtent As Extents3d = wt.Bounds Dim X, Y As Double X = (tExtent.MaxPoint.X + tExtent.MinPoint.X) / 2 Y = (tExtent.MaxPoint.Y + tExtent.MinPoint.Y) / 2 Dim wP As New Point(X, Y, 0) Dim wList As List(Of MyCell) = Me.wTree.Nearest(wP, 1) If wList IsNot Nothing Then If wList.Count &gt; 0 Then wList(0).Value = wt.Text End If End If End Sub Private Shared Function CrTbl(wList As List(Of Line)) As MyTable '</span></span> ""    Dim nvert, nhorz, overt, ohorz <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>) nvert = wList.FindAll(<span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>(l) isOrto(l) = Orent.Vert) nvert.Sort(AddressOf CompareByX) nhorz = wList.FindAll(<span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>(l) isOrto(l) = Orent.Horz) nhorz.Sort(AddressOf CompareByY) <span class="hljs-string"><span class="hljs-string">' Dim MinColW, MinRowH As Double MinColW = Math.Abs(nvert(0).StartPoint.X - nvert(nvert.Count - 1).StartPoint.X) * 0.01 MinRowH = Math.Abs(nhorz(0).StartPoint.Y - nhorz(nhorz.Count - 1).StartPoint.Y) * 0.01 '</span></span> Dim ol <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> overt = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> l <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> nvert <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> ol <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> ol = l overt.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(l) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Math.Abs(l.StartPoint.X - ol.StartPoint.X) &gt; MinColW <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> ol = l overt.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(l) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Next <span class="hljs-string"><span class="hljs-string">' ohorz = New List(Of Line) For Each l In nhorz If ol Is Nothing Then ol = l ohorz.Add(l) Else If Math.Abs(l.StartPoint.Y - ol.StartPoint.Y) &gt; MinRowH Then ol = l ohorz.Add(l) End If End If Next Return New MyTable(overt, ohorz) End Function Public Shared Function CrTbl(acDoc As MyAcAs.Document) As MyTable '</span></span>  Dim ed <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Editor = acDoc.Editor Dim objIdArray() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> ObjectId = MyTable.GetSelect(ed) <span class="hljs-string"><span class="hljs-string">'       If objIdArray IsNot Nothing Then Dim dbObj As DBObject Dim wList As New List(Of Line) Dim wTList As New List(Of DBText) Dim wMTList As New List(Of MText) Using tr As Transaction = acDoc.Database.TransactionManager.StartTransaction Try For Each objId As ObjectId In objIdArray dbObj = tr.GetObject(objId, OpenMode.ForRead) '</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> TypeOf dbObj <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> wList.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(dbObj) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> TypeOf dbObj <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> Polyline wList.AddRange(MyTable.PolyToLine(dbObj)) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> TypeOf dbObj <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> DBText wTList.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(dbObj) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> TypeOf dbObj <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> MText wMTList.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(dbObj) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Next tr.<span class="hljs-keyword"><span class="hljs-keyword">Commit</span></span>() Catch ex <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> ed.WriteMessage(ex.ToString()) tr.<span class="hljs-keyword"><span class="hljs-keyword">Abort</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Try <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Using</span></span> <span class="hljs-string"><span class="hljs-string">' Dim wMTbl As MyTable = MyTable.CrTbl(wList) '</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> wt <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> wTList wMTbl.SetValue(wt) Next <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> wmt <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> wMTList wMTbl.SetValue(wmt) Next <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> wMTbl <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetCols() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> vert.Count - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetColW(i <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Integer</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Double</span></span> Dim res <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Double</span></span> = Math.Abs(vert(i + <span class="hljs-number"><span class="hljs-number">1</span></span>).StartPoint.X - vert(i).StartPoint.X) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> res = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> res = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">'?! Return res End Function Public Function GetRows() As Integer Return horz.Count - 1 End Function Public Function GetRowH(j As Integer) As Double Dim res As Double = Math.Abs(horz(j + 1).StartPoint.Y - horz(j).StartPoint.Y) If res = 0 Then res = 1 '</span></span>?! <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetCellBox(i <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Integer</span></span>, j <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Integer</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> <span class="hljs-string"><span class="hljs-string">'      () Dim p1, p2 As Point3d p1 = New Point3d(vert(i).StartPoint.X, horz(j).StartPoint.Y, 0) p2 = New Point3d(vert(i + 1).StartPoint.X, horz(j + 1).StartPoint.Y, 0) Return New Line(p1, p2) End Function Public Function CrTbl(ip As Point3d) As Table '</span></span> ACAD- Dim res <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Table</span></span>() Dim Rs, Cs <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-type"><span class="hljs-type">Integer</span></span> Rs = Me.GetRows() Cs = Me.GetCols() res.SetSize(Rs, Cs) res.Position = ip <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> Cs - <span class="hljs-number"><span class="hljs-number">1</span></span> res.<span class="hljs-keyword"><span class="hljs-keyword">Columns</span></span>(i).Width = Me.GetColW(i) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> Rs - <span class="hljs-number"><span class="hljs-number">1</span></span> res.<span class="hljs-keyword"><span class="hljs-keyword">Rows</span></span>(j).Height = Me.GetRowH(j) res.Cells(Rs - j - <span class="hljs-number"><span class="hljs-number">1</span></span>, i).TextString = Me.Cells(i, j).<span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> Next Next res.GenerateLayout() <span class="hljs-string"><span class="hljs-string">'!? Return res End Function End Class</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ãƒãƒ¼ãƒ </b> <div class="spoiler_text"><pre> <code class="hljs vhdl">Imports Autodesk.AutoCAD.Runtime Imports MyAcAs = Autodesk.AutoCAD.ApplicationServices Imports Autodesk.AutoCAD.EditorInput Imports Autodesk.AutoCAD.DatabaseServices Public Class AcadWork &lt;CommandMethod(<span class="hljs-string"><span class="hljs-string">"TblParse"</span></span>)&gt; _ Public Sub TblParse() Dim acDoc As MyAcAs.Document = MyAcAs.Application.DocumentManager.MdiActiveDocument Dim ed As Editor = acDoc.Editor Dim wMTbl As MyTable = MyTable.CrTbl(acDoc) ' Dim PPResult As PromptPointResult PPResult = ed.GetPoint(<span class="hljs-string"><span class="hljs-string">" "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> PPResult.Status = PromptStatus.OK <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Dim nTbl As Table = wMTbl.CrTbl(PPResult.Value) Using tr As Transaction = acDoc.Database.TransactionManager.StartTransaction Try Dim bt As BlockTable = tr.GetObject(acDoc.Database.BlockTableId, OpenMode.ForRead) Dim btr As BlockTableRecord = tr.GetObject(bt(BlockTableRecord.ModelSpace), OpenMode.ForWrite) btr.AppendEntity(nTbl) tr.AddNewlyCreatedDBObject(nTbl, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) tr.Commit() Catch ex As Exception ed.WriteMessage(ex.ToString()) tr.Abort() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Try <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Using <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Class</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://github.com/triroakenshield/tblPrs">Github</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5> ãŠã‚ã‚Šã« </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Rãƒ„ãƒªãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€AutoCADã®æ–¹æ³•ã‚’ä½¿ç”¨ã›ãšã«ã€ç›®çš„ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã‚»ãƒƒãƒˆã‚’éå¸¸ã«ã™ã°ã‚„ãæ¤œç´¢ã§ãã¾ã™ã€‚ </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J278749/index.html">OS Xå‘ã‘KeRangerãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢ï¼šåˆ†æ</a></li>
<li><a href="../J27875/index.html">Pythonã§ãƒ—ãƒ­ã‚»ã‚¹ã®åå‰ã‚’å¤‰æ›´ã™ã‚‹</a></li>
<li><a href="../J278757/index.html">ã‚·ã‚¹ãƒ†ãƒ é–“ã®Windowsã‚¦ã‚§ã‚¤è¨­å®šã®åŒæœŸ</a></li>
<li><a href="../J278759/index.html">å­¦ç”Ÿå‘ã‘ã®æ•™è‚²ã‚²ãƒ¼ãƒ ã®ã‚¢ã‚¤ãƒ‡ã‚¢</a></li>
<li><a href="../J278763/index.html">KTVã€‚ æ–°ã—ã„JSON</a></li>
<li><a href="../J278767/index.html">Microsoftã¯SQL Serverã®Linuxãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç™ºè¡¨ã—ã¾ã—ãŸ</a></li>
<li><a href="../J278769/index.html">MVPã‚’ä½¿ç”¨ã—ãŸæ‹¡å¼µå¯èƒ½ãªAndroidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰</a></li>
<li><a href="../J278771/index.html">é€£é‚¦å·æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ç™»éŒ²ç°¿ã«åŸºã¥ãè¼¸å…¥ä»£æ›¿ã¾ãŸã¯å¨¯æ¥½çµ±è¨ˆã®æˆåŠŸ</a></li>
<li><a href="../J278773/index.html">å¤§ããªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚°ãƒªãƒƒãƒ‰å®Ÿè£…ã€‚ ãƒ‘ãƒ¼ãƒˆ1</a></li>
<li><a href="../J278775/index.html">Raspberry Piç”¨ã®Dã§ã®è¨˜è¿°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>