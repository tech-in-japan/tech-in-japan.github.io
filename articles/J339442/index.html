<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧒🏽 🕺🏿 🔋 Windowsでのクリップボードの仕組み 🐽 🍶 ‼️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最近、Windowsでクリップボードをデバッグする機会があり、見つけた情報を共有するのがいいと判断しました。 クリップボードは、Windowsのコンポーネントであり、私たちの多くが1日に何十（何百？）を使用していますが、実際にそれについては考えていません。 このビジネスに着手する前に、私はすべてがど...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>Windowsでのクリップボードの仕組み</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/339442/">最近、Windowsでクリップボードをデバッグする機会があり、見つけた情報を共有するのがいいと判断しました。  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms648709%2528v%3Dvs.85%2529.aspx">クリップボード</a>は、Windowsのコンポーネントであり、私たちの多くが1日に何十（何百？）を使用していますが、実際にそれについては考えていません。 このビジネスに着手する前に、私はすべてがどのように機能するかを考えたことがありませんでした。 結局のところ、想像もできないほど多くの興味深いことがあります。 最初に、アプリケーションがさまざまなタイプのデータをクリップボードに保存する方法とそこからデータを抽出する方法を説明し、次にアプリケーションがクリップボードに「フック」してその変更を追跡する方法を説明します。 どちらの場合も、デバッガーからデータにアクセスする方法を示すデバッグエントリが表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず、 <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649013(v%3Dvs.85).aspx">クリップボード形式</a>について説明し<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649013(v%3Dvs.85).aspx">ます</a> 。 このような形式は、バッファリングできるデータの種類を記述するために使用されます。 ビットマップ、ANSIテキスト、Unicodeテキスト、TIFFなど、アプリケーションで使用できる定義済みの<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff729168%2528v%3Dvs.85%2529.aspx">標準形式</a>が多数あります。  Windowsでは、アプリケーションが独自の形式を設定することもできます。 たとえば、ワードプロセッサは、テキスト、書式、写真などの形式を登録できます。 もちろん、これは特定の問題につながります。データをテキストエディターからコピーしてメモ帳に貼り付けるとどうなりますか。メモ帳はこの書式設定をすべて理解せず、画像を表示しません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     解決策は、クリップボードのデータをいくつかの形式で同時に保存できるようにすることです。 クリップボードについて考えていたとき、そこに単一のオブジェクト（「私のテキスト」または「私の写真」）が格納されていると想像しましたが、実際には、私のデータはさまざまな形式でクリップボードに格納されます。 バッファから情報を取得するプログラムは、使用可能な形式で情報を受け取ります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     データはどのようにクリップボードに表示されますか？ 非常に簡単で、アプリケーションはまず<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649048%2528v%3Dvs.85%2529.aspx">OpenClipboard</a>関数を介してクリップボードの所有権を発表します。 その後、プログラムは<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649037%2528v%3Dvs.85%2529.aspx">EmptyClipboard</a>コマンドでクリップボードをクリアし、最後に<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649037%2528v%3Dvs.85%2529.aspx">SetClipboardData</a>コマンドでデータをそこに配置できます。  SetClipboardDataは2つのパラメーターを受け入れます。  1つ目は、上記のクリップボード形式のいずれかの識別子です。  2番目は、この形式のデータを含むメモリ内のセグメント記述子です。 アプリケーションは、バッファリングする各フォーマットに対して、最良から最悪まで繰り返しSetClipboardDataコマンドを呼び出すことができます（データが挿入されるアプリケーションがリストから最初の適切なフォーマットを選択するため）。 開発者の作業を楽にするために、Windowsはいくつかの種類のクリップボード形式の変換を自動的に提供します。 プロセスの最後に、プログラムは<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649035%2528v%3Dvs.85%2529.aspx">CloseClipboardを</a>呼び出し<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649035%2528v%3Dvs.85%2529.aspx">ます</a> 。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ユーザーが[貼り付け]ボタンをクリックすると、ターゲットアプリケーションはOpenClipboardと次の関数のいずれかを呼び出して、使用可能なデータ形式を決定します： <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649047(v%3Dvs.85).aspx">IsClipboardFormatAvailable</a> 、 <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649045(v%3Dvs.85).aspx">GetPriorityClipboardFormat</a>または<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649038(v%3Dvs.85).aspx">EnumClipboardFormats</a> 。 適切な形式が見つかった場合、データを取得するためのパラメーターとして目的の形式の識別子を<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649039(v%3Dvs.85).aspx">使用</a>して<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649039(v%3Dvs.85).aspx">GetClipboardData</a>を呼び出します。 最後に、アプリケーションはCloseClipboardコマンドを使用してバッファーを閉じます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     デバッガーを使用して、クリップボードに書き込まれるデータを判別する方法を見てみましょう。  （私のエントリはすべてWin7 / 2008 R2システムで作成されていることに注意してください。したがって、OSの他のバージョンでは、外観が若干異なる場合があります）。 バッファーはWin32k.sysの一部であるため、カーネルデバッガーが必要になります。  <code>win32k!InternalSetClipboardData+0xe4</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    を使用するのが<code>win32k!InternalSetClipboardData+0xe4</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     。 このオフセットの良いところは、RDIレジスタの後ろにあり、tagCLIPとして知られる構造のSetClipboardDataからのデータで満たされていることです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; u win32k！InternalSetClipboardData + 0xe4-c L5
 win32k！InternalSetClipboardData + 0xd8：
 fffff960`0011e278 894360 mov dword ptr [rbx + 60h]、eax
 fffff960`0011e27b 8937 mov dword ptr [rdi]、esi
 fffff960`0011e27d 4c896708 mov qword ptr [rdi + 8]、r12
 fffff960`0011e281 896f10 mov dword ptr [rdi + 10h]、ebp
 fffff960`0011e284 ff15667e1900 call qword ptr [win32k！_imp_PsGetCurrentProcessWin32Process（fffff960`002b60f0）] </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt win32k！tagCLIP
    + 0x000 fmt：Uint4B
    + 0x008 hData：Ptr64 Void
    + 0x010fGlobalHandle：Int4B </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     メモ帳からSetClipboardDataを呼び出すと、次のようになります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; k
 Child-SP RetAddr呼び出しサイト
 fffff880`0513a940 fffff960`0011e14f win32k！InternalSetClipboardData + 0xe4
 fffff880`0513ab90 fffff960`000e9312 win32k！SetClipboardData + 0x57
 fffff880`0513abd0 fffff800`01482ed3 win32k！NtUserSetClipboardData + 0x9e
 fffff880`0513ac20 00000000`7792e30ant！KiSystemServiceCopyEnd + 0x13
 00000000`001dfad8 00000000`7792e494 USER32！ZwUserSetClipboardData + 0xa
 00000000`001dfae0 000007fe`fc5b892b USER32！SetClipboardData + 0xdf
 00000000`001dfb20 000007fe`fc5ba625 COMCTL32！Edit_Copy + 0xdf
 00000000`001dfb60 00000000`77929bd1 COMCTL32！Edit_WndProc + 0xec9
 00000000`001dfc00 00000000`779298da USER32！UserCallWinProcCheckWow + 0x1ad
 00000000`001dfcc0 00000000`ff5110bc USER32！DispatchMessageWorker + 0x3b5
 00000000`001dfd40 00000000`ff51133cメモ帳！WinMain + 0x16f
 00000000`001dfdc0 00000000`77a2652dメモ帳！DisplayNonGenuineDlgWorker + 0x2da
 00000000`001dfe80 00000000`77b5c521 kernel32！BaseThreadInitThunk + 0xd
 00000000`001dfeb0 00000000`00000000ntdll！RtlUserThreadStart + 0x1d </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、RDIの内容をtagCLIPとして表示し、バッファーに書き込まれる内容を確認できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt win32k！tagCLIP @rdi
    + 0x000 fmt：0xd
    + 0x008 hData：0x00000000`00270235 Void
    + 0x010fGlobalHandle：0n1 </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Fmtはクリップボードの形式です。  0Xdは番号13で、Unicodeテキストに対応します。 ただし、 <code>hData</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    の値によって<code>du</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    を開始することはできません。これは、データへの直接ポインターではなく記述子であるためです。 そのため、グローバルwin32k構造-gSharedInfoでそれを探す必要があります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt;？win32k！gSharedInfo
式の評価：-7284261440224 = fffff960`002f3520
 kd&gt; dt win32k！tagSHAREDINFO fffff960`002f3520
    + 0x000 psi：0xfffff900`c0980a70 tagSERVERINFO
    + 0x008 aheList：0xfffff900`c0800000 _HANDLEENTRY
    + 0x010 HeEntrySize：0x18
    + 0x018 pDispInfo：0xfffff900`c0981e50 tagDISPLAYINFO
    + 0x020ulSharedDelta：0
    + 0x028 awmControl：[31] _WNDMSG
    + 0x218DefWindowMsgs：_WNDMSG
    + 0x228DefWindowSpecMsgs：_WNDMSG </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      gSharedInfoのaheListには、記述子を持つ配列が含まれ、最後の2つのhDataバイトに記述子レコードのサイズを乗算すると、記述子レコードのアドレスが表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt;？0x00000000`00270235＆FFFF
式の評価：565 = 00000000`00000235
 kd&gt; ?? sizeof（win32k！_HANDLEENTRY）
符号なしint64 0x18
 kd&gt;？  0xfffff900`c0800000 +（0x235 * 0x18）
式の評価：-7693351766792 = fffff900`c08034f8
 kd&gt; dt win32k！_HANDLEENTRY fffff900`c08034f8
    + 0x000 phead：0xfffff900`c0de0fb0 _HEAD
    + 0x008 pOwner：（null）
    + 0x010 bType：0x6 ''
    + 0x011 bFlags：0 ''
    + 0x012 wUniq：0x27 </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      14のオフセットでpheadを見ると、データが得られます（このオフセットはプラットフォームによって異なる場合があります）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; du fffff900`c0de0fb0 + 0x14
 fffff900`c0de0fc4 "こんにちはNTDebuggingリーダー！" </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     別のシナリオを想像してください。 ワードパッドからテキストをコピーし、SetClipboardDataコマンドが特定の回数動作して、データを異なる形式で配置しました。  Unicodeエントリは次のようになります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> ブレークポイント0ヒット
 win32k！InternalSetClipboardData + 0xe4：
 fffff960`0011e284 ff15667e1900 call qword ptr [win32k！_imp_PsGetCurrentProcessWin32Process（fffff960`002b60f0）]
 kd&gt; dt win32k！tagCLIP @rdi
    + 0x000 fmt：0xd
    + 0x008 hData：（null）
    + 0x010fGlobalHandle：0n0 </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      hDataはゼロです！ なぜそう クリップボードにより、アプリケーションは特定の形式のSetClipboardDataパラメーターとしてゼロを渡すことができます。 これは、アプリケーションがこの形式でデータを提供できるが、必要に応じて後で提供することを意味します。 バッファーにUnicodeテキストが必要なテキストをメモ帳に貼り付ける場合、WindowsはWM_RENDERFORMATメッセージをワードパッドウィンドウに送信し、ワードパッドはデータを新しい形式で提供します。 もちろん、すべての形式のデータを提供する前にアプリケーションを閉じると、Windowsはすべての形式を必要とします。 この場合、WindowsはWM_RENDERALLFORMATSメッセージを送信して、他のアプリケーションが親アプリケーションを閉じた後にクリップボードのデータを使用できるようにします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     次に、アプリケーションがクリップボードの変更を追跡する方法を見てみましょう。 この時点で、Windowsはサードパーティのアプリケーションがシステムに接続できるようにするため、これは知っておくことが重要です。 コピーアンドペーストで不明瞭な不具合がある場合、原因はこれらのプログラムの一部の不適切な動作である可能性があります。 まず、クリップボードに接続するためのメカニズムを検討します。 次に、デバッガーを使用してこのようなフックを使用してアプリケーションを識別できるかどうかを調べます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     クリップボードの変更を監視するには、バッファーの表示、バッファー形式のリッスン、および<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms649042(v%3Dvs.85).aspx">バッファーシーケンス番号の要求の</a> 3つの方法があります。 最初の2つのメソッドに焦点を当てます。これらのメソッドは、バッファーの内容が更新されたときに通知を提供するためです。  3番目の方法では、アプリケーション自体がバッファが変更されたかどうかを毎回確認する必要があり、この方法はポーリングサイクルでは使用できません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     クリップボードビューアの機能は、Windows 2000バージョンで登場しました（以前のバージョンではない場合）。 操作の原理は非常に簡単です。バッファの変更の通知を受信することに関心のあるアプリケーションは<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649052%2528v%3Dvs.85%2529.aspx">SetClipboardViewer</a>を呼び出し、そのウィンドウにハンドルを渡します。  Windowsはこのハンドルをwin32k構造に格納し、クリップボードが変更されるたびに、Windowsは登録されたウィンドウに<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649025(v%3Dvs.85).aspx">WM_DRAWCLIPBOARD</a>メッセージを送信します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     もちろん、いくつかのウィンドウを登録してバッファを表示できます-Windowsはこれをどのように処理しますか？ アプリケーションがSetClipboardViewerを呼び出し、クリップボードを表示するために別のウィンドウが以前に登録されている場合、Windowsは前のウィンドウのハンドルを新しいウィンドウに返します。 バッファを監視する新しいウィンドウは、WM_DRAWCLIPBOARDを受信するたびに<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950(v%3Dvs.85).aspx">SendMessageを</a>呼び出し、バッファを監視する人のチェーン内の次のウィンドウについてバッファに通知する必要があります。 各バッファ監視ウィンドウは、WM_CHANGECBCHAINメッセージも処理する必要があります。 このようなメッセージは、チェーン内の1つのリンクの削除を他のすべてのウィンドウに通知し、どのリンクがキュー内の次になるかを通知します。 これにより、チェーンを保存できます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このようなアーキテクチャの明らかな問題は次のとおりです。バッファを監視するすべてのアプリケーションが正しく動作し、予期せず終了せず、全体がシステムの良き市民になることを期待しています。 アプリケーションのいずれかが不親切に動作し始めた場合、クリップボードの変更に関する通知をチェーン内の次のアプリケーションに送信しません。その結果、チェーン全体が通知なしで残ります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     このような問題に対処するため、Windows Vistaでは、クリップボード形式をリッスンするクリップボード形式のリスナーを追加しました。  Windows自体がクリップボードをリッスンするアプリケーションのリストを保持し、チェーンを保持する必要があるアプリケーションの整合性に依存しないことを除いて、クリップボードの表示とほぼ同じように機能します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     アプリケーションがバッファをリッスンする場合、 <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649033(v%3Dvs.85).aspx">AddClipboardFormatListener</a>関数を呼び出して、ウィンドウにハンドルを渡します。 その後、ウィンドウメッセージハンドラーは<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649021%2528v%3Dvs.85%2529.aspx">WM_CLIPBOARDUPDATE</a>メッセージを受け取ります。 アプリケーションがシャットダウンしようとしているとき、または通知を受け取りたくないときは、 <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649050(v%3Dvs.85).aspx">RemoveClipboardFormatListenerを</a>呼び出し<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649050(v%3Dvs.85).aspx">ます</a> 。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     クリップボードの視聴を登録する方法を見ました。 次に、デバッガを使用して、これらのプロセスに関係するプログラムを特定する方法を見てみましょう。 最初に、クリップボードの監視を確認するセッションのプロセスを特定する必要があります。 このセッションの任意のwin32プロセスを使用できます。WindowStationへのポインタを見つけるために必要なだけです。 この場合、以前のようにメモ帳ウィンドウを使用します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt;！process 0 0 notepad.exe
 PROCESS fffff980366ecb30
     SessionId：1 Cid：0374 Peb：7fffffd8000 ParentCid：0814
     DirBase：1867e000 ObjectTable：fffff9803d28ef90 HandleCount：52。
    画像：notepad.exe </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     カーネルのデバッグ中にこれを行う場合、コンテキストを対話的に変更する必要があります（ <code>.process /I&lt;address&gt;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    使用してから<code>g</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    を押し、デバッガーがブレークバックするのを待ちます）。 次に、プロセスアドレスで<code>_EPROCESS</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    として<code>DT</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    を実行し、Win32Processフィールドを確認します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt _EPROCESS fffff980366ecb30 Win32Process
 nt！_EPROCESS
    + 0x258 Win32Process：0xfffff900`c18c0ce0 Void </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     次に、Win32Processアドレスをwin32k！TagPROCESSINFOとして見て、rpwinstaの値を見つけます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt win32k！tagPROCESSINFO 0xfffff900`c18c0ce0 rpwinsta
    + 0x258 rpwinsta：0xfffff980`0be2af60 tagWINDOWSTATION </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これがウィンドウステーションです。  dtを介してコンテンツをマージします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff980`0be2af60 tagWINDOWSTATION
 win32k！tagWINDOWSTATION
    + 0x000 dwSessionId：1
    + 0x008 rpwinstaNext：（null）
    + 0x010 rpdeskList：0xfffff980`0c5e2f20 tagDESKTOP
    + 0x018 pTerm：0xfffff960`002f5560 tagTERMINAL
    + 0x020 dwWSF_Flags：0
    + 0x028 spklList：0xfffff900`c192cf80 tagKL
    + 0x030 ptiClipLock：（null）
    + 0x038 ptiDrawingClipboard：（null）
    + 0x040 spwndClipOpen：（null）
    + 0x048 spwndClipViewer：0xfffff900`c1a4ca70 tagWND
    + 0x050 spwndClipOwner：0xfffff900`c1a3ef70 tagWND
    + 0x058 pClipBase：0xfffff900`c5512fa0 tagCLIP
    + 0x060 cNumClipFormats：4
    + 0x064 iClipSerialNumber：0x16
    + 0x068 iClipSequenceNumber：0xc1
    + 0x070 spwndClipboardListener：0xfffff900`c1a53440 tagWND
    + 0x078 pGlobalAtomTable：0xfffff980`0bd56c70 Void
    + 0x080 luidEndSession：_LUID
    + 0x088 luidUser：_LUID
    + 0x090 psidUser：0xfffff900`c402afe0 Void </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      spwndClipViewer、spwndClipboardListener、およびspwndClipOwnerfieldsフィールドに注目してください。 ここで、spwndClipViewerは、クリップボードを表示しているユーザーのチェーン内で最後に登録されたウィンドウです。 また、spwndClipboardListenerは、Clipboard Format Listenerで最後に登録されたバッファリッスンウィンドウです。  spwndClipOwnerウィンドウは、クリップボードにデータを配置したウィンドウです。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ウィンドウがわかっている場合は、そのプロセスが属するプロセスを見つけるための手順がいくつか残っています。  forspwndClipViewer、spwndClipboardListener、spwndClipOwnerに興味があります。 まず、dtを実行してtagWNDの値を見つけます。 このデモでは、spwndClipViewerを使用します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff900`c1a4ca70 tagWND
 win32k！tagWND
    + 0x000ヘッド：_THRDESKHEAD
    + 0x028状態：0x40020008
    + 0x028 bHasMeun：0y0
    + 0x028 bHasVerticalScrollbar：0y0
 ... </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      headの値のみに関心があるため、オフセットが0の場合は、_THRDESKHEADの同じアドレスに対してdtを実行します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff900`c1a4ca70 _THRDESKHEAD
 win32k！_THRDESKHEAD
    + 0x000 h：0x00000000`000102ae Void
    + 0x008 cLockObj：6
    + 0x010 pti：0xfffff900`c4f26c20tagTHREADINFO
    + 0x018 rpdesk：0xfffff980`0c5e2f20 tagDESKTOP
    + 0x020 pSelf：0xfffff900`c1a4ca70 "???" </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     次に、ptiフィールドにtagTHREADINFOとして示されているアドレスに対してdtを実行します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff900`c4f26c20 tagTHREADINFO
 win32k！tagTHREADINFO
    + 0x000 pEThread：0xfffff980`0ef6cb10 _ETHREAD
    + 0x008 RefCount：1
    + 0x010 ptlW32：（null）
    + 0x018 pgdiDcattr：0x00000000`000f0d00 Void </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これで、pEThreadフィールドの値にのみ興味があり、それを渡すことができます！スレッド： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt;！thread 0xfffff980`0ef6cb10 e
 THREAD fffff9800ef6cb10 Cid 087c.07ec Teb：000007fffffde000 Win32Thread：fffff900c4f26c20 WAIT：（WrUserRequest）UserModeNon-Alertable
     fffff9801c01efe0 SynchronizationEvent
なりすましではない
 DeviceMap fffff980278a0fc0
所有プロセスfffff98032e18b30画像：viewer02.exe
添付プロセスN / A画像：N / A
待機開始TickCount 5435847ティック：33（0：00：00：00.515）
コンテキストスイッチ数809 IdealProcessor：0 LargeStack
 UserTime 00：00：00.000
 KernelTime 00：00：00.062
 Win32開始アドレス0x000000013f203044
 Stack Init fffff880050acdb0現在のfffff880050ac6f0
基本fffff880050ad000制限fffff880050a3000コール0
優先度11 BasePriority 8 UnusualBoost 0 ForegroundBoost 2IoPriority 2 PagePriority 5
 Child-SP RetAddr呼び出しサイト
 fffff880`050ac730 fffff800`01488f32 nt！KiSwapContext + 0x7a
 fffff880`050ac870 fffff800`0148b74f nt！KiCommitThreadWait + 0x1d2
 fffff880`050ac900 fffff960`000dc8e7 nt！KeWaitForSingleObject + 0x19f
 fffff880`050ac9a0 fffff960`000dc989 win32k！xxxRealSleepThread + 0x257
 fffff880`050aca40 fffff960`000dafc0 win32k！xxxSleepThread + 0x59
 fffff880`050aca70 fffff960`000db0c5 win32k！xxxRealInternalGetMessage + 0x7dc
 fffff880`050acb50 fffff960`000dcab5 win32k！xxxInternalGetMessage + 0x35
 fffff880`050acb90 fffff800`01482ed3 win32k！NtUserGetMessage + 0x75
 fffff880`050acc20 00000000`77929e6a nt！KiSystemServiceCopyEnd + 0x13（TrapFrame @ fffff880`050acc20）
 00000000`002ffb18 00000000`00000000 0x77929e6a </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ご覧のとおり、クリップボードビューはviewer02.exeプロセスに代わって登録されました。 ブラウジングはチェーン内にあるため、チェーン内の次のプロセスを決定するのは簡単ではありません。 しかし、バッファを聞く人のためにこれを行うことができます。 ウィンドウステーションをもう一度見てください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff980`0be2af60 tagWINDOWSTATION
 win32k！tagWINDOWSTATION
    + 0x000 dwSessionId：1
    + 0x008 rpwinstaNext：（null）
    + 0x010 rpdeskList：0xfffff980`0c5e2f20 tagDESKTOP
    + 0x018 pTerm：0xfffff960`002f5560 tagTERMINAL
    + 0x020 dwWSF_Flags：0
    + 0x028 spklList：0xfffff900`c192cf80 tagKL
    + 0x030 ptiClipLock：（null）
    + 0x038 ptiDrawingClipboard：（null）
    + 0x040 spwndClipOpen：（null）
    + 0x048 spwndClipViewer：0xfffff900`c1a4ca70tagWND
    + 0x050 spwndClipOwner：0xfffff900`c1a3ef70tagWND
    + 0x058 pClipBase：0xfffff900`c5512fa0 tagCLIP
    + 0x060 cNumClipFormats：4
    + 0x064 iClipSerialNumber：0x16
    + 0x068 iClipSequenceNumber：0xc1
    + 0x070 spwndClipboardListener：0xfffff900`c1a53440 tagWND
    + 0x078 pGlobalAtomTable：0xfffff980`0bd56c70 Void
    + 0x080 luidEndSession：_LUID
    + 0x088 luidUser：_LUID
    + 0x090 psidUser：0xfffff900`c402afe0 Void </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      spwndClipboardListenerでdtを開始すると、次のリスニングプロセスを含むspwndClipboardListenerNextフィールドが表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff900`c1a53440 tagWND spwndClipboardListenerNext
 win32k！tagWND
    + 0x118 spwndClipboardListenerNext：0xfffff900`c1a50080 tagWND </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      tagWNDバッファーのリスナーのリストの最後のプロセスに到達すると、そのspwndClipboardListenerNextフィールドはゼロになります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  kd&gt; dt 0xfffff900`c1a50080 tagWND spwndClipboardListenerNext
 win32k！tagWND
    + 0x118 spwndClipboardListenerNext：（null） </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ウィンドウのアドレスを使用して、同じメソッドを使用してプロセスの名前を取得できます。 前述のように、tagWNDはカーネル構造であるため、OS自体がspwndClipboardListener / spwndClipboardListenerNextポインターを格納するため、ウォッチチェーンのようなバッファートラッキングの問題につながることはありません。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これで、Windowsクリップボードのレビューは終了です。 あなたにとって有益なものになったことを願っています。 クリップボードの監視について詳しく知りたいですか？ これに関する<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms649016(v%3Dvs.85).aspx">MSDNの良い記事をご覧ください</a> 。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J339426/index.html">Goプログラマ向けのモナド</a></li>
<li><a href="../J339432/index.html">データセット内のハッシュステガノグラフィ。 今回はクイック</a></li>
<li><a href="../J339434/index.html">教育を受けていない若者が教育を受ける方法。 大学の対応</a></li>
<li><a href="../J339436/index.html">セマンティックマークアップ：LaTeX、DocBook、???</a></li>
<li><a href="../J339440/index.html">JavaScript Engine Switcher 2.Xに関する誤解</a></li>
<li><a href="../J339444/index.html">「同僚、私はすべてが好きですが、...」または顧客と仕事を構築する方法</a></li>
<li><a href="../J339446/index.html">ウェブデザイナー向けの取引ロボット</a></li>
<li><a href="../J339448/index.html">iPhone X向けのデザイン</a></li>
<li><a href="../J339450/index.html">RFCによるBGP通知の解析</a></li>
<li><a href="../J339454/index.html">脳が木を叩く方法、またはニューラルネットワークを使用して推奨システムを作成した方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>