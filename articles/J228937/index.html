<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍👩‍👧‍👦 🏮 👩🏼‍🏫 ページキャッシュ、またはRAMとファイルの関係 🤳 🏒 🐁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前に、 カーネルがプロセスの仮想メモリを管理する方法に慣れましたが、ファイルと入出力の処理は省略しました。 この記事では、RAM操作とファイル操作の関係と、それがシステムパフォーマンスにどのように影響するかについて、重要かつしばしば誤解を招く質問を検討します。 
  
  
  
 ファイルの操作に...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>ページキャッシュ、またはRAMとファイルの関係</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><img src="https://habrastorage.org/getpro/habr/post_images/d41/e19/445/d41e194452f0d1df9c5ec039d5143ec2.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     前に、 <a href="http://habrahabr.ru/company/smart_soft/blog/226315/">カーネルが</a>プロセスの<a href="http://habrahabr.ru/company/smart_soft/blog/226315/">仮想メモリを管理する方法に慣れましたが、</a>ファイルと入出力<a href="http://habrahabr.ru/company/smart_soft/blog/226315/">の</a>処理は省略しました。 この記事では、RAM操作とファイル操作の関係と、それがシステムパフォーマンスにどのように影響するかについて、重要かつしばしば誤解を招く質問を検討します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ファイルの操作に関しては、ここでオペレーティングシステムが2つの重要な問題を解決する必要があります。 最初の問題は、RAMの速度と比較して、ハードドライブ（ <a href="http://duartes.org/gustavo/blog/post/what-your-computer-does-while-you-wait/">特に検索操作</a> ）の驚くほど遅い速度です。  2番目の問題は、異なるプログラムによってファイルがRAMにロードされると<i>共有</i>される可能性です。  <a href="http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx">Process Explorer</a>を使用して<a href="http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx">プロセス</a>を見ると、各プロセスで約15 MBのRAMが共有DLLに費やされていることがわかります。 現在、私のコンピューターでは100個のプロセスが実行されており、メモリ内のファイルを共有する可能性がなければ、約1.5 GBのメモリが<i>共有DLLのみに</i>費やさ<i>れます</i> 。 もちろん、これは受け入れられません。  Linuxでは、プログラムはld.so、libcなどの共有ライブラリも使用します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     幸いなことに、両方の問題は、 <b>ページキャッシュ</b>を使用して一挙に解決できると言われてい<b>ます</b> 。 ページキャッシュは、ファイルのフラグメントを格納するためにカーネルによって使用されます。各フラグメントはサイズが1ページです。 ページキャッシュの概念を<b>わかりやすく説明</b>するために、 <b>scene.dat</b>ファイルを開き、512バイト単位で読み取り、ヒープ上の割り当てられたスペースにコピーする<b>render</b>というプログラムを<b>思い付き</b>ました。 最初の読み取り操作は、上の図に示すように実行されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      12 KBが読み取られると、一連のレンダリングプロセスと関連する物理ページは次のようになります。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/d5d/ead/971/d5dead97145bbd057dd990df471fc33c.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     すべてが単純に思えますが、実際にはすべて、多くのことが起こっています。 まず、プログラムが通常のread（）呼び出しを使用しているにもかかわらず、実行の結果として、ページキャッシュにはscene.datファイルの内容を含む3つの4 KBページが含まれます。 多くの人が驚いてい<b>ます</b>が、 <b>すべての標準的なファイルI / O操作はページキャッシュを通じて機能します</b> 。  x86プラットフォーム上のLinuxでは、カーネルはファイルを4キロバイトフラグメントのシーケンスとして提示します。 ファイルから1バイトのみの読み取りを要求すると、このバイトを含む4キロバイトのフラグメントがディスクから完全に読み取られ、ページキャッシュに配置されるという事実につながります。 一般的に言えば、これは理にかなっています。第1に、持続的なディスクスループットのパフォーマンスが非常に高く、第2に、プログラムは通常ファイルの特定の領域から複数バイトを読み取るからです。 ページキャッシュは、キャッシュされた各フラグメントがファイル内でどれだけのスペースを占有しているかを知っています。  ＃0、＃1などとして描かれています  Windowsは256キロバイトのフラグメント（「 <b>ビュー</b> 」と呼ばれる）を使用しますが、その目的はLinuxページキャッシュ内のページに似ています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     通常の読み取り操作を使用する場合、データは最初にページキャッシュに送られます。 プログラマーは、バッファーを介して部分的にデータにアクセスし、そこから（この例では）ヒープ上の領域にコピーします。 このビジネスへのアプローチは非常に非効率的です。プロセッサのコンピューティングリソースが無駄になり、 <a href="http://duartes.org/gustavo/blog/post/intel-cpu-caches/">プロセッサキャッシュに</a>悪影響を及ぼすだけでなく<b>、同じデータのコピーを保存するためのRAMの無駄</b>もあり<b>ます</b> 。 前の図を見ると、scene.datファイルの内容が一度に2つのコピーに保存されていることがわかります。 このファイルを使用する新しいプロセスは、このデータを再度コピーします。 したがって、これが私たちが達成したことです-ディスクからの読み取り時の待ち時間の問題をいくらか軽減しましたが、それ以外は完全に失敗しました。 ただし、問題に対する解決策があります-これは<b>「メモリマップファイル」</b>です。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/e11/128/64f/e1112864f0e267bc42756c59098ec480.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     プログラマがメモリへのマッピングファイルを使用すると、カーネルは仮想ページをページキャッシュ内の物理ページに直接マッピングします。 これにより、生産性を大幅に向上させることができます<a href="http://www.amazon.com/Windows-Programming-Addison-Wesley-Microsoft-Technology/dp/0321256190/">。Windowsシステムプログラミング</a>は、プログラムの実行時間を標準のファイルI / O操作と比較して30％以上高速化することについて書いています。  LinuxおよびSolarisの場合にのみ、同様の数字<a href="http://www.amazon.com/Programming-Environment-Addison-Wesley-Professional-Computing/dp/0321525949/">が、Unix環境での高度なプログラミング</a>の本に記載されています。 このメカニズムを使用すると、RAMの使用量を大幅に削減するプログラムを作成できます（ただし、ここではプログラム自体の機能にもよりますが）。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     いつものように、パフォーマンスに関する主なことは、 <a href="http://duartes.org/gustavo/blog/post/performance-is-a-science/">測定と視覚的な結果</a>です。 しかし、これがなくても、ファイルをメモリにマッピングすることは、それ自体の代価をもたらします。 プログラミングインターフェイスは非常に快適で、メモリ内の通常のバイトのようなファイルを読み取ることができます。 このメカニズムのすべての利点のために、特別なものを犠牲にする必要はありません。たとえば、コードの可読性は決して損なわれません。 ことわざにあるように、フラグはあなたの手にあります-あなたの<a href="http://habrahabr.ru/company/smart_soft/blog/185226/">アドレス空間</a>を試して、Unixのようなシステムで<a href="http://man7.org/linux/man-pages/man2/mmap.2.html">mmap</a>を呼び出し、Windowsで<a href="http://msdn.microsoft.com/en-us/library/aa366537(VS.85).aspx">CreateFileMapping</a>を呼び出し、高レベルのプログラミング言語で利用可能なさまざまなラッピング関数を恐れないでください。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ファイルがメモリにマップされると、その内容はすぐにではなく、徐々に<a href="">読み込まれ</a>ます-プロセッサが、まだ<a href="">ロードされ</a>ていないファイルのフラグメントへのアクセスに起因する<a href="">ページフォールトを</a>キャッチするため。 このようなページフォールトのハンドラーは、ページキャッシュで<a href="">必要なページフレーム</a>を<a href="">見つけ</a> <a href="">、仮想ページ</a>をこのページフレームに<a href="">マップします</a> 。 必要なデータが以前にページキャッシュにキャッシュされていなかった場合、ディスク読み取り操作が開始されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     そして今、質問。 レンダープログラムの実行が完了し、子プロセスが残っていないことを想像してください。  <i>scene.dat</i>ファイルのフラグメントを<i>含む</i>ページキャッシュ内のページは<i>すぐに解放され</i>ますか？ 多くの人がそう思う-しかし、それは効果がありません。 一般に、状況を分析しようとすると、これが思い浮かびます。多くの場合、あるプログラムでファイルを作成し、実行を完了してから、そのファイルを別のプログラムで使用します。 ページキャッシュは、このような状況に対応する必要があります。  <i>そして、一般的に</i> 、カーネル<i>が</i>ページキャッシュの内容を<i>原則的</i>に取り除く必要があるのはなぜですか？ ハードドライブの速度はRAMよりも5桁遅いことを覚えています。 また、データが既にキャッシュされている場合は、非常に幸運です。 それが、少なくとも空きRAMがある限り、ページキャッシュから何も削除されない理由です。 ページキャッシュ<i>は</i>特定のプロセスに依存<i>せず</i> 、逆にシステム全体が共有するリソースです。  1週間後、再度renderを実行します。scene.datファイルがまだページキャッシュにある場合は、幸運です！ これが、ページキャッシュのサイズが次第に大きくなり、その成長が突然停止する理由です。 いいえ、オペレーティングシステムが、作業員全体を食い尽くす完全なゴミだからではありません。 しかし、そうすべきだからです。 未使用のRAMも一種の無駄なリソースです。 ページキャッシュには、まったく使用しないよりも、できるだけ多くのRAMを使用することをお勧めします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     プログラムが<a href="http://man7.org/linux/man-pages/man2/write.2.html">write（）</a>呼び出しを行うと、データはページキャッシュ内の対応するページに単にコピーされ、「ダーティ」フラグでマークされます。 ハードディスク自体への直接記録<b>は</b>すぐには行われず、ディスクサブシステムが利用可能になるのを待っている間にプログラムをブロックしても意味がありません。 この動作には欠点もあります-コンピューターがクラッシュしてブルースクリーンになった場合、データがディスクに届かない可能性があります。 そのため、データベーストランザクションログファイルなどの重要なファイルは、 <a href="http://man7.org/linux/man-pages/man2/fsync.2.html">fsync（）の</a>特別な呼び出しと同期する必要があります（ただし、一般に、ハードディスクコントローラーキャッシュもあるため、ここでは書き込み操作の成功を完全に確認することはできません）。 逆に、read（）呼び出しは、ディスクがアクセス可能になりデータが読み取られなくなるまでプログラムをブロックします。 この問題をある程度軽減するために、オペレーティングシステムはいわゆるを使用します。 積極的な読み込み方法と、この方法の例は<b>先読み</b>です。 先読みが有効になっている場合、カーネルは一定数のファイルフラグメントをページキャッシュにプロアクティブにロードし、それによって後続の読み取り要求を予測します。 ファイルの読み取り方法に応じてパラメーターを選択することで、カーネルが先読みに最適なパラメーターを選択できるように支援できます-連続的またはランダムな順序（Windowsで<a href="http://man7.org/linux/man-pages/man2/madvise.2.html">madvise（）</a> 、 <a href="http://man7.org/linux/man-pages/man2/readahead.2.html">readahead（）</a> 、 <a href="http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx">キャッシュヒント</a>への呼び出し）。  Linux <a href="">は</a> 、メモリに反映されたファイルに<a href="">先読み</a>を<a href="">使用し</a>ます。  Windowsについてはわかりません。 最後に、ページキャッシュをまったく使用できません<a href="http://man7.org/linux/man-pages/man2/open.2.html">。LinuxのO_DIRECT</a>フラグとWindowsの<a href="http://msdn.microsoft.com/en-us/library/cc644950(VS.85).aspx">NO_BUFFERING</a>が原因です。 データベースはこれを頻繁に行います。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ファイルのメモリへのマッピングには、 <b>プライベート</b>と<b>共有の</b> 2種類があります。 これらの用語は、システムがRAM内のデータ<b>変更</b>にどのように応答するかのみを示します。共有マッピングの場合、データの変更はディスクにフラッシュされるか、他のプロセスで表示されます。 プライベートマッピングの場合、これは起こりません。 プライベートマッピングを実装するために、カーネルはページテーブル内のレコードの特定の使用に基づく<b>コピーオンライト</b>メカニズムに依存してい<b>ます</b> 。 次の例では、レンダリングプログラムとrender3dプログラム（プログラム名を発明する才能があります！）scene.datファイルのプライベートマッピングを作成します。 次に、ファイルにマップされている仮想メモリ領域に書き込みをレンダリングします。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/7e2/0f0/155/7e20f01551c72eb7955f41db2189ed8e.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     ページテーブル内のエントリが読み取り専用であるという事実（図を参照）は、混乱させることはありません。 これ<i>は</i> 、マッピングが読み取り専用になるという意味で<i>はありません</i> 。 これは、カーネルがさまざまなプロセスでページを共有し、最後の瞬間までページのコピーを作成する必要性を遅らせる、まさにそのような手法です。 この図を見ると、「プライベート」という用語がおそらく最も成功しているわけではないことを理解して<i>い</i>ます<i>が</i> 、データ<i>が変更された</i>とき<i>の</i>動作のみを説明していることを覚えていれば、すべて問題ありません。 マッピングメカニズムには別の機能があります。  「親プロセス-子プロセス」という関係で接続されていない2つのプログラムがあるとします。 プログラムは同じファイルで動作しますが、マッピングは異なります-1つのプログラムではプライベートマッピング、もう1つのプログラムでは共有マッピングです。 したがって、プライベートマッピングのプログラム（「最初のプログラム」と呼びましょう）は<i>、最初のプログラム自体がこのページに何かを書き込もうとするまで、</i> 2番目のプログラムによって特定のページに加えられたすべての変更を確認し<i>ます</i> （これにより、最初のプログラムのページの別のコピー）。 つまり コピーオンライトメカニズムが機能するとすぐに、他のプログラムによって行われた変更は表示されなくなります。 カーネルはこの動作を保証しませんが、これはx86プロセッサーの場合です。 これは、同じAPIの観点からも、ある程度理にかなっています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     共有マッピングについては、次のとおりです。 読み取り/書き込み許可はページに設定され、それらは単にページキャッシュにマップされます。 したがって、ページに変更を加える人は誰でも、これをすべてのプロセスで見ることができます。 さらに、データはハードドライブにフラッシュされます。 最後に、前の図のページが実際に読み取り専用である場合、ページフォールトにアクセスするとキャッチされるため、コピーオンライトロジックではなく、セグメンテーションフォールトが発生します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     共有ライブラリも、他のファイルと同様にメモリにマップされます。 これは特別なことではありません。API呼び出しを介してプログラマーが使用できるのと同じプライベートマッピングです。 以下は、ファイルをメモリにマッピングするメカニズムを使用して、レンダープログラムの2つのインスタンスのアドレス空間の一部を示す例です。 さらに、物理メモリの対応する領域が表示されます。 したがって、この記事で出会った概念をリンクすることができます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/134/ca8/a74/134ca8a741c16d0764189fd1f896c8a0.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     これで、記憶の基本に関する3つの記事シリーズが終了します。 この情報がお役に立てば幸いであり、このトピックに関する一般的なアイデアを作成できたことを願っています。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     シリーズの記事へのリンク： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> プロセスメモリ編成 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://habrahabr.ru/company/smart_soft/blog/185226/">habrahabr.ru/company/smart_soft/blog/185226</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://duartes.org/gustavo/blog/post/anatomy-of-a-program-in-memory/">duartes.org/gustavo/blog/post/anatomy-of-a-program-in-memory</a> </li><li> カーネルがメモリを管理する方法 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://habrahabr.ru/company/smart_soft/blog/226315/">habrahabr.ru/company/smart_soft/blog/226315</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://duartes.org/gustavo/blog/post/how-the-kernel-manages-your-memory/">duartes.org/gustavo/blog/post/how-the-kernel-manages-your-memory</a> </li><li> ページキャッシュ、またはRAMとファイルの関係 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://habrahabr.ru/company/smart_soft/blog/227905/">habrahabr.ru/company/smart_soft/blog/227905</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://duartes.org/gustavo/blog/post/page-cache-the-affair-between-memory-and-files/">duartes.org/gustavo/blog/post/page-cache-the-affair-between-memory-and-files</a> </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     この資料は、Smart-Softの<a href="http://smart-soft.ru/">従業員-smart-soft.ru</a>によって作成され<a href="http://smart-soft.ru/">ました</a> 。 </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J228919/index.html">メルセデスのロボットトラックがドイツの道路を走った</a></li>
<li><a href="../J22892/index.html">habrahabrの作成者へのインタビュー-Denis Kryuchkov</a></li>
<li><a href="../J228921/index.html">SIPアラートCyber​​Data</a></li>
<li><a href="../J228931/index.html">クラウドファイナンスの仕組み</a></li>
<li><a href="../J228933/index.html">データセンターが良好な場所、またはITインフラストラクチャ市場の地域的特徴</a></li>
<li><a href="../J228939/index.html">WebCampでの早期登録の最終日とHabrahabr読者向けの追加割引</a></li>
<li><a href="../J22894/index.html">認証に関する問題-記憶</a></li>
<li><a href="../J228943/index.html">Vidon.me AV200：Androidプレーヤーの革命または進化、またはDVDFabを追加するとXBMCから何が得られるのでしょうか？</a></li>
<li><a href="../J228949/index.html">SwiftでJSONを操作する</a></li>
<li><a href="../J228951/index.html">[翻訳] PHPのマジックメソッド</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>