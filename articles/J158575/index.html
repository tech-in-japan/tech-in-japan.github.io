<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-FEDBM7F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-FEDBM7F51Q');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏽 🖨️ 🕡 WindowsサーバーでのFirebird / InterBaseデータベースバックアップの包括的な自動化 ✅ 👨🏾‍🚒 👩‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="以下の資料は、バックアップシステムを作成することの重要性を認識しているが、独自のスクリプトまたはユーティリティをまだ開発していないデータベース管理者を始めるのに役立ちます。 以下では、Firebirdデータベースからのバックアップの削除を自動化するために組織で使用されるコマンドbatファイルの形式で...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="sitemap" type="application/xml" href="/sitemap.xml"/>

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>document.write('<script src="https://pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://tech-in-japan.github.io/index.html"></a>
    <div class="page-header-text">Clever Geek Handbook</div>
  </header>
  <section class="page js-page"><h1>WindowsサーバーでのFirebird / InterBaseデータベースバックアップの包括的な自動化</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body"><img src="https://habrastorage.org/getpro/habr/post_images/493/01e/546/49301e546e3b00631a04e4f61ad1796e.png" alt="画像">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     以下の資料は、バックアップシステムを作成することの重要性を認識しているが、独自のスクリプトまたはユーティリティをまだ開発していないデータベース管理者を始めるのに役立ちます。 以下では、Firebirdデータベースからのバックアップの削除を自動化するために組織で使用されるコマンドbatファイルの形式でスクリプトを提供し、その主要な断片を分析して使用例を示します。  InterbaseまたはYaffilデータベースにも適していますが、バックアップユーティリティの呼び出しを最小限に変更するだけで、ほぼすべてのDBMSに適応できると思います。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     まず最初に、問題の理論に慣れることができるいくつかのリンクを示します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://www.firebirdsql.org/file/documentation/reference_manuals/user_manuals/html/gbak.html">firebirdsql.org：Firebirdのgbakバックアップおよび復元ツール</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://ibase.ru/devinfo/gbak.htm">ibase.ru：GBAK、Firebird、およびInterBaseユーティリティ</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     用語について少し： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="http://ibase.ru/devinfo/gbak.htm">バックアップ</a> （ <acronym>b</acronym> ）-データベースからバックアップを削除するプロセス。 出力には、データベースではなく、新しいデータベースに展開できる特別な形式のファイルがあります。 通常、インデックスページの不足、データページのスペース予約の使用、「ジャンク」レコードの不在、および圧縮に関係するその他の要因により、元のデータベースファイルよりもはるかに軽量です。 </li><li>  <a href="http://ibase.ru/devinfo/gbak.htm">復元、または復元</a> （ <acronym>r</acronym> ）-バックアップファイルから新しいデータベースを作成するプロセス。 結果のデータベースは、バックアップ開始時の元のデータベースと同等になります。 回復段階で、データベースの所有者を変更したり、データベースのページサイズを変更したり、新しいキャッシュサイズを設定したりできます。 スクリプトでは、復元者がサポートの役割を果たすことがよくあります-バックアップファイルが正しく受信され、データベースの復元に適していることを確認します。 </li><li>  <acronym>b / r-</acronym>一連のバックアップおよびリカバリプロセス。その結果、トランザクションカウントがリセットされ、ディスクスペースを最小限に抑えた、整頓された新しいデータベースが得られます。 誰も知らなかった場合：Firebird / InterBaseデータベースはサイズを大きくすることしかできませんが、ファイルシステムに「余分な」ページを返すことはありません。 したがって、b / rがデータベースの「重みを失う」唯一の方法です。 また、b / rは、サーバー間でデータベースを転送する場合、特に異なるOS、特に異なる鉄のアーキテクチャに関しては、非常に望ましいオプションです。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     したがって、必要なキーを使用してgbak.exeを実行するだけでなく、問題に包括的に取り組む場合、データベースのバックアッププロセスを構成するアクティビティは何ですか？ 次の主なものを選びます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li> 宛先ディレクトリが存在することを確認し、必要に応じて作成します（出力ファイルをまだ存在しないディレクトリに配置する必要があることが判明した場合、すべてのユーティリティがディレクトリ構造を作成するわけではありません）。 </li><li> サーバーのパッケージから標準のユーティリティツールを使用して、データベースからバックアップを削除します。 </li><li> バックアップのオプションのテスト復元（また、サーバーがバックアップファイルを作成したが、メタデータのエラーのために<a href="http://ibase.ru/devinfo/db_repair.htm">新しいデータベースに復元できなかった</a>場合もあります）。 </li><li> アーカイバによるオプションのバックアップファイル圧縮。 </li><li> ファイルの数および/またはそれらが占有するスペースによる保存されたバックアップのオプションの制御。 </li><li> 電子メール、NET SENDトランスポート、またはその他の手段により、前の手順で発生したあらゆる種類の障害を管理者に通知します。 累積障害ログを維持することもお勧めします。 </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     もちろん、スクリプトは上記のすべてを実行できますが、他の何かを実行することもできます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> ローカルまたはリモートの任意のデータベースを操作します。 完全に指定されたパス、またはエイリアスを使用して。 非標準が使用されている場合、オプションのポート表示付き。 </li><li> ローカルデータベースの場合、 <a href="http://ibase.ru/devinfo/gbak.htm">バックアップはサービスを介して</a>使用されるため、操作時間が大幅に短縮さ<a href="http://ibase.ru/devinfo/gbak.htm">れます</a> 。 テストリストアは常にローカルマシンで実行され、サービスを通じて実行されます。 </li><li> デフォルトでは、ソースデータベースのガベージコレクションはバックアップ段階で無効になっています（有効にするオプションがあります）。これにより、操作時間が短縮されます。 </li><li>  RARはバックアップアーカイバとして使用され、圧縮の度合い（および操​​作の速度）は1（低圧縮、最高速度）から5（最高の圧縮、長時間）に設定されます。 圧縮値0は、「アーカイブせず、バックアップファイルを変更せずに保存する」ことを意味します。  rar呼び出しを別のアーカイバ（無料の7zipなど）に簡単に置き換えることができます。 しかし、私たちのテストでは、rarは依然として著しく高速です。 </li><li> 未定義の数のファイル（おそらくマスクを介して）をスクリプトに転送できます。スクリプトは最終アーカイブに追加する必要があります。 この機会に、データベースのバックアップごとに、このデータベースを提供するアプリケーションプログラムの実行可能ファイルが存在するようにします。  6〜12か月前にアーカイブを作成する必要がある場合に便利なのは、すぐに手に入るのは、そのバージョンのメタデータで機能する古いデータベースに関連するプログラムです。 </li><li> バックアップ付きのアーカイブ内にb / rログを追加するオプションの機能があります。  「デブリーフィング」事後の場合。 </li><li> 保存されているバックアップの数は、再定義されていない場合、30個です。 宛先フォルダーの指定されたコピー数に達すると、最も古いバックアップが削除され、新しいバックアップ用のスペースが解放されます。 パラメーターの値を0に設定すると、バックアップ数の制御をオフにできます。 </li><li> 保存されるバックアップのボリュームはデフォルトでは制御されませんが、バイト、Kb、Mb、またはGBで指定できます。 </li><li> デフォルトでは、b / rはSYSDBA組み込みスーパーユーザーの代わりに実行されます。 ローカルサーバーのSYSDBAパスワードはソースに保存されます。 また、ネットワーク経由でバックアップを実行するには、リモートサーバーのSYSDBAパスワードとともにパラメーターをスクリプトに渡すことができます。 特にパロノイドの場合、ローカルサーバーのSYSDBAパスワードをソースから消去し、呼び出されたときにパラメーターとして渡すこともできます。 </li><li> メーラーとして、システム管理者の間でよく知られている<a href="http://sourceforge.net/projects/blat/">Blat</a>ユーティリティが使用されます。 </li><li> 出力ファイル（圧縮が無効になっている場合、アーカイブまたは通常のバックアップファイル）には、作成の日時スタンプが含まれており、バックアップディレクトリ内を視覚的に移動できます。 </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     エントリーが遅れました。 ネタバレの下で、スクリプトの完全なソースコードを提供します。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ソースfb_backup.bat</b> <div class="spoiler_text"><pre><code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">CLS</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> OFF <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> #=============================================================================# <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # Firebird/InterBase database backup, test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>, zip and rotate script # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-built_in"><span class="hljs-built_in">Ver</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">8</span></span> (<span class="hljs-number"><span class="hljs-number">26</span></span>.<span class="hljs-number"><span class="hljs-number">01</span></span>.<span class="hljs-number"><span class="hljs-number">2013</span></span>) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # Author: arni (email:arnisoft <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> rambler dot ru) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>: # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # FB_BACKUP [host[/port]:][<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>]db_file_or_alias result_dir # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [/count:backup_count] [/space:backup_space_limit] [/gc] # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [/<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>] [/compress:level] [/password:SYSDBA_password] # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [other_files_to_compress [...]] # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # Input params: # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [host[/port]:][<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>] : local or network, full-specified <span class="hljs-built_in"><span class="hljs-built_in">path</span></span> or alias # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # db_file_or_alias to the source database # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # result_dir : result backup collecting directory # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /count:backup_count : backup file number to keep (<span class="hljs-number"><span class="hljs-number">30</span></span> by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /space:backup_space_limit : total backup size <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> bytes (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> use by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # you can use suffixes K, M or G. # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /gc : need to collect garbage <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> DB (OFF by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> : need to <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> (OFF by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /compress:level : compress ratio <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> RAR (<span class="hljs-number"><span class="hljs-number">2</span></span> by default): # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> compress, <span class="hljs-number"><span class="hljs-number">1</span></span>: fastest, <span class="hljs-number"><span class="hljs-number">2</span></span>: fast, # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-number"><span class="hljs-number">3</span></span>: normal, <span class="hljs-number"><span class="hljs-number">4</span></span>: good, <span class="hljs-number"><span class="hljs-number">5</span></span>: best # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /password:SYSDBA_password : optional SYSDBA password <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> remote server # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # (by default uses one from the source code) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # other_files_to_compress : list of files that must be add to archive # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> #=============================================================================# <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Server ==================================================================== <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> gbak="C:\Programs\FB25\bin\gbak.exe" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_USER=SYSDBA <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD_LOCAL=masterkey <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD_REMOTE= <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Backup/<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> preferences ================================================ <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> temp_backup_dir=<span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> temp_restore_dir=<span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_count=<span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_space_limit=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_ext=fbk <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> garbage_collection=-g <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== RAR ======================================================================= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar="C:\Program Files\WinRAR\rar.exe" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_options=a -y -ep -idcd <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_password= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_compress_ratio=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Mailer (see "Blat" <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> http://sourceforge.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/projects/blat) =============== <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> blat="C:\Programs\Blat307\blat.exe" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> smtp_server=smtp.mailserver.ru <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> mail_sender=foo@mailserver.ru <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> mail_login=foo <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> mail_password=<span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> mail_receiver= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> mail_subject=Fail while database b/r <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Other preferences ========================================================= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> include_logs_to_archive=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> net_send_receiver= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> error_log= <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define database location ================================================== <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> full_db_specification=%~<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> full_db_specification = <span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Devide DB spec to network and local parts <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f "DELIMS=: TOKENS=<span class="hljs-number"><span class="hljs-number">1</span></span>*" <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ("<span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span>") <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> network=<span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> local=<span class="hljs-variable"><span class="hljs-variable">%%j</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Test <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> spec. is alias with no network part <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> network= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> local=<span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Test <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> spec. is full specified file with no network part <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f "DELIMS=\ TOKENS=*" <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ("<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>") <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>" == "\<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> network= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> local=<span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> network_specification = <span class="hljs-variable"><span class="hljs-variable">%network%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%network%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Extract port from network spec (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> exists) <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f "DELIMS=/ TOKENS=<span class="hljs-number"><span class="hljs-number">1</span></span>*" <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ("<span class="hljs-variable"><span class="hljs-variable">%network%</span></span>") <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> host=<span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> port=<span class="hljs-variable"><span class="hljs-variable">%%j</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%%j</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> network_host = <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> network_port = <span class="hljs-variable"><span class="hljs-variable">%%j</span></span> ) ) ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Test <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> DB is local or remote <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> service_mgr_host=localhost <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_db=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%network%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%host%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> "<span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%host%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> "localhost" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_db=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%is_local_db%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%network%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> service_mgr_host=<span class="hljs-variable"><span class="hljs-variable">%network%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> local_db_specification = <span class="hljs-variable"><span class="hljs-variable">%local%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Param #<span class="hljs-number"><span class="hljs-number">1</span></span> {DB specification} missing! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Extract file (or alias) from local part of spec. <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ("<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>") <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> local_path=<span class="hljs-variable"><span class="hljs-variable">%%~</span></span>dpi <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> local_file_or_alias=<span class="hljs-variable"><span class="hljs-variable">%%~</span></span>nxi ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> "<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> local_path = <span class="hljs-variable"><span class="hljs-variable">%local_path%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Check DB file exists <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> local, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> aliased specification <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%is_local_db%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%local%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Local DB file <span class="hljs-variable"><span class="hljs-variable">%local%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> found! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) ) <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> local_db_file_or_alias = <span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define result directory =================================================== <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> result_dir=%~<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> result_dir = <span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Param #<span class="hljs-number"><span class="hljs-number">2</span></span> {backup collecting directory} missing! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Cut the result <span class="hljs-built_in"><span class="hljs-built_in">dir</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> it is <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>-style (ends with separator) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir:~-1%</span></span>" == "\" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> result_dir=<span class="hljs-variable"><span class="hljs-variable">%result_dir:~0,-1%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Try to create the result directory <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> it is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exists yet <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">MD</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Cannot create backup collecting directory! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> Test <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> it is local or remote directory (elementary, may get wrong answer) <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_result_dir=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir:~0,2%</span></span>" == "\\" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_result_dir=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Use other command line options ============================================ :loop_options <span class="hljs-built_in"><span class="hljs-built_in">SHIFT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> next_param=%~<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span>" == "" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> print_options <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> prefix=<span class="hljs-variable"><span class="hljs-variable">%next_param:~0,1%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%prefix%</span></span>" == "/" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> next_param=<span class="hljs-variable"><span class="hljs-variable">%next_param:~1%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%prefix%</span></span>" == "-" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> next_param=<span class="hljs-variable"><span class="hljs-variable">%next_param:~1%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f "DELIMS=: TOKENS=<span class="hljs-number"><span class="hljs-number">1</span></span>*" <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ("<span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span>") <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> value=<span class="hljs-variable"><span class="hljs-variable">%%j</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" == "count" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%%j</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> count <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" == "space" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%%j</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> space <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" == "gc" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> gc <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" == "<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" == "compress" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%%j</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> compress <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>" == "password" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%%j</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> password <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> add_file_to_compress <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%prefix%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "/" <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> add_file_to_compress <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> unknown param found: <span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options ) ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> empty param found! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define file count <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the result <span class="hljs-built_in"><span class="hljs-built_in">dir</span></span> ======================================= :count <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a backup_count=<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define allowed backup space limit ========================================= :space <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> suffix=<span class="hljs-variable"><span class="hljs-variable">%value:~-1%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%suffix%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "<span class="hljs-number"><span class="hljs-number">9</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> value=<span class="hljs-variable"><span class="hljs-variable">%value:~0,-1%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%suffix%</span></span>" == "K" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> file_size_shift=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a value*=<span class="hljs-number"><span class="hljs-number">1000</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%suffix%</span></span>" == "M" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> file_size_shift=<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a value*=<span class="hljs-number"><span class="hljs-number">1000</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%suffix%</span></span>" == "G" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> file_size_shift=<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a value*=<span class="hljs-number"><span class="hljs-number">1000</span></span> ) ) <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a backup_space_limit=<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define need of garbage collection ========================================= :gc <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> garbage_collection= <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "<span class="hljs-number"><span class="hljs-number">0</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> garbage_collection=-g <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "N" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> garbage_collection=-g <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "NO" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> garbage_collection=-g <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "OFF" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> garbage_collection=-g <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define need of test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> =============================================== :<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "<span class="hljs-number"><span class="hljs-number">0</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "N" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "NO" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> /i "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" == "OFF" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define need of backup compression and compress ratio ====================== :compress <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GEQ</span></span> "<span class="hljs-number"><span class="hljs-number">0</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%value%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">LEQ</span></span> "<span class="hljs-number"><span class="hljs-number">5</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_compress_ratio=<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define SYSDBA password (<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> addition or <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">replace</span></span> source code given) ===== :password <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> "<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_LOCAL%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> "<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_REMOTE%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD_LOCAL=<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD_REMOTE=<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> "<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_LOCAL%</span></span>" == "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD_LOCAL=<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> "<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_REMOTE%</span></span>" == "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD_REMOTE=<span class="hljs-variable"><span class="hljs-variable">%value%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define file list to compress (<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> addition to backup and maybe logs) ======= :add_file_to_compress <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span>" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_files="<span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span>" ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_files=<span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%next_param%</span></span>" ) <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> loop_options <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== <span class="hljs-built_in"><span class="hljs-built_in">Print</span></span> predefined or recognized <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> command line options ==================== :print_options <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_count%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_count = <span class="hljs-variable"><span class="hljs-variable">%backup_count%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_count = OFF ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%file_size_shift%</span></span>" == "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> file_size_shift=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%file_size_shift%</span></span> == <span class="hljs-number"><span class="hljs-number">6</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_space_limit = <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> Mb ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%file_size_shift%</span></span> == <span class="hljs-number"><span class="hljs-number">3</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_space_limit = <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> Kb ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_space_limit = <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> bytes ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_space_limit = OFF ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%garbage_collection%</span></span>" == "-g" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> garbage_collection_flag = OFF ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> garbage_collection_flag = ON ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%restore%</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> test_restore_flag = OFF ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> test_restore_flag = ON ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_compress_ratio%</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_compressing = OFF ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_compressing = ON, RAR-ratio=<span class="hljs-variable"><span class="hljs-variable">%rar_compress_ratio%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define backup file and backup log ========================================= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> datetime=<span class="hljs-variable"><span class="hljs-variable">%date:~-2%</span></span><span class="hljs-variable"><span class="hljs-variable">%date:~3,2%</span></span><span class="hljs-variable"><span class="hljs-variable">%date:~0,2%</span></span>_<span class="hljs-variable"><span class="hljs-variable">%time:~0,2%</span></span><span class="hljs-variable"><span class="hljs-variable">%time:~3,2%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> finish_file=<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.%datetime: =<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-variable"><span class="hljs-variable">%.%</span></span>backup_ext% <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> direct_backup=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_compress_ratio%</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%is_local_result_dir%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> direct_backup=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%restore%</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> direct_backup=<span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%direct_backup%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_file=<span class="hljs-variable"><span class="hljs-variable">%finish_file%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_file=<span class="hljs-variable"><span class="hljs-variable">%temp_backup_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.<span class="hljs-variable"><span class="hljs-variable">%backup_ext%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%temp_backup_dir%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">MD</span></span> "<span class="hljs-variable"><span class="hljs-variable">%temp_backup_dir%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%temp_backup_dir%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Cannot create backup directory! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) ) ) <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_file = <span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_log=<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.backup.log <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_log = <span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> file and <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> log ======================================= <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> restore_file=<span class="hljs-variable"><span class="hljs-variable">%temp_restore_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.testrest <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%restore%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%temp_restore_dir%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">MD</span></span> "<span class="hljs-variable"><span class="hljs-variable">%temp_restore_dir%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%temp_restore_dir%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> temp_restore_dir = <span class="hljs-variable"><span class="hljs-variable">%temp_restore_dir%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Cannot create <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> directory! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) ) <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> restore_file = <span class="hljs-variable"><span class="hljs-variable">%restore_file%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> restore_log=<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>.log ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> restore_log = <span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> restore_log=just_a_stub ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Define compresed file ===================================================== <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> compressed_file=<span class="hljs-variable"><span class="hljs-variable">%finish_file%</span></span>.rar <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_compress_ratio%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> compressed_file = <span class="hljs-variable"><span class="hljs-variable">%compressed_file%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> finish_file=<span class="hljs-variable"><span class="hljs-variable">%compressed_file%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Delete <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> actual files (over <span class="hljs-keyword"><span class="hljs-keyword">defined</span></span> count) ============================== <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a over=<span class="hljs-variable"><span class="hljs-variable">%backup_count%</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_count%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> deleting_old_files = <span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.*.<span class="hljs-variable"><span class="hljs-variable">%backup_ext%</span></span>* <span class="hljs-built_in"><span class="hljs-built_in">DEL</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.*.<span class="hljs-variable"><span class="hljs-variable">%backup_ext%</span></span>*" /q ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_count%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f "SKIP=<span class="hljs-variable"><span class="hljs-variable">%over%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%%f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ('<span class="hljs-built_in"><span class="hljs-built_in">DIR</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.*.<span class="hljs-variable"><span class="hljs-variable">%backup_ext%</span></span>*" /a:-D /b /o:-N <span class="hljs-number"><span class="hljs-number">2</span></span>^&gt;<span class="hljs-built_in"><span class="hljs-built_in">NUL</span></span>') <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%%f</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> deleting_old_file = <span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%%f</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DEL</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%%f</span></span>" /q ) ) ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Perform backup ============================================================ <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">DEL</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" /q <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> backup_start = <span class="hljs-variable"><span class="hljs-variable">%date%</span></span> <span class="hljs-variable"><span class="hljs-variable">%time:~0,8%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_backup=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%is_local_db%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%is_local_result_dir%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_backup=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%direct_backup%</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> is_local_backup=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD=<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_LOCAL%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD=<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_REMOTE%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%rar_password%</span></span>" == "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_password=<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%is_local_backup%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-variable"><span class="hljs-variable">%gbak%</span></span> -b <span class="hljs-variable"><span class="hljs-variable">%garbage_collection%</span></span> -se <span class="hljs-variable"><span class="hljs-variable">%service_mgr_host%</span></span>:service_mgr <span class="hljs-variable"><span class="hljs-variable">%local%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" -v -y "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%gbak%</span></span> -b <span class="hljs-variable"><span class="hljs-variable">%garbage_collection%</span></span> -se <span class="hljs-variable"><span class="hljs-variable">%service_mgr_host%</span></span>:service_mgr <span class="hljs-variable"><span class="hljs-variable">%local%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" -v &gt;"<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-variable"><span class="hljs-variable">%gbak%</span></span> -b <span class="hljs-variable"><span class="hljs-variable">%garbage_collection%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" -v -y "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%gbak%</span></span> -b <span class="hljs-variable"><span class="hljs-variable">%garbage_collection%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" -v &gt;"<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Backup fail! See <span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> details. ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Backup fail! ) <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Backup fail! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Perform test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> ====================================================== <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%restore%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">DEL</span></span> "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" /q <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_LOCAL%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD=<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_LOCAL%</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> ISC_PASSWORD=<span class="hljs-variable"><span class="hljs-variable">%ISC_PASSWORD_REMOTE%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> restore_start = <span class="hljs-variable"><span class="hljs-variable">%date%</span></span> <span class="hljs-variable"><span class="hljs-variable">%time:~0,8%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-variable"><span class="hljs-variable">%gbak%</span></span> -rep -se <span class="hljs-variable"><span class="hljs-variable">%service_mgr_host%</span></span>:service_mgr "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%restore_file%</span></span>" -v -y "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%gbak%</span></span> -rep -se <span class="hljs-variable"><span class="hljs-variable">%service_mgr_host%</span></span>:service_mgr "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%restore_file%</span></span>" -v &gt;"<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> fail! See <span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> details. ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> fail! ) <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXIST</span></span> "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> fail! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Perform RAR-compression or <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> backup into destination <span class="hljs-built_in"><span class="hljs-built_in">dir</span></span> =============== <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%rar_password%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_password=-p<span class="hljs-variable"><span class="hljs-variable">%rar_password%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> rar_options=<span class="hljs-variable"><span class="hljs-variable">%rar_options%</span></span> -m<span class="hljs-variable"><span class="hljs-variable">%rar_compress_ratio%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_files="<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%include_logs_to_archive%</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%restore%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_files=<span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%restore_log%</span></span>" ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> backup_files=<span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_log%</span></span>" ) ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_compress_ratio%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> compressing_start = <span class="hljs-variable"><span class="hljs-variable">%date%</span></span> <span class="hljs-variable"><span class="hljs-variable">%time:~0,8%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar%</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_options%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%compressed_file%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar%</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_options%</span></span> <span class="hljs-variable"><span class="hljs-variable">%rar_password%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%compressed_file%</span></span>" <span class="hljs-variable"><span class="hljs-variable">%backup_files%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=Compression fail! <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%direct_backup%</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> copying_start = <span class="hljs-variable"><span class="hljs-variable">%date%</span></span> <span class="hljs-variable"><span class="hljs-variable">%time:~0,8%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-built_in"><span class="hljs-built_in">COPY</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%finish_file%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">COPY</span></span> "<span class="hljs-variable"><span class="hljs-variable">%backup_file%</span></span>" "<span class="hljs-variable"><span class="hljs-variable">%finish_file%</span></span>" ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Delete <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> actual files (over <span class="hljs-keyword"><span class="hljs-keyword">defined</span></span> space) ============================== <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SETLOCAL</span></span> EnableDelayedExpansion <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> You must enable var delayed expansion by <span class="hljs-built_in"><span class="hljs-built_in">CMD</span></span>.EXE /V:ON or <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> registry key <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> Software\Microsoft\Command Processor\DelayedExpansion: HKLM or HKCU <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> finish ) <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /f <span class="hljs-variable"><span class="hljs-variable">%%f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ('<span class="hljs-built_in"><span class="hljs-built_in">DIR</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%local_file_or_alias%</span></span>.*.<span class="hljs-variable"><span class="hljs-variable">%backup_ext%</span></span>*" /a:-D /b /o:-N') <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ("<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%%f</span></span>") <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> size=<span class="hljs-variable"><span class="hljs-variable">%%~</span></span>zi <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%file_size_shift%</span></span> == <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> size=<span class="hljs-variable"><span class="hljs-variable">!size:~0,-3!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">%file_size_shift%</span></span> == <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> size=<span class="hljs-variable"><span class="hljs-variable">!size:~0,-6!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">!size!</span></span>" == "" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> size=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">!total_space!</span></span>" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a total_space=<span class="hljs-variable"><span class="hljs-variable">!size!</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">!total_space!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEQ</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> /a total_space+=<span class="hljs-variable"><span class="hljs-variable">!size!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-variable"><span class="hljs-variable">!total_space!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-variable"><span class="hljs-variable">%backup_space_limit%</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> deleting_overquota_file = <span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%%f</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DEL</span></span> "<span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span>\<span class="hljs-variable"><span class="hljs-variable">%%f</span></span>" /q ) ) ) ) ) <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> ==== Report when fail or <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> ================================================== :finish <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%fail%</span></span>" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> Finish = <span class="hljs-variable"><span class="hljs-variable">%date%</span></span> <span class="hljs-variable"><span class="hljs-variable">%time:~0,8%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> #=============================================================================# <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-variable"><span class="hljs-variable">%fail%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> #=============================================================================# <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> fail=<span class="hljs-variable"><span class="hljs-variable">%fail%</span></span>, DB: <span class="hljs-variable"><span class="hljs-variable">%full_db_specification%</span></span>, Dest: <span class="hljs-variable"><span class="hljs-variable">%result_dir%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%net_send_receiver%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> SEND <span class="hljs-variable"><span class="hljs-variable">%net_send_receiver%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%fail%</span></span>" <span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> SEND <span class="hljs-variable"><span class="hljs-variable">%net_send_receiver%</span></span> "<span class="hljs-variable"><span class="hljs-variable">%fail%</span></span>" ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%blat%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%smtp_server%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%mail_sender%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%mail_login%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%mail_receiver%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-variable"><span class="hljs-variable">%blat%</span></span> -to "<span class="hljs-variable"><span class="hljs-variable">%mail_receiver%</span></span>" -subject "<span class="hljs-variable"><span class="hljs-variable">%mail_subject%</span></span>" -body "<span class="hljs-variable"><span class="hljs-variable">%fail%</span></span>" -server <span class="hljs-variable"><span class="hljs-variable">%smtp_server%</span></span> -f "<span class="hljs-variable"><span class="hljs-variable">%mail_sender%</span></span>" -u "<span class="hljs-variable"><span class="hljs-variable">%mail_login%</span></span>" -pw "*******" <span class="hljs-variable"><span class="hljs-variable">%blat%</span></span> -to "<span class="hljs-variable"><span class="hljs-variable">%mail_receiver%</span></span>" -subject "<span class="hljs-variable"><span class="hljs-variable">%mail_subject%</span></span>" -body "<span class="hljs-variable"><span class="hljs-variable">%fail%</span></span>" -server <span class="hljs-variable"><span class="hljs-variable">%smtp_server%</span></span> -f "<span class="hljs-variable"><span class="hljs-variable">%mail_sender%</span></span>" -u "<span class="hljs-variable"><span class="hljs-variable">%mail_login%</span></span>" -pw "<span class="hljs-variable"><span class="hljs-variable">%mail_password%</span></span>" ) <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> time_ex=%<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: =<span class="hljs-number"><span class="hljs-number">0</span></span>% <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> "<span class="hljs-variable"><span class="hljs-variable">%error_log%</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> "" ( <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> <span class="hljs-variable"><span class="hljs-variable">%date%</span></span> <span class="hljs-variable"><span class="hljs-variable">%time_ex:~0,8%</span></span> <span class="hljs-variable"><span class="hljs-variable">%fail%</span></span> &gt;&gt; "<span class="hljs-variable"><span class="hljs-variable">%error_log%</span></span>" ) <span class="hljs-keyword"><span class="hljs-keyword">EXIT</span></span> /b <span class="hljs-number"><span class="hljs-number">1</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">exit</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     また、最も単純な形式でスクリプトを実行して生成されたログも提供します。追加のキー、すべてのデフォルトパラメータ、データベースアドレスと宛先ディレクトリのみが転送されます 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">fb_backup.bat localhost：p：\ MSO \ DB \ MS_ORDERS.FDB \\ 192.168.1.1 \ disk_a1 \ exchange&gt; fb_backup.log</b> <div class="spoiler_text"><pre> <code class="hljs tex">#=============================================================================# # # # Firebird/InterBase database backup, test restore, zip and rotate script # # Ver 3.2.7 (11.11.2012) # # # # Author: arni (email:arnisoft at rambler dot ru) # # # # Format: # # FB_BACKUP [host[/port]:][path]db_file_or_alias result_dir # # [/count:backup_count] [/space:backup_space_limit] [/gc] # # [/restore] [/compress:level] [/password:SYSDBA_password] # # [other_files_to_compress [...]] # # # # Input params: # # [host[/port]:][path] : local or network, full-specified path or alias # # db_file_or_alias to the source database # # result_dir : result backup collecting directory # # /count:backup_count : backup file number to keep (30 by default) # # /space:backup_space_limit : total backup size in bytes (not use by default) # # you can use suffixes K, M or G. # # /gc : need to collect garbage in DB (OFF by default) # # /restore : need to do test restore (OFF by default) # # /compress:level : compress ratio for RAR (2 by default): # # 0: not compress, 1: fastest, 2: fast, # # 3: normal, 4: good, 5: best # # /password:SYSDBA_password : optional SYSDBA password for remote server # # (by default uses one from the source code) # # other_files_to_compress : list of files that must be add to archive # # # #=============================================================================# full_db_specification = localhost:p:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSO</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DB</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB network_specification = localhost local_db_specification = p:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSO</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DB</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB local_path = p:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSO</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DB</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>local_db_file_or_alias = MS_ORDERS.FDB result_dir = <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span> backup_count = 30 backup_space_limit = OFF garbage_collection_flag = OFF test_restore_flag = OFF backup_compressing = ON, RAR-ratio=2 backup_file = C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WINDOWS</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TEMP</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.fbk backup_log = <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.backup.log compressed_file = <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.121111_1621.fbk.rar backup_start = 11.11.2012 16:21:48 "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Programs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FB</span></span></span></span>25<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bin</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gbak</span></span></span></span>.exe" -b -g -se localhost:service_mgr p:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSO</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DB</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WINDOWS</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TEMP</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.fbk" -v -y "<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.backup.log" compressing_start = 11.11.2012 16:21:51 "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Program</span></span></span></span> Files<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WinRAR</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rar</span></span></span></span>.exe" a -y -ep -idcd -m2 "<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.121111_1621.fbk.rar" "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WINDOWS</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TEMP</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.fbk" "<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.backup.log"   <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>192.168.1.1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disk</span></span></span></span>_a1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.121111_1621.fbk.rar  C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WINDOWS</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TEMP</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MS</span></span></span></span>_ORDERS.FDB.fbk 6<span class="hljs-comment"><span class="hljs-comment">% 12% 18% 24% 30% 36% 42% 48% 54% 60% 66% 72% 78% 84% 86% OK  \\192.168.1.1\disk_a1\\MS_ORDERS.FDB.backup.log 92% 98%100% OK Finish = 11.11.2012 16:21:51</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     スクリプトの断片を分析してみましょう。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">見出し</b> <div class="spoiler_text"> ヘッダーには、現在のバージョンであるオーサーシップへの参照が含まれていますが、主なものは呼び出し形式の説明です。基本的なパラメーター、オプション、デフォルト値はオプションのパラメーターを受け入れます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     オプションのパラメーターは任意の順序で入力できます。コマンドラインキーの標準文字（スラッシュ[/]またはダッシュ[-]）を前に付けることをお勧めします。 <pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">CLS</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> OFF <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> #=============================================================================# <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # Firebird/InterBase database backup, test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>, zip and rotate script # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-built_in"><span class="hljs-built_in">Ver</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">8</span></span> (<span class="hljs-number"><span class="hljs-number">26</span></span>.<span class="hljs-number"><span class="hljs-number">01</span></span>.<span class="hljs-number"><span class="hljs-number">2013</span></span>) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # Author: arni (email:arnisoft <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> rambler dot ru) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>: # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # FB_BACKUP [host[/port]:][<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>]db_file_or_alias result_dir # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [/count:backup_count] [/space:backup_space_limit] [/gc] # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [/<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span>] [/compress:level] [/password:SYSDBA_password] # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [other_files_to_compress [...]] # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # Input params: # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # [host[/port]:][<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>] : local or network, full-specified <span class="hljs-built_in"><span class="hljs-built_in">path</span></span> or alias # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # db_file_or_alias to the source database # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # result_dir : result backup collecting directory # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /count:backup_count : backup file number to keep (<span class="hljs-number"><span class="hljs-number">30</span></span> by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /space:backup_space_limit : total backup size <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> bytes (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> use by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # you can use suffixes K, M or G. # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /gc : need to collect garbage <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> DB (OFF by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> : need to <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> test <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> (OFF by default) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /compress:level : compress ratio <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> RAR (<span class="hljs-number"><span class="hljs-number">2</span></span> by default): # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> compress, <span class="hljs-number"><span class="hljs-number">1</span></span>: fastest, <span class="hljs-number"><span class="hljs-number">2</span></span>: fast, # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # <span class="hljs-number"><span class="hljs-number">3</span></span>: normal, <span class="hljs-number"><span class="hljs-number">4</span></span>: good, <span class="hljs-number"><span class="hljs-number">5</span></span>: best # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # /password:SYSDBA_password : optional SYSDBA password <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> remote server # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # (by default uses one from the source code) # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # other_files_to_compress : list of files that must be add to archive # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> # # <span class="hljs-built_in"><span class="hljs-built_in">ECHO</span></span> #=============================================================================#</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">デフォルトパラメータの決定</b> <div class="spoiler_text"> ここでは、セクションを担当する5つのブロックが表示されます。 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> サーバー設定; </li><li>  b / rパラメータ; </li><li> アーカイバ設定; </li><li> メーラーオプション。 </li><li> その他のパラメーター。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Server ==================================================================== SET gbak="C:\Programs\FB25\bin\gbak.exe" SET ISC_USER=SYSDBA SET ISC_PASSWORD_LOCAL=masterkey SET ISC_PASSWORD_REMOTE= REM ==== Backup/restore preferences ================================================ SET temp_backup_dir=%TEMP% SET temp_restore_dir=%TEMP% SET backup_count=30 SET backup_space_limit=0 SET backup_ext=fbk SET garbage_collection=-g SET restore=0 REM ==== RAR ======================================================================= SET rar="C:\Program Files\WinRAR\rar.exe" SET rar_options=a -y -ep -idcd SET rar_password= SET rar_compress_ratio=2 REM ==== Mailer (see "Blat" at http://sourceforge.net/projects/blat) =============== SET blat="C:\Programs\Blat307\blat.exe" SET smtp_server=smtp.mailserver.ru SET mail_sender=foo@mailserver.ru SET mail_login=foo SET mail_password=1234 SET mail_receiver= SET mail_subject=Fail while database b/r REM ==== Other preferences ========================================================= SET include_logs_to_archive=1 SET net_send_receiver= SET error_log=</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> ここで： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  gbak-サーバーバンドルからユーティリティユーティリティへのパス。 </li><li>  ISC_USER-代わりにb / rが発生するユーザー。 </li><li>  ISC_PASSWORD_LOCAL-ローカルマシンで選択したユーザーのパスワード。 </li><li>  ISC_PASSWORD_REMOTE-リモートマシンで選択されたユーザーのパスワード（パラメーター/パスワードを渡すことをお勧めします：xxxxxxxx）; </li><li>  temp_backup_dir-宛先ディレクトリにアーカイブされる前にバックアップが実行される一時ディレクトリ。 元のデータベースの場所と一致しない物理ディスクを選択することをお勧めします。 </li><li>  temp_restore_dir-テスト復元が行われるディレクトリ。 元のデータベースの場所と一致せず、バックアップファイルの場所と一致しない物理ディスクを選択することをお勧めします。 </li><li>  backup_ext-バックアップ付きのデフォルトのファイル拡張子。 </li><li>  garbage_collection-gbak.exeキー。バックアップ中のガベージコレクションに関するデフォルトの動作を担当します（/ gcパラメーターを制御することをお勧めします）。 </li><li>  restore-テストリカバリを実行する必要性に関するデフォルトの動作のフラグ（/ restoreオプションを制御することをお勧めします）; </li><li>  rar_options-RARアーカイバのデフォルトキー： "a"-圧縮。  「-y」-質問をしません。  「-ep」-パスを除外します。  「-idcd」-出力に著作権と準備マークを付けない。 </li><li>  rar_password-アーカイブのパスワード（設定されていない場合、アーカイバーはFirebirdユーザーのパスワードを使用します）; </li><li>  rar_compress_ratio-デフォルトの圧縮率（/ compress：levelパラメーターを制御することをお勧めします） </li><li>  blat-メーラーblat.exeへのパス。 </li><li>  smtp_server-メーリングが実行されるSMTPサーバー。 </li><li>  mail_sender-送信者の住所。 </li><li>  mail_login-サーバー上の送信者ログイン。 </li><li>  mail_password-サーバーの送信者パスワード。 </li><li>  mail_receiver-郵送先の住所。 </li><li>  mail_subject-メーリングリストのヘッダー。 </li><li>  include_logs_to_archive-b / rログをアーカイブ内に置くためのフラグ。 </li><li>  net_send_receiver-NET SENDトランスポート障害アラートが送信されるホストのネットワーク名。 </li><li>  error_log-失敗したエラーのログファイル。 </li></ul></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ソースデータベース定義</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 渡された最初のパラメーターからソースデータベースの仕様を読み取ります。 </li><li> ホスト名、ポート、ローカルパス、データベースファイル名またはそのエイリアスへの仕様の分離。 </li><li> 仕様の一部をコンソールに印刷します。 </li><li> このデータベースがローカルであるかリモートであるかを確認します（クラシックバックアップまたはサービスを介したバックアップを選択するときに重要になります）。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Define database location ================================================== SET full_db_specification=%~1 ECHO full_db_specification = %full_db_specification% REM Devide DB spec to network and local parts FOR /f "DELIMS=: TOKENS=1*" %%i IN ("%full_db_specification%") DO ( SET network=%%i SET local=%%j ) REM Test if spec. is alias with no network part IF "%local%" == "" ( SET network= SET local=%full_db_specification% ) REM Test if spec. is full specified file with no network part FOR /f "DELIMS=\ TOKENS=*" %%i IN ("%local%") DO IF "%local%" == "\%%i" ( SET network= SET local=%full_db_specification% ) ECHO network_specification = %network% IF "%network%" GTR "" ( REM Extract port from network spec (if exists) FOR /f "DELIMS=/ TOKENS=1*" %%i IN ("%network%") DO ( SET host=%%i SET port=%%j IF "%%j" GTR "" ( ECHO network_host = %%i ECHO network_port = %%j ) ) ) REM Test if DB is local or remote SET service_mgr_host=localhost SET is_local_db=1 IF "%network%" GTR "" IF "%host%" NEQ "127.0.0.1" IF /i "%host%" NEQ "localhost" SET is_local_db=0 IF %is_local_db% == 1 IF "%network%" GTR "" SET service_mgr_host=%network% ECHO local_db_specification = %local% IF "%local%" == "" ( SET fail=Param #1 {DB specification} missing! GOTO finish ) REM Extract file (or alias) from local part of spec. FOR /f %%i IN ("%local%") DO ( SET local_path=%%~dpi SET local_file_or_alias=%%~nxi ) IF "%local%" NEQ "%local_file_or_alias%" ( ECHO local_path = %local_path% REM Check DB file exists for local, not aliased specification IF %is_local_db% == 1 IF NOT EXIST "%local%" ( SET fail=Local DB file %local% not found! GOTO finish ) ) ECHO local_db_file_or_alias = %local_file_or_alias%</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">結果のディレクトリの定義（バックアップが追加される場所）</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> スクリプトに渡された2番目のパラメーターから結果のディレクトリを読み取ります。 </li><li> 結果のディレクトリが見つからない場合、作成されます。 </li><li> ディレクトリの場所の決定：ローカルまたはリモート（ネットワーク）-最適なバックアップ戦略を選択するために以下で必要になります。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Define result directory =================================================== SET result_dir=%~2 ECHO result_dir = %result_dir% IF "%result_dir%" == "" ( SET fail=Param #2 {backup collecting directory} missing! GOTO finish ) REM Cut the result dir if it is in path-style (ends with separator) IF "%result_dir:~-1%" == "\" SET result_dir=%result_dir:~0,-1% REM Try to create the result directory if it is not exists yet IF NOT EXIST "%result_dir%" ( MD "%result_dir%" IF NOT EXIST "%result_dir%" ( SET fail=Cannot create backup collecting directory! GOTO finish ) ) REM Test if it is local or remote directory (elementary, may get wrong answer) SET is_local_result_dir=1 IF "%result_dir:~0,2%" == "\\" SET is_local_result_dir=0</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> このブロックにはエラー処理コードがあり、エラーが発生すると変数にエラーの本質が書き込まれます。その後、制御はスクリプトの最後に移動します。管理者とのフィードバックブロックです。 同様のハンドラーは、後続のすべてのブロックにあり、さらにそれらについては特に言及しません。 </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">渡された残りのパラメーターの読み取り</b> <div class="spoiler_text"> ここにブロックがあります： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 次のパラメーターの読み取り。 </li><li> キーを名前と値に分離します。 </li><li> キー認識、その処理への移行。 </li><li> 保存するコピーの数を設定します。 </li><li> コピーの総量を設定します。 </li><li> データベース内のガベージコレクションのフラグを管理します。 </li><li> 回復フラグ管理のテスト。 </li><li> アーカイバによる圧縮率の定義。 </li><li> リモートサーバーのSYSDBAパスワードを保存します。 </li><li> アーカイブ用の追加ファイルのリストを読む。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Use other command line options ============================================ :loop_options SHIFT SET next_param=%~2 IF "%next_param%" == "" GOTO print_options SET prefix=%next_param:~0,1% IF "%prefix%" == "/" SET next_param=%next_param:~1% IF "%prefix%" == "-" SET next_param=%next_param:~1% IF "%next_param%" GTR "" ( FOR /f "DELIMS=: TOKENS=1*" %%i IN ("%next_param%") DO ( SET value=%%j IF /i "%%i" == "count" IF "%%j" GTR "" GOTO count IF /i "%%i" == "space" IF "%%j" GTR "" GOTO space IF /i "%%i" == "gc" GOTO gc IF /i "%%i" == "restore" GOTO restore IF /i "%%i" == "compress" IF "%%j" GTR "" GOTO compress IF /i "%%i" == "password" IF "%%j" GTR "" GOTO password IF EXIST "%next_param%" GOTO add_file_to_compress IF "%prefix%" GTR "/" GOTO add_file_to_compress ECHO unknown param found: %next_param% GOTO loop_options ) ) ELSE ( ECHO empty param found! GOTO loop_options ) REM ==== Define file count in the result dir ======================================= :count SET /a backup_count=0+%value% GOTO loop_options REM ==== Define allowed backup space limit ========================================= :space SET suffix=%value:~-1% IF "%suffix%" GTR "9" ( SET value=%value:~0,-1% IF /i "%suffix%" == "K" ( SET file_size_shift=0 SET /a value*=1000 ) IF /i "%suffix%" == "M" ( SET file_size_shift=3 SET /a value*=1000 ) IF /i "%suffix%" == "G" ( SET file_size_shift=6 SET /a value*=1000 ) ) SET /a backup_space_limit=0+%value% GOTO loop_options REM ==== Define need of garbage collection ========================================= :gc SET garbage_collection= IF "%value%" == "0" SET garbage_collection=-g IF /i "%value%" == "N" SET garbage_collection=-g IF /i "%value%" == "NO" SET garbage_collection=-g IF /i "%value%" == "OFF" SET garbage_collection=-g GOTO loop_options REM ==== Define need of test restore =============================================== :restore SET restore=1 IF "%value%" == "0" SET restore=0 IF /i "%value%" == "N" SET restore=0 IF /i "%value%" == "NO" SET restore=0 IF /i "%value%" == "OFF" SET restore=0 GOTO loop_options REM ==== Define need of backup compression and compress ratio ====================== :compress IF "%value%" GEQ "0" IF "%value%" LEQ "5" SET rar_compress_ratio=%value% GOTO loop_options REM ==== Define SYSDBA password (in addition or for replace source code given) ===== :password if "%ISC_PASSWORD_LOCAL%" GTR "" if "%ISC_PASSWORD_REMOTE%" GTR "" ( SET ISC_PASSWORD_LOCAL=%value% SET ISC_PASSWORD_REMOTE=%value% ) if "%ISC_PASSWORD_LOCAL%" == "" SET ISC_PASSWORD_LOCAL=%value% if "%ISC_PASSWORD_REMOTE%" == "" SET ISC_PASSWORD_REMOTE=%value% GOTO loop_options REM ==== Define file list to compress (in addition to backup and maybe logs) ======= :add_file_to_compress IF "%backup_files%" == "" ( SET backup_files="%next_param%" ) ELSE ( SET backup_files=%backup_files% "%next_param%" ) GOTO loop_options</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 注： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> レストランまたはガベージコレクションのブールフラグは、次の値を取ります。False= 0、N、NO、OFF。  True = 1、Y、YES、ON。 </li><li> 格納されるデータの合計量はバイト単位で転送されます。 しかし、以来 コマンドプロセッサの数値は32ビット整数に制限されているため、1 GBを超える値を送信するには、接尾辞のキロバイト（K）、メガバイト（M）、またはギガバイト（G）を指定するのが最適です。 例：/スペース：1200K、/スペース：280M、/スペース：12G。 このブロックでは、ストレージユニットのスケールを切り捨てるコードを観察することもできます。これにより、コマンドプロセッサの32ビット演算を超えるボリュームを操作できます。 </li><li> 転送されたパスワードは次のように解釈されます。ソースが変数ISC_PASSWORD_LOCAL（ローカル）および変数ISC_PASSWORD_REMOTE（リモート）の値を定義している場合、転送された値はこれらの変数の両方をオーバーライドします。 その他の場合（少なくとも1つの変数が定義されていない場合）、転送された値は空の変数にのみ書き込まれ、入力された値はその所定の値を保持します。 </li><li> 圧縮用の追加ファイル（またはファイルマスク）は、キーシンボル[/]なしで自然な方法で転送されます。 </li></ul></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">スクリプトを実行するための最終パラメーターを出力します</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 保存されたコピーの数の出力。 </li><li> コピーを保存するための合計スペースの出力。 </li><li> 出力フラグのガベージコレクション。 </li><li> フラグ出力テスト回復; </li><li> アーカイブの兆候と使用される圧縮率の結論。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Print predefined or recognized in command line options ==================== :print_options IF %backup_count% GTR 0 ( ECHO backup_count = %backup_count% ) ELSE ( ECHO backup_count = OFF ) IF "%file_size_shift%" == "" SET file_size_shift=0 IF %backup_space_limit% GTR 0 ( IF %file_size_shift% == 6 ( ECHO backup_space_limit = %backup_space_limit% Mb ) ELSE IF %file_size_shift% == 3 ( ECHO backup_space_limit = %backup_space_limit% Kb ) ELSE ECHO backup_space_limit = %backup_space_limit% bytes ) ELSE ( ECHO backup_space_limit = OFF ) IF "%garbage_collection%" == "-g" ( ECHO garbage_collection_flag = OFF ) ELSE ( ECHO garbage_collection_flag = ON ) IF %restore% == 0 ( ECHO test_restore_flag = OFF ) ELSE ( ECHO test_restore_flag = ON ) IF %rar_compress_ratio% == 0 ( ECHO backup_compressing = OFF ) ELSE ( ECHO backup_compressing = ON, RAR-ratio=%rar_compress_ratio% )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">ワークファイル定義</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> バックアップファイル名で使用するタイムスタンプを削除します。 </li><li> 宛先ディレクトリに直接バックアップするか、その後のリカバリ、圧縮などのために最初に一時ストレージにバックアップするかを決定します。 </li><li> バックアップファイルの完全な仕様の定義。 </li><li> バックアップログの完全な仕様の定義。 </li><li> 計算されたパラメーターの印刷。 </li><li> レストランのフラグが立てられている場合、レストランのファイルとレストランのログの仕様の決定と印刷 </li><li> 圧縮が要求された場合、アーカイブファイルの定義と印刷。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Define backup file and backup log ========================================= SET datetime=%date:~-2%%date:~3,2%%date:~0,2%_%time:~0,2%%time:~3,2% SET finish_file=%result_dir%\%local_file_or_alias%.%datetime: =0%.%backup_ext% SET direct_backup=0 IF %rar_compress_ratio% == 0 ( IF %is_local_result_dir% == 1 SET direct_backup=1 IF %restore% == 0 SET direct_backup=1 ) IF %direct_backup% == 1 ( SET backup_file=%finish_file% ) ELSE ( SET backup_file=%temp_backup_dir%\%local_file_or_alias%.%backup_ext% IF NOT EXIST "%temp_backup_dir%" ( MD "%temp_backup_dir%" IF NOT EXIST "%temp_backup_dir%" ( SET fail=Cannot create backup directory! GOTO finish ) ) ) ECHO backup_file = %backup_file% SET backup_log=%result_dir%\%local_file_or_alias%.backup.log ECHO backup_log = %backup_log% REM ==== Define restore file and restore log ======================================= SET restore_file=%temp_restore_dir%\%local_file_or_alias%.testrest IF %restore% GTR 0 ( IF NOT EXIST "%temp_restore_dir%" ( MD "%temp_restore_dir%" IF NOT EXIST "%temp_restore_dir%" ( ECHO temp_restore_dir = %temp_restore_dir% SET fail=Cannot create restore directory! GOTO finish ) ) ECHO restore_file = %restore_file% SET restore_log=%result_dir%\%local_file_or_alias%.restore.log ) IF "%restore_log%" GTR "" ( ECHO restore_log = %restore_log% ) else ( SET restore_log=just_a_stub ) REM ==== Define compresed file ===================================================== SET compressed_file=%finish_file%.rar IF %rar_compress_ratio% GTR 0 ( ECHO compressed_file = %compressed_file% SET finish_file=%compressed_file% )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">宛先ディレクトリから余分なコピーを削除する</b> <div class="spoiler_text"><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Delete not actual files (over defined count) ============================== SET /a over=%backup_count%-1 IF %backup_count% == 1 ( ECHO deleting_old_files = %result_dir%\%local_file_or_alias%.*.%backup_ext%* DEL "%result_dir%\%local_file_or_alias%.*.%backup_ext%*" /q ) ELSE IF %backup_count% GTR 1 ( FOR /f "SKIP=%over%" %%f IN ('DIR "%result_dir%\%local_file_or_alias%.*.%backup_ext%*" /a:-D /b /o:-N 2^&gt;NUL') DO ( IF EXIST "%result_dir%\%%f" ( ECHO deleting_old_file = %result_dir%\%%f DEL "%result_dir%\%%f" /q ) ) )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">バックアップ実行</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 以前のバックアップログを削除します（古いログにつまずくとgbak.exeはエラーを返します）。 </li><li> データベースがローカルとして認識されるかリモートとして認識されるかに応じて、パスワードが選択されます。 </li><li> データベースの場所とバックアップ用のディレクトリの場所に応じて、最速の戦略を使用する能力を決定します-サービスを介したバックアップ、またはその他の従来のバックアップ。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Perform backup ============================================================ IF EXIST "%backup_log%" DEL "%backup_log%" /q ECHO backup_start = %date% %time:~0,8% SET is_local_backup=0 IF %is_local_db% == 1 ( IF %is_local_result_dir% == 1 SET is_local_backup=1 IF %direct_backup% == 0 SET is_local_backup=1 SET ISC_PASSWORD=%ISC_PASSWORD_LOCAL% ) ELSE ( SET ISC_PASSWORD=%ISC_PASSWORD_REMOTE% ) IF "%rar_password%" == "" SET rar_password=%ISC_PASSWORD% IF %is_local_backup% == 1 ( ECHO %gbak% -b %garbage_collection% -se %service_mgr_host%:service_mgr %local% "%backup_file%" -v -y "%backup_log%" %gbak% -b %garbage_collection% -se %service_mgr_host%:service_mgr %local% "%backup_file%" -v &gt;"%backup_log%" 2&gt;&amp;1 ) ELSE ( ECHO %gbak% -b %garbage_collection% "%full_db_specification%" "%backup_file%" -v -y "%backup_log%" %gbak% -b %garbage_collection% "%full_db_specification%" "%backup_file%" -v &gt;"%backup_log%" 2&gt;&amp;1 ) IF %ERRORLEVEL% GTR 0 ( IF EXIST "%backup_log%" ( SET fail=Backup fail! See %backup_log% for details. ) ELSE ( SET fail=Backup fail! ) GOTO finish ) IF NOT EXIST "%backup_log%" ( SET fail=Backup fail! GOTO finish )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">テストリカバリの実行</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 以前のレストランのログを削除します（古いログにつまずくとgbak.exeはエラーを返します）。 </li><li> リカバリの実行（バックアップファイルとテストデータベースの両方がスクリプトのこのブランチでローカルであるため、常にサービスを介して）; </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Perform test restore ====================================================== IF %restore% GTR 0 ( IF EXIST "%restore_log%" DEL "%restore_log%" /q IF "%ISC_PASSWORD_LOCAL%" GTR "" ( SET ISC_PASSWORD=%ISC_PASSWORD_LOCAL% ) ELSE ( SET ISC_PASSWORD=%ISC_PASSWORD_REMOTE% ) ECHO restore_start = %date% %time:~0,8% ECHO %gbak% -rep -se %service_mgr_host%:service_mgr "%backup_file%" "%restore_file%" -v -y "%restore_log%" %gbak% -rep -se %service_mgr_host%:service_mgr "%backup_file%" "%restore_file%" -v &gt;"%restore_log%" 2&gt;&amp;1 IF %ERRORLEVEL% GTR 0 ( IF EXIST "%restore_log%" ( SET fail=Test restore fail! See %restore_log% for details. ) ELSE ( SET fail=Test restore fail! ) GOTO finish ) IF NOT EXIST "%restore_log%" ( SET fail=Test restore fail! GOTO finish ) )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 注： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      InterBase、Yaffil、またはFirebirdがバージョン2.0より新しい場合は、-rep回復フラグを-rに置き換える必要があります。 </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">アーカイブ圧縮</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> アーカイブパスワードと圧縮率を含む、すべてのrarパラメータとキーのコレクション。 </li><li> バックアップ、ログ（ポリシーで指定されている場合）およびその他のファイル（転送されている場合）を含む、圧縮用のすべてのファイルのコレクション。 </li><li> 圧縮が指定されている場合、圧縮を実行します。 </li><li> 圧縮が無効になっている場合、バックアップファイルを宛先ディレクトリにコピーするだけです（スクリプトが最初にそこに作成しなかった場合のみ）。 </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Perform RAR-compression or copy backup into destination dir =============== IF "%rar_password%" GTR "" SET rar_password=-p%rar_password% SET rar_options=%rar_options% -m%rar_compress_ratio% SET backup_files="%backup_file%" %backup_files% IF %include_logs_to_archive% == 1 ( IF %restore% GTR 0 ( SET backup_files=%backup_files% "%backup_log%" "%restore_log%" ) ELSE ( SET backup_files=%backup_files% "%backup_log%" ) ) IF %rar_compress_ratio% GTR 0 ( ECHO compressing_start = %date% %time:~0,8% ECHO %rar% %rar_options% "%compressed_file%" %backup_files% %rar% %rar_options% %rar_password% "%compressed_file%" %backup_files% IF %ERRORLEVEL% GTR 0 ( SET fail=Compression fail! GOTO finish ) ) ELSE IF %direct_backup% == 0 ( ECHO copying_start = %date% %time:~0,8% ECHO COPY "%backup_file%" "%finish_file%" COPY "%backup_file%" "%finish_file%" )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 注： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     多くの議論で、バックアップコピーの圧縮を高速化するために、最初の出力が2番目の入力に直接送られるときにgbak.exeとrar.exeが一緒に起動される例があります。 残念ながら、この方法には使用を推奨できない重大な欠点があります。gbak.exeが失敗した場合、いずれにしてもゼロ（成功）のリターンコードが返されます。  rar.exeは、gbak.exeが崩壊する前に転送することができたパン粉を正直かつ間違いなく保存しました。 つまり 破損したバックアップを復元しようとするか、作成されたアーカイブのペニーサイズに誤って注意を払わない限り、バックアッププロセスが失敗することは決してわかりません。 </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">指定されたディスククォータを超えるファイルを削除する</b> <div class="spoiler_text"> ここに見る： 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li> 合計ファイルサイズを計算するために必要な、コマンドプロセッサで変数の遅延展開をアクティブにしようとする試み（障害が発生した場合、ユーザーに通知してブロックを終了する）。 </li><li> 新鮮なものから最も古いものまでの累積バックアップを検索し、それらの合計ボリュームをカウントします。    ,    .     ,     32-          (   ),         . </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Delete not actual files (over defined space) ============================== IF %backup_space_limit% GTR 0 ( SETLOCAL EnableDelayedExpansion IF %ERRORLEVEL% GTR 0 ( ECHO You must enable var delayed expansion by CMD.EXE /V:ON or at registry key ECHO Software\Microsoft\Command Processor\DelayedExpansion: HKLM or HKCU GOTO finish ) FOR /f %%f IN ('DIR "%result_dir%\%local_file_or_alias%.*.%backup_ext%*" /a:-D /b /o:-N') DO ( FOR %%i in ("%result_dir%\%%f") DO ( SET size=%%~zi IF %file_size_shift% == 3 SET size=!size:~0,-3! IF %file_size_shift% == 6 SET size=!size:~0,-6! IF "!size!" == "" SET size=0 IF "!total_space!" == "" ( SET /a total_space=!size! ) ELSE ( IF !total_space! LEQ %backup_space_limit% SET /a total_space+=!size! IF !total_space! GTR %backup_space_limit% ( ECHO deleting_overquota_file = %result_dir%\%%f DEL "%result_dir%\%%f" /q ) ) ) ) )</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> </div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終部</font></font></b> <div class="spoiler_text">   : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>         ,   :  ,  ,  ; </li><li>      NET SEND,      ; </li><li>      (, , , ),       ; </li><li>   - ,       ; </li><li>      —      ,      (  —  ),    ; </li></ul><pre> <code class="dos hljs"><span class="hljs-comment"><span class="hljs-comment">REM ==== Report when fail or exit ================================================== :finish IF "%fail%" == "" ( ECHO Finish = %date% %time:~0,8% GOTO exit ) ECHO #=============================================================================# ECHO # %fail% ECHO #=============================================================================# SET fail=%fail%, DB: %full_db_specification%, Dest: %result_dir% IF "%net_send_receiver%" GTR "" ( ECHO NET SEND %net_send_receiver% "%fail%" NET SEND %net_send_receiver% "%fail%" ) IF "%blat%" GTR "" IF "%smtp_server%" GTR "" IF "%mail_sender%" GTR "" IF "%mail_login%" GTR "" IF "%mail_receiver%" GTR "" ( ECHO %blat% -to "%mail_receiver%" -subject "%mail_subject%" -body "%fail%" -server %smtp_server% -f "%mail_sender%" -u "%mail_login%" -pw "*******" %blat% -to "%mail_receiver%" -subject "%mail_subject%" -body "%fail%" -server %smtp_server% -f "%mail_sender%" -u "%mail_login%" -pw "%mail_password%" ) SET time_ex=%time: =0% IF "%error_log%" GTR "" ( ECHO %date% %time_ex:~0,8% %fail% &gt;&gt; "%error_log%" ) EXIT /b 1 :exit</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちの日常業務でのスクリプトの使用を説明するスクリプトをいくつか紹介します。</font><font style="vertical-align: inherit;">条件付きで「夜間バックアップ」と「昼バックアップ」と呼びます。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">夜になると、誰も基地で働いていないか、ほとんど誰も働いていません。</font><font style="vertical-align: inherit;">サーバーリソースはアイドル状態であるため、完全なb / rサイクルを作成することが適切</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">つまり、次のとおり</font><font style="vertical-align: inherit;">です。-ガベージコレクションを使用したバックアップ。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-テストの回復。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-バックアップとアプリケーションプログラムの現在のバージョンの圧縮、および最適な方法での圧縮。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「夜間バックアップ」を起動する例を次に示します。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">fb_backup.bat localhost:Orma4 d:\Bak /count:<span class="hljs-number"><span class="hljs-number">99</span></span> /space:<span class="hljs-number"><span class="hljs-number">500</span></span>G /compress:<span class="hljs-number"><span class="hljs-number">5</span></span> /<span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> /gc d:\Orma.exe &gt;C:\Orma4.log <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それどころか、「日次バックアップ」の起動は、サーバーへの負担を最小限に抑え、データベースに接続しているユーザーにできるだけ負担をかけずに、できるだけ早く解決する必要があります。</font><font style="vertical-align: inherit;">したがって、ガベージコレクションとテストリカバリを除外し、最速の方法で圧縮し、バックアップファイルのみを圧縮します。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">fb_backup.bat localhost:Orma4 d:\Bak /count:<span class="hljs-number"><span class="hljs-number">99</span></span> /space:<span class="hljs-number"><span class="hljs-number">500</span></span>G /compress:<span class="hljs-number"><span class="hljs-number">1</span></span> &gt;C:\Orma4.log <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リモートサーバーへのバックアップを記録するための別のオプションがあります（セキュリティ上の理由から、「すべての卵を1つのバスケットに保管しない」という原則に従って）。</font><font style="vertical-align: inherit;">中間のキーセットを組み合わせます。</font><font style="vertical-align: inherit;">通常、アーカイバは、ネットワークがファイル転送を処理できる速度より速く粉砕し、他の操作（ガベージコレクション、テストリカバリ、アプリケーションプログラムの保存など）を可能な限り除外します。</font><font style="vertical-align: inherit;">ローカルサーバーへの「夜間バックアップ」が既に行われています。</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">fb_backup.bat localhost:Orma4 \\ifs\E$\backup\FirebirdDB /count:<span class="hljs-number"><span class="hljs-number">99</span></span> /space:<span class="hljs-number"><span class="hljs-number">300</span></span>G /compress:<span class="hljs-number"><span class="hljs-number">5</span></span> &gt;C:\Orma4.log <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 知識のない人にとって、コマンドの終了とは、スクリプト出力（stdout）をファイルにリダイレクトし、エラー出力（stderr）を同じファイルに送信することを意味します。 </font></font><pre> <code class="dos hljs"> &gt;C:\Orma4.log <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span></code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
     </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> スクリプトの制限について少し。 </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>          Windows,          ,   Linux. ,                 UNIX-.      ,  , ,   .   ,  -       . </li><li>    ,   SYSDBA     ,         .           <a href="http://firebird.svn.sourceforge.net/viewvc/firebird/firebird/trunk/doc/README.trusted_authentication%3Fview%3Dmarkup">Windows Trusted Authentication</a> ,    b/r         ,    . </li><li>      ,   , ..    ,      ,       .           ,           (,      FB2.5.1,      FB2.5.2   2.5.3,    ), ..    b/r     . </li><li> b/r      SYSDBA (  ,       ).        .  ,         (  ),   . </li><li>        ,      . ,   —    ,    «»,      ,    —    .             :     ,       . </li><li>     ,     (  ,      ).        :   /  «»    1251,           ,       866. .. FAR         ,      .        UTF8. </li><li>         ,   (     ),       ,   , , ,      /    ,  ,    .   ,         . </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../J158561/index.html">WPF：カスタムウィンドウ</a></li>
<li><a href="../J158565/index.html">機会-忘れられた記録保持者</a></li>
<li><a href="../J158567/index.html">証明書で開発者IDインストーラーに署名します</a></li>
<li><a href="../J158569/index.html">node.jsの下でbackbone.jsを使用します</a></li>
<li><a href="../J158573/index.html">[翻訳]マイクロコントローラーは時代遅れですか？</a></li>
<li><a href="../J158577/index.html">iPad用のjQueryスニペットとプラグイン</a></li>
<li><a href="../J158579/index.html">ますます少なく...マイクロサーバー-マクロタスクのソリューション</a></li>
<li><a href="../J158583/index.html">Google GlassのライバルであるVuzix Smart Glasses M100は2013年初頭に発売されます</a></li>
<li><a href="../J158585/index.html">7 Bubey iOSゲーム開発者</a></li>
<li><a href="../J158587/index.html">Umbraco CMSをコンテンツのソースとして固定します</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter70218013 = new Ya.Metrika({
                  id:70218013,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/70218013" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'G-FEDBM7F51Q', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Clever Geek | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <div class="company-info js-company-info" itemscope="" itemtype="http://schema.org/Organization">
      <span itemprop="name">Western Town Media (WTM)</span>
      <div itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress">
        <span itemprop="streetAddress">1968 Stoney Lonesome Road</span>
        <br>
        <span itemprop="postalCode">PA 18640</span>
        <span itemprop="addressLocality">Pittston, USA</span>
      </div>
      <span itemprop="telephone">570-362-1316</span>
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Pittston, USA",
          "postalCode": "PA 18640",
          "streetAddress": "1968 Stoney Lonesome Road"
        },
        "name": "Western Town Media (WTM)",
        "telephone": "570-362-1316"
      }
    </script>
  </div>
</footer>
  
</body>

</html>